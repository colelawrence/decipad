AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: Exported by architect/package@6.2.0 on 2021-04-30T15:50:09.439Z
Resources:
  HTTP:
    Type: AWS::Serverless::HttpApi
    Properties:
      StageName: $default
      DefinitionBody:
        openapi: 3.0.1
        info:
          title:
            Ref: AWS::StackName
        paths:
          /{proxy+}:
            get:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetCatchallHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /test:
            post:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${PostTestHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /test/{id}:
            get:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetTestIdHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /graphql:
            get:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetGraphqlHTTPLambda.Arn}/invocations
                connectionType: INTERNET
            post:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${PostGraphqlHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/auth/signin:
            get:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetApiAuthSigninHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/auth/signin/{provider}:
            post:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${PostApiAuthSigninProviderHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/auth/callback/{provider}:
            get:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetApiAuthCallbackProviderHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/auth/signout:
            get:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetApiAuthSignoutHTTPLambda.Arn}/invocations
                connectionType: INTERNET
            post:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${PostApiAuthSignoutHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/auth/session:
            get:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetApiAuthSessionHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/auth/csrf:
            get:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetApiAuthCsrfHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/auth/providers:
            get:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetApiAuthProvidersHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/auth/error:
            get:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetApiAuthErrorHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/auth/token:
            get:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetApiAuthTokenHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/workspaces:
            get:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetApiWorkspacesHTTPLambda.Arn}/invocations
                connectionType: INTERNET
            put:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${PutApiWorkspacesHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/workspaces/changes:
            put:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${PutApiWorkspacesChangesHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/workspaces/{workspaceid}:
            get:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetApiWorkspacesWorkspaceidHTTPLambda.Arn}/invocations
                connectionType: INTERNET
            put:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${PutApiWorkspacesWorkspaceidHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/workspaces/{workspaceid}/changes:
            put:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${PutApiWorkspacesWorkspaceidChangesHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/workspaces/{workspaceid}/pads:
            get:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetApiWorkspacesWorkspaceidPadsHTTPLambda.Arn}/invocations
                connectionType: INTERNET
            put:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${PutApiWorkspacesWorkspaceidPadsHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/workspaces/{workspaceid}/pads/changes:
            put:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${PutApiWorkspacesWorkspaceidPadsChangesHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/pads/{padid}:
            get:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetApiPadsPadidHTTPLambda.Arn}/invocations
                connectionType: INTERNET
            put:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${PutApiPadsPadidHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/pads/{padid}/changes:
            put:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${PutApiPadsPadidChangesHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/pads/{padid}/content:
            get:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetApiPadsPadidContentHTTPLambda.Arn}/invocations
                connectionType: INTERNET
            put:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${PutApiPadsPadidContentHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /api/pads/{padid}/content/changes:
            put:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '2.0'
                type: aws_proxy
                httpMethod: POST
                uri:
                  Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${PutApiPadsPadidContentChangesHTTPLambda.Arn}/invocations
                connectionType: INTERNET
          /_static/{proxy+}:
            get:
              x-amazon-apigateway-integration:
                payloadFormatVersion: '1.0'
                type: http_proxy
                httpMethod: GET
                uri:
                  Fn::Sub:
                  - http://${bukkit}.s3.${AWS::Region}.amazonaws.com/{proxy}
                  - bukkit:
                      Ref: StaticBucket
                connectionType: INTERNET
                timeoutInMillis: 30000
  GetCatchallHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/5ba428bd26d605bb0537ce3c81316643
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        GetCatchallHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /{proxy+}
            Method: GET
            ApiId:
              Ref: HTTP
  PostTestHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/0db5de084ddce86a060ab1a2ba9ef3c8
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        PostTestHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /test
            Method: POST
            ApiId:
              Ref: HTTP
  GetTestIdHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/1ee9ef85b690a7253f2fb72306727dc8
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        GetTestIdHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /test/{id}
            Method: GET
            ApiId:
              Ref: HTTP
  GetGraphqlHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/5337f9f79312c0a8b263d2032b7297cc
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        GetGraphqlHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /graphql
            Method: GET
            ApiId:
              Ref: HTTP
  PostGraphqlHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/274951f97e76689e11ce89fd5d959f05
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        PostGraphqlHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /graphql
            Method: POST
            ApiId:
              Ref: HTTP
  GetApiAuthSigninHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/c231cadbee06153a3028e3b167dbdff1
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        GetApiAuthSigninHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/auth/signin
            Method: GET
            ApiId:
              Ref: HTTP
  PostApiAuthSigninProviderHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/d0e6f2be50b4167345f33fc6b47ae3c8
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        PostApiAuthSigninProviderHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/auth/signin/{provider}
            Method: POST
            ApiId:
              Ref: HTTP
  GetApiAuthCallbackProviderHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/56df6b2400cc92b89a3127955ac1dc18
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        GetApiAuthCallbackProviderHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/auth/callback/{provider}
            Method: GET
            ApiId:
              Ref: HTTP
  GetApiAuthSignoutHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/91ff8bb18e7f1bf28a8353c56d399d41
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        GetApiAuthSignoutHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/auth/signout
            Method: GET
            ApiId:
              Ref: HTTP
  PostApiAuthSignoutHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/06a0e21fc5c28df7646ab87c3278caa8
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        PostApiAuthSignoutHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/auth/signout
            Method: POST
            ApiId:
              Ref: HTTP
  GetApiAuthSessionHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/7fd8ac68f5fd5a92a7496f9303d2689a
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        GetApiAuthSessionHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/auth/session
            Method: GET
            ApiId:
              Ref: HTTP
  GetApiAuthCsrfHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/1f3221db59fc8038497f4f4c6b311c66
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        GetApiAuthCsrfHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/auth/csrf
            Method: GET
            ApiId:
              Ref: HTTP
  GetApiAuthProvidersHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/59e3cac5e958399d616eae3122b54f4c
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        GetApiAuthProvidersHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/auth/providers
            Method: GET
            ApiId:
              Ref: HTTP
  GetApiAuthErrorHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/7c1b32b3929ff37e1cf2f051e888d5d7
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        GetApiAuthErrorHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/auth/error
            Method: GET
            ApiId:
              Ref: HTTP
  GetApiAuthTokenHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/38232eee97611f514697a3b48996f0cd
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        GetApiAuthTokenHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/auth/token
            Method: GET
            ApiId:
              Ref: HTTP
  GetApiWorkspacesHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/4b79fac60ab70061704dc934ee319e3e
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        GetApiWorkspacesHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/workspaces
            Method: GET
            ApiId:
              Ref: HTTP
  PutApiWorkspacesHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/7e400c7b6c425b757b31c22b793acc2d
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        PutApiWorkspacesHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/workspaces
            Method: PUT
            ApiId:
              Ref: HTTP
  PutApiWorkspacesChangesHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/d9cee3c746689658fb0ba3268cb48f25
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        PutApiWorkspacesChangesHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/workspaces/changes
            Method: PUT
            ApiId:
              Ref: HTTP
  GetApiWorkspacesWorkspaceidHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/c66a29e3142d8f10eedc65995c5b5941
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        GetApiWorkspacesWorkspaceidHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/workspaces/{workspaceid}
            Method: GET
            ApiId:
              Ref: HTTP
  PutApiWorkspacesWorkspaceidHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/16471a13c51ddeb13c49cf1ccfd17cc5
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        PutApiWorkspacesWorkspaceidHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/workspaces/{workspaceid}
            Method: PUT
            ApiId:
              Ref: HTTP
  PutApiWorkspacesWorkspaceidChangesHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/a7d370148950a425399da530d7503739
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        PutApiWorkspacesWorkspaceidChangesHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/workspaces/{workspaceid}/changes
            Method: PUT
            ApiId:
              Ref: HTTP
  GetApiWorkspacesWorkspaceidPadsHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/88c06be4e35f71be4bd44309682c35b5
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        GetApiWorkspacesWorkspaceidPadsHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/workspaces/{workspaceid}/pads
            Method: GET
            ApiId:
              Ref: HTTP
  PutApiWorkspacesWorkspaceidPadsHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/eb966dde958fa290c5483352eaf1117a
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        PutApiWorkspacesWorkspaceidPadsHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/workspaces/{workspaceid}/pads
            Method: PUT
            ApiId:
              Ref: HTTP
  PutApiWorkspacesWorkspaceidPadsChangesHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/c1a13e7365df06cfbbd036b37b17a9a1
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        PutApiWorkspacesWorkspaceidPadsChangesHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/workspaces/{workspaceid}/pads/changes
            Method: PUT
            ApiId:
              Ref: HTTP
  GetApiPadsPadidHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/c51b2dae2a87a108849cd0149e5f665e
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        GetApiPadsPadidHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/pads/{padid}
            Method: GET
            ApiId:
              Ref: HTTP
  PutApiPadsPadidHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/ef38e6d9a10f19cfc94b5ddd2a654b09
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        PutApiPadsPadidHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/pads/{padid}
            Method: PUT
            ApiId:
              Ref: HTTP
  PutApiPadsPadidChangesHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/ab904eda9df2d0b90d7cbb6073735c40
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        PutApiPadsPadidChangesHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/pads/{padid}/changes
            Method: PUT
            ApiId:
              Ref: HTTP
  GetApiPadsPadidContentHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/95e589eaea842972b8bd363749f7a2a9
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        GetApiPadsPadidContentHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/pads/{padid}/content
            Method: GET
            ApiId:
              Ref: HTTP
  PutApiPadsPadidContentHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/dbd16c5b38a290bcd168083e3e4cb3dc
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        PutApiPadsPadidContentHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/pads/{padid}/content
            Method: PUT
            ApiId:
              Ref: HTTP
  PutApiPadsPadidContentChangesHTTPLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/1e8c8d21b9fe52cb4e27513c52315079
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events:
        PutApiPadsPadidContentChangesHTTPEvent:
          Type: HttpApi
          Properties:
            Path: /api/pads/{padid}/content/changes
            Method: PUT
            ApiId:
              Ref: HTTP
  TestTable:
    Type: AWS::DynamoDB::Table
    Properties:
      KeySchema:
      - AttributeName: key
        KeyType: HASH
      AttributeDefinitions:
      - AttributeName: key
        AttributeType: S
      BillingMode: PAY_PER_REQUEST
  UsersTable:
    Type: AWS::DynamoDB::Table
    Properties:
      KeySchema:
      - AttributeName: id
        KeyType: HASH
      AttributeDefinitions:
      - AttributeName: id
        AttributeType: S
      BillingMode: PAY_PER_REQUEST
      SSESpecification:
        SSEEnabled: true
  UserprofilesTable:
    Type: AWS::DynamoDB::Table
    Properties:
      KeySchema:
      - AttributeName: user_id
        KeyType: HASH
      AttributeDefinitions:
      - AttributeName: user_id
        AttributeType: S
      BillingMode: PAY_PER_REQUEST
      SSESpecification:
        SSEEnabled: true
  UserkeysTable:
    Type: AWS::DynamoDB::Table
    Properties:
      KeySchema:
      - AttributeName: id
        KeyType: HASH
      AttributeDefinitions:
      - AttributeName: id
        AttributeType: S
      BillingMode: PAY_PER_REQUEST
      SSESpecification:
        SSEEnabled: true
  SyncdocTable:
    Type: AWS::DynamoDB::Table
    Properties:
      KeySchema:
      - AttributeName: id
        KeyType: HASH
      AttributeDefinitions:
      - AttributeName: id
        AttributeType: S
      BillingMode: PAY_PER_REQUEST
      SSESpecification:
        SSEEnabled: true
  ConnectionsTable:
    Type: AWS::DynamoDB::Table
    Properties:
      KeySchema:
      - AttributeName: id
        KeyType: HASH
      AttributeDefinitions:
      - AttributeName: id
        AttributeType: S
      BillingMode: PAY_PER_REQUEST
      SSESpecification:
        SSEEnabled: true
  CollabsTable:
    Type: AWS::DynamoDB::Table
    Properties:
      KeySchema:
      - AttributeName: id
        KeyType: HASH
      AttributeDefinitions:
      - AttributeName: id
        AttributeType: S
      - AttributeName: room
        AttributeType: S
      - AttributeName: conn
        AttributeType: S
      BillingMode: PAY_PER_REQUEST
      SSESpecification:
        SSEEnabled: true
      GlobalSecondaryIndexes:
      - IndexName: room-index
        KeySchema:
        - AttributeName: room
          KeyType: HASH
        Projection:
          ProjectionType: ALL
      - IndexName: conn-index
        KeySchema:
        - AttributeName: conn
          KeyType: HASH
        Projection:
          ProjectionType: ALL
  StaticBucket:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: PublicRead
      WebsiteConfiguration:
        IndexDocument: index.html
        ErrorDocument: 404.html
  WS:
    Type: AWS::ApiGatewayV2::Api
    Properties:
      Name: DecipadBackendWebsocketStaging
      ProtocolType: WEBSOCKET
      RouteSelectionExpression: $request.body.message
  WebsocketDeployment:
    Type: AWS::ApiGatewayV2::Deployment
    DependsOn:
    - ConnectWSRoute
    - DefaultWSRoute
    - DisconnectWSRoute
    Properties:
      ApiId:
        Ref: WS
  WebsocketStage:
    Type: AWS::ApiGatewayV2::Stage
    Properties:
      StageName: staging
      DeploymentId:
        Ref: WebsocketDeployment
      ApiId:
        Ref: WS
  WebSocketPolicy:
    Type: AWS::IAM::Policy
    DependsOn: Role
    Properties:
      PolicyName: ArcWebSocketPolicy
      PolicyDocument:
        Statement:
        - Effect: Allow
          Action:
          - execute-api:Invoke
          - execute-api:ManageConnections
          Resource:
          - Fn::Sub:
            - arn:aws:execute-api:${AWS::Region}:*:${api}/*
            - api:
                Ref: WS
      Roles:
      - Ref: Role
  ConnectWSLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/fe063b4bdfb5a6a45faaf667018fe0a9
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events: {}
  ConnectWSRoute:
    Type: AWS::ApiGatewayV2::Route
    Properties:
      ApiId:
        Ref: WS
      RouteKey: $connect
      OperationName: ConnectWSRoute
      Target:
        Fn::Join:
        - /
        - - integrations
          - Ref: ConnectWSIntegration
  ConnectWSIntegration:
    Type: AWS::ApiGatewayV2::Integration
    Properties:
      ApiId:
        Ref: WS
      IntegrationType: AWS_PROXY
      IntegrationUri:
        Fn::Sub:
        - arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${ConnectWSLambda.Arn}/invocations
        - {}
  ConnectWSPermission:
    Type: AWS::Lambda::Permission
    DependsOn:
    - WS
    - ConnectWSLambda
    Properties:
      Action: lambda:InvokeFunction
      FunctionName:
        Ref: ConnectWSLambda
      Principal: apigateway.amazonaws.com
  DefaultWSLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/333afa3f75253daf788c616148a9914e
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events: {}
  DefaultWSRoute:
    Type: AWS::ApiGatewayV2::Route
    Properties:
      ApiId:
        Ref: WS
      RouteKey: $default
      OperationName: DefaultWSRoute
      Target:
        Fn::Join:
        - /
        - - integrations
          - Ref: DefaultWSIntegration
  DefaultWSIntegration:
    Type: AWS::ApiGatewayV2::Integration
    Properties:
      ApiId:
        Ref: WS
      IntegrationType: AWS_PROXY
      IntegrationUri:
        Fn::Sub:
        - arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${DefaultWSLambda.Arn}/invocations
        - {}
  DefaultWSPermission:
    Type: AWS::Lambda::Permission
    DependsOn:
    - WS
    - DefaultWSLambda
    Properties:
      Action: lambda:InvokeFunction
      FunctionName:
        Ref: DefaultWSLambda
      Principal: apigateway.amazonaws.com
  DisconnectWSLambda:
    Type: AWS::Serverless::Function
    Properties:
      Handler: index.handler
      CodeUri: s3://decipad-backend-cfn-deployments-11e42/4f2de5c722554827c06a9bbf05b314a4
      Runtime: nodejs12.x
      MemorySize: 1152
      Timeout: 5
      Environment:
        Variables:
          ARC_APP_NAME: decipad-backend
          ARC_CLOUDFORMATION:
            Ref: AWS::StackName
          ARC_ENV: staging
          ARC_HTTP: aws_proxy
          ARC_ROLE:
            Ref: Role
          NODE_ENV: staging
          SESSION_TABLE_NAME: jwe
          ARC_STATIC_BUCKET:
            Ref: StaticBucket
          ARC_WSS_URL:
            Fn::Sub:
            - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
            - {}
          GITHUB_CLIENT_ID: 9527494e09d1bd1db3c3
          GITHUB_CLIENT_SECRET: a278e99b6111d1b0df0d24fc146794be22f81d00
          JWT_SECRET: catwalklrjqwr92309endasjkdn023eqhjdskajhaskj
          JWT_SIGNING_PRIVATE_KEY: '{"kty":"oct","kid":"ZOZrs3wZ9G2ANQMc2H74fvZK9g50dBdFuCrECQwbznM","alg":"HS512","k":"JbdHYPsSYiiHDabJZTo1VUJd8HF56eCM_4LTbncw8Wg"}'
          NEXTAUTH_URL: https://pwjc27kjr1.execute-api.eu-west-2.amazonaws.com/api/auth
      Role:
        Fn::Sub:
        - arn:aws:iam::${AWS::AccountId}:role/${roleName}
        - roleName:
            Ref: Role
      Events: {}
  DisconnectWSRoute:
    Type: AWS::ApiGatewayV2::Route
    Properties:
      ApiId:
        Ref: WS
      RouteKey: $disconnect
      OperationName: DisconnectWSRoute
      Target:
        Fn::Join:
        - /
        - - integrations
          - Ref: DisconnectWSIntegration
  DisconnectWSIntegration:
    Type: AWS::ApiGatewayV2::Integration
    Properties:
      ApiId:
        Ref: WS
      IntegrationType: AWS_PROXY
      IntegrationUri:
        Fn::Sub:
        - arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${DisconnectWSLambda.Arn}/invocations
        - {}
  DisconnectWSPermission:
    Type: AWS::Lambda::Permission
    DependsOn:
    - WS
    - DisconnectWSLambda
    Properties:
      Action: lambda:InvokeFunction
      FunctionName:
        Ref: DisconnectWSLambda
      Principal: apigateway.amazonaws.com
  Role:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Principal:
            Service: lambda.amazonaws.com
          Action: sts:AssumeRole
      Policies:
      - PolicyName: ArcGlobalPolicy
        PolicyDocument:
          Statement:
          - Effect: Allow
            Action:
            - logs:CreateLogGroup
            - logs:CreateLogStream
            - logs:PutLogEvents
            - logs:DescribeLogStreams
            Resource: arn:aws:logs:*:*:*
      - PolicyName: ArcStaticBucketPolicy
        PolicyDocument:
          Statement:
          - Effect: Allow
            Action:
            - s3:GetObject
            - s3:PutObject
            - s3:PutObjectAcl
            - s3:DeleteObject
            Resource:
            - Fn::Sub:
              - arn:aws:s3:::${bukkit}
              - bukkit:
                  Ref: StaticBucket
            - Fn::Sub:
              - arn:aws:s3:::${bukkit}/*
              - bukkit:
                  Ref: StaticBucket
      - PolicyName: ArcDynamoPolicy
        PolicyDocument:
          Statement:
          - Effect: Allow
            Action:
            - dynamodb:BatchGetItem
            - dynamodb:BatchWriteItem
            - dynamodb:PutItem
            - dynamodb:DeleteItem
            - dynamodb:GetItem
            - dynamodb:Query
            - dynamodb:Scan
            - dynamodb:UpdateItem
            - dynamodb:GetRecords
            - dynamodb:GetShardIterator
            - dynamodb:DescribeStream
            - dynamodb:ListStreams
            Resource:
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}
              - tablename:
                  Ref: TestTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}/*
              - tablename:
                  Ref: TestTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}/stream/*
              - tablename:
                  Ref: TestTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}
              - tablename:
                  Ref: UsersTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}/*
              - tablename:
                  Ref: UsersTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}/stream/*
              - tablename:
                  Ref: UsersTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}
              - tablename:
                  Ref: UserprofilesTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}/*
              - tablename:
                  Ref: UserprofilesTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}/stream/*
              - tablename:
                  Ref: UserprofilesTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}
              - tablename:
                  Ref: UserkeysTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}/*
              - tablename:
                  Ref: UserkeysTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}/stream/*
              - tablename:
                  Ref: UserkeysTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}
              - tablename:
                  Ref: SyncdocTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}/*
              - tablename:
                  Ref: SyncdocTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}/stream/*
              - tablename:
                  Ref: SyncdocTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}
              - tablename:
                  Ref: ConnectionsTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}/*
              - tablename:
                  Ref: ConnectionsTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}/stream/*
              - tablename:
                  Ref: ConnectionsTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}
              - tablename:
                  Ref: CollabsTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}/*
              - tablename:
                  Ref: CollabsTable
            - Fn::Sub:
              - arn:aws:dynamodb:${AWS::Region}:${AWS::AccountId}:table/${tablename}/stream/*
              - tablename:
                  Ref: CollabsTable
  TestParam:
    Type: AWS::SSM::Parameter
    Properties:
      Type: String
      Name:
        Fn::Sub:
        - /${AWS::StackName}/tables/${tablename}
        - tablename: test
      Value:
        Ref: TestTable
  UsersParam:
    Type: AWS::SSM::Parameter
    Properties:
      Type: String
      Name:
        Fn::Sub:
        - /${AWS::StackName}/tables/${tablename}
        - tablename: users
      Value:
        Ref: UsersTable
  UserprofilesParam:
    Type: AWS::SSM::Parameter
    Properties:
      Type: String
      Name:
        Fn::Sub:
        - /${AWS::StackName}/tables/${tablename}
        - tablename: userprofiles
      Value:
        Ref: UserprofilesTable
  UserkeysParam:
    Type: AWS::SSM::Parameter
    Properties:
      Type: String
      Name:
        Fn::Sub:
        - /${AWS::StackName}/tables/${tablename}
        - tablename: userkeys
      Value:
        Ref: UserkeysTable
  SyncdocParam:
    Type: AWS::SSM::Parameter
    Properties:
      Type: String
      Name:
        Fn::Sub:
        - /${AWS::StackName}/tables/${tablename}
        - tablename: syncdoc
      Value:
        Ref: SyncdocTable
  ConnectionsParam:
    Type: AWS::SSM::Parameter
    Properties:
      Type: String
      Name:
        Fn::Sub:
        - /${AWS::StackName}/tables/${tablename}
        - tablename: connections
      Value:
        Ref: ConnectionsTable
  CollabsParam:
    Type: AWS::SSM::Parameter
    Properties:
      Type: String
      Name:
        Fn::Sub:
        - /${AWS::StackName}/tables/${tablename}
        - tablename: collabs
      Value:
        Ref: CollabsTable
  StaticBucketParam:
    Type: AWS::SSM::Parameter
    Properties:
      Type: String
      Name:
        Fn::Sub:
        - /${AWS::StackName}/static/${key}
        - key: bucket
      Value:
        Ref: StaticBucket
  StaticFingerprintParam:
    Type: AWS::SSM::Parameter
    Properties:
      Type: String
      Name:
        Fn::Sub:
        - /${AWS::StackName}/static/${key}
        - key: fingerprint
      Value: 'false'
  ParameterStorePolicy:
    Type: AWS::IAM::Policy
    DependsOn: Role
    Properties:
      PolicyName: ArcParameterStorePolicy
      PolicyDocument:
        Statement:
        - Effect: Allow
          Action: ssm:GetParametersByPath
          Resource:
            Fn::Sub:
            - arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter/${AWS::StackName}
            - {}
      Roles:
      - Ref: Role
Outputs:
  API:
    Description: API Gateway (HTTP)
    Value:
      Fn::Sub:
      - https://${ApiId}.execute-api.${AWS::Region}.amazonaws.com
      - ApiId:
          Ref: HTTP
  ApiId:
    Description: API ID (ApiId)
    Value:
      Ref: HTTP
  BucketURL:
    Description: Bucket URL
    Value:
      Fn::Sub:
      - http://${bukkit}.s3-website.${AWS::Region}.amazonaws.com
      - bukkit:
          Ref: StaticBucket
  WSS:
    Description: WebSocket Endpoint
    Value:
      Fn::Sub:
      - wss://${WS}.execute-api.${AWS::Region}.amazonaws.com/staging
      - {}
