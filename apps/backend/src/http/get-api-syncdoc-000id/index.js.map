{
  "version": 3,
  "sources": ["../../../../../node_modules/@sentry/serverless/node_modules/tslib/tslib.js", "../../../../../node_modules/@sentry/node/node_modules/tslib/tslib.js", "../../../../../node_modules/@sentry/node/node_modules/@sentry/types/src/loglevel.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/types/src/session.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/types/src/severity.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/types/src/status.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/types/src/transaction.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/types/src/index.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/async.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/is.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/browser.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/polyfill.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/error.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/dsn.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/node.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/string.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/misc.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/logger.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/memo.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/stacktrace.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/object.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/supports.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/instrument.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/path.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/syncpromise.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/promisebuffer.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/time.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/utils/src/index.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/hub/src/scope.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/hub/src/session.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/hub/src/hub.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/hub/src/sessionflusher.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/hub/src/index.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/minimal/src/index.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/core/src/api.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/core/src/integration.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/core/src/baseclient.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/core/src/transports/noop.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/core/src/basebackend.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/core/src/request.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/core/src/sdk.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/core/src/version.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/core/src/integrations/functiontostring.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/core/src/integrations/inboundfilters.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/core/src/integrations/index.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/core/src/index.ts", "../../../../../node_modules/lru_map/lru.js", "../../../../../node_modules/@sentry/node/src/stacktrace.ts", "../../../../../node_modules/@sentry/node/src/parsers.ts", "../../../../../node_modules/@sentry/node/src/version.ts", "../../../../../node_modules/@sentry/node/src/transports/base/index.ts", "../../../../../node_modules/ms/index.js", "../../../../../node_modules/debug/src/common.js", "../../../../../node_modules/debug/src/browser.js", "../../../../../node_modules/has-flag/index.js", "../../../../../node_modules/supports-color/index.js", "../../../../../node_modules/debug/src/node.js", "../../../../../node_modules/debug/src/index.js", "../../../../../node_modules/agent-base/src/promisify.ts", "../../../../../node_modules/agent-base/src/index.ts", "../../../../../node_modules/https-proxy-agent/src/parse-proxy-response.ts", "../../../../../node_modules/https-proxy-agent/src/agent.ts", "../../../../../node_modules/https-proxy-agent/src/index.ts", "../../../../../node_modules/@sentry/node/src/transports/http.ts", "../../../../../node_modules/@sentry/node/src/transports/https.ts", "../../../../../node_modules/@sentry/node/src/transports/index.ts", "../../../../../node_modules/@sentry/node/src/backend.ts", "../../../../../node_modules/@sentry/node/src/client.ts", "../../../../../node_modules/@sentry/node/src/integrations/console.ts", "../../../../../node_modules/@sentry/node/src/integrations/utils/http.ts", "../../../../../node_modules/@sentry/node/src/integrations/http.ts", "../../../../../node_modules/@sentry/node/src/integrations/utils/errorhandling.ts", "../../../../../node_modules/@sentry/node/src/integrations/onuncaughtexception.ts", "../../../../../node_modules/@sentry/node/src/integrations/onunhandledrejection.ts", "../../../../../node_modules/@sentry/node/src/integrations/linkederrors.ts", "../../../../../node_modules/@sentry/node/src/integrations/modules.ts", "../../../../../node_modules/@sentry/node/src/integrations/index.ts", "../../../../../node_modules/@sentry/node/src/sdk.ts", "../../../../../node_modules/@sentry/node/src/utils.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/spanstatus.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/utils.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/errors.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/span.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/transaction.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/idletransaction.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/hubextensions.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/browser/backgroundtab.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/browser/web-vitals/lib/bindReporter.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/browser/web-vitals/lib/generateUniqueID.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/browser/web-vitals/lib/initMetric.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/browser/web-vitals/lib/observe.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/browser/web-vitals/lib/onHidden.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/browser/web-vitals/getCLS.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/browser/web-vitals/lib/getFirstHidden.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/browser/web-vitals/getFID.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/browser/web-vitals/lib/whenInput.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/browser/web-vitals/getLCP.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/browser/metrics.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/browser/request.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/browser/router.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/browser/browsertracing.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/browser/index.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/integrations/express.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/integrations/postgres.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/integrations/mysql.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/integrations/mongo.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/integrations/index.ts", "../../../../../node_modules/@sentry/node/node_modules/@sentry/tracing/src/index.ts", "../../../../../node_modules/@sentry/node/node_modules/cookie/index.js", "../../../../../node_modules/@sentry/node/src/handlers.ts", "../../../../../node_modules/@sentry/node/src/index.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/async.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/is.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/browser.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/polyfill.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/error.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/dsn.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/node.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/string.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/misc.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/logger.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/memo.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/stacktrace.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/object.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/supports.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/instrument.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/path.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/syncpromise.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/promisebuffer.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/time.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/utils/src/index.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/hub/src/scope.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/types/src/loglevel.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/types/src/session.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/types/src/severity.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/types/src/status.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/types/src/transaction.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/types/src/index.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/hub/src/session.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/hub/src/hub.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/hub/src/sessionflusher.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/hub/src/index.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/spanstatus.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/utils.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/errors.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/span.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/transaction.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/idletransaction.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/hubextensions.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/browser/backgroundtab.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/browser/web-vitals/lib/bindReporter.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/browser/web-vitals/lib/generateUniqueID.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/browser/web-vitals/lib/initMetric.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/browser/web-vitals/lib/observe.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/browser/web-vitals/lib/onHidden.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/browser/web-vitals/getCLS.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/browser/web-vitals/lib/getFirstHidden.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/browser/web-vitals/getFID.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/browser/web-vitals/lib/whenInput.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/browser/web-vitals/getLCP.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/browser/metrics.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/browser/request.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/browser/router.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/browser/browsertracing.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/browser/index.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/integrations/express.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/integrations/postgres.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/integrations/mysql.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/integrations/mongo.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/integrations/index.ts", "../../../../../node_modules/@sentry/serverless/node_modules/@sentry/tracing/src/index.ts", "../../../../../node_modules/@sentry/serverless/src/awsservices.ts", "../../../../../node_modules/@sentry/serverless/src/utils.ts", "../../../../../node_modules/@sentry/serverless/src/awslambda.ts", "../../../../../node_modules/@sentry/serverless/src/google-cloud-grpc.ts", "../../../../../node_modules/@sentry/serverless/src/google-cloud-http.ts", "../../../../../node_modules/@sentry/serverless/src/gcpfunction/http.ts", "../../../../../node_modules/@sentry/serverless/src/gcpfunction/general.ts", "../../../../../node_modules/@sentry/serverless/src/gcpfunction/events.ts", "../../../../../node_modules/@sentry/serverless/src/gcpfunction/cloud_events.ts", "../../../../../node_modules/@sentry/serverless/src/gcpfunction/index.ts", "../../../../../node_modules/@sentry/serverless/src/index.ts", "../../../node_modules/simple-cookie/index.js", "../../../node_modules/@babel/runtime/helpers/interopRequireDefault.js", "../../../node_modules/jose/lib/help/consts.js", "../../../node_modules/jose/lib/jwk/key/secp256k1_crv.js", "../../../node_modules/jose/lib/registry/ec_curves.js", "../../../node_modules/jose/lib/registry/iv_lengths.js", "../../../node_modules/jose/lib/registry/jwa.js", "../../../node_modules/jose/lib/registry/jwk.js", "../../../node_modules/jose/lib/registry/key_lengths.js", "../../../node_modules/jose/lib/registry/okp_curves.js", "../../../node_modules/jose/lib/registry/ecdh_derive_lengths.js", "../../../node_modules/jose/lib/registry/index.js", "../../../node_modules/jose/lib/help/generate_iv.js", "../../../node_modules/jose/lib/help/base64url.js", "../../../node_modules/jose/lib/errors.js", "../../../node_modules/jose/lib/help/runtime_support.js", "../../../node_modules/jose/lib/help/is_object.js", "../../../node_modules/@panva/asn1.js/lib/asn1/base/reporter.js", "../../../node_modules/@panva/asn1.js/lib/asn1/base/buffer.js", "../../../node_modules/@panva/asn1.js/lib/asn1/base/node.js", "../../../node_modules/@panva/asn1.js/lib/asn1/constants/der.js", "../../../node_modules/@panva/asn1.js/lib/asn1/encoders/der.js", "../../../node_modules/@panva/asn1.js/lib/asn1/encoders/pem.js", "../../../node_modules/@panva/asn1.js/lib/asn1/encoders/index.js", "../../../node_modules/@panva/asn1.js/lib/asn1/decoders/der.js", "../../../node_modules/@panva/asn1.js/lib/asn1/decoders/pem.js", "../../../node_modules/@panva/asn1.js/lib/asn1/decoders/index.js", "../../../node_modules/@panva/asn1.js/lib/asn1/api.js", "../../../node_modules/@panva/asn1.js/lib/asn1/base/index.js", "../../../node_modules/@panva/asn1.js/lib/asn1/constants/index.js", "../../../node_modules/@panva/asn1.js/lib/asn1.js", "../../../node_modules/jose/lib/help/asn1/oids.js", "../../../node_modules/jose/lib/help/asn1/algorithm_identifier.js", "../../../node_modules/jose/lib/help/asn1/ec_private_key.js", "../../../node_modules/jose/lib/help/asn1/private_key_info.js", "../../../node_modules/jose/lib/help/asn1/public_key_info.js", "../../../node_modules/jose/lib/help/asn1/private_key.js", "../../../node_modules/jose/lib/help/asn1/one_asymmetric_key.js", "../../../node_modules/jose/lib/help/asn1/rsa_private_key.js", "../../../node_modules/jose/lib/help/asn1/rsa_public_key.js", "../../../node_modules/jose/lib/help/asn1/index.js", "../../../node_modules/jose/lib/help/key_object.js", "../../../node_modules/jose/lib/help/rsa_primes.js", "../../../node_modules/jose/lib/help/key_utils.js", "../../../node_modules/jose/lib/jwk/thumbprint.js", "../../../node_modules/jose/lib/jwk/key/base.js", "../../../node_modules/jose/lib/jwk/key/rsa.js", "../../../node_modules/jose/lib/jwk/key/ec.js", "../../../node_modules/jose/lib/jwk/key/okp.js", "../../../node_modules/jose/lib/jwk/key/oct.js", "../../../node_modules/jose/lib/jwk/import.js", "../../../node_modules/jose/lib/jwk/generate.js", "../../../node_modules/jose/lib/jwk/key/none.js", "../../../node_modules/jose/lib/jwk/key/embedded.jwk.js", "../../../node_modules/jose/lib/jwk/key/embedded.x5c.js", "../../../node_modules/jose/lib/jwk/index.js", "../../../node_modules/jose/lib/jwks/keystore.js", "../../../node_modules/jose/lib/help/get_key.js", "../../../node_modules/jose/lib/help/deep_clone.js", "../../../node_modules/jose/lib/help/timing_safe_equal.js", "../../../node_modules/jose/lib/help/node_alg.js", "../../../node_modules/jose/lib/jwa/hmac.js", "../../../node_modules/jose/lib/help/ecdsa_signatures.js", "../../../node_modules/jose/lib/jwa/ecdsa.js", "../../../node_modules/jose/lib/jwa/eddsa.js", "../../../node_modules/jose/lib/jwa/rsassa_pss.js", "../../../node_modules/jose/lib/jwa/rsassa.js", "../../../node_modules/jose/lib/jwa/none.js", "../../../node_modules/jose/lib/help/uint64be.js", "../../../node_modules/jose/lib/jwa/aes_cbc_hmac_sha2.js", "../../../node_modules/jose/lib/jwa/aes_gcm.js", "../../../node_modules/jose/lib/jwa/rsaes.js", "../../../node_modules/jose/lib/jwa/aes_kw.js", "../../../node_modules/jose/lib/jwa/aes_gcm_kw.js", "../../../node_modules/jose/lib/jwa/pbes2.js", "../../../node_modules/jose/lib/jwa/ecdh/compute_secret.js", "../../../node_modules/jose/lib/jwa/ecdh/derive.js", "../../../node_modules/jose/lib/jwa/ecdh/dir.js", "../../../node_modules/jose/lib/jwa/ecdh/kw.js", "../../../node_modules/jose/lib/jwa/index.js", "../../../node_modules/jose/lib/help/validate_crit.js", "../../../node_modules/jose/lib/jwe/serializers.js", "../../../node_modules/jose/lib/jwe/generate_cek.js", "../../../node_modules/jose/lib/help/is_disjoint.js", "../../../node_modules/jose/lib/jwe/validate_headers.js", "../../../node_modules/jose/lib/jwe/encrypt.js", "../../../node_modules/jose/lib/jwks/index.js", "../../../node_modules/jose/lib/jwe/decrypt.js", "../../../node_modules/jose/lib/jwe/index.js", "../../../node_modules/jose/lib/jws/serializers.js", "../../../node_modules/jose/lib/jws/sign.js", "../../../node_modules/jose/lib/jws/verify.js", "../../../node_modules/jose/lib/jws/index.js", "../../../node_modules/jose/lib/jwt/decode.js", "../../../node_modules/jose/lib/help/secs.js", "../../../node_modules/jose/lib/help/epoch.js", "../../../node_modules/jose/lib/jwt/shared_validations.js", "../../../node_modules/jose/lib/jwt/sign.js", "../../../node_modules/jose/lib/jwt/verify.js", "../../../node_modules/jose/lib/jwt/profiles.js", "../../../node_modules/jose/lib/jwt/index.js", "../../../node_modules/jose/lib/index.js", "../../../node_modules/next-auth/dist/lib/logger.js", "../../../node_modules/futoin-hkdf/hkdf.js", "../../../node_modules/next-auth/dist/lib/jwt.js", "../../../node_modules/@architect/functions/src/http/session/providers/_get-idx.js", "../../../node_modules/cookie/index.js", "../../../node_modules/node-webtokens/lib/ecdsa.js", "../../../node_modules/node-webtokens/lib/common.js", "../../../node_modules/node-webtokens/lib/jws.js", "../../../node_modules/node-webtokens/lib/jwe.js", "../../../node_modules/node-webtokens/index.js", "../../../node_modules/@architect/functions/src/http/session/providers/jwe.js", "../../../node_modules/cookie-signature/index.js", "../../../node_modules/@architect/functions/src/tables/dynamo.js", "../../../node_modules/random-bytes/index.js", "../../../node_modules/uid-safe/index.js", "../../../node_modules/@architect/functions/src/http/session/providers/ddb/_week-from-now.js", "../../../node_modules/rndm/index.js", "../../../node_modules/tsscmp/lib/index.js", "../../../node_modules/csrf/index.js", "../../../node_modules/queue-microtask/index.js", "../../../node_modules/run-parallel/index.js", "../../../node_modules/@architect/functions/src/http/session/providers/ddb/create.js", "../../../node_modules/@architect/functions/src/http/session/providers/ddb/find.js", "../../../node_modules/@architect/functions/src/http/session/providers/ddb/update.js", "../../../node_modules/@architect/functions/src/http/session/providers/ddb/index.js", "../../../node_modules/@architect/functions/src/http/session/read.js", "../../../node_modules/@architect/functions/src/http/session/write.js", "../../../node_modules/@architect/functions/src/http/helpers/body-parser.js", "../../../node_modules/@architect/functions/src/http/helpers/params.js", "../../../node_modules/@architect/functions/src/http/errors/index.js", "../../../node_modules/@architect/functions/src/http/helpers/binary-types.js", "../../../node_modules/@architect/functions/src/http/_res-fmt.js", "../../../node_modules/@architect/functions/src/http/http.js", "../../../node_modules/@architect/functions/src/static/index.js", "../../../node_modules/@architect/functions/src/http/helpers/url.js", "../../../node_modules/@architect/functions/src/http/async/index.js", "../../../node_modules/binary-case/index.js", "../../../node_modules/media-typer/index.js", "../../../node_modules/mime-db/index.js", "../../../node_modules/mime-types/index.js", "../../../node_modules/type-is/index.js", "../../../node_modules/@vendia/serverless-express/src/index.js", "../../../node_modules/@vendia/serverless-express/index.js", "../../../node_modules/aws-serverless-express/src/index.js", "../../../node_modules/aws-serverless-express/index.js", "../../../node_modules/@architect/functions/src/http/express/index.js", "../../../node_modules/@architect/functions/src/http/proxy/format/transform.js", "../../../node_modules/@architect/functions/src/http/proxy/format/templatize.js", "../../../node_modules/@architect/functions/src/http/proxy/format/compress.js", "../../../node_modules/@architect/functions/src/http/proxy/format/response.js", "../../../node_modules/@architect/functions/src/http/proxy/read/_pretty.js", "../../../node_modules/@architect/functions/src/http/proxy/read/_local.js", "../../../node_modules/@architect/functions/src/http/proxy/read/_s3.js", "../../../node_modules/@architect/functions/src/http/proxy/read/index.js", "../../../node_modules/@architect/functions/src/http/proxy/index.js", "../../../node_modules/@architect/functions/src/http/index.js", "../../../node_modules/@architect/functions/src/discovery/index.js", "../../../node_modules/@architect/functions/src/ws/send-sandbox.js", "../../../node_modules/@architect/functions/src/ws/send.js", "../../../node_modules/@architect/functions/src/ws/index.js", "../../../node_modules/run-waterfall/index.js", "../../../node_modules/@architect/functions/src/tables/old.js", "../../../node_modules/@architect/functions/src/tables/promisify-object.js", "../../../node_modules/@architect/functions/src/tables/factory.js", "../../../node_modules/@architect/functions/src/tables/sandbox.js", "../../../node_modules/@architect/functions/src/tables/index.js", "../../../node_modules/@architect/functions/src/queues/publish-old.js", "../../../node_modules/@architect/functions/src/queues/subscribe.js", "../../../node_modules/@architect/functions/src/queues/publish-sandbox.js", "../../../node_modules/@architect/functions/src/queues/publish-queue.js", "../../../node_modules/@architect/functions/src/queues/publish.js", "../../../node_modules/@architect/functions/src/queues/index.js", "../../../node_modules/@architect/functions/src/events/publish-old.js", "../../../node_modules/@architect/functions/src/events/subscribe.js", "../../../node_modules/@architect/functions/src/events/publish-sandbox.js", "../../../node_modules/@architect/functions/src/events/publish-topic.js", "../../../node_modules/@architect/functions/src/events/publish.js", "../../../node_modules/@architect/functions/src/events/index.js", "../../../node_modules/@architect/functions/src/index.js", "../../../lib/monitor.ts", "../../../lib/config.ts", "../../../lib/handle.ts", "../../../lib/auth.ts", "../../../lib/tables/index.ts", "../../../lib/utils/timestamp.ts", "../../../lib/auth-flow/jwt.ts", "../../../lib/authorization.ts", "../../../lib/resource/index.ts", "../../../lib/s3/pads.ts", "../../../lib/architect/http/get-api-syncdoc-000id/index.ts"],
  "sourcesContent": ["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\n/* global global, define, System, Reflect, Promise */\r\nvar __extends;\r\nvar __assign;\r\nvar __rest;\r\nvar __decorate;\r\nvar __param;\r\nvar __metadata;\r\nvar __awaiter;\r\nvar __generator;\r\nvar __exportStar;\r\nvar __values;\r\nvar __read;\r\nvar __spread;\r\nvar __spreadArrays;\r\nvar __await;\r\nvar __asyncGenerator;\r\nvar __asyncDelegator;\r\nvar __asyncValues;\r\nvar __makeTemplateObject;\r\nvar __importStar;\r\nvar __importDefault;\r\nvar __classPrivateFieldGet;\r\nvar __classPrivateFieldSet;\r\nvar __createBinding;\r\n(function (factory) {\r\n    var root = typeof global === \"object\" ? global : typeof self === \"object\" ? self : typeof this === \"object\" ? this : {};\r\n    if (typeof define === \"function\" && define.amd) {\r\n        define(\"tslib\", [\"exports\"], function (exports) { factory(createExporter(root, createExporter(exports))); });\r\n    }\r\n    else if (typeof module === \"object\" && typeof module.exports === \"object\") {\r\n        factory(createExporter(root, createExporter(module.exports)));\r\n    }\r\n    else {\r\n        factory(createExporter(root));\r\n    }\r\n    function createExporter(exports, previous) {\r\n        if (exports !== root) {\r\n            if (typeof Object.create === \"function\") {\r\n                Object.defineProperty(exports, \"__esModule\", { value: true });\r\n            }\r\n            else {\r\n                exports.__esModule = true;\r\n            }\r\n        }\r\n        return function (id, v) { return exports[id] = previous ? previous(id, v) : v; };\r\n    }\r\n})\r\n(function (exporter) {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\n    __extends = function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n\r\n    __assign = Object.assign || function (t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n\r\n    __rest = function (s, e) {\r\n        var t = {};\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n            t[p] = s[p];\r\n        if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n            for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n                if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                    t[p[i]] = s[p[i]];\r\n            }\r\n        return t;\r\n    };\r\n\r\n    __decorate = function (decorators, target, key, desc) {\r\n        var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n        if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n        else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n        return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n    };\r\n\r\n    __param = function (paramIndex, decorator) {\r\n        return function (target, key) { decorator(target, key, paramIndex); }\r\n    };\r\n\r\n    __metadata = function (metadataKey, metadataValue) {\r\n        if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n    };\r\n\r\n    __awaiter = function (thisArg, _arguments, P, generator) {\r\n        function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n        return new (P || (P = Promise))(function (resolve, reject) {\r\n            function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n            function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n            function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n            step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n        });\r\n    };\r\n\r\n    __generator = function (thisArg, body) {\r\n        var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n        return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n        function verb(n) { return function (v) { return step([n, v]); }; }\r\n        function step(op) {\r\n            if (f) throw new TypeError(\"Generator is already executing.\");\r\n            while (_) try {\r\n                if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n                if (y = 0, t) op = [op[0] & 2, t.value];\r\n                switch (op[0]) {\r\n                    case 0: case 1: t = op; break;\r\n                    case 4: _.label++; return { value: op[1], done: false };\r\n                    case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                    case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                    default:\r\n                        if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                        if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                        if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                        if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                        if (t[2]) _.ops.pop();\r\n                        _.trys.pop(); continue;\r\n                }\r\n                op = body.call(thisArg, _);\r\n            } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n            if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n        }\r\n    };\r\n\r\n    __createBinding = function(o, m, k, k2) {\r\n        if (k2 === undefined) k2 = k;\r\n        o[k2] = m[k];\r\n    };\r\n\r\n    __exportStar = function (m, exports) {\r\n        for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n    };\r\n\r\n    __values = function (o) {\r\n        var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n        if (m) return m.call(o);\r\n        if (o && typeof o.length === \"number\") return {\r\n            next: function () {\r\n                if (o && i >= o.length) o = void 0;\r\n                return { value: o && o[i++], done: !o };\r\n            }\r\n        };\r\n        throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n    };\r\n\r\n    __read = function (o, n) {\r\n        var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n        if (!m) return o;\r\n        var i = m.call(o), r, ar = [], e;\r\n        try {\r\n            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n        }\r\n        catch (error) { e = { error: error }; }\r\n        finally {\r\n            try {\r\n                if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n            }\r\n            finally { if (e) throw e.error; }\r\n        }\r\n        return ar;\r\n    };\r\n\r\n    __spread = function () {\r\n        for (var ar = [], i = 0; i < arguments.length; i++)\r\n            ar = ar.concat(__read(arguments[i]));\r\n        return ar;\r\n    };\r\n\r\n    __spreadArrays = function () {\r\n        for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n        for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n            for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n                r[k] = a[j];\r\n        return r;\r\n    };\r\n\r\n    __await = function (v) {\r\n        return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n    };\r\n\r\n    __asyncGenerator = function (thisArg, _arguments, generator) {\r\n        if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n        var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n        return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n        function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n        function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n        function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }\r\n        function fulfill(value) { resume(\"next\", value); }\r\n        function reject(value) { resume(\"throw\", value); }\r\n        function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n    };\r\n\r\n    __asyncDelegator = function (o) {\r\n        var i, p;\r\n        return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n        function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n    };\r\n\r\n    __asyncValues = function (o) {\r\n        if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n        var m = o[Symbol.asyncIterator], i;\r\n        return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n        function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n        function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n    };\r\n\r\n    __makeTemplateObject = function (cooked, raw) {\r\n        if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n        return cooked;\r\n    };\r\n\r\n    __importStar = function (mod) {\r\n        if (mod && mod.__esModule) return mod;\r\n        var result = {};\r\n        if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n        result[\"default\"] = mod;\r\n        return result;\r\n    };\r\n\r\n    __importDefault = function (mod) {\r\n        return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n    };\r\n\r\n    __classPrivateFieldGet = function (receiver, privateMap) {\r\n        if (!privateMap.has(receiver)) {\r\n            throw new TypeError(\"attempted to get private field on non-instance\");\r\n        }\r\n        return privateMap.get(receiver);\r\n    };\r\n\r\n    __classPrivateFieldSet = function (receiver, privateMap, value) {\r\n        if (!privateMap.has(receiver)) {\r\n            throw new TypeError(\"attempted to set private field on non-instance\");\r\n        }\r\n        privateMap.set(receiver, value);\r\n        return value;\r\n    };\r\n\r\n    exporter(\"__extends\", __extends);\r\n    exporter(\"__assign\", __assign);\r\n    exporter(\"__rest\", __rest);\r\n    exporter(\"__decorate\", __decorate);\r\n    exporter(\"__param\", __param);\r\n    exporter(\"__metadata\", __metadata);\r\n    exporter(\"__awaiter\", __awaiter);\r\n    exporter(\"__generator\", __generator);\r\n    exporter(\"__exportStar\", __exportStar);\r\n    exporter(\"__createBinding\", __createBinding);\r\n    exporter(\"__values\", __values);\r\n    exporter(\"__read\", __read);\r\n    exporter(\"__spread\", __spread);\r\n    exporter(\"__spreadArrays\", __spreadArrays);\r\n    exporter(\"__await\", __await);\r\n    exporter(\"__asyncGenerator\", __asyncGenerator);\r\n    exporter(\"__asyncDelegator\", __asyncDelegator);\r\n    exporter(\"__asyncValues\", __asyncValues);\r\n    exporter(\"__makeTemplateObject\", __makeTemplateObject);\r\n    exporter(\"__importStar\", __importStar);\r\n    exporter(\"__importDefault\", __importDefault);\r\n    exporter(\"__classPrivateFieldGet\", __classPrivateFieldGet);\r\n    exporter(\"__classPrivateFieldSet\", __classPrivateFieldSet);\r\n});\r\n", "/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\n/* global global, define, System, Reflect, Promise */\r\nvar __extends;\r\nvar __assign;\r\nvar __rest;\r\nvar __decorate;\r\nvar __param;\r\nvar __metadata;\r\nvar __awaiter;\r\nvar __generator;\r\nvar __exportStar;\r\nvar __values;\r\nvar __read;\r\nvar __spread;\r\nvar __spreadArrays;\r\nvar __await;\r\nvar __asyncGenerator;\r\nvar __asyncDelegator;\r\nvar __asyncValues;\r\nvar __makeTemplateObject;\r\nvar __importStar;\r\nvar __importDefault;\r\nvar __classPrivateFieldGet;\r\nvar __classPrivateFieldSet;\r\nvar __createBinding;\r\n(function (factory) {\r\n    var root = typeof global === \"object\" ? global : typeof self === \"object\" ? self : typeof this === \"object\" ? this : {};\r\n    if (typeof define === \"function\" && define.amd) {\r\n        define(\"tslib\", [\"exports\"], function (exports) { factory(createExporter(root, createExporter(exports))); });\r\n    }\r\n    else if (typeof module === \"object\" && typeof module.exports === \"object\") {\r\n        factory(createExporter(root, createExporter(module.exports)));\r\n    }\r\n    else {\r\n        factory(createExporter(root));\r\n    }\r\n    function createExporter(exports, previous) {\r\n        if (exports !== root) {\r\n            if (typeof Object.create === \"function\") {\r\n                Object.defineProperty(exports, \"__esModule\", { value: true });\r\n            }\r\n            else {\r\n                exports.__esModule = true;\r\n            }\r\n        }\r\n        return function (id, v) { return exports[id] = previous ? previous(id, v) : v; };\r\n    }\r\n})\r\n(function (exporter) {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\n    __extends = function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n\r\n    __assign = Object.assign || function (t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n\r\n    __rest = function (s, e) {\r\n        var t = {};\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n            t[p] = s[p];\r\n        if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n            for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n                if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                    t[p[i]] = s[p[i]];\r\n            }\r\n        return t;\r\n    };\r\n\r\n    __decorate = function (decorators, target, key, desc) {\r\n        var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n        if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n        else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n        return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n    };\r\n\r\n    __param = function (paramIndex, decorator) {\r\n        return function (target, key) { decorator(target, key, paramIndex); }\r\n    };\r\n\r\n    __metadata = function (metadataKey, metadataValue) {\r\n        if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n    };\r\n\r\n    __awaiter = function (thisArg, _arguments, P, generator) {\r\n        function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n        return new (P || (P = Promise))(function (resolve, reject) {\r\n            function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n            function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n            function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n            step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n        });\r\n    };\r\n\r\n    __generator = function (thisArg, body) {\r\n        var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n        return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n        function verb(n) { return function (v) { return step([n, v]); }; }\r\n        function step(op) {\r\n            if (f) throw new TypeError(\"Generator is already executing.\");\r\n            while (_) try {\r\n                if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n                if (y = 0, t) op = [op[0] & 2, t.value];\r\n                switch (op[0]) {\r\n                    case 0: case 1: t = op; break;\r\n                    case 4: _.label++; return { value: op[1], done: false };\r\n                    case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                    case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                    default:\r\n                        if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                        if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                        if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                        if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                        if (t[2]) _.ops.pop();\r\n                        _.trys.pop(); continue;\r\n                }\r\n                op = body.call(thisArg, _);\r\n            } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n            if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n        }\r\n    };\r\n\r\n    __createBinding = function(o, m, k, k2) {\r\n        if (k2 === undefined) k2 = k;\r\n        o[k2] = m[k];\r\n    };\r\n\r\n    __exportStar = function (m, exports) {\r\n        for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n    };\r\n\r\n    __values = function (o) {\r\n        var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n        if (m) return m.call(o);\r\n        if (o && typeof o.length === \"number\") return {\r\n            next: function () {\r\n                if (o && i >= o.length) o = void 0;\r\n                return { value: o && o[i++], done: !o };\r\n            }\r\n        };\r\n        throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n    };\r\n\r\n    __read = function (o, n) {\r\n        var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n        if (!m) return o;\r\n        var i = m.call(o), r, ar = [], e;\r\n        try {\r\n            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n        }\r\n        catch (error) { e = { error: error }; }\r\n        finally {\r\n            try {\r\n                if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n            }\r\n            finally { if (e) throw e.error; }\r\n        }\r\n        return ar;\r\n    };\r\n\r\n    __spread = function () {\r\n        for (var ar = [], i = 0; i < arguments.length; i++)\r\n            ar = ar.concat(__read(arguments[i]));\r\n        return ar;\r\n    };\r\n\r\n    __spreadArrays = function () {\r\n        for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n        for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n            for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n                r[k] = a[j];\r\n        return r;\r\n    };\r\n\r\n    __await = function (v) {\r\n        return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n    };\r\n\r\n    __asyncGenerator = function (thisArg, _arguments, generator) {\r\n        if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n        var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n        return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n        function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n        function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n        function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }\r\n        function fulfill(value) { resume(\"next\", value); }\r\n        function reject(value) { resume(\"throw\", value); }\r\n        function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n    };\r\n\r\n    __asyncDelegator = function (o) {\r\n        var i, p;\r\n        return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n        function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n    };\r\n\r\n    __asyncValues = function (o) {\r\n        if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n        var m = o[Symbol.asyncIterator], i;\r\n        return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n        function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n        function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n    };\r\n\r\n    __makeTemplateObject = function (cooked, raw) {\r\n        if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n        return cooked;\r\n    };\r\n\r\n    __importStar = function (mod) {\r\n        if (mod && mod.__esModule) return mod;\r\n        var result = {};\r\n        if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n        result[\"default\"] = mod;\r\n        return result;\r\n    };\r\n\r\n    __importDefault = function (mod) {\r\n        return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n    };\r\n\r\n    __classPrivateFieldGet = function (receiver, privateMap) {\r\n        if (!privateMap.has(receiver)) {\r\n            throw new TypeError(\"attempted to get private field on non-instance\");\r\n        }\r\n        return privateMap.get(receiver);\r\n    };\r\n\r\n    __classPrivateFieldSet = function (receiver, privateMap, value) {\r\n        if (!privateMap.has(receiver)) {\r\n            throw new TypeError(\"attempted to set private field on non-instance\");\r\n        }\r\n        privateMap.set(receiver, value);\r\n        return value;\r\n    };\r\n\r\n    exporter(\"__extends\", __extends);\r\n    exporter(\"__assign\", __assign);\r\n    exporter(\"__rest\", __rest);\r\n    exporter(\"__decorate\", __decorate);\r\n    exporter(\"__param\", __param);\r\n    exporter(\"__metadata\", __metadata);\r\n    exporter(\"__awaiter\", __awaiter);\r\n    exporter(\"__generator\", __generator);\r\n    exporter(\"__exportStar\", __exportStar);\r\n    exporter(\"__createBinding\", __createBinding);\r\n    exporter(\"__values\", __values);\r\n    exporter(\"__read\", __read);\r\n    exporter(\"__spread\", __spread);\r\n    exporter(\"__spreadArrays\", __spreadArrays);\r\n    exporter(\"__await\", __await);\r\n    exporter(\"__asyncGenerator\", __asyncGenerator);\r\n    exporter(\"__asyncDelegator\", __asyncDelegator);\r\n    exporter(\"__asyncValues\", __asyncValues);\r\n    exporter(\"__makeTemplateObject\", __makeTemplateObject);\r\n    exporter(\"__importStar\", __importStar);\r\n    exporter(\"__importDefault\", __importDefault);\r\n    exporter(\"__classPrivateFieldGet\", __classPrivateFieldGet);\r\n    exporter(\"__classPrivateFieldSet\", __classPrivateFieldSet);\r\n});\r\n", "/** Console logging verbosity for the SDK. */\nexport enum LogLevel {\n  /** No logs will be generated. */\n  None = 0,\n  /** Only SDK internal errors will be logged. */\n  Error = 1,\n  /** Information useful for debugging the SDK will be logged. */\n  Debug = 2,\n  /** All SDK actions will be logged. */\n  Verbose = 3,\n}\n", "import { User } from './user';\n\n/**\n * @inheritdoc\n */\nexport interface Session extends SessionContext {\n  /** JSDoc */\n  update(context?: SessionContext): void;\n\n  /** JSDoc */\n  close(status?: SessionStatus): void;\n\n  /** JSDoc */\n  toJSON(): {\n    init: boolean;\n    sid: string;\n    did?: string;\n    timestamp: string;\n    started: string;\n    duration?: number;\n    status: SessionStatus;\n    errors: number;\n    attrs?: {\n      release?: string;\n      environment?: string;\n      user_agent?: string;\n      ip_address?: string;\n    };\n  };\n}\n\nexport interface RequestSession {\n  status?: RequestSessionStatus;\n}\n\n/**\n * Session Context\n */\nexport interface SessionContext {\n  sid?: string;\n  did?: string;\n  init?: boolean;\n  // seconds since the UNIX epoch\n  timestamp?: number;\n  // seconds since the UNIX epoch\n  started?: number;\n  duration?: number;\n  status?: SessionStatus;\n  release?: string;\n  environment?: string;\n  userAgent?: string;\n  ipAddress?: string;\n  errors?: number;\n  user?: User | null;\n  ignoreDuration?: boolean;\n}\n\n/**\n * Session Status\n */\nexport enum SessionStatus {\n  /** JSDoc */\n  Ok = 'ok',\n  /** JSDoc */\n  Exited = 'exited',\n  /** JSDoc */\n  Crashed = 'crashed',\n  /** JSDoc */\n  Abnormal = 'abnormal',\n}\n\nexport enum RequestSessionStatus {\n  /** JSDoc */\n  Ok = 'ok',\n  /** JSDoc */\n  Errored = 'errored',\n  /** JSDoc */\n  Crashed = 'crashed',\n}\n\n/** JSDoc */\nexport interface SessionAggregates {\n  attrs?: {\n    environment?: string;\n    release?: string;\n  };\n  aggregates: Array<AggregationCounts>;\n}\n\nexport interface SessionFlusherLike {\n  /**\n   * Increments the Session Status bucket in SessionAggregates Object corresponding to the status of the session\n   * captured\n   */\n  incrementSessionStatusCount(): void;\n\n  /** Submits the aggregates request mode sessions to Sentry */\n  sendSessionAggregates(sessionAggregates: SessionAggregates): void;\n\n  /** Empties Aggregate Buckets and Sends them to Transport Buffer */\n  flush(): void;\n\n  /** Clears setInterval and calls flush */\n  close(): void;\n}\n\nexport interface AggregationCounts {\n  started: string;\n  errored?: number;\n  exited?: number;\n  crashed?: number;\n}\n", "/** JSDoc */\n// eslint-disable-next-line import/export\nexport enum Severity {\n  /** JSDoc */\n  Fatal = 'fatal',\n  /** JSDoc */\n  Error = 'error',\n  /** JSDoc */\n  Warning = 'warning',\n  /** JSDoc */\n  Log = 'log',\n  /** JSDoc */\n  Info = 'info',\n  /** JSDoc */\n  Debug = 'debug',\n  /** JSDoc */\n  Critical = 'critical',\n}\n\n// eslint-disable-next-line @typescript-eslint/no-namespace, import/export\nexport namespace Severity {\n  /**\n   * Converts a string-based level into a {@link Severity}.\n   *\n   * @param level string representation of Severity\n   * @returns Severity\n   */\n  export function fromString(level: string): Severity {\n    switch (level) {\n      case 'debug':\n        return Severity.Debug;\n      case 'info':\n        return Severity.Info;\n      case 'warn':\n      case 'warning':\n        return Severity.Warning;\n      case 'error':\n        return Severity.Error;\n      case 'fatal':\n        return Severity.Fatal;\n      case 'critical':\n        return Severity.Critical;\n      case 'log':\n      default:\n        return Severity.Log;\n    }\n  }\n}\n", "/** The status of an event. */\n// eslint-disable-next-line import/export\nexport enum Status {\n  /** The status could not be determined. */\n  Unknown = 'unknown',\n  /** The event was skipped due to configuration or callbacks. */\n  Skipped = 'skipped',\n  /** The event was sent to Sentry successfully. */\n  Success = 'success',\n  /** The client is currently rate limited and will try again later. */\n  RateLimit = 'rate_limit',\n  /** The event could not be processed. */\n  Invalid = 'invalid',\n  /** A server-side error ocurred during submission. */\n  Failed = 'failed',\n}\n\n// eslint-disable-next-line @typescript-eslint/no-namespace, import/export\nexport namespace Status {\n  /**\n   * Converts a HTTP status code into a {@link Status}.\n   *\n   * @param code The HTTP response status code.\n   * @returns The send status or {@link Status.Unknown}.\n   */\n  export function fromHttpCode(code: number): Status {\n    if (code >= 200 && code < 300) {\n      return Status.Success;\n    }\n\n    if (code === 429) {\n      return Status.RateLimit;\n    }\n\n    if (code >= 400 && code < 500) {\n      return Status.Invalid;\n    }\n\n    if (code >= 500) {\n      return Status.Failed;\n    }\n\n    return Status.Unknown;\n  }\n}\n", "import { ExtractedNodeRequestData, Primitive, WorkerLocation } from './misc';\nimport { Span, SpanContext } from './span';\n\n/**\n * Interface holding Transaction-specific properties\n */\nexport interface TransactionContext extends SpanContext {\n  /**\n   * Human-readable identifier for the transaction\n   */\n  name: string;\n\n  /**\n   * If true, sets the end timestamp of the transaction to the highest timestamp of child spans, trimming\n   * the duration of the transaction. This is useful to discard extra time in the transaction that is not\n   * accounted for in child spans, like what happens in the idle transaction Tracing integration, where we finish the\n   * transaction after a given \"idle time\" and we don't want this \"idle time\" to be part of the transaction.\n   */\n  trimEnd?: boolean;\n\n  /**\n   * If this transaction has a parent, the parent's sampling decision\n   */\n  parentSampled?: boolean;\n\n  /**\n   * Metadata associated with the transaction, for internal SDK use.\n   */\n  metadata?: TransactionMetadata;\n}\n\n/**\n * Data pulled from a `sentry-trace` header\n */\nexport type TraceparentData = Pick<TransactionContext, 'traceId' | 'parentSpanId' | 'parentSampled'>;\n\n/**\n * Transaction \"Class\", inherits Span only has `setName`\n */\nexport interface Transaction extends TransactionContext, Span {\n  /**\n   * @inheritDoc\n   */\n  spanId: string;\n\n  /**\n   * @inheritDoc\n   */\n  traceId: string;\n\n  /**\n   * @inheritDoc\n   */\n  startTimestamp: number;\n\n  /**\n   * @inheritDoc\n   */\n  tags: { [key: string]: Primitive };\n\n  /**\n   * @inheritDoc\n   */\n  data: { [key: string]: any };\n\n  /**\n   * Metadata about the transaction\n   */\n  metadata: TransactionMetadata;\n\n  /**\n   * Set the name of the transaction\n   */\n  setName(name: string): void;\n\n  /** Returns the current transaction properties as a `TransactionContext` */\n  toContext(): TransactionContext;\n\n  /** Updates the current transaction with a new `TransactionContext` */\n  updateWithContext(transactionContext: TransactionContext): this;\n}\n\n/**\n * Context data passed by the user when starting a transaction, to be used by the tracesSampler method.\n */\nexport interface CustomSamplingContext {\n  [key: string]: any;\n}\n\n/**\n * Data passed to the `tracesSampler` function, which forms the basis for whatever decisions it might make.\n *\n * Adds default data to data provided by the user. See {@link Hub.startTransaction}\n */\nexport interface SamplingContext extends CustomSamplingContext {\n  /**\n   * Context data with which transaction being sampled was created\n   */\n  transactionContext: TransactionContext;\n\n  /**\n   * Sampling decision from the parent transaction, if any.\n   */\n  parentSampled?: boolean;\n\n  /**\n   * Object representing the URL of the current page or worker script. Passed by default when using the `BrowserTracing`\n   * integration.\n   */\n  location?: WorkerLocation;\n\n  /**\n   * Object representing the incoming request to a node server. Passed by default when using the TracingHandler.\n   */\n  request?: ExtractedNodeRequestData;\n}\n\nexport type Measurements = Record<string, { value: number }>;\n\nexport enum TransactionSamplingMethod {\n  Explicit = 'explicitly_set',\n  Sampler = 'client_sampler',\n  Rate = 'client_rate',\n  Inheritance = 'inheritance',\n}\n\nexport interface TransactionMetadata {\n  transactionSampling?: { rate?: number; method?: string };\n\n  /** The two halves (sentry and third-party) of a transaction's tracestate header, used for dynamic sampling */\n  tracestate?: {\n    sentry?: string;\n    thirdparty?: string;\n  };\n\n  /** For transactions tracing server-side request handling, the path of the request being tracked. */\n  requestPath?: string;\n}\n", "export { Breadcrumb, BreadcrumbHint } from './breadcrumb';\nexport { Client } from './client';\nexport { Context, Contexts } from './context';\nexport { Dsn, DsnComponents, DsnLike, DsnProtocol } from './dsn';\nexport { DebugImage, DebugImageType, DebugMeta } from './debugMeta';\nexport { ExtendedError } from './error';\nexport { Event, EventHint } from './event';\nexport { EventProcessor } from './eventprocessor';\nexport { Exception } from './exception';\nexport { Extra, Extras } from './extra';\nexport { Hub } from './hub';\nexport { Integration, IntegrationClass } from './integration';\nexport { LogLevel } from './loglevel';\nexport { Mechanism } from './mechanism';\nexport { ExtractedNodeRequestData, Primitive, WorkerLocation } from './misc';\nexport { Options } from './options';\nexport { Package } from './package';\nexport { QueryParams, Request, SentryRequest, SentryRequestType } from './request';\nexport { Response } from './response';\nexport { Runtime } from './runtime';\nexport { CaptureContext, Scope, ScopeContext } from './scope';\nexport { SdkInfo } from './sdkinfo';\nexport { SdkMetadata } from './sdkmetadata';\nexport {\n  SessionAggregates,\n  AggregationCounts,\n  Session,\n  SessionContext,\n  SessionStatus,\n  RequestSession,\n  RequestSessionStatus,\n  SessionFlusherLike,\n} from './session';\nexport { Severity } from './severity';\nexport { Span, SpanContext } from './span';\nexport { StackFrame } from './stackframe';\nexport { Stacktrace } from './stacktrace';\nexport { Status } from './status';\nexport {\n  CustomSamplingContext,\n  Measurements,\n  SamplingContext,\n  TraceparentData,\n  Transaction,\n  TransactionContext,\n  TransactionMetadata,\n  TransactionSamplingMethod,\n} from './transaction';\nexport { Thread } from './thread';\nexport { Transport, TransportOptions, TransportClass } from './transport';\nexport { User } from './user';\nexport { WrappedFunction } from './wrappedfunction';\n", "/**\n * Consumes the promise and logs the error when it rejects.\n * @param promise A promise to forget.\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function forget(promise: PromiseLike<any>): void {\n  void promise.then(null, e => {\n    // TODO: Use a better logging mechanism\n    // eslint-disable-next-line no-console\n    console.error(e);\n  });\n}\n", "/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\n\nimport { Primitive } from '@sentry/types';\n/**\n * Checks whether given value's type is one of a few Error or Error-like\n * {@link isError}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isError(wat: any): boolean {\n  switch (Object.prototype.toString.call(wat)) {\n    case '[object Error]':\n      return true;\n    case '[object Exception]':\n      return true;\n    case '[object DOMException]':\n      return true;\n    default:\n      return isInstanceOf(wat, Error);\n  }\n}\n\n/**\n * Checks whether given value's type is ErrorEvent\n * {@link isErrorEvent}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isErrorEvent(wat: any): boolean {\n  return Object.prototype.toString.call(wat) === '[object ErrorEvent]';\n}\n\n/**\n * Checks whether given value's type is DOMError\n * {@link isDOMError}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isDOMError(wat: any): boolean {\n  return Object.prototype.toString.call(wat) === '[object DOMError]';\n}\n\n/**\n * Checks whether given value's type is DOMException\n * {@link isDOMException}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isDOMException(wat: any): boolean {\n  return Object.prototype.toString.call(wat) === '[object DOMException]';\n}\n\n/**\n * Checks whether given value's type is a string\n * {@link isString}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isString(wat: any): boolean {\n  return Object.prototype.toString.call(wat) === '[object String]';\n}\n\n/**\n * Checks whether given value's is a primitive (undefined, null, number, boolean, string, bigint, symbol)\n * {@link isPrimitive}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isPrimitive(wat: any): wat is Primitive {\n  return wat === null || (typeof wat !== 'object' && typeof wat !== 'function');\n}\n\n/**\n * Checks whether given value's type is an object literal\n * {@link isPlainObject}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isPlainObject(wat: any): boolean {\n  return Object.prototype.toString.call(wat) === '[object Object]';\n}\n\n/**\n * Checks whether given value's type is an Event instance\n * {@link isEvent}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isEvent(wat: any): boolean {\n  return typeof Event !== 'undefined' && isInstanceOf(wat, Event);\n}\n\n/**\n * Checks whether given value's type is an Element instance\n * {@link isElement}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isElement(wat: any): boolean {\n  return typeof Element !== 'undefined' && isInstanceOf(wat, Element);\n}\n\n/**\n * Checks whether given value's type is an regexp\n * {@link isRegExp}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isRegExp(wat: any): boolean {\n  return Object.prototype.toString.call(wat) === '[object RegExp]';\n}\n\n/**\n * Checks whether given value has a then function.\n * @param wat A value to be checked.\n */\nexport function isThenable(wat: any): boolean {\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n  return Boolean(wat && wat.then && typeof wat.then === 'function');\n}\n\n/**\n * Checks whether given value's type is a SyntheticEvent\n * {@link isSyntheticEvent}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isSyntheticEvent(wat: any): boolean {\n  return isPlainObject(wat) && 'nativeEvent' in wat && 'preventDefault' in wat && 'stopPropagation' in wat;\n}\n/**\n * Checks whether given value's type is an instance of provided constructor.\n * {@link isInstanceOf}.\n *\n * @param wat A value to be checked.\n * @param base A constructor to be used in a check.\n * @returns A boolean representing the result.\n */\nexport function isInstanceOf(wat: any, base: any): boolean {\n  try {\n    return wat instanceof base;\n  } catch (_e) {\n    return false;\n  }\n}\n", "import { isString } from './is';\n\n/**\n * Given a child DOM element, returns a query-selector statement describing that\n * and its ancestors\n * e.g. [HTMLElement] => body > div > input#foo.btn[name=baz]\n * @returns generated DOM path\n */\nexport function htmlTreeAsString(elem: unknown, keyAttrs?: string[]): string {\n  type SimpleNode = {\n    parentNode: SimpleNode;\n  } | null;\n\n  // try/catch both:\n  // - accessing event.target (see getsentry/raven-js#838, #768)\n  // - `htmlTreeAsString` because it's complex, and just accessing the DOM incorrectly\n  // - can throw an exception in some circumstances.\n  try {\n    let currentElem = elem as SimpleNode;\n    const MAX_TRAVERSE_HEIGHT = 5;\n    const MAX_OUTPUT_LEN = 80;\n    const out = [];\n    let height = 0;\n    let len = 0;\n    const separator = ' > ';\n    const sepLength = separator.length;\n    let nextStr;\n\n    // eslint-disable-next-line no-plusplus\n    while (currentElem && height++ < MAX_TRAVERSE_HEIGHT) {\n      nextStr = _htmlElementAsString(currentElem, keyAttrs);\n      // bail out if\n      // - nextStr is the 'html' element\n      // - the length of the string that would be created exceeds MAX_OUTPUT_LEN\n      //   (ignore this limit if we are on the first iteration)\n      if (nextStr === 'html' || (height > 1 && len + out.length * sepLength + nextStr.length >= MAX_OUTPUT_LEN)) {\n        break;\n      }\n\n      out.push(nextStr);\n\n      len += nextStr.length;\n      currentElem = currentElem.parentNode;\n    }\n\n    return out.reverse().join(separator);\n  } catch (_oO) {\n    return '<unknown>';\n  }\n}\n\n/**\n * Returns a simple, query-selector representation of a DOM element\n * e.g. [HTMLElement] => input#foo.btn[name=baz]\n * @returns generated DOM path\n */\nfunction _htmlElementAsString(el: unknown, keyAttrs?: string[]): string {\n  const elem = el as {\n    tagName?: string;\n    id?: string;\n    className?: string;\n    getAttribute(key: string): string;\n  };\n\n  const out = [];\n  let className;\n  let classes;\n  let key;\n  let attr;\n  let i;\n\n  if (!elem || !elem.tagName) {\n    return '';\n  }\n\n  out.push(elem.tagName.toLowerCase());\n\n  // Pairs of attribute keys defined in `serializeAttribute` and their values on element.\n  const keyAttrPairs = keyAttrs?.length\n    ? keyAttrs.filter(keyAttr => elem.getAttribute(keyAttr)).map(keyAttr => [keyAttr, elem.getAttribute(keyAttr)])\n    : null;\n\n  if (keyAttrPairs?.length) {\n    keyAttrPairs.forEach(keyAttrPair => {\n      out.push(`[${keyAttrPair[0]}=\"${keyAttrPair[1]}\"]`);\n    });\n  } else {\n    if (elem.id) {\n      out.push(`#${elem.id}`);\n    }\n\n    // eslint-disable-next-line prefer-const\n    className = elem.className;\n    if (className && isString(className)) {\n      classes = className.split(/\\s+/);\n      for (i = 0; i < classes.length; i++) {\n        out.push(`.${classes[i]}`);\n      }\n    }\n  }\n  const allowedAttrs = ['type', 'name', 'title', 'alt'];\n  for (i = 0; i < allowedAttrs.length; i++) {\n    key = allowedAttrs[i];\n    attr = elem.getAttribute(key);\n    if (attr) {\n      out.push(`[${key}=\"${attr}\"]`);\n    }\n  }\n  return out.join('');\n}\n", "export const setPrototypeOf =\n  Object.setPrototypeOf || ({ __proto__: [] } instanceof Array ? setProtoOf : mixinProperties);\n\n/**\n * setPrototypeOf polyfill using __proto__\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nfunction setProtoOf<TTarget extends object, TProto>(obj: TTarget, proto: TProto): TTarget & TProto {\n  // @ts-ignore __proto__ does not exist on obj\n  obj.__proto__ = proto;\n  return obj as TTarget & TProto;\n}\n\n/**\n * setPrototypeOf polyfill using mixin\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nfunction mixinProperties<TTarget extends object, TProto>(obj: TTarget, proto: TProto): TTarget & TProto {\n  for (const prop in proto) {\n    // eslint-disable-next-line no-prototype-builtins\n    if (!obj.hasOwnProperty(prop)) {\n      // @ts-ignore typescript complains about indexing so we remove\n      obj[prop] = proto[prop];\n    }\n  }\n\n  return obj as TTarget & TProto;\n}\n", "import { setPrototypeOf } from './polyfill';\n\n/** An error emitted by Sentry SDKs and related utilities. */\nexport class SentryError extends Error {\n  /** Display name of this error instance. */\n  public name: string;\n\n  public constructor(public message: string) {\n    super(message);\n\n    this.name = new.target.prototype.constructor.name;\n    setPrototypeOf(this, new.target.prototype);\n  }\n}\n", "import { DsnComponents, DsnLike, DsnProtocol } from '@sentry/types';\n\nimport { SentryError } from './error';\n\n/** Regular expression used to parse a Dsn. */\nconst DSN_REGEX = /^(?:(\\w+):)\\/\\/(?:(\\w+)(?::(\\w+))?@)([\\w.-]+)(?::(\\d+))?\\/(.+)/;\n\n/** Error message */\nconst ERROR_MESSAGE = 'Invalid Dsn';\n\n/** The Sentry Dsn, identifying a Sentry instance and project. */\nexport class Dsn implements DsnComponents {\n  /** Protocol used to connect to Sentry. */\n  public protocol!: DsnProtocol;\n  /** Public authorization key (deprecated, renamed to publicKey). */\n  public user!: string;\n  /** Public authorization key. */\n  public publicKey!: string;\n  /** Private authorization key (deprecated, optional). */\n  public pass!: string;\n  /** Hostname of the Sentry instance. */\n  public host!: string;\n  /** Port of the Sentry instance. */\n  public port!: string;\n  /** Path */\n  public path!: string;\n  /** Project ID */\n  public projectId!: string;\n\n  /** Creates a new Dsn component */\n  public constructor(from: DsnLike) {\n    if (typeof from === 'string') {\n      this._fromString(from);\n    } else {\n      this._fromComponents(from);\n    }\n\n    this._validate();\n  }\n\n  /**\n   * Renders the string representation of this Dsn.\n   *\n   * By default, this will render the public representation without the password\n   * component. To get the deprecated private representation, set `withPassword`\n   * to true.\n   *\n   * @param withPassword When set to true, the password will be included.\n   */\n  public toString(withPassword: boolean = false): string {\n    const { host, path, pass, port, projectId, protocol, publicKey } = this;\n    return (\n      `${protocol}://${publicKey}${withPassword && pass ? `:${pass}` : ''}` +\n      `@${host}${port ? `:${port}` : ''}/${path ? `${path}/` : path}${projectId}`\n    );\n  }\n\n  /** Parses a string into this Dsn. */\n  private _fromString(str: string): void {\n    const match = DSN_REGEX.exec(str);\n\n    if (!match) {\n      throw new SentryError(ERROR_MESSAGE);\n    }\n\n    const [protocol, publicKey, pass = '', host, port = '', lastPath] = match.slice(1);\n    let path = '';\n    let projectId = lastPath;\n\n    const split = projectId.split('/');\n    if (split.length > 1) {\n      path = split.slice(0, -1).join('/');\n      projectId = split.pop() as string;\n    }\n\n    if (projectId) {\n      const projectMatch = projectId.match(/^\\d+/);\n      if (projectMatch) {\n        projectId = projectMatch[0];\n      }\n    }\n\n    this._fromComponents({ host, pass, path, projectId, port, protocol: protocol as DsnProtocol, publicKey });\n  }\n\n  /** Maps Dsn components into this instance. */\n  private _fromComponents(components: DsnComponents): void {\n    // TODO this is for backwards compatibility, and can be removed in a future version\n    if ('user' in components && !('publicKey' in components)) {\n      components.publicKey = components.user;\n    }\n    this.user = components.publicKey || '';\n\n    this.protocol = components.protocol;\n    this.publicKey = components.publicKey || '';\n    this.pass = components.pass || '';\n    this.host = components.host;\n    this.port = components.port || '';\n    this.path = components.path || '';\n    this.projectId = components.projectId;\n  }\n\n  /** Validates this Dsn and throws on error. */\n  private _validate(): void {\n    ['protocol', 'publicKey', 'host', 'projectId'].forEach(component => {\n      if (!this[component as keyof DsnComponents]) {\n        throw new SentryError(`${ERROR_MESSAGE}: ${component} missing`);\n      }\n    });\n\n    if (!this.projectId.match(/^\\d+$/)) {\n      throw new SentryError(`${ERROR_MESSAGE}: Invalid projectId ${this.projectId}`);\n    }\n\n    if (this.protocol !== 'http' && this.protocol !== 'https') {\n      throw new SentryError(`${ERROR_MESSAGE}: Invalid protocol ${this.protocol}`);\n    }\n\n    if (this.port && isNaN(parseInt(this.port, 10))) {\n      throw new SentryError(`${ERROR_MESSAGE}: Invalid port ${this.port}`);\n    }\n  }\n}\n", "/**\n * Checks whether we're in the Node.js or Browser environment\n *\n * @returns Answer to given question\n */\nexport function isNodeEnv(): boolean {\n  return Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]';\n}\n\n/**\n * Requires a module which is protected against bundler minification.\n *\n * @param request The module path to resolve\n */\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\nexport function dynamicRequire(mod: any, request: string): any {\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n  return mod.require(request);\n}\n\n/**\n * Helper for dynamically loading module that should work with linked dependencies.\n * The problem is that we _should_ be using `require(require.resolve(moduleName, { paths: [cwd()] }))`\n * However it's _not possible_ to do that with Webpack, as it has to know all the dependencies during\n * build time. `require.resolve` is also not available in any other way, so we cannot create,\n * a fake helper like we do with `dynamicRequire`.\n *\n * We always prefer to use local package, thus the value is not returned early from each `try/catch` block.\n * That is to mimic the behavior of `require.resolve` exactly.\n *\n * @param moduleName module name to require\n * @returns possibly required module\n */\nexport function loadModule<T>(moduleName: string): T | undefined {\n  let mod: T | undefined;\n\n  try {\n    mod = dynamicRequire(module, moduleName);\n  } catch (e) {\n    // no-empty\n  }\n\n  try {\n    const { cwd } = dynamicRequire(module, 'process');\n    mod = dynamicRequire(module, `${cwd()}/node_modules/${moduleName}`) as T;\n  } catch (e) {\n    // no-empty\n  }\n\n  return mod;\n}\n", "import { isRegExp, isString } from './is';\n\n/**\n * Truncates given string to the maximum characters count\n *\n * @param str An object that contains serializable values\n * @param max Maximum number of characters in truncated string (0 = unlimited)\n * @returns string Encoded\n */\nexport function truncate(str: string, max: number = 0): string {\n  if (typeof str !== 'string' || max === 0) {\n    return str;\n  }\n  return str.length <= max ? str : `${str.substr(0, max)}...`;\n}\n\n/**\n * This is basically just `trim_line` from\n * https://github.com/getsentry/sentry/blob/master/src/sentry/lang/javascript/processor.py#L67\n *\n * @param str An object that contains serializable values\n * @param max Maximum number of characters in truncated string\n * @returns string Encoded\n */\nexport function snipLine(line: string, colno: number): string {\n  let newLine = line;\n  const ll = newLine.length;\n  if (ll <= 150) {\n    return newLine;\n  }\n  if (colno > ll) {\n    // eslint-disable-next-line no-param-reassign\n    colno = ll;\n  }\n\n  let start = Math.max(colno - 60, 0);\n  if (start < 5) {\n    start = 0;\n  }\n\n  let end = Math.min(start + 140, ll);\n  if (end > ll - 5) {\n    end = ll;\n  }\n  if (end === ll) {\n    start = Math.max(end - 140, 0);\n  }\n\n  newLine = newLine.slice(start, end);\n  if (start > 0) {\n    newLine = `'{snip} ${newLine}`;\n  }\n  if (end < ll) {\n    newLine += ' {snip}';\n  }\n\n  return newLine;\n}\n\n/**\n * Join values in array\n * @param input array of values to be joined together\n * @param delimiter string to be placed in-between values\n * @returns Joined values\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function safeJoin(input: any[], delimiter?: string): string {\n  if (!Array.isArray(input)) {\n    return '';\n  }\n\n  const output = [];\n  // eslint-disable-next-line @typescript-eslint/prefer-for-of\n  for (let i = 0; i < input.length; i++) {\n    const value = input[i];\n    try {\n      output.push(String(value));\n    } catch (e) {\n      output.push('[value cannot be serialized]');\n    }\n  }\n\n  return output.join(delimiter);\n}\n\n/**\n * Checks if the value matches a regex or includes the string\n * @param value The string value to be checked against\n * @param pattern Either a regex or a string that must be contained in value\n */\nexport function isMatchingPattern(value: string, pattern: RegExp | string): boolean {\n  if (!isString(value)) {\n    return false;\n  }\n\n  if (isRegExp(pattern)) {\n    return (pattern as RegExp).test(value);\n  }\n  if (typeof pattern === 'string') {\n    return value.indexOf(pattern) !== -1;\n  }\n  return false;\n}\n", "/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { Event, Integration, StackFrame, WrappedFunction } from '@sentry/types';\n\nimport { isNodeEnv } from './node';\nimport { snipLine } from './string';\n\n/** Internal */\ninterface SentryGlobal {\n  Sentry?: {\n    Integrations?: Integration[];\n  };\n  SENTRY_ENVIRONMENT?: string;\n  SENTRY_DSN?: string;\n  SENTRY_RELEASE?: {\n    id?: string;\n  };\n  __SENTRY__: {\n    globalEventProcessors: any;\n    hub: any;\n    logger: any;\n  };\n}\n\nconst fallbackGlobalObject = {};\n\n/**\n * Safely get global scope object\n *\n * @returns Global scope object\n */\nexport function getGlobalObject<T>(): T & SentryGlobal {\n  return (isNodeEnv()\n    ? global\n    : typeof window !== 'undefined'\n    ? window\n    : typeof self !== 'undefined'\n    ? self\n    : fallbackGlobalObject) as T & SentryGlobal;\n}\n\n/**\n * Extended Window interface that allows for Crypto API usage in IE browsers\n */\ninterface MsCryptoWindow extends Window {\n  msCrypto?: Crypto;\n}\n\n/**\n * UUID4 generator\n *\n * @returns string Generated UUID4.\n */\nexport function uuid4(): string {\n  const global = getGlobalObject() as MsCryptoWindow;\n  const crypto = global.crypto || global.msCrypto;\n\n  if (!(crypto === void 0) && crypto.getRandomValues) {\n    // Use window.crypto API if available\n    const arr = new Uint16Array(8);\n    crypto.getRandomValues(arr);\n\n    // set 4 in byte 7\n    // eslint-disable-next-line no-bitwise\n    arr[3] = (arr[3] & 0xfff) | 0x4000;\n    // set 2 most significant bits of byte 9 to '10'\n    // eslint-disable-next-line no-bitwise\n    arr[4] = (arr[4] & 0x3fff) | 0x8000;\n\n    const pad = (num: number): string => {\n      let v = num.toString(16);\n      while (v.length < 4) {\n        v = `0${v}`;\n      }\n      return v;\n    };\n\n    return (\n      pad(arr[0]) + pad(arr[1]) + pad(arr[2]) + pad(arr[3]) + pad(arr[4]) + pad(arr[5]) + pad(arr[6]) + pad(arr[7])\n    );\n  }\n  // http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/2117523#2117523\n  return 'xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx'.replace(/[xy]/g, c => {\n    // eslint-disable-next-line no-bitwise\n    const r = (Math.random() * 16) | 0;\n    // eslint-disable-next-line no-bitwise\n    const v = c === 'x' ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n}\n\n/**\n * Parses string form of URL into an object\n * // borrowed from https://tools.ietf.org/html/rfc3986#appendix-B\n * // intentionally using regex and not <a/> href parsing trick because React Native and other\n * // environments where DOM might not be available\n * @returns parsed URL object\n */\nexport function parseUrl(\n  url: string,\n): {\n  host?: string;\n  path?: string;\n  protocol?: string;\n  relative?: string;\n} {\n  if (!url) {\n    return {};\n  }\n\n  const match = url.match(/^(([^:/?#]+):)?(\\/\\/([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$/);\n\n  if (!match) {\n    return {};\n  }\n\n  // coerce to undefined values to empty string so we don't get 'undefined'\n  const query = match[6] || '';\n  const fragment = match[8] || '';\n  return {\n    host: match[4],\n    path: match[5],\n    protocol: match[2],\n    relative: match[5] + query + fragment, // everything minus origin\n  };\n}\n\n/**\n * Extracts either message or type+value from an event that can be used for user-facing logs\n * @returns event's description\n */\nexport function getEventDescription(event: Event): string {\n  if (event.message) {\n    return event.message;\n  }\n  if (event.exception && event.exception.values && event.exception.values[0]) {\n    const exception = event.exception.values[0];\n\n    if (exception.type && exception.value) {\n      return `${exception.type}: ${exception.value}`;\n    }\n    return exception.type || exception.value || event.event_id || '<unknown>';\n  }\n  return event.event_id || '<unknown>';\n}\n\n/** JSDoc */\ninterface ExtensibleConsole extends Console {\n  [key: string]: any;\n}\n\n/** JSDoc */\nexport function consoleSandbox(callback: () => any): any {\n  const global = getGlobalObject<Window>();\n  const levels = ['debug', 'info', 'warn', 'error', 'log', 'assert'];\n\n  if (!('console' in global)) {\n    return callback();\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n  const originalConsole = (global as any).console as ExtensibleConsole;\n  const wrappedLevels: { [key: string]: any } = {};\n\n  // Restore all wrapped console methods\n  levels.forEach(level => {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    if (level in (global as any).console && (originalConsole[level] as WrappedFunction).__sentry_original__) {\n      wrappedLevels[level] = originalConsole[level] as WrappedFunction;\n      originalConsole[level] = (originalConsole[level] as WrappedFunction).__sentry_original__;\n    }\n  });\n\n  // Perform callback manipulations\n  const result = callback();\n\n  // Revert restoration to wrapped state\n  Object.keys(wrappedLevels).forEach(level => {\n    originalConsole[level] = wrappedLevels[level];\n  });\n\n  return result;\n}\n\n/**\n * Adds exception values, type and value to an synthetic Exception.\n * @param event The event to modify.\n * @param value Value of the exception.\n * @param type Type of the exception.\n * @hidden\n */\nexport function addExceptionTypeValue(event: Event, value?: string, type?: string): void {\n  event.exception = event.exception || {};\n  event.exception.values = event.exception.values || [];\n  event.exception.values[0] = event.exception.values[0] || {};\n  event.exception.values[0].value = event.exception.values[0].value || value || '';\n  event.exception.values[0].type = event.exception.values[0].type || type || 'Error';\n}\n\n/**\n * Adds exception mechanism to a given event.\n * @param event The event to modify.\n * @param mechanism Mechanism of the mechanism.\n * @hidden\n */\nexport function addExceptionMechanism(\n  event: Event,\n  mechanism: {\n    [key: string]: any;\n  } = {},\n): void {\n  // TODO: Use real type with `keyof Mechanism` thingy and maybe make it better?\n  try {\n    // @ts-ignore Type 'Mechanism | {}' is not assignable to type 'Mechanism | undefined'\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    event.exception!.values![0].mechanism = event.exception!.values![0].mechanism || {};\n    Object.keys(mechanism).forEach(key => {\n      // @ts-ignore Mechanism has no index signature\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      event.exception!.values![0].mechanism[key] = mechanism[key];\n    });\n  } catch (_oO) {\n    // no-empty\n  }\n}\n\n/**\n * A safe form of location.href\n */\nexport function getLocationHref(): string {\n  try {\n    return document.location.href;\n  } catch (oO) {\n    return '';\n  }\n}\n\n// https://semver.org/#is-there-a-suggested-regular-expression-regex-to-check-a-semver-string\nconst SEMVER_REGEXP = /^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$/;\n\n/**\n * Represents Semantic Versioning object\n */\ninterface SemVer {\n  major?: number;\n  minor?: number;\n  patch?: number;\n  prerelease?: string;\n  buildmetadata?: string;\n}\n\n/**\n * Parses input into a SemVer interface\n * @param input string representation of a semver version\n */\nexport function parseSemver(input: string): SemVer {\n  const match = input.match(SEMVER_REGEXP) || [];\n  const major = parseInt(match[1], 10);\n  const minor = parseInt(match[2], 10);\n  const patch = parseInt(match[3], 10);\n  return {\n    buildmetadata: match[5],\n    major: isNaN(major) ? undefined : major,\n    minor: isNaN(minor) ? undefined : minor,\n    patch: isNaN(patch) ? undefined : patch,\n    prerelease: match[4],\n  };\n}\n\nconst defaultRetryAfter = 60 * 1000; // 60 seconds\n\n/**\n * Extracts Retry-After value from the request header or returns default value\n * @param now current unix timestamp\n * @param header string representation of 'Retry-After' header\n */\nexport function parseRetryAfterHeader(now: number, header?: string | number | null): number {\n  if (!header) {\n    return defaultRetryAfter;\n  }\n\n  const headerDelay = parseInt(`${header}`, 10);\n  if (!isNaN(headerDelay)) {\n    return headerDelay * 1000;\n  }\n\n  const headerDate = Date.parse(`${header}`);\n  if (!isNaN(headerDate)) {\n    return headerDate - now;\n  }\n\n  return defaultRetryAfter;\n}\n\n/**\n * This function adds context (pre/post/line) lines to the provided frame\n *\n * @param lines string[] containing all lines\n * @param frame StackFrame that will be mutated\n * @param linesOfContext number of context lines we want to add pre/post\n */\nexport function addContextToFrame(lines: string[], frame: StackFrame, linesOfContext: number = 5): void {\n  const lineno = frame.lineno || 0;\n  const maxLines = lines.length;\n  const sourceLine = Math.max(Math.min(maxLines, lineno - 1), 0);\n\n  frame.pre_context = lines\n    .slice(Math.max(0, sourceLine - linesOfContext), sourceLine)\n    .map((line: string) => snipLine(line, 0));\n\n  frame.context_line = snipLine(lines[Math.min(maxLines - 1, sourceLine)], frame.colno || 0);\n\n  frame.post_context = lines\n    .slice(Math.min(sourceLine + 1, maxLines), sourceLine + 1 + linesOfContext)\n    .map((line: string) => snipLine(line, 0));\n}\n\n/**\n * Strip the query string and fragment off of a given URL or path (if present)\n *\n * @param urlPath Full URL or path, including possible query string and/or fragment\n * @returns URL or path without query string or fragment\n */\nexport function stripUrlQueryAndFragment(urlPath: string): string {\n  // eslint-disable-next-line no-useless-escape\n  return urlPath.split(/[\\?#]/, 1)[0];\n}\n", "/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { consoleSandbox, getGlobalObject } from './misc';\n\n// TODO: Implement different loggers for different environments\nconst global = getGlobalObject<Window | NodeJS.Global>();\n\n/** Prefix for logging strings */\nconst PREFIX = 'Sentry Logger ';\n\n/** JSDoc */\nclass Logger {\n  /** JSDoc */\n  private _enabled: boolean;\n\n  /** JSDoc */\n  public constructor() {\n    this._enabled = false;\n  }\n\n  /** JSDoc */\n  public disable(): void {\n    this._enabled = false;\n  }\n\n  /** JSDoc */\n  public enable(): void {\n    this._enabled = true;\n  }\n\n  /** JSDoc */\n  public log(...args: any[]): void {\n    if (!this._enabled) {\n      return;\n    }\n    consoleSandbox(() => {\n      global.console.log(`${PREFIX}[Log]: ${args.join(' ')}`);\n    });\n  }\n\n  /** JSDoc */\n  public warn(...args: any[]): void {\n    if (!this._enabled) {\n      return;\n    }\n    consoleSandbox(() => {\n      global.console.warn(`${PREFIX}[Warn]: ${args.join(' ')}`);\n    });\n  }\n\n  /** JSDoc */\n  public error(...args: any[]): void {\n    if (!this._enabled) {\n      return;\n    }\n    consoleSandbox(() => {\n      global.console.error(`${PREFIX}[Error]: ${args.join(' ')}`);\n    });\n  }\n}\n\n// Ensure we only have a single logger instance, even if multiple versions of @sentry/utils are being used\nglobal.__SENTRY__ = global.__SENTRY__ || {};\nconst logger = (global.__SENTRY__.logger as Logger) || (global.__SENTRY__.logger = new Logger());\n\nexport { logger };\n", "/* eslint-disable @typescript-eslint/no-unsafe-member-access */\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\n/**\n * Memo class used for decycle json objects. Uses WeakSet if available otherwise array.\n */\nexport class Memo {\n  /** Determines if WeakSet is available */\n  private readonly _hasWeakSet: boolean;\n  /** Either WeakSet or Array */\n  private readonly _inner: any;\n\n  public constructor() {\n    this._hasWeakSet = typeof WeakSet === 'function';\n    this._inner = this._hasWeakSet ? new WeakSet() : [];\n  }\n\n  /**\n   * Sets obj to remember.\n   * @param obj Object to remember\n   */\n  public memoize(obj: any): boolean {\n    if (this._hasWeakSet) {\n      if (this._inner.has(obj)) {\n        return true;\n      }\n      this._inner.add(obj);\n      return false;\n    }\n    // eslint-disable-next-line @typescript-eslint/prefer-for-of\n    for (let i = 0; i < this._inner.length; i++) {\n      const value = this._inner[i];\n      if (value === obj) {\n        return true;\n      }\n    }\n    this._inner.push(obj);\n    return false;\n  }\n\n  /**\n   * Removes object from internal storage.\n   * @param obj Object to forget\n   */\n  public unmemoize(obj: any): void {\n    if (this._hasWeakSet) {\n      this._inner.delete(obj);\n    } else {\n      for (let i = 0; i < this._inner.length; i++) {\n        if (this._inner[i] === obj) {\n          this._inner.splice(i, 1);\n          break;\n        }\n      }\n    }\n  }\n}\n", "const defaultFunctionName = '<anonymous>';\n\n/**\n * Safely extract function name from itself\n */\nexport function getFunctionName(fn: unknown): string {\n  try {\n    if (!fn || typeof fn !== 'function') {\n      return defaultFunctionName;\n    }\n    return fn.name || defaultFunctionName;\n  } catch (e) {\n    // Just accessing custom props in some Selenium environments\n    // can cause a \"Permission denied\" exception (see raven-js#495).\n    return defaultFunctionName;\n  }\n}\n", "/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { ExtendedError, WrappedFunction } from '@sentry/types';\n\nimport { htmlTreeAsString } from './browser';\nimport { isElement, isError, isEvent, isInstanceOf, isPlainObject, isPrimitive, isSyntheticEvent } from './is';\nimport { Memo } from './memo';\nimport { getFunctionName } from './stacktrace';\nimport { truncate } from './string';\n\n/**\n * Replace a method in an object with a wrapped version of itself.\n *\n * @param source An object that contains a method to be wrapped.\n * @param name The name of the method to be wrapped.\n * @param replacementFactory A higher-order function that takes the original version of the given method and returns a\n * wrapped version. Note: The function returned by `replacementFactory` needs to be a non-arrow function, in order to\n * preserve the correct value of `this`, and the original method must be called using `origMethod.call(this, <other\n * args>)` or `origMethod.apply(this, [<other args>])` (rather than being called directly), again to preserve `this`.\n * @returns void\n */\nexport function fill(source: { [key: string]: any }, name: string, replacementFactory: (...args: any[]) => any): void {\n  if (!(name in source)) {\n    return;\n  }\n\n  const original = source[name] as () => any;\n  const wrapped = replacementFactory(original) as WrappedFunction;\n\n  // Make sure it's a function first, as we need to attach an empty prototype for `defineProperties` to work\n  // otherwise it'll throw \"TypeError: Object.defineProperties called on non-object\"\n  if (typeof wrapped === 'function') {\n    try {\n      wrapped.prototype = wrapped.prototype || {};\n      Object.defineProperties(wrapped, {\n        __sentry_original__: {\n          enumerable: false,\n          value: original,\n        },\n      });\n    } catch (_Oo) {\n      // This can throw if multiple fill happens on a global object like XMLHttpRequest\n      // Fixes https://github.com/getsentry/sentry-javascript/issues/2043\n    }\n  }\n\n  source[name] = wrapped;\n}\n\n/**\n * Encodes given object into url-friendly format\n *\n * @param object An object that contains serializable values\n * @returns string Encoded\n */\nexport function urlEncode(object: { [key: string]: any }): string {\n  return Object.keys(object)\n    .map(key => `${encodeURIComponent(key)}=${encodeURIComponent(object[key])}`)\n    .join('&');\n}\n\n/**\n * Transforms any object into an object literal with all its attributes\n * attached to it.\n *\n * @param value Initial source that we have to transform in order for it to be usable by the serializer\n */\nfunction getWalkSource(\n  value: any,\n): {\n  [key: string]: any;\n} {\n  if (isError(value)) {\n    const error = value as ExtendedError;\n    const err: {\n      [key: string]: any;\n      stack: string | undefined;\n      message: string;\n      name: string;\n    } = {\n      message: error.message,\n      name: error.name,\n      stack: error.stack,\n    };\n\n    for (const i in error) {\n      if (Object.prototype.hasOwnProperty.call(error, i)) {\n        err[i] = error[i];\n      }\n    }\n\n    return err;\n  }\n\n  if (isEvent(value)) {\n    /**\n     * Event-like interface that's usable in browser and node\n     */\n    interface SimpleEvent {\n      [key: string]: unknown;\n      type: string;\n      target?: unknown;\n      currentTarget?: unknown;\n    }\n\n    const event = value as SimpleEvent;\n\n    const source: {\n      [key: string]: any;\n    } = {};\n\n    source.type = event.type;\n\n    // Accessing event.target can throw (see getsentry/raven-js#838, #768)\n    try {\n      source.target = isElement(event.target)\n        ? htmlTreeAsString(event.target)\n        : Object.prototype.toString.call(event.target);\n    } catch (_oO) {\n      source.target = '<unknown>';\n    }\n\n    try {\n      source.currentTarget = isElement(event.currentTarget)\n        ? htmlTreeAsString(event.currentTarget)\n        : Object.prototype.toString.call(event.currentTarget);\n    } catch (_oO) {\n      source.currentTarget = '<unknown>';\n    }\n\n    if (typeof CustomEvent !== 'undefined' && isInstanceOf(value, CustomEvent)) {\n      source.detail = event.detail;\n    }\n\n    for (const i in event) {\n      if (Object.prototype.hasOwnProperty.call(event, i)) {\n        source[i] = event;\n      }\n    }\n\n    return source;\n  }\n\n  return value as {\n    [key: string]: any;\n  };\n}\n\n/** Calculates bytes size of input string */\nfunction utf8Length(value: string): number {\n  // eslint-disable-next-line no-bitwise\n  return ~-encodeURI(value).split(/%..|./).length;\n}\n\n/** Calculates bytes size of input object */\nfunction jsonSize(value: any): number {\n  return utf8Length(JSON.stringify(value));\n}\n\n/** JSDoc */\nexport function normalizeToSize<T>(\n  object: { [key: string]: any },\n  // Default Node.js REPL depth\n  depth: number = 3,\n  // 100kB, as 200kB is max payload size, so half sounds reasonable\n  maxSize: number = 100 * 1024,\n): T {\n  const serialized = normalize(object, depth);\n\n  if (jsonSize(serialized) > maxSize) {\n    return normalizeToSize(object, depth - 1, maxSize);\n  }\n\n  return serialized as T;\n}\n\n/**\n * Transform any non-primitive, BigInt, or Symbol-type value into a string. Acts as a no-op on strings, numbers,\n * booleans, null, and undefined.\n *\n * @param value The value to stringify\n * @returns For non-primitive, BigInt, and Symbol-type values, a string denoting the value's type, type and value, or\n *  type and `description` property, respectively. For non-BigInt, non-Symbol primitives, returns the original value,\n *  unchanged.\n */\nfunction serializeValue(value: any): any {\n  const type = Object.prototype.toString.call(value);\n\n  // Node.js REPL notation\n  if (typeof value === 'string') {\n    return value;\n  }\n  if (type === '[object Object]') {\n    return '[Object]';\n  }\n  if (type === '[object Array]') {\n    return '[Array]';\n  }\n\n  const normalized = normalizeValue(value);\n  return isPrimitive(normalized) ? normalized : type;\n}\n\n/**\n * normalizeValue()\n *\n * Takes unserializable input and make it serializable friendly\n *\n * - translates undefined/NaN values to \"[undefined]\"/\"[NaN]\" respectively,\n * - serializes Error objects\n * - filter global objects\n */\nfunction normalizeValue<T>(value: T, key?: any): T | string {\n  if (key === 'domain' && value && typeof value === 'object' && ((value as unknown) as { _events: any })._events) {\n    return '[Domain]';\n  }\n\n  if (key === 'domainEmitter') {\n    return '[DomainEmitter]';\n  }\n\n  if (typeof (global as any) !== 'undefined' && (value as unknown) === global) {\n    return '[Global]';\n  }\n\n  if (typeof (window as any) !== 'undefined' && (value as unknown) === window) {\n    return '[Window]';\n  }\n\n  if (typeof (document as any) !== 'undefined' && (value as unknown) === document) {\n    return '[Document]';\n  }\n\n  // React's SyntheticEvent thingy\n  if (isSyntheticEvent(value)) {\n    return '[SyntheticEvent]';\n  }\n\n  if (typeof value === 'number' && value !== value) {\n    return '[NaN]';\n  }\n\n  if (value === void 0) {\n    return '[undefined]';\n  }\n\n  if (typeof value === 'function') {\n    return `[Function: ${getFunctionName(value)}]`;\n  }\n\n  // symbols and bigints are considered primitives by TS, but aren't natively JSON-serilaizable\n\n  if (typeof value === 'symbol') {\n    return `[${String(value)}]`;\n  }\n\n  if (typeof value === 'bigint') {\n    return `[BigInt: ${String(value)}]`;\n  }\n\n  return value;\n}\n\n/**\n * Walks an object to perform a normalization on it\n *\n * @param key of object that's walked in current iteration\n * @param value object to be walked\n * @param depth Optional number indicating how deep should walking be performed\n * @param memo Optional Memo class handling decycling\n */\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function walk(key: string, value: any, depth: number = +Infinity, memo: Memo = new Memo()): any {\n  // If we reach the maximum depth, serialize whatever has left\n  if (depth === 0) {\n    return serializeValue(value);\n  }\n\n  /* eslint-disable @typescript-eslint/no-unsafe-member-access */\n  // If value implements `toJSON` method, call it and return early\n  if (value !== null && value !== undefined && typeof value.toJSON === 'function') {\n    return value.toJSON();\n  }\n  /* eslint-enable @typescript-eslint/no-unsafe-member-access */\n\n  // If normalized value is a primitive, there are no branches left to walk, so we can just bail out, as theres no point in going down that branch any further\n  const normalized = normalizeValue(value, key);\n  if (isPrimitive(normalized)) {\n    return normalized;\n  }\n\n  // Create source that we will use for next itterations, either objectified error object (Error type with extracted keys:value pairs) or the input itself\n  const source = getWalkSource(value);\n\n  // Create an accumulator that will act as a parent for all future itterations of that branch\n  const acc = Array.isArray(value) ? [] : {};\n\n  // If we already walked that branch, bail out, as it's circular reference\n  if (memo.memoize(value)) {\n    return '[Circular ~]';\n  }\n\n  // Walk all keys of the source\n  for (const innerKey in source) {\n    // Avoid iterating over fields in the prototype if they've somehow been exposed to enumeration.\n    if (!Object.prototype.hasOwnProperty.call(source, innerKey)) {\n      continue;\n    }\n    // Recursively walk through all the child nodes\n    (acc as { [key: string]: any })[innerKey] = walk(innerKey, source[innerKey], depth - 1, memo);\n  }\n\n  // Once walked through all the branches, remove the parent from memo storage\n  memo.unmemoize(value);\n\n  // Return accumulated values\n  return acc;\n}\n\n/**\n * normalize()\n *\n * - Creates a copy to prevent original input mutation\n * - Skip non-enumerablers\n * - Calls `toJSON` if implemented\n * - Removes circular references\n * - Translates non-serializeable values (undefined/NaN/Functions) to serializable format\n * - Translates known global objects/Classes to a string representations\n * - Takes care of Error objects serialization\n * - Optionally limit depth of final output\n */\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function normalize(input: any, depth?: number): any {\n  try {\n    return JSON.parse(JSON.stringify(input, (key: string, value: any) => walk(key, value, depth)));\n  } catch (_oO) {\n    return '**non-serializable**';\n  }\n}\n\n/**\n * Given any captured exception, extract its keys and create a sorted\n * and truncated list that will be used inside the event message.\n * eg. `Non-error exception captured with keys: foo, bar, baz`\n */\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function extractExceptionKeysForMessage(exception: any, maxLength: number = 40): string {\n  const keys = Object.keys(getWalkSource(exception));\n  keys.sort();\n\n  if (!keys.length) {\n    return '[object has no keys]';\n  }\n\n  if (keys[0].length >= maxLength) {\n    return truncate(keys[0], maxLength);\n  }\n\n  for (let includedKeys = keys.length; includedKeys > 0; includedKeys--) {\n    const serialized = keys.slice(0, includedKeys).join(', ');\n    if (serialized.length > maxLength) {\n      continue;\n    }\n    if (includedKeys === keys.length) {\n      return serialized;\n    }\n    return truncate(serialized, maxLength);\n  }\n\n  return '';\n}\n\n/**\n * Given any object, return the new object with removed keys that value was `undefined`.\n * Works recursively on objects and arrays.\n */\nexport function dropUndefinedKeys<T>(val: T): T {\n  if (isPlainObject(val)) {\n    const obj = val as { [key: string]: any };\n    const rv: { [key: string]: any } = {};\n    for (const key of Object.keys(obj)) {\n      if (typeof obj[key] !== 'undefined') {\n        rv[key] = dropUndefinedKeys(obj[key]);\n      }\n    }\n    return rv as T;\n  }\n\n  if (Array.isArray(val)) {\n    return (val as any[]).map(dropUndefinedKeys) as any;\n  }\n\n  return val;\n}\n", "import { logger } from './logger';\nimport { getGlobalObject } from './misc';\n\n/**\n * Tells whether current environment supports ErrorEvent objects\n * {@link supportsErrorEvent}.\n *\n * @returns Answer to the given question.\n */\nexport function supportsErrorEvent(): boolean {\n  try {\n    new ErrorEvent('');\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Tells whether current environment supports DOMError objects\n * {@link supportsDOMError}.\n *\n * @returns Answer to the given question.\n */\nexport function supportsDOMError(): boolean {\n  try {\n    // Chrome: VM89:1 Uncaught TypeError: Failed to construct 'DOMError':\n    // 1 argument required, but only 0 present.\n    // @ts-ignore It really needs 1 argument, not 0.\n    new DOMError('');\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Tells whether current environment supports DOMException objects\n * {@link supportsDOMException}.\n *\n * @returns Answer to the given question.\n */\nexport function supportsDOMException(): boolean {\n  try {\n    new DOMException('');\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Tells whether current environment supports Fetch API\n * {@link supportsFetch}.\n *\n * @returns Answer to the given question.\n */\nexport function supportsFetch(): boolean {\n  if (!('fetch' in getGlobalObject<Window>())) {\n    return false;\n  }\n\n  try {\n    new Headers();\n    new Request('');\n    new Response();\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n/**\n * isNativeFetch checks if the given function is a native implementation of fetch()\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function isNativeFetch(func: Function): boolean {\n  return func && /^function fetch\\(\\)\\s+\\{\\s+\\[native code\\]\\s+\\}$/.test(func.toString());\n}\n\n/**\n * Tells whether current environment supports Fetch API natively\n * {@link supportsNativeFetch}.\n *\n * @returns true if `window.fetch` is natively implemented, false otherwise\n */\nexport function supportsNativeFetch(): boolean {\n  if (!supportsFetch()) {\n    return false;\n  }\n\n  const global = getGlobalObject<Window>();\n\n  // Fast path to avoid DOM I/O\n  // eslint-disable-next-line @typescript-eslint/unbound-method\n  if (isNativeFetch(global.fetch)) {\n    return true;\n  }\n\n  // window.fetch is implemented, but is polyfilled or already wrapped (e.g: by a chrome extension)\n  // so create a \"pure\" iframe to see if that has native fetch\n  let result = false;\n  const doc = global.document;\n  // eslint-disable-next-line deprecation/deprecation\n  if (doc && typeof (doc.createElement as unknown) === `function`) {\n    try {\n      const sandbox = doc.createElement('iframe');\n      sandbox.hidden = true;\n      doc.head.appendChild(sandbox);\n      if (sandbox.contentWindow && sandbox.contentWindow.fetch) {\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        result = isNativeFetch(sandbox.contentWindow.fetch);\n      }\n      doc.head.removeChild(sandbox);\n    } catch (err) {\n      logger.warn('Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ', err);\n    }\n  }\n\n  return result;\n}\n\n/**\n * Tells whether current environment supports ReportingObserver API\n * {@link supportsReportingObserver}.\n *\n * @returns Answer to the given question.\n */\nexport function supportsReportingObserver(): boolean {\n  return 'ReportingObserver' in getGlobalObject();\n}\n\n/**\n * Tells whether current environment supports Referrer Policy API\n * {@link supportsReferrerPolicy}.\n *\n * @returns Answer to the given question.\n */\nexport function supportsReferrerPolicy(): boolean {\n  // Despite all stars in the sky saying that Edge supports old draft syntax, aka 'never', 'always', 'origin' and 'default\n  // https://caniuse.com/#feat=referrer-policy\n  // It doesn't. And it throw exception instead of ignoring this parameter...\n  // REF: https://github.com/getsentry/raven-js/issues/1233\n\n  if (!supportsFetch()) {\n    return false;\n  }\n\n  try {\n    new Request('_', {\n      referrerPolicy: 'origin' as ReferrerPolicy,\n    });\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Tells whether current environment supports History API\n * {@link supportsHistory}.\n *\n * @returns Answer to the given question.\n */\nexport function supportsHistory(): boolean {\n  // NOTE: in Chrome App environment, touching history.pushState, *even inside\n  //       a try/catch block*, will cause Chrome to output an error to console.error\n  // borrowed from: https://github.com/angular/angular.js/pull/13945/files\n  const global = getGlobalObject<Window>();\n  /* eslint-disable @typescript-eslint/no-unsafe-member-access */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const chrome = (global as any).chrome;\n  const isChromePackagedApp = chrome && chrome.app && chrome.app.runtime;\n  /* eslint-enable @typescript-eslint/no-unsafe-member-access */\n  const hasHistoryApi = 'history' in global && !!global.history.pushState && !!global.history.replaceState;\n\n  return !isChromePackagedApp && hasHistoryApi;\n}\n", "/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/ban-types */\nimport { WrappedFunction } from '@sentry/types';\n\nimport { isInstanceOf, isString } from './is';\nimport { logger } from './logger';\nimport { getGlobalObject } from './misc';\nimport { fill } from './object';\nimport { getFunctionName } from './stacktrace';\nimport { supportsHistory, supportsNativeFetch } from './supports';\n\nconst global = getGlobalObject<Window>();\n\n/** Object describing handler that will be triggered for a given `type` of instrumentation */\ninterface InstrumentHandler {\n  type: InstrumentHandlerType;\n  callback: InstrumentHandlerCallback;\n}\ntype InstrumentHandlerType =\n  | 'console'\n  | 'dom'\n  | 'fetch'\n  | 'history'\n  | 'sentry'\n  | 'xhr'\n  | 'error'\n  | 'unhandledrejection';\ntype InstrumentHandlerCallback = (data: any) => void;\n\n/**\n * Instrument native APIs to call handlers that can be used to create breadcrumbs, APM spans etc.\n *  - Console API\n *  - Fetch API\n *  - XHR API\n *  - History API\n *  - DOM API (click/typing)\n *  - Error API\n *  - UnhandledRejection API\n */\n\nconst handlers: { [key in InstrumentHandlerType]?: InstrumentHandlerCallback[] } = {};\nconst instrumented: { [key in InstrumentHandlerType]?: boolean } = {};\n\n/** Instruments given API */\nfunction instrument(type: InstrumentHandlerType): void {\n  if (instrumented[type]) {\n    return;\n  }\n\n  instrumented[type] = true;\n\n  switch (type) {\n    case 'console':\n      instrumentConsole();\n      break;\n    case 'dom':\n      instrumentDOM();\n      break;\n    case 'xhr':\n      instrumentXHR();\n      break;\n    case 'fetch':\n      instrumentFetch();\n      break;\n    case 'history':\n      instrumentHistory();\n      break;\n    case 'error':\n      instrumentError();\n      break;\n    case 'unhandledrejection':\n      instrumentUnhandledRejection();\n      break;\n    default:\n      logger.warn('unknown instrumentation type:', type);\n  }\n}\n\n/**\n * Add handler that will be called when given type of instrumentation triggers.\n * Use at your own risk, this might break without changelog notice, only used internally.\n * @hidden\n */\nexport function addInstrumentationHandler(handler: InstrumentHandler): void {\n  if (!handler || typeof handler.type !== 'string' || typeof handler.callback !== 'function') {\n    return;\n  }\n  handlers[handler.type] = handlers[handler.type] || [];\n  (handlers[handler.type] as InstrumentHandlerCallback[]).push(handler.callback);\n  instrument(handler.type);\n}\n\n/** JSDoc */\nfunction triggerHandlers(type: InstrumentHandlerType, data: any): void {\n  if (!type || !handlers[type]) {\n    return;\n  }\n\n  for (const handler of handlers[type] || []) {\n    try {\n      handler(data);\n    } catch (e) {\n      logger.error(\n        `Error while triggering instrumentation handler.\\nType: ${type}\\nName: ${getFunctionName(\n          handler,\n        )}\\nError: ${e}`,\n      );\n    }\n  }\n}\n\n/** JSDoc */\nfunction instrumentConsole(): void {\n  if (!('console' in global)) {\n    return;\n  }\n\n  ['debug', 'info', 'warn', 'error', 'log', 'assert'].forEach(function(level: string): void {\n    if (!(level in global.console)) {\n      return;\n    }\n\n    fill(global.console, level, function(originalConsoleLevel: () => any): Function {\n      return function(...args: any[]): void {\n        triggerHandlers('console', { args, level });\n\n        // this fails for some browsers. :(\n        if (originalConsoleLevel) {\n          Function.prototype.apply.call(originalConsoleLevel, global.console, args);\n        }\n      };\n    });\n  });\n}\n\n/** JSDoc */\nfunction instrumentFetch(): void {\n  if (!supportsNativeFetch()) {\n    return;\n  }\n\n  fill(global, 'fetch', function(originalFetch: () => void): () => void {\n    return function(...args: any[]): void {\n      const handlerData = {\n        args,\n        fetchData: {\n          method: getFetchMethod(args),\n          url: getFetchUrl(args),\n        },\n        startTimestamp: Date.now(),\n      };\n\n      triggerHandlers('fetch', {\n        ...handlerData,\n      });\n\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      return originalFetch.apply(global, args).then(\n        (response: Response) => {\n          triggerHandlers('fetch', {\n            ...handlerData,\n            endTimestamp: Date.now(),\n            response,\n          });\n          return response;\n        },\n        (error: Error) => {\n          triggerHandlers('fetch', {\n            ...handlerData,\n            endTimestamp: Date.now(),\n            error,\n          });\n          // NOTE: If you are a Sentry user, and you are seeing this stack frame,\n          //       it means the sentry.javascript SDK caught an error invoking your application code.\n          //       This is expected behavior and NOT indicative of a bug with sentry.javascript.\n          throw error;\n        },\n      );\n    };\n  });\n}\n\ntype XHRSendInput = null | Blob | BufferSource | FormData | URLSearchParams | string;\n\n/** JSDoc */\ninterface SentryWrappedXMLHttpRequest extends XMLHttpRequest {\n  [key: string]: any;\n  __sentry_xhr__?: {\n    method?: string;\n    url?: string;\n    status_code?: number;\n    body?: XHRSendInput;\n  };\n}\n\n/* eslint-disable @typescript-eslint/no-unsafe-member-access */\n/** Extract `method` from fetch call arguments */\nfunction getFetchMethod(fetchArgs: any[] = []): string {\n  if ('Request' in global && isInstanceOf(fetchArgs[0], Request) && fetchArgs[0].method) {\n    return String(fetchArgs[0].method).toUpperCase();\n  }\n  if (fetchArgs[1] && fetchArgs[1].method) {\n    return String(fetchArgs[1].method).toUpperCase();\n  }\n  return 'GET';\n}\n\n/** Extract `url` from fetch call arguments */\nfunction getFetchUrl(fetchArgs: any[] = []): string {\n  if (typeof fetchArgs[0] === 'string') {\n    return fetchArgs[0];\n  }\n  if ('Request' in global && isInstanceOf(fetchArgs[0], Request)) {\n    return fetchArgs[0].url;\n  }\n  return String(fetchArgs[0]);\n}\n/* eslint-enable @typescript-eslint/no-unsafe-member-access */\n\n/** JSDoc */\nfunction instrumentXHR(): void {\n  if (!('XMLHttpRequest' in global)) {\n    return;\n  }\n\n  // Poor man's implementation of ES6 `Map`, tracking and keeping in sync key and value separately.\n  const requestKeys: XMLHttpRequest[] = [];\n  const requestValues: Array<any>[] = [];\n  const xhrproto = XMLHttpRequest.prototype;\n\n  fill(xhrproto, 'open', function(originalOpen: () => void): () => void {\n    return function(this: SentryWrappedXMLHttpRequest, ...args: any[]): void {\n      // eslint-disable-next-line @typescript-eslint/no-this-alias\n      const xhr = this;\n      const url = args[1];\n      xhr.__sentry_xhr__ = {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        method: isString(args[0]) ? args[0].toUpperCase() : args[0],\n        url: args[1],\n      };\n\n      // if Sentry key appears in URL, don't capture it as a request\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      if (isString(url) && xhr.__sentry_xhr__.method === 'POST' && url.match(/sentry_key/)) {\n        xhr.__sentry_own_request__ = true;\n      }\n\n      const onreadystatechangeHandler = function(): void {\n        if (xhr.readyState === 4) {\n          try {\n            // touching statusCode in some platforms throws\n            // an exception\n            if (xhr.__sentry_xhr__) {\n              xhr.__sentry_xhr__.status_code = xhr.status;\n            }\n          } catch (e) {\n            /* do nothing */\n          }\n\n          try {\n            const requestPos = requestKeys.indexOf(xhr);\n            if (requestPos !== -1) {\n              // Make sure to pop both key and value to keep it in sync.\n              requestKeys.splice(requestPos);\n              const args = requestValues.splice(requestPos)[0];\n              if (xhr.__sentry_xhr__ && args[0] !== undefined) {\n                xhr.__sentry_xhr__.body = args[0] as XHRSendInput;\n              }\n            }\n          } catch (e) {\n            /* do nothing */\n          }\n\n          triggerHandlers('xhr', {\n            args,\n            endTimestamp: Date.now(),\n            startTimestamp: Date.now(),\n            xhr,\n          });\n        }\n      };\n\n      if ('onreadystatechange' in xhr && typeof xhr.onreadystatechange === 'function') {\n        fill(xhr, 'onreadystatechange', function(original: WrappedFunction): Function {\n          return function(...readyStateArgs: any[]): void {\n            onreadystatechangeHandler();\n            return original.apply(xhr, readyStateArgs);\n          };\n        });\n      } else {\n        xhr.addEventListener('readystatechange', onreadystatechangeHandler);\n      }\n\n      return originalOpen.apply(xhr, args);\n    };\n  });\n\n  fill(xhrproto, 'send', function(originalSend: () => void): () => void {\n    return function(this: SentryWrappedXMLHttpRequest, ...args: any[]): void {\n      requestKeys.push(this);\n      requestValues.push(args);\n\n      triggerHandlers('xhr', {\n        args,\n        startTimestamp: Date.now(),\n        xhr: this,\n      });\n\n      return originalSend.apply(this, args);\n    };\n  });\n}\n\nlet lastHref: string;\n\n/** JSDoc */\nfunction instrumentHistory(): void {\n  if (!supportsHistory()) {\n    return;\n  }\n\n  const oldOnPopState = global.onpopstate;\n  global.onpopstate = function(this: WindowEventHandlers, ...args: any[]): any {\n    const to = global.location.href;\n    // keep track of the current URL state, as we always receive only the updated state\n    const from = lastHref;\n    lastHref = to;\n    triggerHandlers('history', {\n      from,\n      to,\n    });\n    if (oldOnPopState) {\n      // Apparently this can throw in Firefox when incorrectly implemented plugin is installed.\n      // https://github.com/getsentry/sentry-javascript/issues/3344\n      // https://github.com/bugsnag/bugsnag-js/issues/469\n      try {\n        return oldOnPopState.apply(this, args);\n      } catch (_oO) {\n        // no-empty\n      }\n    }\n  };\n\n  /** @hidden */\n  function historyReplacementFunction(originalHistoryFunction: () => void): () => void {\n    return function(this: History, ...args: any[]): void {\n      const url = args.length > 2 ? args[2] : undefined;\n      if (url) {\n        // coerce to string (this is what pushState does)\n        const from = lastHref;\n        const to = String(url);\n        // keep track of the current URL state, as we always receive only the updated state\n        lastHref = to;\n        triggerHandlers('history', {\n          from,\n          to,\n        });\n      }\n      return originalHistoryFunction.apply(this, args);\n    };\n  }\n\n  fill(global.history, 'pushState', historyReplacementFunction);\n  fill(global.history, 'replaceState', historyReplacementFunction);\n}\n\nconst debounceDuration = 1000;\nlet debounceTimerID: number | undefined;\nlet lastCapturedEvent: Event | undefined;\n\n/**\n * Decide whether the current event should finish the debounce of previously captured one.\n * @param previous previously captured event\n * @param current event to be captured\n */\nfunction shouldShortcircuitPreviousDebounce(previous: Event | undefined, current: Event): boolean {\n  // If there was no previous event, it should always be swapped for the new one.\n  if (!previous) {\n    return true;\n  }\n\n  // If both events have different type, then user definitely performed two separate actions. e.g. click + keypress.\n  if (previous.type !== current.type) {\n    return true;\n  }\n\n  try {\n    // If both events have the same type, it's still possible that actions were performed on different targets.\n    // e.g. 2 clicks on different buttons.\n    if (previous.target !== current.target) {\n      return true;\n    }\n  } catch (e) {\n    // just accessing `target` property can throw an exception in some rare circumstances\n    // see: https://github.com/getsentry/sentry-javascript/issues/838\n  }\n\n  // If both events have the same type _and_ same `target` (an element which triggered an event, _not necessarily_\n  // to which an event listener was attached), we treat them as the same action, as we want to capture\n  // only one breadcrumb. e.g. multiple clicks on the same button, or typing inside a user input box.\n  return false;\n}\n\n/**\n * Decide whether an event should be captured.\n * @param event event to be captured\n */\nfunction shouldSkipDOMEvent(event: Event): boolean {\n  // We are only interested in filtering `keypress` events for now.\n  if (event.type !== 'keypress') {\n    return false;\n  }\n\n  try {\n    const target = event.target as HTMLElement;\n\n    if (!target || !target.tagName) {\n      return true;\n    }\n\n    // Only consider keypress events on actual input elements. This will disregard keypresses targeting body\n    // e.g.tabbing through elements, hotkeys, etc.\n    if (target.tagName === 'INPUT' || target.tagName === 'TEXTAREA' || target.isContentEditable) {\n      return false;\n    }\n  } catch (e) {\n    // just accessing `target` property can throw an exception in some rare circumstances\n    // see: https://github.com/getsentry/sentry-javascript/issues/838\n  }\n\n  return true;\n}\n\n/**\n * Wraps addEventListener to capture UI breadcrumbs\n * @param handler function that will be triggered\n * @param globalListener indicates whether event was captured by the global event listener\n * @returns wrapped breadcrumb events handler\n * @hidden\n */\nfunction makeDOMEventHandler(handler: Function, globalListener: boolean = false): (event: Event) => void {\n  return (event: Event): void => {\n    // It's possible this handler might trigger multiple times for the same\n    // event (e.g. event propagation through node ancestors).\n    // Ignore if we've already captured that event.\n    if (!event || lastCapturedEvent === event) {\n      return;\n    }\n\n    // We always want to skip _some_ events.\n    if (shouldSkipDOMEvent(event)) {\n      return;\n    }\n\n    const name = event.type === 'keypress' ? 'input' : event.type;\n\n    // If there is no debounce timer, it means that we can safely capture the new event and store it for future comparisons.\n    if (debounceTimerID === undefined) {\n      handler({\n        event: event,\n        name,\n        global: globalListener,\n      });\n      lastCapturedEvent = event;\n    }\n    // If there is a debounce awaiting, see if the new event is different enough to treat it as a unique one.\n    // If that's the case, emit the previous event and store locally the newly-captured DOM event.\n    else if (shouldShortcircuitPreviousDebounce(lastCapturedEvent, event)) {\n      handler({\n        event: event,\n        name,\n        global: globalListener,\n      });\n      lastCapturedEvent = event;\n    }\n\n    // Start a new debounce timer that will prevent us from capturing multiple events that should be grouped together.\n    clearTimeout(debounceTimerID);\n    debounceTimerID = global.setTimeout(() => {\n      debounceTimerID = undefined;\n    }, debounceDuration);\n  };\n}\n\ntype AddEventListener = (\n  type: string,\n  listener: EventListenerOrEventListenerObject,\n  options?: boolean | AddEventListenerOptions,\n) => void;\ntype RemoveEventListener = (\n  type: string,\n  listener: EventListenerOrEventListenerObject,\n  options?: boolean | EventListenerOptions,\n) => void;\n\ntype InstrumentedElement = Element & {\n  __sentry_instrumentation_handlers__?: {\n    [key in 'click' | 'keypress']?: {\n      handler?: Function;\n      /** The number of custom listeners attached to this element */\n      refCount: number;\n    };\n  };\n};\n\n/** JSDoc */\nfunction instrumentDOM(): void {\n  if (!('document' in global)) {\n    return;\n  }\n\n  // Make it so that any click or keypress that is unhandled / bubbled up all the way to the document triggers our dom\n  // handlers. (Normally we have only one, which captures a breadcrumb for each click or keypress.) Do this before\n  // we instrument `addEventListener` so that we don't end up attaching this handler twice.\n  const triggerDOMHandler = triggerHandlers.bind(null, 'dom');\n  const globalDOMEventHandler = makeDOMEventHandler(triggerDOMHandler, true);\n  global.document.addEventListener('click', globalDOMEventHandler, false);\n  global.document.addEventListener('keypress', globalDOMEventHandler, false);\n\n  // After hooking into click and keypress events bubbled up to `document`, we also hook into user-handled\n  // clicks & keypresses, by adding an event listener of our own to any element to which they add a listener. That\n  // way, whenever one of their handlers is triggered, ours will be, too. (This is needed because their handler\n  // could potentially prevent the event from bubbling up to our global listeners. This way, our handler are still\n  // guaranteed to fire at least once.)\n  ['EventTarget', 'Node'].forEach((target: string) => {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    const proto = (global as any)[target] && (global as any)[target].prototype;\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, no-prototype-builtins\n    if (!proto || !proto.hasOwnProperty || !proto.hasOwnProperty('addEventListener')) {\n      return;\n    }\n\n    fill(proto, 'addEventListener', function(originalAddEventListener: AddEventListener): AddEventListener {\n      return function(\n        this: Element,\n        type: string,\n        listener: EventListenerOrEventListenerObject,\n        options?: boolean | AddEventListenerOptions,\n      ): AddEventListener {\n        if (type === 'click' || type == 'keypress') {\n          try {\n            const el = this as InstrumentedElement;\n            const handlers = (el.__sentry_instrumentation_handlers__ = el.__sentry_instrumentation_handlers__ || {});\n            const handlerForType = (handlers[type] = handlers[type] || { refCount: 0 });\n\n            if (!handlerForType.handler) {\n              const handler = makeDOMEventHandler(triggerDOMHandler);\n              handlerForType.handler = handler;\n              originalAddEventListener.call(this, type, handler, options);\n            }\n\n            handlerForType.refCount += 1;\n          } catch (e) {\n            // Accessing dom properties is always fragile.\n            // Also allows us to skip `addEventListenrs` calls with no proper `this` context.\n          }\n        }\n\n        return originalAddEventListener.call(this, type, listener, options);\n      };\n    });\n\n    fill(proto, 'removeEventListener', function(originalRemoveEventListener: RemoveEventListener): RemoveEventListener {\n      return function(\n        this: Element,\n        type: string,\n        listener: EventListenerOrEventListenerObject,\n        options?: boolean | EventListenerOptions,\n      ): () => void {\n        if (type === 'click' || type == 'keypress') {\n          try {\n            const el = this as InstrumentedElement;\n            const handlers = el.__sentry_instrumentation_handlers__ || {};\n            const handlerForType = handlers[type];\n\n            if (handlerForType) {\n              handlerForType.refCount -= 1;\n              // If there are no longer any custom handlers of the current type on this element, we can remove ours, too.\n              if (handlerForType.refCount <= 0) {\n                originalRemoveEventListener.call(this, type, handlerForType.handler, options);\n                handlerForType.handler = undefined;\n                delete handlers[type]; // eslint-disable-line @typescript-eslint/no-dynamic-delete\n              }\n\n              // If there are no longer any custom handlers of any type on this element, cleanup everything.\n              if (Object.keys(handlers).length === 0) {\n                delete el.__sentry_instrumentation_handlers__;\n              }\n            }\n          } catch (e) {\n            // Accessing dom properties is always fragile.\n            // Also allows us to skip `addEventListenrs` calls with no proper `this` context.\n          }\n        }\n\n        return originalRemoveEventListener.call(this, type, listener, options);\n      };\n    });\n  });\n}\n\nlet _oldOnErrorHandler: OnErrorEventHandler = null;\n/** JSDoc */\nfunction instrumentError(): void {\n  _oldOnErrorHandler = global.onerror;\n\n  global.onerror = function(msg: any, url: any, line: any, column: any, error: any): boolean {\n    triggerHandlers('error', {\n      column,\n      error,\n      line,\n      msg,\n      url,\n    });\n\n    if (_oldOnErrorHandler) {\n      // eslint-disable-next-line prefer-rest-params\n      return _oldOnErrorHandler.apply(this, arguments);\n    }\n\n    return false;\n  };\n}\n\nlet _oldOnUnhandledRejectionHandler: ((e: any) => void) | null = null;\n/** JSDoc */\nfunction instrumentUnhandledRejection(): void {\n  _oldOnUnhandledRejectionHandler = global.onunhandledrejection;\n\n  global.onunhandledrejection = function(e: any): boolean {\n    triggerHandlers('unhandledrejection', e);\n\n    if (_oldOnUnhandledRejectionHandler) {\n      // eslint-disable-next-line prefer-rest-params\n      return _oldOnUnhandledRejectionHandler.apply(this, arguments);\n    }\n\n    return true;\n  };\n}\n", "// Slightly modified (no IE8 support, ES6) and transcribed to TypeScript\n// https://raw.githubusercontent.com/calvinmetcalf/rollup-plugin-node-builtins/master/src/es6/path.js\n\n/** JSDoc */\nfunction normalizeArray(parts: string[], allowAboveRoot?: boolean): string[] {\n  // if the path tries to go above the root, `up` ends up > 0\n  let up = 0;\n  for (let i = parts.length - 1; i >= 0; i--) {\n    const last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      // eslint-disable-next-line no-plusplus\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      // eslint-disable-next-line no-plusplus\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    // eslint-disable-next-line no-plusplus\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// Split a filename into [root, dir, basename, ext], unix version\n// 'root' is just a slash, or nothing.\nconst splitPathRe = /^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^/]+?|)(\\.[^./]*|))(?:[/]*)$/;\n/** JSDoc */\nfunction splitPath(filename: string): string[] {\n  const parts = splitPathRe.exec(filename);\n  return parts ? parts.slice(1) : [];\n}\n\n// path.resolve([from ...], to)\n// posix version\n/** JSDoc */\nexport function resolve(...args: string[]): string {\n  let resolvedPath = '';\n  let resolvedAbsolute = false;\n\n  for (let i = args.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    const path = i >= 0 ? args[i] : '/';\n\n    // Skip empty entries\n    if (!path) {\n      continue;\n    }\n\n    resolvedPath = `${path}/${resolvedPath}`;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(\n    resolvedPath.split('/').filter(p => !!p),\n    !resolvedAbsolute,\n  ).join('/');\n\n  return (resolvedAbsolute ? '/' : '') + resolvedPath || '.';\n}\n\n/** JSDoc */\nfunction trim(arr: string[]): string[] {\n  let start = 0;\n  for (; start < arr.length; start++) {\n    if (arr[start] !== '') {\n      break;\n    }\n  }\n\n  let end = arr.length - 1;\n  for (; end >= 0; end--) {\n    if (arr[end] !== '') {\n      break;\n    }\n  }\n\n  if (start > end) {\n    return [];\n  }\n  return arr.slice(start, end - start + 1);\n}\n\n// path.relative(from, to)\n// posix version\n/** JSDoc */\nexport function relative(from: string, to: string): string {\n  /* eslint-disable no-param-reassign */\n  from = resolve(from).substr(1);\n  to = resolve(to).substr(1);\n  /* eslint-enable no-param-reassign */\n\n  const fromParts = trim(from.split('/'));\n  const toParts = trim(to.split('/'));\n\n  const length = Math.min(fromParts.length, toParts.length);\n  let samePartsLength = length;\n  for (let i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  let outputParts = [];\n  for (let i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n}\n\n// path.normalize(path)\n// posix version\n/** JSDoc */\nexport function normalizePath(path: string): string {\n  const isPathAbsolute = isAbsolute(path);\n  const trailingSlash = path.substr(-1) === '/';\n\n  // Normalize the path\n  let normalizedPath = normalizeArray(\n    path.split('/').filter(p => !!p),\n    !isPathAbsolute,\n  ).join('/');\n\n  if (!normalizedPath && !isPathAbsolute) {\n    normalizedPath = '.';\n  }\n  if (normalizedPath && trailingSlash) {\n    normalizedPath += '/';\n  }\n\n  return (isPathAbsolute ? '/' : '') + normalizedPath;\n}\n\n// posix version\n/** JSDoc */\nexport function isAbsolute(path: string): boolean {\n  return path.charAt(0) === '/';\n}\n\n// posix version\n/** JSDoc */\nexport function join(...args: string[]): string {\n  return normalizePath(args.join('/'));\n}\n\n/** JSDoc */\nexport function dirname(path: string): string {\n  const result = splitPath(path);\n  const root = result[0];\n  let dir = result[1];\n\n  if (!root && !dir) {\n    // No dirname whatsoever\n    return '.';\n  }\n\n  if (dir) {\n    // It has a dirname, strip trailing slash\n    dir = dir.substr(0, dir.length - 1);\n  }\n\n  return root + dir;\n}\n\n/** JSDoc */\nexport function basename(path: string, ext?: string): string {\n  let f = splitPath(path)[2];\n  if (ext && f.substr(ext.length * -1) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n}\n", "/* eslint-disable @typescript-eslint/explicit-function-return-type */\n/* eslint-disable @typescript-eslint/typedef */\n/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { isThenable } from './is';\n\n/** SyncPromise internal states */\nenum States {\n  /** Pending */\n  PENDING = 'PENDING',\n  /** Resolved / OK */\n  RESOLVED = 'RESOLVED',\n  /** Rejected / Error */\n  REJECTED = 'REJECTED',\n}\n\n/**\n * Thenable class that behaves like a Promise and follows it's interface\n * but is not async internally\n */\nclass SyncPromise<T> implements PromiseLike<T> {\n  private _state: States = States.PENDING;\n  private _handlers: Array<{\n    done: boolean;\n    onfulfilled?: ((value: T) => T | PromiseLike<T>) | null;\n    onrejected?: ((reason: any) => any) | null;\n  }> = [];\n  private _value: any;\n\n  public constructor(\n    executor: (resolve: (value?: T | PromiseLike<T> | null) => void, reject: (reason?: any) => void) => void,\n  ) {\n    try {\n      executor(this._resolve, this._reject);\n    } catch (e) {\n      this._reject(e);\n    }\n  }\n\n  /** JSDoc */\n  public static resolve<T>(value: T | PromiseLike<T>): PromiseLike<T> {\n    return new SyncPromise(resolve => {\n      resolve(value);\n    });\n  }\n\n  /** JSDoc */\n  public static reject<T = never>(reason?: any): PromiseLike<T> {\n    return new SyncPromise((_, reject) => {\n      reject(reason);\n    });\n  }\n\n  /** JSDoc */\n  public static all<U = any>(collection: Array<U | PromiseLike<U>>): PromiseLike<U[]> {\n    return new SyncPromise<U[]>((resolve, reject) => {\n      if (!Array.isArray(collection)) {\n        reject(new TypeError(`Promise.all requires an array as input.`));\n        return;\n      }\n\n      if (collection.length === 0) {\n        resolve([]);\n        return;\n      }\n\n      let counter = collection.length;\n      const resolvedCollection: U[] = [];\n\n      collection.forEach((item, index) => {\n        void SyncPromise.resolve(item)\n          .then(value => {\n            resolvedCollection[index] = value;\n            counter -= 1;\n\n            if (counter !== 0) {\n              return;\n            }\n            resolve(resolvedCollection);\n          })\n          .then(null, reject);\n      });\n    });\n  }\n\n  /** JSDoc */\n  public then<TResult1 = T, TResult2 = never>(\n    onfulfilled?: ((value: T) => TResult1 | PromiseLike<TResult1>) | null,\n    onrejected?: ((reason: any) => TResult2 | PromiseLike<TResult2>) | null,\n  ): PromiseLike<TResult1 | TResult2> {\n    return new SyncPromise((resolve, reject) => {\n      this._attachHandler({\n        done: false,\n        onfulfilled: result => {\n          if (!onfulfilled) {\n            // TODO: \u00AF\\_(\u30C4)_/\u00AF\n            // TODO: FIXME\n            resolve(result as any);\n            return;\n          }\n          try {\n            resolve(onfulfilled(result));\n            return;\n          } catch (e) {\n            reject(e);\n            return;\n          }\n        },\n        onrejected: reason => {\n          if (!onrejected) {\n            reject(reason);\n            return;\n          }\n          try {\n            resolve(onrejected(reason));\n            return;\n          } catch (e) {\n            reject(e);\n            return;\n          }\n        },\n      });\n    });\n  }\n\n  /** JSDoc */\n  public catch<TResult = never>(\n    onrejected?: ((reason: any) => TResult | PromiseLike<TResult>) | null,\n  ): PromiseLike<T | TResult> {\n    return this.then(val => val, onrejected);\n  }\n\n  /** JSDoc */\n  public finally<TResult>(onfinally?: (() => void) | null): PromiseLike<TResult> {\n    return new SyncPromise<TResult>((resolve, reject) => {\n      let val: TResult | any;\n      let isRejected: boolean;\n\n      return this.then(\n        value => {\n          isRejected = false;\n          val = value;\n          if (onfinally) {\n            onfinally();\n          }\n        },\n        reason => {\n          isRejected = true;\n          val = reason;\n          if (onfinally) {\n            onfinally();\n          }\n        },\n      ).then(() => {\n        if (isRejected) {\n          reject(val);\n          return;\n        }\n\n        resolve((val as unknown) as any);\n      });\n    });\n  }\n\n  /** JSDoc */\n  public toString(): string {\n    return '[object SyncPromise]';\n  }\n\n  /** JSDoc */\n  private readonly _resolve = (value?: T | PromiseLike<T> | null) => {\n    this._setResult(States.RESOLVED, value);\n  };\n\n  /** JSDoc */\n  private readonly _reject = (reason?: any) => {\n    this._setResult(States.REJECTED, reason);\n  };\n\n  /** JSDoc */\n  private readonly _setResult = (state: States, value?: T | PromiseLike<T> | any) => {\n    if (this._state !== States.PENDING) {\n      return;\n    }\n\n    if (isThenable(value)) {\n      void (value as PromiseLike<T>).then(this._resolve, this._reject);\n      return;\n    }\n\n    this._state = state;\n    this._value = value;\n\n    this._executeHandlers();\n  };\n\n  // TODO: FIXME\n  /** JSDoc */\n  private readonly _attachHandler = (handler: {\n    /** JSDoc */\n    done: boolean;\n    /** JSDoc */\n    onfulfilled?(value: T): any;\n    /** JSDoc */\n    onrejected?(reason: any): any;\n  }) => {\n    this._handlers = this._handlers.concat(handler);\n    this._executeHandlers();\n  };\n\n  /** JSDoc */\n  private readonly _executeHandlers = () => {\n    if (this._state === States.PENDING) {\n      return;\n    }\n\n    const cachedHandlers = this._handlers.slice();\n    this._handlers = [];\n\n    cachedHandlers.forEach(handler => {\n      if (handler.done) {\n        return;\n      }\n\n      if (this._state === States.RESOLVED) {\n        if (handler.onfulfilled) {\n          // eslint-disable-next-line @typescript-eslint/no-floating-promises\n          handler.onfulfilled((this._value as unknown) as any);\n        }\n      }\n\n      if (this._state === States.REJECTED) {\n        if (handler.onrejected) {\n          handler.onrejected(this._value);\n        }\n      }\n\n      handler.done = true;\n    });\n  };\n}\n\nexport { SyncPromise };\n", "import { SentryError } from './error';\nimport { SyncPromise } from './syncpromise';\n\n/** A simple queue that holds promises. */\nexport class PromiseBuffer<T> {\n  /** Internal set of queued Promises */\n  private readonly _buffer: Array<PromiseLike<T>> = [];\n\n  public constructor(protected _limit?: number) {}\n\n  /**\n   * Says if the buffer is ready to take more requests\n   */\n  public isReady(): boolean {\n    return this._limit === undefined || this.length() < this._limit;\n  }\n\n  /**\n   * Add a promise to the queue.\n   *\n   * @param taskProducer A function producing any PromiseLike<T>; In previous versions this used to be `task: PromiseLike<T>`,\n   *        however, Promises were instantly created on the call-site, making them fall through the buffer limit.\n   * @returns The original promise.\n   */\n  public add(taskProducer: () => PromiseLike<T>): PromiseLike<T> {\n    if (!this.isReady()) {\n      return SyncPromise.reject(new SentryError('Not adding Promise due to buffer limit reached.'));\n    }\n    const task = taskProducer();\n    if (this._buffer.indexOf(task) === -1) {\n      this._buffer.push(task);\n    }\n    void task\n      .then(() => this.remove(task))\n      .then(null, () =>\n        this.remove(task).then(null, () => {\n          // We have to add this catch here otherwise we have an unhandledPromiseRejection\n          // because it's a new Promise chain.\n        }),\n      );\n    return task;\n  }\n\n  /**\n   * Remove a promise to the queue.\n   *\n   * @param task Can be any PromiseLike<T>\n   * @returns Removed promise.\n   */\n  public remove(task: PromiseLike<T>): PromiseLike<T> {\n    const removedTask = this._buffer.splice(this._buffer.indexOf(task), 1)[0];\n    return removedTask;\n  }\n\n  /**\n   * This function returns the number of unresolved promises in the queue.\n   */\n  public length(): number {\n    return this._buffer.length;\n  }\n\n  /**\n   * This will drain the whole queue, returns true if queue is empty or drained.\n   * If timeout is provided and the queue takes longer to drain, the promise still resolves but with false.\n   *\n   * @param timeout Number in ms to wait until it resolves with false.\n   */\n  public drain(timeout?: number): PromiseLike<boolean> {\n    return new SyncPromise<boolean>(resolve => {\n      const capturedSetTimeout = setTimeout(() => {\n        if (timeout && timeout > 0) {\n          resolve(false);\n        }\n      }, timeout);\n      void SyncPromise.all(this._buffer)\n        .then(() => {\n          clearTimeout(capturedSetTimeout);\n          resolve(true);\n        })\n        .then(null, () => {\n          resolve(true);\n        });\n    });\n  }\n}\n", "import { getGlobalObject } from './misc';\nimport { dynamicRequire, isNodeEnv } from './node';\n\n/**\n * An object that can return the current timestamp in seconds since the UNIX epoch.\n */\ninterface TimestampSource {\n  nowSeconds(): number;\n}\n\n/**\n * A TimestampSource implementation for environments that do not support the Performance Web API natively.\n *\n * Note that this TimestampSource does not use a monotonic clock. A call to `nowSeconds` may return a timestamp earlier\n * than a previously returned value. We do not try to emulate a monotonic behavior in order to facilitate debugging. It\n * is more obvious to explain \"why does my span have negative duration\" than \"why my spans have zero duration\".\n */\nconst dateTimestampSource: TimestampSource = {\n  nowSeconds: () => Date.now() / 1000,\n};\n\n/**\n * A partial definition of the [Performance Web API]{@link https://developer.mozilla.org/en-US/docs/Web/API/Performance}\n * for accessing a high resolution monotonic clock.\n */\ninterface Performance {\n  /**\n   * The millisecond timestamp at which measurement began, measured in Unix time.\n   */\n  timeOrigin: number;\n  /**\n   * Returns the current millisecond timestamp, where 0 represents the start of measurement.\n   */\n  now(): number;\n}\n\n/**\n * Returns a wrapper around the native Performance API browser implementation, or undefined for browsers that do not\n * support the API.\n *\n * Wrapping the native API works around differences in behavior from different browsers.\n */\nfunction getBrowserPerformance(): Performance | undefined {\n  const { performance } = getGlobalObject<Window>();\n  if (!performance || !performance.now) {\n    return undefined;\n  }\n\n  // Replace performance.timeOrigin with our own timeOrigin based on Date.now().\n  //\n  // This is a partial workaround for browsers reporting performance.timeOrigin such that performance.timeOrigin +\n  // performance.now() gives a date arbitrarily in the past.\n  //\n  // Additionally, computing timeOrigin in this way fills the gap for browsers where performance.timeOrigin is\n  // undefined.\n  //\n  // The assumption that performance.timeOrigin + performance.now() ~= Date.now() is flawed, but we depend on it to\n  // interact with data coming out of performance entries.\n  //\n  // Note that despite recommendations against it in the spec, browsers implement the Performance API with a clock that\n  // might stop when the computer is asleep (and perhaps under other circumstances). Such behavior causes\n  // performance.timeOrigin + performance.now() to have an arbitrary skew over Date.now(). In laptop computers, we have\n  // observed skews that can be as long as days, weeks or months.\n  //\n  // See https://github.com/getsentry/sentry-javascript/issues/2590.\n  //\n  // BUG: despite our best intentions, this workaround has its limitations. It mostly addresses timings of pageload\n  // transactions, but ignores the skew built up over time that can aversely affect timestamps of navigation\n  // transactions of long-lived web pages.\n  const timeOrigin = Date.now() - performance.now();\n\n  return {\n    now: () => performance.now(),\n    timeOrigin,\n  };\n}\n\n/**\n * Returns the native Performance API implementation from Node.js. Returns undefined in old Node.js versions that don't\n * implement the API.\n */\nfunction getNodePerformance(): Performance | undefined {\n  try {\n    const perfHooks = dynamicRequire(module, 'perf_hooks') as { performance: Performance };\n    return perfHooks.performance;\n  } catch (_) {\n    return undefined;\n  }\n}\n\n/**\n * The Performance API implementation for the current platform, if available.\n */\nconst platformPerformance: Performance | undefined = isNodeEnv() ? getNodePerformance() : getBrowserPerformance();\n\nconst timestampSource: TimestampSource =\n  platformPerformance === undefined\n    ? dateTimestampSource\n    : {\n        nowSeconds: () => (platformPerformance.timeOrigin + platformPerformance.now()) / 1000,\n      };\n\n/**\n * Returns a timestamp in seconds since the UNIX epoch using the Date API.\n */\nexport const dateTimestampInSeconds: () => number = dateTimestampSource.nowSeconds.bind(dateTimestampSource);\n\n/**\n * Returns a timestamp in seconds since the UNIX epoch using either the Performance or Date APIs, depending on the\n * availability of the Performance API.\n *\n * See `usingPerformanceAPI` to test whether the Performance API is used.\n *\n * BUG: Note that because of how browsers implement the Performance API, the clock might stop when the computer is\n * asleep. This creates a skew between `dateTimestampInSeconds` and `timestampInSeconds`. The\n * skew can grow to arbitrary amounts like days, weeks or months.\n * See https://github.com/getsentry/sentry-javascript/issues/2590.\n */\nexport const timestampInSeconds: () => number = timestampSource.nowSeconds.bind(timestampSource);\n\n// Re-exported with an old name for backwards-compatibility.\nexport const timestampWithMs = timestampInSeconds;\n\n/**\n * A boolean that is true when timestampInSeconds uses the Performance API to produce monotonic timestamps.\n */\nexport const usingPerformanceAPI = platformPerformance !== undefined;\n\n/**\n * Internal helper to store what is the source of browserPerformanceTimeOrigin below. For debugging only.\n */\nexport let _browserPerformanceTimeOriginMode: string;\n\n/**\n * The number of milliseconds since the UNIX epoch. This value is only usable in a browser, and only when the\n * performance API is available.\n */\nexport const browserPerformanceTimeOrigin = ((): number | undefined => {\n  // Unfortunately browsers may report an inaccurate time origin data, through either performance.timeOrigin or\n  // performance.timing.navigationStart, which results in poor results in performance data. We only treat time origin\n  // data as reliable if they are within a reasonable threshold of the current time.\n\n  const { performance } = getGlobalObject<Window>();\n  if (!performance || !performance.now) {\n    _browserPerformanceTimeOriginMode = 'none';\n    return undefined;\n  }\n\n  const threshold = 3600 * 1000;\n  const performanceNow = performance.now();\n  const dateNow = Date.now();\n\n  // if timeOrigin isn't available set delta to threshold so it isn't used\n  const timeOriginDelta = performance.timeOrigin\n    ? Math.abs(performance.timeOrigin + performanceNow - dateNow)\n    : threshold;\n  const timeOriginIsReliable = timeOriginDelta < threshold;\n\n  // While performance.timing.navigationStart is deprecated in favor of performance.timeOrigin, performance.timeOrigin\n  // is not as widely supported. Namely, performance.timeOrigin is undefined in Safari as of writing.\n  // Also as of writing, performance.timing is not available in Web Workers in mainstream browsers, so it is not always\n  // a valid fallback. In the absence of an initial time provided by the browser, fallback to the current time from the\n  // Date API.\n  // eslint-disable-next-line deprecation/deprecation\n  const navigationStart = performance.timing && performance.timing.navigationStart;\n  const hasNavigationStart = typeof navigationStart === 'number';\n  // if navigationStart isn't available set delta to threshold so it isn't used\n  const navigationStartDelta = hasNavigationStart ? Math.abs(navigationStart + performanceNow - dateNow) : threshold;\n  const navigationStartIsReliable = navigationStartDelta < threshold;\n\n  if (timeOriginIsReliable || navigationStartIsReliable) {\n    // Use the more reliable time origin\n    if (timeOriginDelta <= navigationStartDelta) {\n      _browserPerformanceTimeOriginMode = 'timeOrigin';\n      return performance.timeOrigin;\n    } else {\n      _browserPerformanceTimeOriginMode = 'navigationStart';\n      return navigationStart;\n    }\n  }\n\n  // Either both timeOrigin and navigationStart are skewed or neither is available, fallback to Date.\n  _browserPerformanceTimeOriginMode = 'dateNow';\n  return dateNow;\n})();\n", "export * from './async';\nexport * from './browser';\nexport * from './dsn';\nexport * from './error';\nexport * from './instrument';\nexport * from './is';\nexport * from './logger';\nexport * from './memo';\nexport * from './misc';\nexport * from './node';\nexport * from './object';\nexport * from './path';\nexport * from './promisebuffer';\nexport * from './stacktrace';\nexport * from './string';\nexport * from './supports';\nexport * from './syncpromise';\nexport * from './time';\n", "/* eslint-disable max-lines */\nimport {\n  Breadcrumb,\n  CaptureContext,\n  Context,\n  Contexts,\n  Event,\n  EventHint,\n  EventProcessor,\n  Extra,\n  Extras,\n  Primitive,\n  RequestSession,\n  Scope as ScopeInterface,\n  ScopeContext,\n  Severity,\n  Span,\n  Transaction,\n  User,\n} from '@sentry/types';\nimport { dateTimestampInSeconds, getGlobalObject, isPlainObject, isThenable, SyncPromise } from '@sentry/utils';\n\nimport { Session } from './session';\n\n/**\n * Absolute maximum number of breadcrumbs added to an event.\n * The `maxBreadcrumbs` option cannot be higher than this value.\n */\nconst MAX_BREADCRUMBS = 100;\n\n/**\n * Holds additional event information. {@link Scope.applyToEvent} will be\n * called by the client before an event will be sent.\n */\nexport class Scope implements ScopeInterface {\n  /** Flag if notifiying is happening. */\n  protected _notifyingListeners: boolean = false;\n\n  /** Callback for client to receive scope changes. */\n  protected _scopeListeners: Array<(scope: Scope) => void> = [];\n\n  /** Callback list that will be called after {@link applyToEvent}. */\n  protected _eventProcessors: EventProcessor[] = [];\n\n  /** Array of breadcrumbs. */\n  protected _breadcrumbs: Breadcrumb[] = [];\n\n  /** User */\n  protected _user: User = {};\n\n  /** Tags */\n  protected _tags: { [key: string]: Primitive } = {};\n\n  /** Extra */\n  protected _extra: Extras = {};\n\n  /** Contexts */\n  protected _contexts: Contexts = {};\n\n  /** Fingerprint */\n  protected _fingerprint?: string[];\n\n  /** Severity */\n  protected _level?: Severity;\n\n  /** Transaction Name */\n  protected _transactionName?: string;\n\n  /** Span */\n  protected _span?: Span;\n\n  /** Session */\n  protected _session?: Session;\n\n  /** Request Mode Session Status */\n  protected _requestSession?: RequestSession;\n\n  /**\n   * Inherit values from the parent scope.\n   * @param scope to clone.\n   */\n  public static clone(scope?: Scope): Scope {\n    const newScope = new Scope();\n    if (scope) {\n      newScope._breadcrumbs = [...scope._breadcrumbs];\n      newScope._tags = { ...scope._tags };\n      newScope._extra = { ...scope._extra };\n      newScope._contexts = { ...scope._contexts };\n      newScope._user = scope._user;\n      newScope._level = scope._level;\n      newScope._span = scope._span;\n      newScope._session = scope._session;\n      newScope._transactionName = scope._transactionName;\n      newScope._fingerprint = scope._fingerprint;\n      newScope._eventProcessors = [...scope._eventProcessors];\n      newScope._requestSession = scope._requestSession;\n    }\n    return newScope;\n  }\n\n  /**\n   * Add internal on change listener. Used for sub SDKs that need to store the scope.\n   * @hidden\n   */\n  public addScopeListener(callback: (scope: Scope) => void): void {\n    this._scopeListeners.push(callback);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public addEventProcessor(callback: EventProcessor): this {\n    this._eventProcessors.push(callback);\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setUser(user: User | null): this {\n    this._user = user || {};\n    if (this._session) {\n      this._session.update({ user });\n    }\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getUser(): User | undefined {\n    return this._user;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getRequestSession(): RequestSession | undefined {\n    return this._requestSession;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setRequestSession(requestSession?: RequestSession): this {\n    this._requestSession = requestSession;\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setTags(tags: { [key: string]: Primitive }): this {\n    this._tags = {\n      ...this._tags,\n      ...tags,\n    };\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setTag(key: string, value: Primitive): this {\n    this._tags = { ...this._tags, [key]: value };\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setExtras(extras: Extras): this {\n    this._extra = {\n      ...this._extra,\n      ...extras,\n    };\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setExtra(key: string, extra: Extra): this {\n    this._extra = { ...this._extra, [key]: extra };\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setFingerprint(fingerprint: string[]): this {\n    this._fingerprint = fingerprint;\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setLevel(level: Severity): this {\n    this._level = level;\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setTransactionName(name?: string): this {\n    this._transactionName = name;\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * Can be removed in major version.\n   * @deprecated in favor of {@link this.setTransactionName}\n   */\n  public setTransaction(name?: string): this {\n    return this.setTransactionName(name);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setContext(key: string, context: Context | null): this {\n    if (context === null) {\n      // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n      delete this._contexts[key];\n    } else {\n      this._contexts = { ...this._contexts, [key]: context };\n    }\n\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setSpan(span?: Span): this {\n    this._span = span;\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getSpan(): Span | undefined {\n    return this._span;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getTransaction(): Transaction | undefined {\n    // often, this span will be a transaction, but it's not guaranteed to be\n    const span = this.getSpan() as undefined | (Span & { spanRecorder: { spans: Span[] } });\n\n    // try it the new way first\n    if (span?.transaction) {\n      return span?.transaction;\n    }\n\n    // fallback to the old way (known bug: this only finds transactions with sampled = true)\n    if (span?.spanRecorder?.spans[0]) {\n      return span.spanRecorder.spans[0] as Transaction;\n    }\n\n    // neither way found a transaction\n    return undefined;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setSession(session?: Session): this {\n    if (!session) {\n      delete this._session;\n    } else {\n      this._session = session;\n    }\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getSession(): Session | undefined {\n    return this._session;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public update(captureContext?: CaptureContext): this {\n    if (!captureContext) {\n      return this;\n    }\n\n    if (typeof captureContext === 'function') {\n      const updatedScope = (captureContext as <T>(scope: T) => T)(this);\n      return updatedScope instanceof Scope ? updatedScope : this;\n    }\n\n    if (captureContext instanceof Scope) {\n      this._tags = { ...this._tags, ...captureContext._tags };\n      this._extra = { ...this._extra, ...captureContext._extra };\n      this._contexts = { ...this._contexts, ...captureContext._contexts };\n      if (captureContext._user && Object.keys(captureContext._user).length) {\n        this._user = captureContext._user;\n      }\n      if (captureContext._level) {\n        this._level = captureContext._level;\n      }\n      if (captureContext._fingerprint) {\n        this._fingerprint = captureContext._fingerprint;\n      }\n      if (captureContext._requestSession) {\n        this._requestSession = captureContext._requestSession;\n      }\n    } else if (isPlainObject(captureContext)) {\n      // eslint-disable-next-line no-param-reassign\n      captureContext = captureContext as ScopeContext;\n      this._tags = { ...this._tags, ...captureContext.tags };\n      this._extra = { ...this._extra, ...captureContext.extra };\n      this._contexts = { ...this._contexts, ...captureContext.contexts };\n      if (captureContext.user) {\n        this._user = captureContext.user;\n      }\n      if (captureContext.level) {\n        this._level = captureContext.level;\n      }\n      if (captureContext.fingerprint) {\n        this._fingerprint = captureContext.fingerprint;\n      }\n      if (captureContext.requestSession) {\n        this._requestSession = captureContext.requestSession;\n      }\n    }\n\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public clear(): this {\n    this._breadcrumbs = [];\n    this._tags = {};\n    this._extra = {};\n    this._user = {};\n    this._contexts = {};\n    this._level = undefined;\n    this._transactionName = undefined;\n    this._fingerprint = undefined;\n    this._requestSession = undefined;\n    this._span = undefined;\n    this._session = undefined;\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public addBreadcrumb(breadcrumb: Breadcrumb, maxBreadcrumbs?: number): this {\n    const maxCrumbs = typeof maxBreadcrumbs === 'number' ? Math.min(maxBreadcrumbs, MAX_BREADCRUMBS) : MAX_BREADCRUMBS;\n\n    // No data has been changed, so don't notify scope listeners\n    if (maxCrumbs <= 0) {\n      return this;\n    }\n\n    const mergedBreadcrumb = {\n      timestamp: dateTimestampInSeconds(),\n      ...breadcrumb,\n    };\n    this._breadcrumbs = [...this._breadcrumbs, mergedBreadcrumb].slice(-maxCrumbs);\n    this._notifyScopeListeners();\n\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public clearBreadcrumbs(): this {\n    this._breadcrumbs = [];\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * Applies the current context and fingerprint to the event.\n   * Note that breadcrumbs will be added by the client.\n   * Also if the event has already breadcrumbs on it, we do not merge them.\n   * @param event Event\n   * @param hint May contain additional informartion about the original exception.\n   * @hidden\n   */\n  public applyToEvent(event: Event, hint?: EventHint): PromiseLike<Event | null> {\n    if (this._extra && Object.keys(this._extra).length) {\n      event.extra = { ...this._extra, ...event.extra };\n    }\n    if (this._tags && Object.keys(this._tags).length) {\n      event.tags = { ...this._tags, ...event.tags };\n    }\n    if (this._user && Object.keys(this._user).length) {\n      event.user = { ...this._user, ...event.user };\n    }\n    if (this._contexts && Object.keys(this._contexts).length) {\n      event.contexts = { ...this._contexts, ...event.contexts };\n    }\n    if (this._level) {\n      event.level = this._level;\n    }\n    if (this._transactionName) {\n      event.transaction = this._transactionName;\n    }\n    // We want to set the trace context for normal events only if there isn't already\n    // a trace context on the event. There is a product feature in place where we link\n    // errors with transaction and it relys on that.\n    if (this._span) {\n      event.contexts = { trace: this._span.getTraceContext(), ...event.contexts };\n      const transactionName = this._span.transaction?.name;\n      if (transactionName) {\n        event.tags = { transaction: transactionName, ...event.tags };\n      }\n    }\n\n    this._applyFingerprint(event);\n\n    event.breadcrumbs = [...(event.breadcrumbs || []), ...this._breadcrumbs];\n    event.breadcrumbs = event.breadcrumbs.length > 0 ? event.breadcrumbs : undefined;\n\n    return this._notifyEventProcessors([...getGlobalEventProcessors(), ...this._eventProcessors], event, hint);\n  }\n\n  /**\n   * This will be called after {@link applyToEvent} is finished.\n   */\n  protected _notifyEventProcessors(\n    processors: EventProcessor[],\n    event: Event | null,\n    hint?: EventHint,\n    index: number = 0,\n  ): PromiseLike<Event | null> {\n    return new SyncPromise<Event | null>((resolve, reject) => {\n      const processor = processors[index];\n      if (event === null || typeof processor !== 'function') {\n        resolve(event);\n      } else {\n        const result = processor({ ...event }, hint) as Event | null;\n        if (isThenable(result)) {\n          void (result as PromiseLike<Event | null>)\n            .then(final => this._notifyEventProcessors(processors, final, hint, index + 1).then(resolve))\n            .then(null, reject);\n        } else {\n          void this._notifyEventProcessors(processors, result, hint, index + 1)\n            .then(resolve)\n            .then(null, reject);\n        }\n      }\n    });\n  }\n\n  /**\n   * This will be called on every set call.\n   */\n  protected _notifyScopeListeners(): void {\n    // We need this check for this._notifyingListeners to be able to work on scope during updates\n    // If this check is not here we'll produce endless recursion when something is done with the scope\n    // during the callback.\n    if (!this._notifyingListeners) {\n      this._notifyingListeners = true;\n      this._scopeListeners.forEach(callback => {\n        callback(this);\n      });\n      this._notifyingListeners = false;\n    }\n  }\n\n  /**\n   * Applies fingerprint from the scope to the event if there's one,\n   * uses message if there's one instead or get rid of empty fingerprint\n   */\n  private _applyFingerprint(event: Event): void {\n    // Make sure it's an array first and we actually have something in place\n    event.fingerprint = event.fingerprint\n      ? Array.isArray(event.fingerprint)\n        ? event.fingerprint\n        : [event.fingerprint]\n      : [];\n\n    // If we have something on the scope, then merge it with event\n    if (this._fingerprint) {\n      event.fingerprint = event.fingerprint.concat(this._fingerprint);\n    }\n\n    // If we have no data at all, remove empty array default\n    if (event.fingerprint && !event.fingerprint.length) {\n      delete event.fingerprint;\n    }\n  }\n}\n\n/**\n * Retruns the global event processors.\n */\nfunction getGlobalEventProcessors(): EventProcessor[] {\n  /* eslint-disable @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-member-access  */\n  const global = getGlobalObject<any>();\n  global.__SENTRY__ = global.__SENTRY__ || {};\n  global.__SENTRY__.globalEventProcessors = global.__SENTRY__.globalEventProcessors || [];\n  return global.__SENTRY__.globalEventProcessors;\n  /* eslint-enable @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-member-access */\n}\n\n/**\n * Add a EventProcessor to be kept globally.\n * @param callback EventProcessor to add\n */\nexport function addGlobalEventProcessor(callback: EventProcessor): void {\n  getGlobalEventProcessors().push(callback);\n}\n", "import { Session as SessionInterface, SessionContext, SessionStatus } from '@sentry/types';\nimport { dropUndefinedKeys, timestampInSeconds, uuid4 } from '@sentry/utils';\n\n/**\n * @inheritdoc\n */\nexport class Session implements SessionInterface {\n  public userAgent?: string;\n  public errors: number = 0;\n  public release?: string;\n  public sid: string = uuid4();\n  public did?: string;\n  public timestamp: number;\n  public started: number;\n  public duration?: number = 0;\n  public status: SessionStatus = SessionStatus.Ok;\n  public environment?: string;\n  public ipAddress?: string;\n  public init: boolean = true;\n  public ignoreDuration: boolean = false;\n\n  public constructor(context?: Omit<SessionContext, 'started' | 'status'>) {\n    // Both timestamp and started are in seconds since the UNIX epoch.\n    const startingTime = timestampInSeconds();\n    this.timestamp = startingTime;\n    this.started = startingTime;\n    if (context) {\n      this.update(context);\n    }\n  }\n\n  /** JSDoc */\n  // eslint-disable-next-line complexity\n  public update(context: SessionContext = {}): void {\n    if (context.user) {\n      if (!this.ipAddress && context.user.ip_address) {\n        this.ipAddress = context.user.ip_address;\n      }\n\n      if (!this.did && !context.did) {\n        this.did = context.user.id || context.user.email || context.user.username;\n      }\n    }\n\n    this.timestamp = context.timestamp || timestampInSeconds();\n    if (context.ignoreDuration) {\n      this.ignoreDuration = context.ignoreDuration;\n    }\n    if (context.sid) {\n      // Good enough uuid validation. \u2014 Kamil\n      this.sid = context.sid.length === 32 ? context.sid : uuid4();\n    }\n    if (context.init !== undefined) {\n      this.init = context.init;\n    }\n    if (!this.did && context.did) {\n      this.did = `${context.did}`;\n    }\n    if (typeof context.started === 'number') {\n      this.started = context.started;\n    }\n    if (this.ignoreDuration) {\n      this.duration = undefined;\n    } else if (typeof context.duration === 'number') {\n      this.duration = context.duration;\n    } else {\n      const duration = this.timestamp - this.started;\n      this.duration = duration >= 0 ? duration : 0;\n    }\n    if (context.release) {\n      this.release = context.release;\n    }\n    if (context.environment) {\n      this.environment = context.environment;\n    }\n    if (!this.ipAddress && context.ipAddress) {\n      this.ipAddress = context.ipAddress;\n    }\n    if (!this.userAgent && context.userAgent) {\n      this.userAgent = context.userAgent;\n    }\n    if (typeof context.errors === 'number') {\n      this.errors = context.errors;\n    }\n    if (context.status) {\n      this.status = context.status;\n    }\n  }\n\n  /** JSDoc */\n  public close(status?: Exclude<SessionStatus, SessionStatus.Ok>): void {\n    if (status) {\n      this.update({ status });\n    } else if (this.status === SessionStatus.Ok) {\n      this.update({ status: SessionStatus.Exited });\n    } else {\n      this.update();\n    }\n  }\n\n  /** JSDoc */\n  public toJSON(): {\n    init: boolean;\n    sid: string;\n    did?: string;\n    timestamp: string;\n    started: string;\n    duration?: number;\n    status: SessionStatus;\n    errors: number;\n    attrs?: {\n      release?: string;\n      environment?: string;\n      user_agent?: string;\n      ip_address?: string;\n    };\n  } {\n    return dropUndefinedKeys({\n      sid: `${this.sid}`,\n      init: this.init,\n      // Make sure that sec is converted to ms for date constructor\n      started: new Date(this.started * 1000).toISOString(),\n      timestamp: new Date(this.timestamp * 1000).toISOString(),\n      status: this.status,\n      errors: this.errors,\n      did: typeof this.did === 'number' || typeof this.did === 'string' ? `${this.did}` : undefined,\n      duration: this.duration,\n      attrs: dropUndefinedKeys({\n        release: this.release,\n        environment: this.environment,\n        ip_address: this.ipAddress,\n        user_agent: this.userAgent,\n      }),\n    });\n  }\n}\n", "/* eslint-disable max-lines */\nimport {\n  Breadcrumb,\n  BreadcrumbHint,\n  Client,\n  CustomSamplingContext,\n  Event,\n  EventHint,\n  Extra,\n  Extras,\n  Hub as HubInterface,\n  Integration,\n  IntegrationClass,\n  Primitive,\n  SessionContext,\n  SessionStatus,\n  Severity,\n  Span,\n  SpanContext,\n  Transaction,\n  TransactionContext,\n  User,\n} from '@sentry/types';\nimport { consoleSandbox, dateTimestampInSeconds, getGlobalObject, isNodeEnv, logger, uuid4 } from '@sentry/utils';\n\nimport { Scope } from './scope';\nimport { Session } from './session';\n\n/**\n * API compatibility version of this hub.\n *\n * WARNING: This number should only be increased when the global interface\n * changes and new methods are introduced.\n *\n * @hidden\n */\nexport const API_VERSION = 4;\n\n/**\n * Default maximum number of breadcrumbs added to an event. Can be overwritten\n * with {@link Options.maxBreadcrumbs}.\n */\nconst DEFAULT_BREADCRUMBS = 100;\n\n/**\n * A layer in the process stack.\n * @hidden\n */\nexport interface Layer {\n  client?: Client;\n  scope?: Scope;\n}\n\n/**\n * An object that contains a hub and maintains a scope stack.\n * @hidden\n */\nexport interface Carrier {\n  __SENTRY__?: {\n    hub?: Hub;\n    /**\n     * Extra Hub properties injected by various SDKs\n     */\n    integrations?: Integration[];\n    extensions?: {\n      /** Hack to prevent bundlers from breaking our usage of the domain package in the cross-platform Hub package */\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      domain?: { [key: string]: any };\n    } & {\n      /** Extension methods for the hub, which are bound to the current Hub instance */\n      // eslint-disable-next-line @typescript-eslint/ban-types\n      [key: string]: Function;\n    };\n  };\n}\n\n/**\n * @hidden\n * @deprecated Can be removed once `Hub.getActiveDomain` is removed.\n */\nexport interface DomainAsCarrier extends Carrier {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  members: { [key: string]: any }[];\n}\n\n/**\n * @inheritDoc\n */\nexport class Hub implements HubInterface {\n  /** Is a {@link Layer}[] containing the client and scope */\n  private readonly _stack: Layer[] = [{}];\n\n  /** Contains the last event id of a captured event.  */\n  private _lastEventId?: string;\n\n  /**\n   * Creates a new instance of the hub, will push one {@link Layer} into the\n   * internal stack on creation.\n   *\n   * @param client bound to the hub.\n   * @param scope bound to the hub.\n   * @param version number, higher number means higher priority.\n   */\n  public constructor(client?: Client, scope: Scope = new Scope(), private readonly _version: number = API_VERSION) {\n    this.getStackTop().scope = scope;\n    this.bindClient(client);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public isOlderThan(version: number): boolean {\n    return this._version < version;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public bindClient(client?: Client): void {\n    const top = this.getStackTop();\n    top.client = client;\n    if (client && client.setupIntegrations) {\n      client.setupIntegrations();\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public pushScope(): Scope {\n    // We want to clone the content of prev scope\n    const scope = Scope.clone(this.getScope());\n    this.getStack().push({\n      client: this.getClient(),\n      scope,\n    });\n    return scope;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public popScope(): boolean {\n    if (this.getStack().length <= 1) return false;\n    return !!this.getStack().pop();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public withScope(callback: (scope: Scope) => void): void {\n    const scope = this.pushScope();\n    try {\n      callback(scope);\n    } finally {\n      this.popScope();\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getClient<C extends Client>(): C | undefined {\n    return this.getStackTop().client as C;\n  }\n\n  /** Returns the scope of the top stack. */\n  public getScope(): Scope | undefined {\n    return this.getStackTop().scope;\n  }\n\n  /** Returns the scope stack for domains or the process. */\n  public getStack(): Layer[] {\n    return this._stack;\n  }\n\n  /** Returns the topmost scope layer in the order domain > local > process. */\n  public getStackTop(): Layer {\n    return this._stack[this._stack.length - 1];\n  }\n\n  /**\n   * @inheritDoc\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\n  public captureException(exception: any, hint?: EventHint): string {\n    const eventId = (this._lastEventId = uuid4());\n    let finalHint = hint;\n\n    // If there's no explicit hint provided, mimick the same thing that would happen\n    // in the minimal itself to create a consistent behavior.\n    // We don't do this in the client, as it's the lowest level API, and doing this,\n    // would prevent user from having full control over direct calls.\n    if (!hint) {\n      let syntheticException: Error;\n      try {\n        throw new Error('Sentry syntheticException');\n      } catch (exception) {\n        syntheticException = exception as Error;\n      }\n      finalHint = {\n        originalException: exception,\n        syntheticException,\n      };\n    }\n\n    this._invokeClient('captureException', exception, {\n      ...finalHint,\n      event_id: eventId,\n    });\n    return eventId;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public captureMessage(message: string, level?: Severity, hint?: EventHint): string {\n    const eventId = (this._lastEventId = uuid4());\n    let finalHint = hint;\n\n    // If there's no explicit hint provided, mimick the same thing that would happen\n    // in the minimal itself to create a consistent behavior.\n    // We don't do this in the client, as it's the lowest level API, and doing this,\n    // would prevent user from having full control over direct calls.\n    if (!hint) {\n      let syntheticException: Error;\n      try {\n        throw new Error(message);\n      } catch (exception) {\n        syntheticException = exception as Error;\n      }\n      finalHint = {\n        originalException: message,\n        syntheticException,\n      };\n    }\n\n    this._invokeClient('captureMessage', message, level, {\n      ...finalHint,\n      event_id: eventId,\n    });\n    return eventId;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public captureEvent(event: Event, hint?: EventHint): string {\n    const eventId = (this._lastEventId = uuid4());\n    this._invokeClient('captureEvent', event, {\n      ...hint,\n      event_id: eventId,\n    });\n    return eventId;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public lastEventId(): string | undefined {\n    return this._lastEventId;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public addBreadcrumb(breadcrumb: Breadcrumb, hint?: BreadcrumbHint): void {\n    const { scope, client } = this.getStackTop();\n\n    if (!scope || !client) return;\n\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const { beforeBreadcrumb = null, maxBreadcrumbs = DEFAULT_BREADCRUMBS } =\n      (client.getOptions && client.getOptions()) || {};\n\n    if (maxBreadcrumbs <= 0) return;\n\n    const timestamp = dateTimestampInSeconds();\n    const mergedBreadcrumb = { timestamp, ...breadcrumb };\n    const finalBreadcrumb = beforeBreadcrumb\n      ? (consoleSandbox(() => beforeBreadcrumb(mergedBreadcrumb, hint)) as Breadcrumb | null)\n      : mergedBreadcrumb;\n\n    if (finalBreadcrumb === null) return;\n\n    scope.addBreadcrumb(finalBreadcrumb, maxBreadcrumbs);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setUser(user: User | null): void {\n    const scope = this.getScope();\n    if (scope) scope.setUser(user);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setTags(tags: { [key: string]: Primitive }): void {\n    const scope = this.getScope();\n    if (scope) scope.setTags(tags);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setExtras(extras: Extras): void {\n    const scope = this.getScope();\n    if (scope) scope.setExtras(extras);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setTag(key: string, value: Primitive): void {\n    const scope = this.getScope();\n    if (scope) scope.setTag(key, value);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setExtra(key: string, extra: Extra): void {\n    const scope = this.getScope();\n    if (scope) scope.setExtra(key, extra);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public setContext(name: string, context: { [key: string]: any } | null): void {\n    const scope = this.getScope();\n    if (scope) scope.setContext(name, context);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public configureScope(callback: (scope: Scope) => void): void {\n    const { scope, client } = this.getStackTop();\n    if (scope && client) {\n      callback(scope);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public run(callback: (hub: Hub) => void): void {\n    const oldHub = makeMain(this);\n    try {\n      callback(this);\n    } finally {\n      makeMain(oldHub);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getIntegration<T extends Integration>(integration: IntegrationClass<T>): T | null {\n    const client = this.getClient();\n    if (!client) return null;\n    try {\n      return client.getIntegration(integration);\n    } catch (_oO) {\n      logger.warn(`Cannot retrieve integration ${integration.id} from the current Hub`);\n      return null;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public startSpan(context: SpanContext): Span {\n    return this._callExtensionMethod('startSpan', context);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public startTransaction(context: TransactionContext, customSamplingContext?: CustomSamplingContext): Transaction {\n    return this._callExtensionMethod('startTransaction', context, customSamplingContext);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public traceHeaders(): { [key: string]: string } {\n    return this._callExtensionMethod<{ [key: string]: string }>('traceHeaders');\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public captureSession(endSession: boolean = false): void {\n    // both send the update and pull the session from the scope\n    if (endSession) {\n      return this.endSession();\n    }\n\n    // only send the update\n    this._sendSessionUpdate();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public endSession(): void {\n    this.getStackTop()\n      ?.scope?.getSession()\n      ?.close();\n    this._sendSessionUpdate();\n\n    // the session is over; take it off of the scope\n    this.getStackTop()?.scope?.setSession();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public startSession(context?: SessionContext): Session {\n    const { scope, client } = this.getStackTop();\n    const { release, environment } = (client && client.getOptions()) || {};\n\n    // Will fetch userAgent if called from browser sdk\n    const global = getGlobalObject<{ navigator?: { userAgent?: string } }>();\n    const { userAgent } = global.navigator || {};\n\n    const session = new Session({\n      release,\n      environment,\n      ...(scope && { user: scope.getUser() }),\n      ...(userAgent && { userAgent }),\n      ...context,\n    });\n\n    if (scope) {\n      // End existing session if there's one\n      const currentSession = scope.getSession && scope.getSession();\n      if (currentSession && currentSession.status === SessionStatus.Ok) {\n        currentSession.update({ status: SessionStatus.Exited });\n      }\n      this.endSession();\n\n      // Afterwards we set the new session on the scope\n      scope.setSession(session);\n    }\n\n    return session;\n  }\n\n  /**\n   * Sends the current Session on the scope\n   */\n  private _sendSessionUpdate(): void {\n    const { scope, client } = this.getStackTop();\n    if (!scope) return;\n\n    const session = scope.getSession && scope.getSession();\n    if (session) {\n      if (client && client.captureSession) {\n        client.captureSession(session);\n      }\n    }\n  }\n\n  /**\n   * Internal helper function to call a method on the top client if it exists.\n   *\n   * @param method The method to call on the client.\n   * @param args Arguments to pass to the client function.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private _invokeClient<M extends keyof Client>(method: M, ...args: any[]): void {\n    const { scope, client } = this.getStackTop();\n    if (client && client[method]) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-explicit-any\n      (client as any)[method](...args, scope);\n    }\n  }\n\n  /**\n   * Calls global extension method and binding current instance to the function call\n   */\n  // @ts-ignore Function lacks ending return statement and return type does not include 'undefined'. ts(2366)\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private _callExtensionMethod<T>(method: string, ...args: any[]): T {\n    const carrier = getMainCarrier();\n    const sentry = carrier.__SENTRY__;\n    if (sentry && sentry.extensions && typeof sentry.extensions[method] === 'function') {\n      return sentry.extensions[method].apply(this, args);\n    }\n    logger.warn(`Extension method ${method} couldn't be found, doing nothing.`);\n  }\n}\n\n/**\n * Returns the global shim registry.\n *\n * FIXME: This function is problematic, because despite always returning a valid Carrier,\n * it has an optional `__SENTRY__` property, which then in turn requires us to always perform an unnecessary check\n * at the call-site. We always access the carrier through this function, so we can guarantee that `__SENTRY__` is there.\n **/\nexport function getMainCarrier(): Carrier {\n  const carrier = getGlobalObject();\n  carrier.__SENTRY__ = carrier.__SENTRY__ || {\n    extensions: {},\n    hub: undefined,\n  };\n  return carrier;\n}\n\n/**\n * Replaces the current main hub with the passed one on the global object\n *\n * @returns The old replaced hub\n */\nexport function makeMain(hub: Hub): Hub {\n  const registry = getMainCarrier();\n  const oldHub = getHubFromCarrier(registry);\n  setHubOnCarrier(registry, hub);\n  return oldHub;\n}\n\n/**\n * Returns the default hub instance.\n *\n * If a hub is already registered in the global carrier but this module\n * contains a more recent version, it replaces the registered version.\n * Otherwise, the currently registered hub will be returned.\n */\nexport function getCurrentHub(): Hub {\n  // Get main carrier (global for every environment)\n  const registry = getMainCarrier();\n\n  // If there's no hub, or its an old API, assign a new one\n  if (!hasHubOnCarrier(registry) || getHubFromCarrier(registry).isOlderThan(API_VERSION)) {\n    setHubOnCarrier(registry, new Hub());\n  }\n\n  // Prefer domains over global if they are there (applicable only to Node environment)\n  if (isNodeEnv()) {\n    return getHubFromActiveDomain(registry);\n  }\n  // Return hub that lives on a global object\n  return getHubFromCarrier(registry);\n}\n\n/**\n * Returns the active domain, if one exists\n * @deprecated No longer used; remove in v7\n * @returns The domain, or undefined if there is no active domain\n */\n// eslint-disable-next-line deprecation/deprecation\nexport function getActiveDomain(): DomainAsCarrier | undefined {\n  logger.warn('Function `getActiveDomain` is deprecated and will be removed in a future version.');\n\n  const sentry = getMainCarrier().__SENTRY__;\n\n  return sentry && sentry.extensions && sentry.extensions.domain && sentry.extensions.domain.active;\n}\n\n/**\n * Try to read the hub from an active domain, and fallback to the registry if one doesn't exist\n * @returns discovered hub\n */\nfunction getHubFromActiveDomain(registry: Carrier): Hub {\n  try {\n    const activeDomain = getMainCarrier().__SENTRY__?.extensions?.domain?.active;\n\n    // If there's no active domain, just return global hub\n    if (!activeDomain) {\n      return getHubFromCarrier(registry);\n    }\n\n    // If there's no hub on current domain, or it's an old API, assign a new one\n    if (!hasHubOnCarrier(activeDomain) || getHubFromCarrier(activeDomain).isOlderThan(API_VERSION)) {\n      const registryHubTopStack = getHubFromCarrier(registry).getStackTop();\n      setHubOnCarrier(activeDomain, new Hub(registryHubTopStack.client, Scope.clone(registryHubTopStack.scope)));\n    }\n\n    // Return hub that lives on a domain\n    return getHubFromCarrier(activeDomain);\n  } catch (_Oo) {\n    // Return hub that lives on a global object\n    return getHubFromCarrier(registry);\n  }\n}\n\n/**\n * This will tell whether a carrier has a hub on it or not\n * @param carrier object\n */\nfunction hasHubOnCarrier(carrier: Carrier): boolean {\n  return !!(carrier && carrier.__SENTRY__ && carrier.__SENTRY__.hub);\n}\n\n/**\n * This will create a new {@link Hub} and add to the passed object on\n * __SENTRY__.hub.\n * @param carrier object\n * @hidden\n */\nexport function getHubFromCarrier(carrier: Carrier): Hub {\n  if (carrier && carrier.__SENTRY__ && carrier.__SENTRY__.hub) return carrier.__SENTRY__.hub;\n  carrier.__SENTRY__ = carrier.__SENTRY__ || {};\n  carrier.__SENTRY__.hub = new Hub();\n  return carrier.__SENTRY__.hub;\n}\n\n/**\n * This will set passed {@link Hub} on the passed object's __SENTRY__.hub attribute\n * @param carrier object\n * @param hub Hub\n * @returns A boolean indicating success or failure\n */\nexport function setHubOnCarrier(carrier: Carrier, hub: Hub): boolean {\n  if (!carrier) return false;\n  carrier.__SENTRY__ = carrier.__SENTRY__ || {};\n  carrier.__SENTRY__.hub = hub;\n  return true;\n}\n", "import {\n  AggregationCounts,\n  RequestSessionStatus,\n  SessionAggregates,\n  SessionFlusherLike,\n  Transport,\n} from '@sentry/types';\nimport { dropUndefinedKeys, logger } from '@sentry/utils';\n\nimport { getCurrentHub } from './hub';\n\ntype ReleaseHealthAttributes = {\n  environment?: string;\n  release: string;\n};\n\n/**\n * @inheritdoc\n */\nexport class SessionFlusher implements SessionFlusherLike {\n  public readonly flushTimeout: number = 60;\n  private _pendingAggregates: Record<number, AggregationCounts> = {};\n  private _sessionAttrs: ReleaseHealthAttributes;\n  private _intervalId: ReturnType<typeof setInterval>;\n  private _isEnabled: boolean = true;\n  private _transport: Transport;\n\n  public constructor(transport: Transport, attrs: ReleaseHealthAttributes) {\n    this._transport = transport;\n    // Call to setInterval, so that flush is called every 60 seconds\n    this._intervalId = setInterval(() => this.flush(), this.flushTimeout * 1000);\n    this._sessionAttrs = attrs;\n  }\n\n  /** Sends session aggregates to Transport */\n  public sendSessionAggregates(sessionAggregates: SessionAggregates): void {\n    if (!this._transport.sendSession) {\n      logger.warn(\"Dropping session because custom transport doesn't implement sendSession\");\n      return;\n    }\n    void this._transport.sendSession(sessionAggregates).then(null, reason => {\n      logger.error(`Error while sending session: ${reason}`);\n    });\n  }\n\n  /** Checks if `pendingAggregates` has entries, and if it does flushes them by calling `sendSessions` */\n  public flush(): void {\n    const sessionAggregates = this.getSessionAggregates();\n    if (sessionAggregates.aggregates.length === 0) {\n      return;\n    }\n    this._pendingAggregates = {};\n    this.sendSessionAggregates(sessionAggregates);\n  }\n\n  /** Massages the entries in `pendingAggregates` and returns aggregated sessions */\n  public getSessionAggregates(): SessionAggregates {\n    const aggregates: AggregationCounts[] = Object.keys(this._pendingAggregates).map((key: string) => {\n      return this._pendingAggregates[parseInt(key)];\n    });\n\n    const sessionAggregates: SessionAggregates = {\n      attrs: this._sessionAttrs,\n      aggregates,\n    };\n    return dropUndefinedKeys(sessionAggregates);\n  }\n\n  /** JSDoc */\n  public close(): void {\n    clearInterval(this._intervalId);\n    this._isEnabled = false;\n    this.flush();\n  }\n\n  /**\n   * Wrapper function for _incrementSessionStatusCount that checks if the instance of SessionFlusher is enabled then\n   * fetches the session status of the request from `Scope.getRequestSession().status` on the scope and passes them to\n   * `_incrementSessionStatusCount` along with the start date\n   */\n  public incrementSessionStatusCount(): void {\n    if (!this._isEnabled) {\n      return;\n    }\n    const scope = getCurrentHub().getScope();\n    const requestSession = scope?.getRequestSession();\n\n    if (requestSession && requestSession.status) {\n      this._incrementSessionStatusCount(requestSession.status, new Date());\n      // This is not entirely necessarily but is added as a safe guard to indicate the bounds of a request and so in\n      // case captureRequestSession is called more than once to prevent double count\n      scope?.setRequestSession(undefined);\n\n      /* eslint-enable @typescript-eslint/no-unsafe-member-access */\n    }\n  }\n\n  /**\n   * Increments status bucket in pendingAggregates buffer (internal state) corresponding to status of\n   * the session received\n   */\n  private _incrementSessionStatusCount(status: RequestSessionStatus, date: Date): number {\n    // Truncate minutes and seconds on Session Started attribute to have one minute bucket keys\n    const sessionStartedTrunc = new Date(date).setSeconds(0, 0);\n    this._pendingAggregates[sessionStartedTrunc] = this._pendingAggregates[sessionStartedTrunc] || {};\n\n    // corresponds to aggregated sessions in one specific minute bucket\n    // for example, {\"started\":\"2021-03-16T08:00:00.000Z\",\"exited\":4, \"errored\": 1}\n    const aggregationCounts: AggregationCounts = this._pendingAggregates[sessionStartedTrunc];\n    if (!aggregationCounts.started) {\n      aggregationCounts.started = new Date(sessionStartedTrunc).toISOString();\n    }\n\n    switch (status) {\n      case RequestSessionStatus.Errored:\n        aggregationCounts.errored = (aggregationCounts.errored || 0) + 1;\n        return aggregationCounts.errored;\n      case RequestSessionStatus.Ok:\n        aggregationCounts.exited = (aggregationCounts.exited || 0) + 1;\n        return aggregationCounts.exited;\n      case RequestSessionStatus.Crashed:\n        aggregationCounts.crashed = (aggregationCounts.crashed || 0) + 1;\n        return aggregationCounts.crashed;\n    }\n  }\n}\n", "export { addGlobalEventProcessor, Scope } from './scope';\nexport { Session } from './session';\nexport { SessionFlusher } from './sessionflusher';\nexport {\n  // eslint-disable-next-line deprecation/deprecation\n  getActiveDomain,\n  getCurrentHub,\n  getHubFromCarrier,\n  getMainCarrier,\n  Hub,\n  makeMain,\n  setHubOnCarrier,\n  Carrier,\n  // eslint-disable-next-line deprecation/deprecation\n  DomainAsCarrier,\n  Layer,\n} from './hub';\n", "import { getCurrentHub, Hub, Scope } from '@sentry/hub';\nimport {\n  Breadcrumb,\n  CaptureContext,\n  CustomSamplingContext,\n  Event,\n  Extra,\n  Extras,\n  Primitive,\n  Severity,\n  Transaction,\n  TransactionContext,\n  User,\n} from '@sentry/types';\n\n/**\n * This calls a function on the current hub.\n * @param method function to call on hub.\n * @param args to pass to function.\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction callOnHub<T>(method: string, ...args: any[]): T {\n  const hub = getCurrentHub();\n  if (hub && hub[method as keyof Hub]) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return (hub[method as keyof Hub] as any)(...args);\n  }\n  throw new Error(`No hub defined or ${method} was not found on the hub, please open a bug report.`);\n}\n\n/**\n * Captures an exception event and sends it to Sentry.\n *\n * @param exception An exception-like object.\n * @returns The generated eventId.\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\nexport function captureException(exception: any, captureContext?: CaptureContext): string {\n  let syntheticException: Error;\n  try {\n    throw new Error('Sentry syntheticException');\n  } catch (exception) {\n    syntheticException = exception as Error;\n  }\n  return callOnHub('captureException', exception, {\n    captureContext,\n    originalException: exception,\n    syntheticException,\n  });\n}\n\n/**\n * Captures a message event and sends it to Sentry.\n *\n * @param message The message to send to Sentry.\n * @param level Define the level of the message.\n * @returns The generated eventId.\n */\nexport function captureMessage(message: string, captureContext?: CaptureContext | Severity): string {\n  let syntheticException: Error;\n  try {\n    throw new Error(message);\n  } catch (exception) {\n    syntheticException = exception as Error;\n  }\n\n  // This is necessary to provide explicit scopes upgrade, without changing the original\n  // arity of the `captureMessage(message, level)` method.\n  const level = typeof captureContext === 'string' ? captureContext : undefined;\n  const context = typeof captureContext !== 'string' ? { captureContext } : undefined;\n\n  return callOnHub('captureMessage', message, level, {\n    originalException: message,\n    syntheticException,\n    ...context,\n  });\n}\n\n/**\n * Captures a manually created event and sends it to Sentry.\n *\n * @param event The event to send to Sentry.\n * @returns The generated eventId.\n */\nexport function captureEvent(event: Event): string {\n  return callOnHub('captureEvent', event);\n}\n\n/**\n * Callback to set context information onto the scope.\n * @param callback Callback function that receives Scope.\n */\nexport function configureScope(callback: (scope: Scope) => void): void {\n  callOnHub<void>('configureScope', callback);\n}\n\n/**\n * Records a new breadcrumb which will be attached to future events.\n *\n * Breadcrumbs will be added to subsequent events to provide more context on\n * user's actions prior to an error or crash.\n *\n * @param breadcrumb The breadcrumb to record.\n */\nexport function addBreadcrumb(breadcrumb: Breadcrumb): void {\n  callOnHub<void>('addBreadcrumb', breadcrumb);\n}\n\n/**\n * Sets context data with the given name.\n * @param name of the context\n * @param context Any kind of data. This data will be normalized.\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function setContext(name: string, context: { [key: string]: any } | null): void {\n  callOnHub<void>('setContext', name, context);\n}\n\n/**\n * Set an object that will be merged sent as extra data with the event.\n * @param extras Extras object to merge into current context.\n */\nexport function setExtras(extras: Extras): void {\n  callOnHub<void>('setExtras', extras);\n}\n\n/**\n * Set an object that will be merged sent as tags data with the event.\n * @param tags Tags context object to merge into current context.\n */\nexport function setTags(tags: { [key: string]: Primitive }): void {\n  callOnHub<void>('setTags', tags);\n}\n\n/**\n * Set key:value that will be sent as extra data with the event.\n * @param key String of extra\n * @param extra Any kind of data. This data will be normalized.\n */\nexport function setExtra(key: string, extra: Extra): void {\n  callOnHub<void>('setExtra', key, extra);\n}\n\n/**\n * Set key:value that will be sent as tags data with the event.\n *\n * Can also be used to unset a tag, by passing `undefined`.\n *\n * @param key String key of tag\n * @param value Value of tag\n */\nexport function setTag(key: string, value: Primitive): void {\n  callOnHub<void>('setTag', key, value);\n}\n\n/**\n * Updates user context information for future events.\n *\n * @param user User context object to be set in the current context. Pass `null` to unset the user.\n */\nexport function setUser(user: User | null): void {\n  callOnHub<void>('setUser', user);\n}\n\n/**\n * Creates a new scope with and executes the given operation within.\n * The scope is automatically removed once the operation\n * finishes or throws.\n *\n * This is essentially a convenience function for:\n *\n *     pushScope();\n *     callback();\n *     popScope();\n *\n * @param callback that will be enclosed into push/popScope.\n */\nexport function withScope(callback: (scope: Scope) => void): void {\n  callOnHub<void>('withScope', callback);\n}\n\n/**\n * Calls a function on the latest client. Use this with caution, it's meant as\n * in \"internal\" helper so we don't need to expose every possible function in\n * the shim. It is not guaranteed that the client actually implements the\n * function.\n *\n * @param method The method to call on the client/client.\n * @param args Arguments to pass to the client/fontend.\n * @hidden\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function _callOnClient(method: string, ...args: any[]): void {\n  callOnHub<void>('_invokeClient', method, ...args);\n}\n\n/**\n * Starts a new `Transaction` and returns it. This is the entry point to manual tracing instrumentation.\n *\n * A tree structure can be built by adding child spans to the transaction, and child spans to other spans. To start a\n * new child span within the transaction or any span, call the respective `.startChild()` method.\n *\n * Every child span must be finished before the transaction is finished, otherwise the unfinished spans are discarded.\n *\n * The transaction must be finished with a call to its `.finish()` method, at which point the transaction with all its\n * finished child spans will be sent to Sentry.\n *\n * @param context Properties of the new `Transaction`.\n * @param customSamplingContext Information given to the transaction sampling function (along with context-dependent\n * default values). See {@link Options.tracesSampler}.\n *\n * @returns The transaction which was just started\n */\nexport function startTransaction(\n  context: TransactionContext,\n  customSamplingContext?: CustomSamplingContext,\n): Transaction {\n  return callOnHub('startTransaction', { ...context }, customSamplingContext);\n}\n", "import { DsnLike, SdkMetadata } from '@sentry/types';\nimport { Dsn, urlEncode } from '@sentry/utils';\n\nconst SENTRY_API_VERSION = '7';\n\n/**\n * Helper class to provide urls, headers and metadata that can be used to form\n * different types of requests to Sentry endpoints.\n * Supports both envelopes and regular event requests.\n **/\nexport class API {\n  /** The DSN as passed to Sentry.init() */\n  public dsn: DsnLike;\n\n  /** Metadata about the SDK (name, version, etc) for inclusion in envelope headers */\n  public metadata: SdkMetadata;\n\n  /** The internally used Dsn object. */\n  private readonly _dsnObject: Dsn;\n\n  /** The envelope tunnel to use. */\n  private readonly _tunnel?: string;\n\n  /** Create a new instance of API */\n  public constructor(dsn: DsnLike, metadata: SdkMetadata = {}, tunnel?: string) {\n    this.dsn = dsn;\n    this._dsnObject = new Dsn(dsn);\n    this.metadata = metadata;\n    this._tunnel = tunnel;\n  }\n\n  /** Returns the Dsn object. */\n  public getDsn(): Dsn {\n    return this._dsnObject;\n  }\n\n  /** Does this transport force envelopes? */\n  public forceEnvelope(): boolean {\n    return !!this._tunnel;\n  }\n\n  /** Returns the prefix to construct Sentry ingestion API endpoints. */\n  public getBaseApiEndpoint(): string {\n    const dsn = this.getDsn();\n    const protocol = dsn.protocol ? `${dsn.protocol}:` : '';\n    const port = dsn.port ? `:${dsn.port}` : '';\n    return `${protocol}//${dsn.host}${port}${dsn.path ? `/${dsn.path}` : ''}/api/`;\n  }\n\n  /** Returns the store endpoint URL. */\n  public getStoreEndpoint(): string {\n    return this._getIngestEndpoint('store');\n  }\n\n  /**\n   * Returns the store endpoint URL with auth in the query string.\n   *\n   * Sending auth as part of the query string and not as custom HTTP headers avoids CORS preflight requests.\n   */\n  public getStoreEndpointWithUrlEncodedAuth(): string {\n    return `${this.getStoreEndpoint()}?${this._encodedAuth()}`;\n  }\n\n  /**\n   * Returns the envelope endpoint URL with auth in the query string.\n   *\n   * Sending auth as part of the query string and not as custom HTTP headers avoids CORS preflight requests.\n   */\n  public getEnvelopeEndpointWithUrlEncodedAuth(): string {\n    if (this.forceEnvelope()) {\n      return this._tunnel as string;\n    }\n\n    return `${this._getEnvelopeEndpoint()}?${this._encodedAuth()}`;\n  }\n\n  /** Returns only the path component for the store endpoint. */\n  public getStoreEndpointPath(): string {\n    const dsn = this.getDsn();\n    return `${dsn.path ? `/${dsn.path}` : ''}/api/${dsn.projectId}/store/`;\n  }\n\n  /**\n   * Returns an object that can be used in request headers.\n   * This is needed for node and the old /store endpoint in sentry\n   */\n  public getRequestHeaders(clientName: string, clientVersion: string): { [key: string]: string } {\n    // CHANGE THIS to use metadata but keep clientName and clientVersion compatible\n    const dsn = this.getDsn();\n    const header = [`Sentry sentry_version=${SENTRY_API_VERSION}`];\n    header.push(`sentry_client=${clientName}/${clientVersion}`);\n    header.push(`sentry_key=${dsn.publicKey}`);\n    if (dsn.pass) {\n      header.push(`sentry_secret=${dsn.pass}`);\n    }\n    return {\n      'Content-Type': 'application/json',\n      'X-Sentry-Auth': header.join(', '),\n    };\n  }\n\n  /** Returns the url to the report dialog endpoint. */\n  public getReportDialogEndpoint(\n    dialogOptions: {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      [key: string]: any;\n      user?: { name?: string; email?: string };\n    } = {},\n  ): string {\n    const dsn = this.getDsn();\n    const endpoint = `${this.getBaseApiEndpoint()}embed/error-page/`;\n\n    const encodedOptions = [];\n    encodedOptions.push(`dsn=${dsn.toString()}`);\n    for (const key in dialogOptions) {\n      if (key === 'dsn') {\n        continue;\n      }\n\n      if (key === 'user') {\n        if (!dialogOptions.user) {\n          continue;\n        }\n        if (dialogOptions.user.name) {\n          encodedOptions.push(`name=${encodeURIComponent(dialogOptions.user.name)}`);\n        }\n        if (dialogOptions.user.email) {\n          encodedOptions.push(`email=${encodeURIComponent(dialogOptions.user.email)}`);\n        }\n      } else {\n        encodedOptions.push(`${encodeURIComponent(key)}=${encodeURIComponent(dialogOptions[key] as string)}`);\n      }\n    }\n    if (encodedOptions.length) {\n      return `${endpoint}?${encodedOptions.join('&')}`;\n    }\n\n    return endpoint;\n  }\n\n  /** Returns the envelope endpoint URL. */\n  private _getEnvelopeEndpoint(): string {\n    return this._getIngestEndpoint('envelope');\n  }\n\n  /** Returns the ingest API endpoint for target. */\n  private _getIngestEndpoint(target: 'store' | 'envelope'): string {\n    if (this._tunnel) {\n      return this._tunnel;\n    }\n    const base = this.getBaseApiEndpoint();\n    const dsn = this.getDsn();\n    return `${base}${dsn.projectId}/${target}/`;\n  }\n\n  /** Returns a URL-encoded string with auth config suitable for a query string. */\n  private _encodedAuth(): string {\n    const dsn = this.getDsn();\n    const auth = {\n      // We send only the minimum set of required information. See\n      // https://github.com/getsentry/sentry-javascript/issues/2572.\n      sentry_key: dsn.publicKey,\n      sentry_version: SENTRY_API_VERSION,\n    };\n    return urlEncode(auth);\n  }\n}\n", "import { addGlobalEventProcessor, getCurrentHub } from '@sentry/hub';\nimport { Integration, Options } from '@sentry/types';\nimport { logger } from '@sentry/utils';\n\nexport const installedIntegrations: string[] = [];\n\n/** Map of integrations assigned to a client */\nexport interface IntegrationIndex {\n  [key: string]: Integration;\n}\n\n/**\n * @private\n */\nfunction filterDuplicates(integrations: Integration[]): Integration[] {\n  return integrations.reduce((acc, integrations) => {\n    if (acc.every(accIntegration => integrations.name !== accIntegration.name)) {\n      acc.push(integrations);\n    }\n    return acc;\n  }, [] as Integration[]);\n}\n\n/** Gets integration to install */\nexport function getIntegrationsToSetup(options: Options): Integration[] {\n  const defaultIntegrations = (options.defaultIntegrations && [...options.defaultIntegrations]) || [];\n  const userIntegrations = options.integrations;\n\n  let integrations: Integration[] = [...filterDuplicates(defaultIntegrations)];\n\n  if (Array.isArray(userIntegrations)) {\n    // Filter out integrations that are also included in user options\n    integrations = [\n      ...integrations.filter(integrations =>\n        userIntegrations.every(userIntegration => userIntegration.name !== integrations.name),\n      ),\n      // And filter out duplicated user options integrations\n      ...filterDuplicates(userIntegrations),\n    ];\n  } else if (typeof userIntegrations === 'function') {\n    integrations = userIntegrations(integrations);\n    integrations = Array.isArray(integrations) ? integrations : [integrations];\n  }\n\n  // Make sure that if present, `Debug` integration will always run last\n  const integrationsNames = integrations.map(i => i.name);\n  const alwaysLastToRun = 'Debug';\n  if (integrationsNames.indexOf(alwaysLastToRun) !== -1) {\n    integrations.push(...integrations.splice(integrationsNames.indexOf(alwaysLastToRun), 1));\n  }\n\n  return integrations;\n}\n\n/** Setup given integration */\nexport function setupIntegration(integration: Integration): void {\n  if (installedIntegrations.indexOf(integration.name) !== -1) {\n    return;\n  }\n  integration.setupOnce(addGlobalEventProcessor, getCurrentHub);\n  installedIntegrations.push(integration.name);\n  logger.log(`Integration installed: ${integration.name}`);\n}\n\n/**\n * Given a list of integration instances this installs them all. When `withDefaults` is set to `true` then all default\n * integrations are added unless they were already provided before.\n * @param integrations array of integration instances\n * @param withDefault should enable default integrations\n */\nexport function setupIntegrations<O extends Options>(options: O): IntegrationIndex {\n  const integrations: IntegrationIndex = {};\n  getIntegrationsToSetup(options).forEach(integration => {\n    integrations[integration.name] = integration;\n    setupIntegration(integration);\n  });\n  return integrations;\n}\n", "/* eslint-disable max-lines */\nimport { Scope, Session } from '@sentry/hub';\nimport {\n  Client,\n  Event,\n  EventHint,\n  Integration,\n  IntegrationClass,\n  Options,\n  SessionStatus,\n  Severity,\n} from '@sentry/types';\nimport {\n  dateTimestampInSeconds,\n  Dsn,\n  isPlainObject,\n  isPrimitive,\n  isThenable,\n  logger,\n  normalize,\n  SentryError,\n  SyncPromise,\n  truncate,\n  uuid4,\n} from '@sentry/utils';\n\nimport { Backend, BackendClass } from './basebackend';\nimport { IntegrationIndex, setupIntegrations } from './integration';\n\n/**\n * Base implementation for all JavaScript SDK clients.\n *\n * Call the constructor with the corresponding backend constructor and options\n * specific to the client subclass. To access these options later, use\n * {@link Client.getOptions}. Also, the Backend instance is available via\n * {@link Client.getBackend}.\n *\n * If a Dsn is specified in the options, it will be parsed and stored. Use\n * {@link Client.getDsn} to retrieve the Dsn at any moment. In case the Dsn is\n * invalid, the constructor will throw a {@link SentryException}. Note that\n * without a valid Dsn, the SDK will not send any events to Sentry.\n *\n * Before sending an event via the backend, it is passed through\n * {@link BaseClient._prepareEvent} to add SDK information and scope data\n * (breadcrumbs and context). To add more custom information, override this\n * method and extend the resulting prepared event.\n *\n * To issue automatically created events (e.g. via instrumentation), use\n * {@link Client.captureEvent}. It will prepare the event and pass it through\n * the callback lifecycle. To issue auto-breadcrumbs, use\n * {@link Client.addBreadcrumb}.\n *\n * @example\n * class NodeClient extends BaseClient<NodeBackend, NodeOptions> {\n *   public constructor(options: NodeOptions) {\n *     super(NodeBackend, options);\n *   }\n *\n *   // ...\n * }\n */\nexport abstract class BaseClient<B extends Backend, O extends Options> implements Client<O> {\n  /**\n   * The backend used to physically interact in the environment. Usually, this\n   * will correspond to the client. When composing SDKs, however, the Backend\n   * from the root SDK will be used.\n   */\n  protected readonly _backend: B;\n\n  /** Options passed to the SDK. */\n  protected readonly _options: O;\n\n  /** The client Dsn, if specified in options. Without this Dsn, the SDK will be disabled. */\n  protected readonly _dsn?: Dsn;\n\n  /** Array of used integrations. */\n  protected _integrations: IntegrationIndex = {};\n\n  /** Number of call being processed */\n  protected _processing: number = 0;\n\n  /**\n   * Initializes this client instance.\n   *\n   * @param backendClass A constructor function to create the backend.\n   * @param options Options for the client.\n   */\n  protected constructor(backendClass: BackendClass<B, O>, options: O) {\n    this._backend = new backendClass(options);\n    this._options = options;\n\n    if (options.dsn) {\n      this._dsn = new Dsn(options.dsn);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\n  public captureException(exception: any, hint?: EventHint, scope?: Scope): string | undefined {\n    let eventId: string | undefined = hint && hint.event_id;\n\n    this._process(\n      this._getBackend()\n        .eventFromException(exception, hint)\n        .then(event => this._captureEvent(event, hint, scope))\n        .then(result => {\n          eventId = result;\n        }),\n    );\n\n    return eventId;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public captureMessage(message: string, level?: Severity, hint?: EventHint, scope?: Scope): string | undefined {\n    let eventId: string | undefined = hint && hint.event_id;\n\n    const promisedEvent = isPrimitive(message)\n      ? this._getBackend().eventFromMessage(String(message), level, hint)\n      : this._getBackend().eventFromException(message, hint);\n\n    this._process(\n      promisedEvent\n        .then(event => this._captureEvent(event, hint, scope))\n        .then(result => {\n          eventId = result;\n        }),\n    );\n\n    return eventId;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public captureEvent(event: Event, hint?: EventHint, scope?: Scope): string | undefined {\n    let eventId: string | undefined = hint && hint.event_id;\n\n    this._process(\n      this._captureEvent(event, hint, scope).then(result => {\n        eventId = result;\n      }),\n    );\n\n    return eventId;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public captureSession(session: Session): void {\n    if (!this._isEnabled()) {\n      logger.warn('SDK not enabled, will not capture session.');\n      return;\n    }\n\n    if (!(typeof session.release === 'string')) {\n      logger.warn('Discarded session because of missing or non-string release');\n    } else {\n      this._sendSession(session);\n      // After sending, we set init false to indicate it's not the first occurrence\n      session.update({ init: false });\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getDsn(): Dsn | undefined {\n    return this._dsn;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getOptions(): O {\n    return this._options;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public flush(timeout?: number): PromiseLike<boolean> {\n    return this._isClientProcessing(timeout).then(ready => {\n      return this._getBackend()\n        .getTransport()\n        .close(timeout)\n        .then(transportFlushed => ready && transportFlushed);\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public close(timeout?: number): PromiseLike<boolean> {\n    return this.flush(timeout).then(result => {\n      this.getOptions().enabled = false;\n      return result;\n    });\n  }\n\n  /**\n   * Sets up the integrations\n   */\n  public setupIntegrations(): void {\n    if (this._isEnabled()) {\n      this._integrations = setupIntegrations(this._options);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getIntegration<T extends Integration>(integration: IntegrationClass<T>): T | null {\n    try {\n      return (this._integrations[integration.id] as T) || null;\n    } catch (_oO) {\n      logger.warn(`Cannot retrieve integration ${integration.id} from the current Client`);\n      return null;\n    }\n  }\n\n  /** Updates existing session based on the provided event */\n  protected _updateSessionFromEvent(session: Session, event: Event): void {\n    let crashed = false;\n    let errored = false;\n    const exceptions = event.exception && event.exception.values;\n\n    if (exceptions) {\n      errored = true;\n\n      for (const ex of exceptions) {\n        const mechanism = ex.mechanism;\n        if (mechanism && mechanism.handled === false) {\n          crashed = true;\n          break;\n        }\n      }\n    }\n\n    // A session is updated and that session update is sent in only one of the two following scenarios:\n    // 1. Session with non terminal status and 0 errors + an error occurred -> Will set error count to 1 and send update\n    // 2. Session with non terminal status and 1 error + a crash occurred -> Will set status crashed and send update\n    const sessionNonTerminal = session.status === SessionStatus.Ok;\n    const shouldUpdateAndSend = (sessionNonTerminal && session.errors === 0) || (sessionNonTerminal && crashed);\n\n    if (shouldUpdateAndSend) {\n      session.update({\n        ...(crashed && { status: SessionStatus.Crashed }),\n        errors: session.errors || Number(errored || crashed),\n      });\n      this.captureSession(session);\n    }\n  }\n\n  /** Deliver captured session to Sentry */\n  protected _sendSession(session: Session): void {\n    this._getBackend().sendSession(session);\n  }\n\n  /** Waits for the client to be done with processing. */\n  protected _isClientProcessing(timeout?: number): PromiseLike<boolean> {\n    return new SyncPromise(resolve => {\n      let ticked: number = 0;\n      const tick: number = 1;\n\n      const interval = setInterval(() => {\n        if (this._processing == 0) {\n          clearInterval(interval);\n          resolve(true);\n        } else {\n          ticked += tick;\n          if (timeout && ticked >= timeout) {\n            clearInterval(interval);\n            resolve(false);\n          }\n        }\n      }, tick);\n    });\n  }\n\n  /** Returns the current backend. */\n  protected _getBackend(): B {\n    return this._backend;\n  }\n\n  /** Determines whether this SDK is enabled and a valid Dsn is present. */\n  protected _isEnabled(): boolean {\n    return this.getOptions().enabled !== false && this._dsn !== undefined;\n  }\n\n  /**\n   * Adds common information to events.\n   *\n   * The information includes release and environment from `options`,\n   * breadcrumbs and context (extra, tags and user) from the scope.\n   *\n   * Information that is already present in the event is never overwritten. For\n   * nested objects, such as the context, keys are merged.\n   *\n   * @param event The original event.\n   * @param hint May contain additional information about the original exception.\n   * @param scope A scope containing event metadata.\n   * @returns A new event with more information.\n   */\n  protected _prepareEvent(event: Event, scope?: Scope, hint?: EventHint): PromiseLike<Event | null> {\n    const { normalizeDepth = 3 } = this.getOptions();\n    const prepared: Event = {\n      ...event,\n      event_id: event.event_id || (hint && hint.event_id ? hint.event_id : uuid4()),\n      timestamp: event.timestamp || dateTimestampInSeconds(),\n    };\n\n    this._applyClientOptions(prepared);\n    this._applyIntegrationsMetadata(prepared);\n\n    // If we have scope given to us, use it as the base for further modifications.\n    // This allows us to prevent unnecessary copying of data if `captureContext` is not provided.\n    let finalScope = scope;\n    if (hint && hint.captureContext) {\n      finalScope = Scope.clone(finalScope).update(hint.captureContext);\n    }\n\n    // We prepare the result here with a resolved Event.\n    let result = SyncPromise.resolve<Event | null>(prepared);\n\n    // This should be the last thing called, since we want that\n    // {@link Hub.addEventProcessor} gets the finished prepared event.\n    if (finalScope) {\n      // In case we have a hub we reassign it.\n      result = finalScope.applyToEvent(prepared, hint);\n    }\n\n    return result.then(evt => {\n      if (typeof normalizeDepth === 'number' && normalizeDepth > 0) {\n        return this._normalizeEvent(evt, normalizeDepth);\n      }\n      return evt;\n    });\n  }\n\n  /**\n   * Applies `normalize` function on necessary `Event` attributes to make them safe for serialization.\n   * Normalized keys:\n   * - `breadcrumbs.data`\n   * - `user`\n   * - `contexts`\n   * - `extra`\n   * @param event Event\n   * @returns Normalized event\n   */\n  protected _normalizeEvent(event: Event | null, depth: number): Event | null {\n    if (!event) {\n      return null;\n    }\n\n    const normalized = {\n      ...event,\n      ...(event.breadcrumbs && {\n        breadcrumbs: event.breadcrumbs.map(b => ({\n          ...b,\n          ...(b.data && {\n            data: normalize(b.data, depth),\n          }),\n        })),\n      }),\n      ...(event.user && {\n        user: normalize(event.user, depth),\n      }),\n      ...(event.contexts && {\n        contexts: normalize(event.contexts, depth),\n      }),\n      ...(event.extra && {\n        extra: normalize(event.extra, depth),\n      }),\n    };\n    // event.contexts.trace stores information about a Transaction. Similarly,\n    // event.spans[] stores information about child Spans. Given that a\n    // Transaction is conceptually a Span, normalization should apply to both\n    // Transactions and Spans consistently.\n    // For now the decision is to skip normalization of Transactions and Spans,\n    // so this block overwrites the normalized event to add back the original\n    // Transaction information prior to normalization.\n    if (event.contexts && event.contexts.trace) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      normalized.contexts.trace = event.contexts.trace;\n    }\n    return normalized;\n  }\n\n  /**\n   *  Enhances event using the client configuration.\n   *  It takes care of all \"static\" values like environment, release and `dist`,\n   *  as well as truncating overly long values.\n   * @param event event instance to be enhanced\n   */\n  protected _applyClientOptions(event: Event): void {\n    const options = this.getOptions();\n    const { environment, release, dist, maxValueLength = 250 } = options;\n\n    if (!('environment' in event)) {\n      event.environment = 'environment' in options ? environment : 'production';\n    }\n\n    if (event.release === undefined && release !== undefined) {\n      event.release = release;\n    }\n\n    if (event.dist === undefined && dist !== undefined) {\n      event.dist = dist;\n    }\n\n    if (event.message) {\n      event.message = truncate(event.message, maxValueLength);\n    }\n\n    const exception = event.exception && event.exception.values && event.exception.values[0];\n    if (exception && exception.value) {\n      exception.value = truncate(exception.value, maxValueLength);\n    }\n\n    const request = event.request;\n    if (request && request.url) {\n      request.url = truncate(request.url, maxValueLength);\n    }\n  }\n\n  /**\n   * This function adds all used integrations to the SDK info in the event.\n   * @param event The event that will be filled with all integrations.\n   */\n  protected _applyIntegrationsMetadata(event: Event): void {\n    const integrationsArray = Object.keys(this._integrations);\n    if (integrationsArray.length > 0) {\n      event.sdk = event.sdk || {};\n      event.sdk.integrations = [...(event.sdk.integrations || []), ...integrationsArray];\n    }\n  }\n\n  /**\n   * Tells the backend to send this event\n   * @param event The Sentry event to send\n   */\n  protected _sendEvent(event: Event): void {\n    this._getBackend().sendEvent(event);\n  }\n\n  /**\n   * Processes the event and logs an error in case of rejection\n   * @param event\n   * @param hint\n   * @param scope\n   */\n  protected _captureEvent(event: Event, hint?: EventHint, scope?: Scope): PromiseLike<string | undefined> {\n    return this._processEvent(event, hint, scope).then(\n      finalEvent => {\n        return finalEvent.event_id;\n      },\n      reason => {\n        logger.error(reason);\n        return undefined;\n      },\n    );\n  }\n\n  /**\n   * Processes an event (either error or message) and sends it to Sentry.\n   *\n   * This also adds breadcrumbs and context information to the event. However,\n   * platform specific meta data (such as the User's IP address) must be added\n   * by the SDK implementor.\n   *\n   *\n   * @param event The event to send to Sentry.\n   * @param hint May contain additional information about the original exception.\n   * @param scope A scope containing event metadata.\n   * @returns A SyncPromise that resolves with the event or rejects in case event was/will not be send.\n   */\n  protected _processEvent(event: Event, hint?: EventHint, scope?: Scope): PromiseLike<Event> {\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const { beforeSend, sampleRate } = this.getOptions();\n\n    if (!this._isEnabled()) {\n      return SyncPromise.reject(new SentryError('SDK not enabled, will not capture event.'));\n    }\n\n    const isTransaction = event.type === 'transaction';\n    // 1.0 === 100% events are sent\n    // 0.0 === 0% events are sent\n    // Sampling for transaction happens somewhere else\n    if (!isTransaction && typeof sampleRate === 'number' && Math.random() > sampleRate) {\n      return SyncPromise.reject(\n        new SentryError(\n          `Discarding event because it's not included in the random sample (sampling rate = ${sampleRate})`,\n        ),\n      );\n    }\n\n    return this._prepareEvent(event, scope, hint)\n      .then(prepared => {\n        if (prepared === null) {\n          throw new SentryError('An event processor returned null, will not send event.');\n        }\n\n        const isInternalException = hint && hint.data && (hint.data as { __sentry__: boolean }).__sentry__ === true;\n        if (isInternalException || isTransaction || !beforeSend) {\n          return prepared;\n        }\n\n        const beforeSendResult = beforeSend(prepared, hint);\n        return this._ensureBeforeSendRv(beforeSendResult);\n      })\n      .then(processedEvent => {\n        if (processedEvent === null) {\n          throw new SentryError('`beforeSend` returned `null`, will not send event.');\n        }\n\n        const session = scope && scope.getSession && scope.getSession();\n        if (!isTransaction && session) {\n          this._updateSessionFromEvent(session, processedEvent);\n        }\n\n        this._sendEvent(processedEvent);\n        return processedEvent;\n      })\n      .then(null, reason => {\n        if (reason instanceof SentryError) {\n          throw reason;\n        }\n\n        this.captureException(reason, {\n          data: {\n            __sentry__: true,\n          },\n          originalException: reason as Error,\n        });\n        throw new SentryError(\n          `Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\\nReason: ${reason}`,\n        );\n      });\n  }\n\n  /**\n   * Occupies the client with processing and event\n   */\n  protected _process<T>(promise: PromiseLike<T>): void {\n    this._processing += 1;\n    void promise.then(\n      value => {\n        this._processing -= 1;\n        return value;\n      },\n      reason => {\n        this._processing -= 1;\n        return reason;\n      },\n    );\n  }\n\n  /**\n   * Verifies that return value of configured `beforeSend` is of expected type.\n   */\n  protected _ensureBeforeSendRv(\n    rv: PromiseLike<Event | null> | Event | null,\n  ): PromiseLike<Event | null> | Event | null {\n    const nullErr = '`beforeSend` method has to return `null` or a valid event.';\n    if (isThenable(rv)) {\n      return (rv as PromiseLike<Event | null>).then(\n        event => {\n          if (!(isPlainObject(event) || event === null)) {\n            throw new SentryError(nullErr);\n          }\n          return event;\n        },\n        e => {\n          throw new SentryError(`beforeSend rejected with ${e}`);\n        },\n      );\n    } else if (!(isPlainObject(rv) || rv === null)) {\n      throw new SentryError(nullErr);\n    }\n    return rv;\n  }\n}\n", "import { Event, Response, Status, Transport } from '@sentry/types';\nimport { SyncPromise } from '@sentry/utils';\n\n/** Noop transport */\nexport class NoopTransport implements Transport {\n  /**\n   * @inheritDoc\n   */\n  public sendEvent(_: Event): PromiseLike<Response> {\n    return SyncPromise.resolve({\n      reason: `NoopTransport: Event has been skipped because no Dsn is configured.`,\n      status: Status.Skipped,\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public close(_?: number): PromiseLike<boolean> {\n    return SyncPromise.resolve(true);\n  }\n}\n", "import { Event, EventHint, Options, Session, Severity, Transport } from '@sentry/types';\nimport { logger, SentryError } from '@sentry/utils';\n\nimport { NoopTransport } from './transports/noop';\n\n/**\n * Internal platform-dependent Sentry SDK Backend.\n *\n * While {@link Client} contains business logic specific to an SDK, the\n * Backend offers platform specific implementations for low-level operations.\n * These are persisting and loading information, sending events, and hooking\n * into the environment.\n *\n * Backends receive a handle to the Client in their constructor. When a\n * Backend automatically generates events, it must pass them to\n * the Client for validation and processing first.\n *\n * Usually, the Client will be of corresponding type, e.g. NodeBackend\n * receives NodeClient. However, higher-level SDKs can choose to instantiate\n * multiple Backends and delegate tasks between them. In this case, an event\n * generated by one backend might very well be sent by another one.\n *\n * The client also provides access to options via {@link Client.getOptions}.\n * @hidden\n */\nexport interface Backend {\n  /** Creates a {@link Event} from an exception. */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  eventFromException(exception: any, hint?: EventHint): PromiseLike<Event>;\n\n  /** Creates a {@link Event} from a plain message. */\n  eventFromMessage(message: string, level?: Severity, hint?: EventHint): PromiseLike<Event>;\n\n  /** Submits the event to Sentry */\n  sendEvent(event: Event): void;\n\n  /** Submits the session to Sentry */\n  sendSession(session: Session): void;\n\n  /**\n   * Returns the transport that is used by the backend.\n   * Please note that the transport gets lazy initialized so it will only be there once the first event has been sent.\n   *\n   * @returns The transport.\n   */\n  getTransport(): Transport;\n}\n\n/**\n * A class object that can instantiate Backend objects.\n * @hidden\n */\nexport type BackendClass<B extends Backend, O extends Options> = new (options: O) => B;\n\n/**\n * This is the base implemention of a Backend.\n * @hidden\n */\nexport abstract class BaseBackend<O extends Options> implements Backend {\n  /** Options passed to the SDK. */\n  protected readonly _options: O;\n\n  /** Cached transport used internally. */\n  protected _transport: Transport;\n\n  /** Creates a new backend instance. */\n  public constructor(options: O) {\n    this._options = options;\n    if (!this._options.dsn) {\n      logger.warn('No DSN provided, backend will not do anything.');\n    }\n    this._transport = this._setupTransport();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\n  public eventFromException(_exception: any, _hint?: EventHint): PromiseLike<Event> {\n    throw new SentryError('Backend has to implement `eventFromException` method');\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public eventFromMessage(_message: string, _level?: Severity, _hint?: EventHint): PromiseLike<Event> {\n    throw new SentryError('Backend has to implement `eventFromMessage` method');\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public sendEvent(event: Event): void {\n    void this._transport.sendEvent(event).then(null, reason => {\n      logger.error(`Error while sending event: ${reason}`);\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public sendSession(session: Session): void {\n    if (!this._transport.sendSession) {\n      logger.warn(\"Dropping session because custom transport doesn't implement sendSession\");\n      return;\n    }\n\n    void this._transport.sendSession(session).then(null, reason => {\n      logger.error(`Error while sending session: ${reason}`);\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getTransport(): Transport {\n    return this._transport;\n  }\n\n  /**\n   * Sets up the transport so it can be used later to send requests.\n   */\n  protected _setupTransport(): Transport {\n    return new NoopTransport();\n  }\n}\n", "import { Event, SdkInfo, SentryRequest, SentryRequestType, Session, SessionAggregates } from '@sentry/types';\n\nimport { API } from './api';\n\n/** Extract sdk info from from the API metadata */\nfunction getSdkMetadataForEnvelopeHeader(api: API): SdkInfo | undefined {\n  if (!api.metadata || !api.metadata.sdk) {\n    return;\n  }\n  const { name, version } = api.metadata.sdk;\n  return { name, version };\n}\n\n/**\n * Apply SdkInfo (name, version, packages, integrations) to the corresponding event key.\n * Merge with existing data if any.\n **/\nfunction enhanceEventWithSdkInfo(event: Event, sdkInfo?: SdkInfo): Event {\n  if (!sdkInfo) {\n    return event;\n  }\n  event.sdk = event.sdk || {};\n  event.sdk.name = event.sdk.name || sdkInfo.name;\n  event.sdk.version = event.sdk.version || sdkInfo.version;\n  event.sdk.integrations = [...(event.sdk.integrations || []), ...(sdkInfo.integrations || [])];\n  event.sdk.packages = [...(event.sdk.packages || []), ...(sdkInfo.packages || [])];\n  return event;\n}\n\n/** Creates a SentryRequest from a Session. */\nexport function sessionToSentryRequest(session: Session | SessionAggregates, api: API): SentryRequest {\n  const sdkInfo = getSdkMetadataForEnvelopeHeader(api);\n  const envelopeHeaders = JSON.stringify({\n    sent_at: new Date().toISOString(),\n    ...(sdkInfo && { sdk: sdkInfo }),\n    ...(api.forceEnvelope() && { dsn: api.getDsn().toString() }),\n  });\n  // I know this is hacky but we don't want to add `session` to request type since it's never rate limited\n  const type: SentryRequestType = 'aggregates' in session ? ('sessions' as SentryRequestType) : 'session';\n  const itemHeaders = JSON.stringify({\n    type,\n  });\n\n  return {\n    body: `${envelopeHeaders}\\n${itemHeaders}\\n${JSON.stringify(session)}`,\n    type,\n    url: api.getEnvelopeEndpointWithUrlEncodedAuth(),\n  };\n}\n\n/** Creates a SentryRequest from an event. */\nexport function eventToSentryRequest(event: Event, api: API): SentryRequest {\n  const sdkInfo = getSdkMetadataForEnvelopeHeader(api);\n  const eventType = event.type || 'event';\n  const useEnvelope = eventType === 'transaction' || api.forceEnvelope();\n\n  const { transactionSampling, ...metadata } = event.debug_meta || {};\n  const { method: samplingMethod, rate: sampleRate } = transactionSampling || {};\n  if (Object.keys(metadata).length === 0) {\n    delete event.debug_meta;\n  } else {\n    event.debug_meta = metadata;\n  }\n\n  const req: SentryRequest = {\n    body: JSON.stringify(sdkInfo ? enhanceEventWithSdkInfo(event, api.metadata.sdk) : event),\n    type: eventType,\n    url: useEnvelope ? api.getEnvelopeEndpointWithUrlEncodedAuth() : api.getStoreEndpointWithUrlEncodedAuth(),\n  };\n\n  // https://develop.sentry.dev/sdk/envelopes/\n\n  // Since we don't need to manipulate envelopes nor store them, there is no\n  // exported concept of an Envelope with operations including serialization and\n  // deserialization. Instead, we only implement a minimal subset of the spec to\n  // serialize events inline here.\n  if (useEnvelope) {\n    const envelopeHeaders = JSON.stringify({\n      event_id: event.event_id,\n      sent_at: new Date().toISOString(),\n      ...(sdkInfo && { sdk: sdkInfo }),\n      ...(api.forceEnvelope() && { dsn: api.getDsn().toString() }),\n    });\n    const itemHeaders = JSON.stringify({\n      type: eventType,\n\n      // TODO: Right now, sampleRate may or may not be defined (it won't be in the cases of inheritance and\n      // explicitly-set sampling decisions). Are we good with that?\n      sample_rates: [{ id: samplingMethod, rate: sampleRate }],\n\n      // The content-type is assumed to be 'application/json' and not part of\n      // the current spec for transaction items, so we don't bloat the request\n      // body with it.\n      //\n      // content_type: 'application/json',\n      //\n      // The length is optional. It must be the number of bytes in req.Body\n      // encoded as UTF-8. Since the server can figure this out and would\n      // otherwise refuse events that report the length incorrectly, we decided\n      // not to send the length to avoid problems related to reporting the wrong\n      // size and to reduce request body size.\n      //\n      // length: new TextEncoder().encode(req.body).length,\n    });\n    // The trailing newline is optional. We intentionally don't send it to avoid\n    // sending unnecessary bytes.\n    //\n    // const envelope = `${envelopeHeaders}\\n${itemHeaders}\\n${req.body}\\n`;\n    const envelope = `${envelopeHeaders}\\n${itemHeaders}\\n${req.body}`;\n    req.body = envelope;\n  }\n\n  return req;\n}\n", "import { getCurrentHub } from '@sentry/hub';\nimport { Client, Options } from '@sentry/types';\nimport { logger } from '@sentry/utils';\n\n/** A class object that can instantiate Client objects. */\nexport type ClientClass<F extends Client, O extends Options> = new (options: O) => F;\n\n/**\n * Internal function to create a new SDK client instance. The client is\n * installed and then bound to the current scope.\n *\n * @param clientClass The client class to instantiate.\n * @param options Options to pass to the client.\n */\nexport function initAndBind<F extends Client, O extends Options>(clientClass: ClientClass<F, O>, options: O): void {\n  if (options.debug === true) {\n    logger.enable();\n  }\n  const hub = getCurrentHub();\n  hub.getScope()?.update(options.initialScope);\n  const client = new clientClass(options);\n  hub.bindClient(client);\n}\n", "export const SDK_VERSION = '6.8.0';\n", "import { Integration, WrappedFunction } from '@sentry/types';\n\nlet originalFunctionToString: () => void;\n\n/** Patch toString calls to return proper name for wrapped functions */\nexport class FunctionToString implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'FunctionToString';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = FunctionToString.id;\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(): void {\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    originalFunctionToString = Function.prototype.toString;\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    Function.prototype.toString = function(this: WrappedFunction, ...args: any[]): string {\n      const context = this.__sentry_original__ || this;\n      return originalFunctionToString.apply(context, args);\n    };\n  }\n}\n", "import { addGlobalEventProcessor, getCurrentHub } from '@sentry/hub';\nimport { Event, Integration } from '@sentry/types';\nimport { getEventDescription, isMatchingPattern, logger } from '@sentry/utils';\n\n// \"Script error.\" is hard coded into browsers for errors that it can't read.\n// this is the result of a script being pulled in from an external domain and CORS.\nconst DEFAULT_IGNORE_ERRORS = [/^Script error\\.?$/, /^Javascript error: Script error\\.? on line 0$/];\n\n/** JSDoc */\ninterface InboundFiltersOptions {\n  allowUrls: Array<string | RegExp>;\n  denyUrls: Array<string | RegExp>;\n  ignoreErrors: Array<string | RegExp>;\n  ignoreInternal: boolean;\n\n  /** @deprecated use {@link InboundFiltersOptions.allowUrls} instead. */\n  whitelistUrls: Array<string | RegExp>;\n  /** @deprecated use {@link InboundFiltersOptions.denyUrls} instead. */\n  blacklistUrls: Array<string | RegExp>;\n}\n\n/** Inbound filters configurable by the user */\nexport class InboundFilters implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'InboundFilters';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = InboundFilters.id;\n\n  public constructor(private readonly _options: Partial<InboundFiltersOptions> = {}) {}\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(): void {\n    addGlobalEventProcessor((event: Event) => {\n      const hub = getCurrentHub();\n      if (!hub) {\n        return event;\n      }\n      const self = hub.getIntegration(InboundFilters);\n      if (self) {\n        const client = hub.getClient();\n        const clientOptions = client ? client.getOptions() : {};\n        // This checks prevents most of the occurrences of the bug linked below:\n        // https://github.com/getsentry/sentry-javascript/issues/2622\n        // The bug is caused by multiple SDK instances, where one is minified and one is using non-mangled code.\n        // Unfortunatelly we cannot fix it reliably (thus reserved property in rollup's terser config),\n        // as we cannot force people using multiple instances in their apps to sync SDK versions.\n        const options = typeof self._mergeOptions === 'function' ? self._mergeOptions(clientOptions) : {};\n        if (typeof self._shouldDropEvent !== 'function') {\n          return event;\n        }\n        return self._shouldDropEvent(event, options) ? null : event;\n      }\n      return event;\n    });\n  }\n\n  /** JSDoc */\n  private _shouldDropEvent(event: Event, options: Partial<InboundFiltersOptions>): boolean {\n    if (this._isSentryError(event, options)) {\n      logger.warn(`Event dropped due to being internal Sentry Error.\\nEvent: ${getEventDescription(event)}`);\n      return true;\n    }\n    if (this._isIgnoredError(event, options)) {\n      logger.warn(\n        `Event dropped due to being matched by \\`ignoreErrors\\` option.\\nEvent: ${getEventDescription(event)}`,\n      );\n      return true;\n    }\n    if (this._isDeniedUrl(event, options)) {\n      logger.warn(\n        `Event dropped due to being matched by \\`denyUrls\\` option.\\nEvent: ${getEventDescription(\n          event,\n        )}.\\nUrl: ${this._getEventFilterUrl(event)}`,\n      );\n      return true;\n    }\n    if (!this._isAllowedUrl(event, options)) {\n      logger.warn(\n        `Event dropped due to not being matched by \\`allowUrls\\` option.\\nEvent: ${getEventDescription(\n          event,\n        )}.\\nUrl: ${this._getEventFilterUrl(event)}`,\n      );\n      return true;\n    }\n    return false;\n  }\n\n  /** JSDoc */\n  private _isSentryError(event: Event, options: Partial<InboundFiltersOptions>): boolean {\n    if (!options.ignoreInternal) {\n      return false;\n    }\n\n    try {\n      return (\n        (event &&\n          event.exception &&\n          event.exception.values &&\n          event.exception.values[0] &&\n          event.exception.values[0].type === 'SentryError') ||\n        false\n      );\n    } catch (_oO) {\n      return false;\n    }\n  }\n\n  /** JSDoc */\n  private _isIgnoredError(event: Event, options: Partial<InboundFiltersOptions>): boolean {\n    if (!options.ignoreErrors || !options.ignoreErrors.length) {\n      return false;\n    }\n\n    return this._getPossibleEventMessages(event).some(message =>\n      // Not sure why TypeScript complains here...\n      (options.ignoreErrors as Array<RegExp | string>).some(pattern => isMatchingPattern(message, pattern)),\n    );\n  }\n\n  /** JSDoc */\n  private _isDeniedUrl(event: Event, options: Partial<InboundFiltersOptions>): boolean {\n    // TODO: Use Glob instead?\n    if (!options.denyUrls || !options.denyUrls.length) {\n      return false;\n    }\n    const url = this._getEventFilterUrl(event);\n    return !url ? false : options.denyUrls.some(pattern => isMatchingPattern(url, pattern));\n  }\n\n  /** JSDoc */\n  private _isAllowedUrl(event: Event, options: Partial<InboundFiltersOptions>): boolean {\n    // TODO: Use Glob instead?\n    if (!options.allowUrls || !options.allowUrls.length) {\n      return true;\n    }\n    const url = this._getEventFilterUrl(event);\n    return !url ? true : options.allowUrls.some(pattern => isMatchingPattern(url, pattern));\n  }\n\n  /** JSDoc */\n  private _mergeOptions(clientOptions: Partial<InboundFiltersOptions> = {}): Partial<InboundFiltersOptions> {\n    return {\n      allowUrls: [\n        // eslint-disable-next-line deprecation/deprecation\n        ...(this._options.whitelistUrls || []),\n        ...(this._options.allowUrls || []),\n        // eslint-disable-next-line deprecation/deprecation\n        ...(clientOptions.whitelistUrls || []),\n        ...(clientOptions.allowUrls || []),\n      ],\n      denyUrls: [\n        // eslint-disable-next-line deprecation/deprecation\n        ...(this._options.blacklistUrls || []),\n        ...(this._options.denyUrls || []),\n        // eslint-disable-next-line deprecation/deprecation\n        ...(clientOptions.blacklistUrls || []),\n        ...(clientOptions.denyUrls || []),\n      ],\n      ignoreErrors: [\n        ...(this._options.ignoreErrors || []),\n        ...(clientOptions.ignoreErrors || []),\n        ...DEFAULT_IGNORE_ERRORS,\n      ],\n      ignoreInternal: typeof this._options.ignoreInternal !== 'undefined' ? this._options.ignoreInternal : true,\n    };\n  }\n\n  /** JSDoc */\n  private _getPossibleEventMessages(event: Event): string[] {\n    if (event.message) {\n      return [event.message];\n    }\n    if (event.exception) {\n      try {\n        const { type = '', value = '' } = (event.exception.values && event.exception.values[0]) || {};\n        return [`${value}`, `${type}: ${value}`];\n      } catch (oO) {\n        logger.error(`Cannot extract message for event ${getEventDescription(event)}`);\n        return [];\n      }\n    }\n    return [];\n  }\n\n  /** JSDoc */\n  private _getEventFilterUrl(event: Event): string | null {\n    try {\n      if (event.stacktrace) {\n        const frames = event.stacktrace.frames;\n        return (frames && frames[frames.length - 1].filename) || null;\n      }\n      if (event.exception) {\n        const frames =\n          event.exception.values && event.exception.values[0].stacktrace && event.exception.values[0].stacktrace.frames;\n        return (frames && frames[frames.length - 1].filename) || null;\n      }\n      return null;\n    } catch (oO) {\n      logger.error(`Cannot extract url for event ${getEventDescription(event)}`);\n      return null;\n    }\n  }\n}\n", "export { FunctionToString } from './functiontostring';\nexport { InboundFilters } from './inboundfilters';\n", "export {\n  addBreadcrumb,\n  captureException,\n  captureEvent,\n  captureMessage,\n  configureScope,\n  startTransaction,\n  setContext,\n  setExtra,\n  setExtras,\n  setTag,\n  setTags,\n  setUser,\n  withScope,\n} from '@sentry/minimal';\nexport { addGlobalEventProcessor, getCurrentHub, getHubFromCarrier, Hub, makeMain, Scope } from '@sentry/hub';\nexport { API } from './api';\nexport { BaseClient } from './baseclient';\nexport { BackendClass, BaseBackend } from './basebackend';\nexport { eventToSentryRequest, sessionToSentryRequest } from './request';\nexport { initAndBind, ClientClass } from './sdk';\nexport { NoopTransport } from './transports/noop';\nexport { SDK_VERSION } from './version';\n\nimport * as Integrations from './integrations';\n\nexport { Integrations };\n", "/**\n * A doubly linked list-based Least Recently Used (LRU) cache. Will keep most\n * recently used items while discarding least recently used items when its limit\n * is reached.\n *\n * Licensed under MIT. Copyright (c) 2010 Rasmus Andersson <http://hunch.se/>\n * See README.md for details.\n *\n * Illustration of the design:\n *\n *       entry             entry             entry             entry\n *       ______            ______            ______            ______\n *      | head |.newer => |      |.newer => |      |.newer => | tail |\n *      |  A   |          |  B   |          |  C   |          |  D   |\n *      |______| <= older.|______| <= older.|______| <= older.|______|\n *\n *  removed  <--  <--  <--  <--  <--  <--  <--  <--  <--  <--  <--  added\n */\n(function(g,f){\n  const e = typeof exports == 'object' ? exports : typeof g == 'object' ? g : {};\n  f(e);\n  if (typeof define == 'function' && define.amd) { define('lru', e); }\n})(this, function(exports) {\n\nconst NEWER = Symbol('newer');\nconst OLDER = Symbol('older');\n\nfunction LRUMap(limit, entries) {\n  if (typeof limit !== 'number') {\n    // called as (entries)\n    entries = limit;\n    limit = 0;\n  }\n\n  this.size = 0;\n  this.limit = limit;\n  this.oldest = this.newest = undefined;\n  this._keymap = new Map();\n\n  if (entries) {\n    this.assign(entries);\n    if (limit < 1) {\n      this.limit = this.size;\n    }\n  }\n}\n\nexports.LRUMap = LRUMap;\n\nfunction Entry(key, value) {\n  this.key = key;\n  this.value = value;\n  this[NEWER] = undefined;\n  this[OLDER] = undefined;\n}\n\n\nLRUMap.prototype._markEntryAsUsed = function(entry) {\n  if (entry === this.newest) {\n    // Already the most recenlty used entry, so no need to update the list\n    return;\n  }\n  // HEAD--------------TAIL\n  //   <.older   .newer>\n  //  <--- add direction --\n  //   A  B  C  <D>  E\n  if (entry[NEWER]) {\n    if (entry === this.oldest) {\n      this.oldest = entry[NEWER];\n    }\n    entry[NEWER][OLDER] = entry[OLDER]; // C <-- E.\n  }\n  if (entry[OLDER]) {\n    entry[OLDER][NEWER] = entry[NEWER]; // C. --> E\n  }\n  entry[NEWER] = undefined; // D --x\n  entry[OLDER] = this.newest; // D. --> E\n  if (this.newest) {\n    this.newest[NEWER] = entry; // E. <-- D\n  }\n  this.newest = entry;\n};\n\nLRUMap.prototype.assign = function(entries) {\n  let entry, limit = this.limit || Number.MAX_VALUE;\n  this._keymap.clear();\n  let it = entries[Symbol.iterator]();\n  for (let itv = it.next(); !itv.done; itv = it.next()) {\n    let e = new Entry(itv.value[0], itv.value[1]);\n    this._keymap.set(e.key, e);\n    if (!entry) {\n      this.oldest = e;\n    } else {\n      entry[NEWER] = e;\n      e[OLDER] = entry;\n    }\n    entry = e;\n    if (limit-- == 0) {\n      throw new Error('overflow');\n    }\n  }\n  this.newest = entry;\n  this.size = this._keymap.size;\n};\n\nLRUMap.prototype.get = function(key) {\n  // First, find our cache entry\n  var entry = this._keymap.get(key);\n  if (!entry) return; // Not cached. Sorry.\n  // As <key> was found in the cache, register it as being requested recently\n  this._markEntryAsUsed(entry);\n  return entry.value;\n};\n\nLRUMap.prototype.set = function(key, value) {\n  var entry = this._keymap.get(key);\n\n  if (entry) {\n    // update existing\n    entry.value = value;\n    this._markEntryAsUsed(entry);\n    return this;\n  }\n\n  // new entry\n  this._keymap.set(key, (entry = new Entry(key, value)));\n\n  if (this.newest) {\n    // link previous tail to the new tail (entry)\n    this.newest[NEWER] = entry;\n    entry[OLDER] = this.newest;\n  } else {\n    // we're first in -- yay\n    this.oldest = entry;\n  }\n\n  // add new entry to the end of the linked list -- it's now the freshest entry.\n  this.newest = entry;\n  ++this.size;\n  if (this.size > this.limit) {\n    // we hit the limit -- remove the head\n    this.shift();\n  }\n\n  return this;\n};\n\nLRUMap.prototype.shift = function() {\n  // todo: handle special case when limit == 1\n  var entry = this.oldest;\n  if (entry) {\n    if (this.oldest[NEWER]) {\n      // advance the list\n      this.oldest = this.oldest[NEWER];\n      this.oldest[OLDER] = undefined;\n    } else {\n      // the cache is exhausted\n      this.oldest = undefined;\n      this.newest = undefined;\n    }\n    // Remove last strong reference to <entry> and remove links from the purged\n    // entry being returned:\n    entry[NEWER] = entry[OLDER] = undefined;\n    this._keymap.delete(entry.key);\n    --this.size;\n    return [entry.key, entry.value];\n  }\n};\n\n// ----------------------------------------------------------------------------\n// Following code is optional and can be removed without breaking the core\n// functionality.\n\nLRUMap.prototype.find = function(key) {\n  let e = this._keymap.get(key);\n  return e ? e.value : undefined;\n};\n\nLRUMap.prototype.has = function(key) {\n  return this._keymap.has(key);\n};\n\nLRUMap.prototype['delete'] = function(key) {\n  var entry = this._keymap.get(key);\n  if (!entry) return;\n  this._keymap.delete(entry.key);\n  if (entry[NEWER] && entry[OLDER]) {\n    // relink the older entry with the newer entry\n    entry[OLDER][NEWER] = entry[NEWER];\n    entry[NEWER][OLDER] = entry[OLDER];\n  } else if (entry[NEWER]) {\n    // remove the link to us\n    entry[NEWER][OLDER] = undefined;\n    // link the newer entry to head\n    this.oldest = entry[NEWER];\n  } else if (entry[OLDER]) {\n    // remove the link to us\n    entry[OLDER][NEWER] = undefined;\n    // link the newer entry to head\n    this.newest = entry[OLDER];\n  } else {// if(entry[OLDER] === undefined && entry.newer === undefined) {\n    this.oldest = this.newest = undefined;\n  }\n\n  this.size--;\n  return entry.value;\n};\n\nLRUMap.prototype.clear = function() {\n  // Not clearing links should be safe, as we don't expose live links to user\n  this.oldest = this.newest = undefined;\n  this.size = 0;\n  this._keymap.clear();\n};\n\n\nfunction EntryIterator(oldestEntry) { this.entry = oldestEntry; }\nEntryIterator.prototype[Symbol.iterator] = function() { return this; }\nEntryIterator.prototype.next = function() {\n  let ent = this.entry;\n  if (ent) {\n    this.entry = ent[NEWER];\n    return { done: false, value: [ent.key, ent.value] };\n  } else {\n    return { done: true, value: undefined };\n  }\n};\n\n\nfunction KeyIterator(oldestEntry) { this.entry = oldestEntry; }\nKeyIterator.prototype[Symbol.iterator] = function() { return this; }\nKeyIterator.prototype.next = function() {\n  let ent = this.entry;\n  if (ent) {\n    this.entry = ent[NEWER];\n    return { done: false, value: ent.key };\n  } else {\n    return { done: true, value: undefined };\n  }\n};\n\nfunction ValueIterator(oldestEntry) { this.entry = oldestEntry; }\nValueIterator.prototype[Symbol.iterator] = function() { return this; }\nValueIterator.prototype.next = function() {\n  let ent = this.entry;\n  if (ent) {\n    this.entry = ent[NEWER];\n    return { done: false, value: ent.value };\n  } else {\n    return { done: true, value: undefined };\n  }\n};\n\n\nLRUMap.prototype.keys = function() {\n  return new KeyIterator(this.oldest);\n};\n\nLRUMap.prototype.values = function() {\n  return new ValueIterator(this.oldest);\n};\n\nLRUMap.prototype.entries = function() {\n  return this;\n};\n\nLRUMap.prototype[Symbol.iterator] = function() {\n  return new EntryIterator(this.oldest);\n};\n\nLRUMap.prototype.forEach = function(fun, thisObj) {\n  if (typeof thisObj !== 'object') {\n    thisObj = this;\n  }\n  let entry = this.oldest;\n  while (entry) {\n    fun.call(thisObj, entry.value, entry.key, this);\n    entry = entry[NEWER];\n  }\n};\n\n/** Returns a JSON (array) representation */\nLRUMap.prototype.toJSON = function() {\n  var s = new Array(this.size), i = 0, entry = this.oldest;\n  while (entry) {\n    s[i++] = { key: entry.key, value: entry.value };\n    entry = entry[NEWER];\n  }\n  return s;\n};\n\n/** Returns a String representation */\nLRUMap.prototype.toString = function() {\n  var s = '', entry = this.oldest;\n  while (entry) {\n    s += String(entry.key)+':'+entry.value;\n    entry = entry[NEWER];\n    if (entry) {\n      s += ' < ';\n    }\n  }\n  return s;\n};\n\n});\n", "/**\n * stack-trace - Parses node.js stack traces\n *\n * This was originally forked to fix this issue:\n * https://github.com/felixge/node-stack-trace/issues/31\n *\n * Mar 19,2019 - #4fd379e\n *\n * https://github.com/felixge/node-stack-trace/\n * @license MIT\n */\n\n/** Decoded StackFrame */\nexport interface StackFrame {\n  fileName: string;\n  lineNumber: number;\n  functionName: string;\n  typeName: string;\n  methodName: string;\n  native: boolean;\n  columnNumber: number;\n}\n\n/** Extracts StackFrames from the Error */\nexport function parse(err: Error): StackFrame[] {\n  if (!err.stack) {\n    return [];\n  }\n\n  const lines = err.stack.split('\\n').slice(1);\n\n  return lines\n    .map(line => {\n      if (line.match(/^\\s*[-]{4,}$/)) {\n        return {\n          columnNumber: null,\n          fileName: line,\n          functionName: null,\n          lineNumber: null,\n          methodName: null,\n          native: null,\n          typeName: null,\n        };\n      }\n\n      const lineMatch = line.match(/at (?:(.+?)\\s+\\()?(?:(.+?):(\\d+)(?::(\\d+))?|([^)]+))\\)?/);\n      if (!lineMatch) {\n        return undefined;\n      }\n\n      let object = null;\n      let method = null;\n      let functionName = null;\n      let typeName = null;\n      let methodName = null;\n      const isNative = lineMatch[5] === 'native';\n\n      if (lineMatch[1]) {\n        functionName = lineMatch[1];\n        let methodStart = functionName.lastIndexOf('.');\n        if (functionName[methodStart - 1] === '.') {\n          // eslint-disable-next-line no-plusplus\n          methodStart--;\n        }\n        if (methodStart > 0) {\n          object = functionName.substr(0, methodStart);\n          method = functionName.substr(methodStart + 1);\n          const objectEnd = object.indexOf('.Module');\n          if (objectEnd > 0) {\n            functionName = functionName.substr(objectEnd + 1);\n            object = object.substr(0, objectEnd);\n          }\n        }\n        typeName = null;\n      }\n\n      if (method) {\n        typeName = object;\n        methodName = method;\n      }\n\n      if (method === '<anonymous>') {\n        methodName = null;\n        functionName = null;\n      }\n\n      const properties = {\n        columnNumber: parseInt(lineMatch[4], 10) || null,\n        fileName: lineMatch[2] || null,\n        functionName,\n        lineNumber: parseInt(lineMatch[3], 10) || null,\n        methodName,\n        native: isNative,\n        typeName,\n      };\n\n      return properties;\n    })\n    .filter(callSite => !!callSite) as StackFrame[];\n}\n", "import { Event, Exception, ExtendedError, StackFrame } from '@sentry/types';\nimport { addContextToFrame, basename, dirname, SyncPromise } from '@sentry/utils';\nimport { readFile } from 'fs';\nimport { LRUMap } from 'lru_map';\n\nimport * as stacktrace from './stacktrace';\nimport { NodeOptions } from './types';\n\nconst DEFAULT_LINES_OF_CONTEXT: number = 7;\nconst FILE_CONTENT_CACHE = new LRUMap<string, string | null>(100);\n\n/**\n * Resets the file cache. Exists for testing purposes.\n * @hidden\n */\nexport function resetFileContentCache(): void {\n  FILE_CONTENT_CACHE.clear();\n}\n\n/** JSDoc */\nfunction getFunction(frame: stacktrace.StackFrame): string {\n  try {\n    return frame.functionName || `${frame.typeName}.${frame.methodName || '<anonymous>'}`;\n  } catch (e) {\n    // This seems to happen sometimes when using 'use strict',\n    // stemming from `getTypeName`.\n    // [TypeError: Cannot read property 'constructor' of undefined]\n    return '<anonymous>';\n  }\n}\n\nconst mainModule: string = `${(require.main && require.main.filename && dirname(require.main.filename)) ||\n  global.process.cwd()}/`;\n\n/** JSDoc */\nfunction getModule(filename: string, base?: string): string {\n  if (!base) {\n    // eslint-disable-next-line no-param-reassign\n    base = mainModule;\n  }\n\n  // It's specifically a module\n  const file = basename(filename, '.js');\n  // eslint-disable-next-line no-param-reassign\n  filename = dirname(filename);\n  let n = filename.lastIndexOf('/node_modules/');\n  if (n > -1) {\n    // /node_modules/ is 14 chars\n    return `${filename.substr(n + 14).replace(/\\//g, '.')}:${file}`;\n  }\n  // Let's see if it's a part of the main module\n  // To be a part of main module, it has to share the same base\n  n = `${filename}/`.lastIndexOf(base, 0);\n  if (n === 0) {\n    let moduleName = filename.substr(base.length).replace(/\\//g, '.');\n    if (moduleName) {\n      moduleName += ':';\n    }\n    moduleName += file;\n    return moduleName;\n  }\n  return file;\n}\n\n/**\n * This function reads file contents and caches them in a global LRU cache.\n * Returns a Promise filepath => content array for all files that we were able to read.\n *\n * @param filenames Array of filepaths to read content from.\n */\nfunction readSourceFiles(filenames: string[]): PromiseLike<{ [key: string]: string | null }> {\n  // we're relying on filenames being de-duped already\n  if (filenames.length === 0) {\n    return SyncPromise.resolve({});\n  }\n\n  return new SyncPromise<{\n    [key: string]: string | null;\n  }>(resolve => {\n    const sourceFiles: {\n      [key: string]: string | null;\n    } = {};\n\n    let count = 0;\n    // eslint-disable-next-line @typescript-eslint/prefer-for-of\n    for (let i = 0; i < filenames.length; i++) {\n      const filename = filenames[i];\n\n      const cache = FILE_CONTENT_CACHE.get(filename);\n      // We have a cache hit\n      if (cache !== undefined) {\n        // If it's not null (which means we found a file and have a content)\n        // we set the content and return it later.\n        if (cache !== null) {\n          sourceFiles[filename] = cache;\n        }\n        // eslint-disable-next-line no-plusplus\n        count++;\n        // In any case we want to skip here then since we have a content already or we couldn't\n        // read the file and don't want to try again.\n        if (count === filenames.length) {\n          resolve(sourceFiles);\n        }\n        continue;\n      }\n\n      readFile(filename, (err: Error | null, data: Buffer) => {\n        const content = err ? null : data.toString();\n        sourceFiles[filename] = content;\n\n        // We always want to set the cache, even to null which means there was an error reading the file.\n        // We do not want to try to read the file again.\n        FILE_CONTENT_CACHE.set(filename, content);\n        // eslint-disable-next-line no-plusplus\n        count++;\n        if (count === filenames.length) {\n          resolve(sourceFiles);\n        }\n      });\n    }\n  });\n}\n\n/**\n * @hidden\n */\nexport function extractStackFromError(error: Error): stacktrace.StackFrame[] {\n  const stack = stacktrace.parse(error);\n  if (!stack) {\n    return [];\n  }\n  return stack;\n}\n\n/**\n * @hidden\n */\nexport function parseStack(stack: stacktrace.StackFrame[], options?: NodeOptions): PromiseLike<StackFrame[]> {\n  const filesToRead: string[] = [];\n\n  const linesOfContext =\n    options && options.frameContextLines !== undefined ? options.frameContextLines : DEFAULT_LINES_OF_CONTEXT;\n\n  const frames: StackFrame[] = stack.map(frame => {\n    const parsedFrame: StackFrame = {\n      colno: frame.columnNumber,\n      filename: frame.fileName?.startsWith('file://') ? frame.fileName.substr(7) : frame.fileName || '',\n      function: getFunction(frame),\n      lineno: frame.lineNumber,\n    };\n\n    const isInternal =\n      frame.native ||\n      (parsedFrame.filename &&\n        !parsedFrame.filename.startsWith('/') &&\n        !parsedFrame.filename.startsWith('.') &&\n        parsedFrame.filename.indexOf(':\\\\') !== 1);\n\n    // in_app is all that's not an internal Node function or a module within node_modules\n    // note that isNative appears to return true even for node core libraries\n    // see https://github.com/getsentry/raven-node/issues/176\n    parsedFrame.in_app =\n      !isInternal && parsedFrame.filename !== undefined && parsedFrame.filename.indexOf('node_modules/') === -1;\n\n    // Extract a module name based on the filename\n    if (parsedFrame.filename) {\n      parsedFrame.module = getModule(parsedFrame.filename);\n\n      if (!isInternal && linesOfContext > 0 && filesToRead.indexOf(parsedFrame.filename) === -1) {\n        filesToRead.push(parsedFrame.filename);\n      }\n    }\n\n    return parsedFrame;\n  });\n\n  // We do an early return if we do not want to fetch context liens\n  if (linesOfContext <= 0) {\n    return SyncPromise.resolve(frames);\n  }\n\n  try {\n    return addPrePostContext(filesToRead, frames, linesOfContext);\n  } catch (_) {\n    // This happens in electron for example where we are not able to read files from asar.\n    // So it's fine, we recover be just returning all frames without pre/post context.\n    return SyncPromise.resolve(frames);\n  }\n}\n\n/**\n * This function tries to read the source files + adding pre and post context (source code)\n * to a frame.\n * @param filesToRead string[] of filepaths\n * @param frames StackFrame[] containg all frames\n */\nfunction addPrePostContext(\n  filesToRead: string[],\n  frames: StackFrame[],\n  linesOfContext: number,\n): PromiseLike<StackFrame[]> {\n  return new SyncPromise<StackFrame[]>(resolve =>\n    readSourceFiles(filesToRead).then(sourceFiles => {\n      const result = frames.map(frame => {\n        if (frame.filename && sourceFiles[frame.filename]) {\n          try {\n            const lines = (sourceFiles[frame.filename] as string).split('\\n');\n\n            addContextToFrame(lines, frame, linesOfContext);\n          } catch (e) {\n            // anomaly, being defensive in case\n            // unlikely to ever happen in practice but can definitely happen in theory\n          }\n        }\n        return frame;\n      });\n\n      resolve(result);\n    }),\n  );\n}\n\n/**\n * @hidden\n */\nexport function getExceptionFromError(error: Error, options?: NodeOptions): PromiseLike<Exception> {\n  const name = error.name || error.constructor.name;\n  const stack = extractStackFromError(error);\n  return new SyncPromise<Exception>(resolve =>\n    parseStack(stack, options).then(frames => {\n      const result = {\n        stacktrace: {\n          frames: prepareFramesForEvent(frames),\n        },\n        type: name,\n        value: error.message,\n      };\n      resolve(result);\n    }),\n  );\n}\n\n/**\n * @hidden\n */\nexport function parseError(error: ExtendedError, options?: NodeOptions): PromiseLike<Event> {\n  return new SyncPromise<Event>(resolve =>\n    getExceptionFromError(error, options).then((exception: Exception) => {\n      resolve({\n        exception: {\n          values: [exception],\n        },\n      });\n    }),\n  );\n}\n\n/**\n * @hidden\n */\nexport function prepareFramesForEvent(stack: StackFrame[]): StackFrame[] {\n  if (!stack || !stack.length) {\n    return [];\n  }\n\n  let localStack = stack;\n  const firstFrameFunction = localStack[0].function || '';\n\n  if (firstFrameFunction.indexOf('captureMessage') !== -1 || firstFrameFunction.indexOf('captureException') !== -1) {\n    localStack = localStack.slice(1);\n  }\n\n  // The frame where the crash happened, should be the last entry in the array\n  return localStack.reverse();\n}\n", "// TODO: Remove in the next major release and rely only on @sentry/core SDK_VERSION and SdkMetadata\nexport const SDK_NAME = 'sentry.javascript.node';\n", "import { API, SDK_VERSION } from '@sentry/core';\nimport {\n  DsnProtocol,\n  Event,\n  Response,\n  SentryRequest,\n  SentryRequestType,\n  Session,\n  SessionAggregates,\n  Status,\n  Transport,\n  TransportOptions,\n} from '@sentry/types';\nimport { logger, parseRetryAfterHeader, PromiseBuffer, SentryError } from '@sentry/utils';\nimport * as fs from 'fs';\nimport * as http from 'http';\nimport * as https from 'https';\nimport { URL } from 'url';\n\nimport { SDK_NAME } from '../../version';\nimport { HTTPModule } from './http-module';\n\nexport type URLParts = Pick<URL, 'hostname' | 'pathname' | 'port' | 'protocol'>;\nexport type UrlParser = (url: string) => URLParts;\n\nconst CATEGORY_MAPPING: {\n  [key in SentryRequestType]: string;\n} = {\n  event: 'error',\n  transaction: 'transaction',\n  session: 'session',\n  attachment: 'attachment',\n};\n\n/** Base Transport class implementation */\nexport abstract class BaseTransport implements Transport {\n  /** The Agent used for corresponding transport */\n  public module?: HTTPModule;\n\n  /** The Agent used for corresponding transport */\n  public client?: http.Agent | https.Agent;\n\n  /** API object */\n  protected _api: API;\n\n  /** A simple buffer holding all requests. */\n  protected readonly _buffer: PromiseBuffer<Response> = new PromiseBuffer(30);\n\n  /** Locks transport after receiving rate limits in a response */\n  protected readonly _rateLimits: Record<string, Date> = {};\n\n  /** Create instance and set this.dsn */\n  public constructor(public options: TransportOptions) {\n    this._api = new API(options.dsn, options._metadata, options.tunnel);\n  }\n\n  /** Default function used to parse URLs */\n  public urlParser: UrlParser = url => new URL(url);\n\n  /**\n   * @inheritDoc\n   */\n  public sendEvent(_: Event): PromiseLike<Response> {\n    throw new SentryError('Transport Class has to implement `sendEvent` method.');\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public close(timeout?: number): PromiseLike<boolean> {\n    return this._buffer.drain(timeout);\n  }\n\n  /**\n   * Extracts proxy settings from client options and env variables.\n   *\n   * Honors `no_proxy` env variable with the highest priority to allow for hosts exclusion.\n   *\n   * An order of priority for available protocols is:\n   * `http`  => `options.httpProxy` | `process.env.http_proxy`\n   * `https` => `options.httpsProxy` | `options.httpProxy` | `process.env.https_proxy` | `process.env.http_proxy`\n   */\n  protected _getProxy(protocol: DsnProtocol): string | undefined {\n    const { no_proxy, http_proxy, https_proxy } = process.env;\n    const { httpProxy, httpsProxy } = this.options;\n    const proxy = protocol === 'http' ? httpProxy || http_proxy : httpsProxy || httpProxy || https_proxy || http_proxy;\n\n    if (!no_proxy) {\n      return proxy;\n    }\n\n    const { host, port } = this._api.getDsn();\n    for (const np of no_proxy.split(',')) {\n      if (host.endsWith(np) || `${host}:${port}`.endsWith(np)) {\n        return;\n      }\n    }\n\n    return proxy;\n  }\n\n  /** Returns a build request option object used by request */\n  protected _getRequestOptions(urlParts: URLParts): http.RequestOptions | https.RequestOptions {\n    const headers = {\n      ...this._api.getRequestHeaders(SDK_NAME, SDK_VERSION),\n      ...this.options.headers,\n    };\n    const { hostname, pathname, port, protocol } = urlParts;\n    // See https://github.com/nodejs/node/blob/38146e717fed2fabe3aacb6540d839475e0ce1c6/lib/internal/url.js#L1268-L1290\n    // We ignore the query string on purpose\n    const path = `${pathname}`;\n\n    return {\n      agent: this.client,\n      headers,\n      hostname,\n      method: 'POST',\n      path,\n      port,\n      protocol,\n      ...(this.options.caCerts && {\n        ca: fs.readFileSync(this.options.caCerts),\n      }),\n    };\n  }\n\n  /**\n   * Gets the time that given category is disabled until for rate limiting\n   */\n  protected _disabledUntil(requestType: SentryRequestType): Date {\n    const category = CATEGORY_MAPPING[requestType];\n    return this._rateLimits[category] || this._rateLimits.all;\n  }\n\n  /**\n   * Checks if a category is rate limited\n   */\n  protected _isRateLimited(requestType: SentryRequestType): boolean {\n    return this._disabledUntil(requestType) > new Date(Date.now());\n  }\n\n  /**\n   * Sets internal _rateLimits from incoming headers. Returns true if headers contains a non-empty rate limiting header.\n   */\n  protected _handleRateLimit(headers: Record<string, string | null>): boolean {\n    const now = Date.now();\n    const rlHeader = headers['x-sentry-rate-limits'];\n    const raHeader = headers['retry-after'];\n\n    if (rlHeader) {\n      // rate limit headers are of the form\n      //     <header>,<header>,..\n      // where each <header> is of the form\n      //     <retry_after>: <categories>: <scope>: <reason_code>\n      // where\n      //     <retry_after> is a delay in ms\n      //     <categories> is the event type(s) (error, transaction, etc) being rate limited and is of the form\n      //         <category>;<category>;...\n      //     <scope> is what's being limited (org, project, or key) - ignored by SDK\n      //     <reason_code> is an arbitrary string like \"org_quota\" - ignored by SDK\n      for (const limit of rlHeader.trim().split(',')) {\n        const parameters = limit.split(':', 2);\n        const headerDelay = parseInt(parameters[0], 10);\n        const delay = (!isNaN(headerDelay) ? headerDelay : 60) * 1000; // 60sec default\n        for (const category of (parameters[1] && parameters[1].split(';')) || ['all']) {\n          // categoriesAllowed is added here to ensure we are only storing rate limits for categories we support in this\n          // sdk and any categories that are not supported will not be added redundantly to the rateLimits object\n          const categoriesAllowed = [\n            ...(Object.keys(CATEGORY_MAPPING) as [SentryRequestType]).map(k => CATEGORY_MAPPING[k]),\n            'all',\n          ];\n          if (categoriesAllowed.includes(category)) this._rateLimits[category] = new Date(now + delay);\n        }\n      }\n      return true;\n    } else if (raHeader) {\n      this._rateLimits.all = new Date(now + parseRetryAfterHeader(now, raHeader));\n      return true;\n    }\n    return false;\n  }\n\n  /** JSDoc */\n  protected async _send(\n    sentryRequest: SentryRequest,\n    originalPayload?: Event | Session | SessionAggregates,\n  ): Promise<Response> {\n    if (!this.module) {\n      throw new SentryError('No module available');\n    }\n    if (originalPayload && this._isRateLimited(sentryRequest.type)) {\n      return Promise.reject({\n        payload: originalPayload,\n        type: sentryRequest.type,\n        reason: `Transport for ${sentryRequest.type} requests locked till ${this._disabledUntil(\n          sentryRequest.type,\n        )} due to too many requests.`,\n        status: 429,\n      });\n    }\n\n    if (!this._buffer.isReady()) {\n      return Promise.reject(new SentryError('Not adding Promise due to buffer limit reached.'));\n    }\n    return this._buffer.add(\n      () =>\n        new Promise<Response>((resolve, reject) => {\n          if (!this.module) {\n            throw new SentryError('No module available');\n          }\n          const options = this._getRequestOptions(this.urlParser(sentryRequest.url));\n          const req = this.module.request(options, res => {\n            const statusCode = res.statusCode || 500;\n            const status = Status.fromHttpCode(statusCode);\n\n            res.setEncoding('utf8');\n\n            /**\n             * \"Key-value pairs of header names and values. Header names are lower-cased.\"\n             * https://nodejs.org/api/http.html#http_message_headers\n             */\n            let retryAfterHeader = res.headers ? res.headers['retry-after'] : '';\n            retryAfterHeader = (Array.isArray(retryAfterHeader) ? retryAfterHeader[0] : retryAfterHeader) as string;\n\n            let rlHeader = res.headers ? res.headers['x-sentry-rate-limits'] : '';\n            rlHeader = (Array.isArray(rlHeader) ? rlHeader[0] : rlHeader) as string;\n\n            const headers = {\n              'x-sentry-rate-limits': rlHeader,\n              'retry-after': retryAfterHeader,\n            };\n\n            const limited = this._handleRateLimit(headers);\n            if (limited)\n              logger.warn(\n                `Too many ${sentryRequest.type} requests, backing off until: ${this._disabledUntil(\n                  sentryRequest.type,\n                )}`,\n              );\n\n            if (status === Status.Success) {\n              resolve({ status });\n            } else {\n              let rejectionMessage = `HTTP Error (${statusCode})`;\n              if (res.headers && res.headers['x-sentry-error']) {\n                rejectionMessage += `: ${res.headers['x-sentry-error']}`;\n              }\n              reject(new SentryError(rejectionMessage));\n            }\n\n            // Force the socket to drain\n            res.on('data', () => {\n              // Drain\n            });\n            res.on('end', () => {\n              // Drain\n            });\n          });\n          req.on('error', reject);\n          req.end(sentryRequest.body);\n        }),\n    );\n  }\n}\n", "/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isFinite(val)) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n", "\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n */\n\nfunction setup(env) {\n\tcreateDebug.debug = createDebug;\n\tcreateDebug.default = createDebug;\n\tcreateDebug.coerce = coerce;\n\tcreateDebug.disable = disable;\n\tcreateDebug.enable = enable;\n\tcreateDebug.enabled = enabled;\n\tcreateDebug.humanize = require('ms');\n\tcreateDebug.destroy = destroy;\n\n\tObject.keys(env).forEach(key => {\n\t\tcreateDebug[key] = env[key];\n\t});\n\n\t/**\n\t* The currently active debug mode names, and names to skip.\n\t*/\n\n\tcreateDebug.names = [];\n\tcreateDebug.skips = [];\n\n\t/**\n\t* Map of special \"%n\" handling functions, for the debug \"format\" argument.\n\t*\n\t* Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n\t*/\n\tcreateDebug.formatters = {};\n\n\t/**\n\t* Selects a color for a debug namespace\n\t* @param {String} namespace The namespace string for the for the debug instance to be colored\n\t* @return {Number|String} An ANSI color code for the given namespace\n\t* @api private\n\t*/\n\tfunction selectColor(namespace) {\n\t\tlet hash = 0;\n\n\t\tfor (let i = 0; i < namespace.length; i++) {\n\t\t\thash = ((hash << 5) - hash) + namespace.charCodeAt(i);\n\t\t\thash |= 0; // Convert to 32bit integer\n\t\t}\n\n\t\treturn createDebug.colors[Math.abs(hash) % createDebug.colors.length];\n\t}\n\tcreateDebug.selectColor = selectColor;\n\n\t/**\n\t* Create a debugger with the given `namespace`.\n\t*\n\t* @param {String} namespace\n\t* @return {Function}\n\t* @api public\n\t*/\n\tfunction createDebug(namespace) {\n\t\tlet prevTime;\n\t\tlet enableOverride = null;\n\n\t\tfunction debug(...args) {\n\t\t\t// Disabled?\n\t\t\tif (!debug.enabled) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst self = debug;\n\n\t\t\t// Set `diff` timestamp\n\t\t\tconst curr = Number(new Date());\n\t\t\tconst ms = curr - (prevTime || curr);\n\t\t\tself.diff = ms;\n\t\t\tself.prev = prevTime;\n\t\t\tself.curr = curr;\n\t\t\tprevTime = curr;\n\n\t\t\targs[0] = createDebug.coerce(args[0]);\n\n\t\t\tif (typeof args[0] !== 'string') {\n\t\t\t\t// Anything else let's inspect with %O\n\t\t\t\targs.unshift('%O');\n\t\t\t}\n\n\t\t\t// Apply any `formatters` transformations\n\t\t\tlet index = 0;\n\t\t\targs[0] = args[0].replace(/%([a-zA-Z%])/g, (match, format) => {\n\t\t\t\t// If we encounter an escaped % then don't increase the array index\n\t\t\t\tif (match === '%%') {\n\t\t\t\t\treturn '%';\n\t\t\t\t}\n\t\t\t\tindex++;\n\t\t\t\tconst formatter = createDebug.formatters[format];\n\t\t\t\tif (typeof formatter === 'function') {\n\t\t\t\t\tconst val = args[index];\n\t\t\t\t\tmatch = formatter.call(self, val);\n\n\t\t\t\t\t// Now we need to remove `args[index]` since it's inlined in the `format`\n\t\t\t\t\targs.splice(index, 1);\n\t\t\t\t\tindex--;\n\t\t\t\t}\n\t\t\t\treturn match;\n\t\t\t});\n\n\t\t\t// Apply env-specific formatting (colors, etc.)\n\t\t\tcreateDebug.formatArgs.call(self, args);\n\n\t\t\tconst logFn = self.log || createDebug.log;\n\t\t\tlogFn.apply(self, args);\n\t\t}\n\n\t\tdebug.namespace = namespace;\n\t\tdebug.useColors = createDebug.useColors();\n\t\tdebug.color = createDebug.selectColor(namespace);\n\t\tdebug.extend = extend;\n\t\tdebug.destroy = createDebug.destroy; // XXX Temporary. Will be removed in the next major release.\n\n\t\tObject.defineProperty(debug, 'enabled', {\n\t\t\tenumerable: true,\n\t\t\tconfigurable: false,\n\t\t\tget: () => enableOverride === null ? createDebug.enabled(namespace) : enableOverride,\n\t\t\tset: v => {\n\t\t\t\tenableOverride = v;\n\t\t\t}\n\t\t});\n\n\t\t// Env-specific initialization logic for debug instances\n\t\tif (typeof createDebug.init === 'function') {\n\t\t\tcreateDebug.init(debug);\n\t\t}\n\n\t\treturn debug;\n\t}\n\n\tfunction extend(namespace, delimiter) {\n\t\tconst newDebug = createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace);\n\t\tnewDebug.log = this.log;\n\t\treturn newDebug;\n\t}\n\n\t/**\n\t* Enables a debug mode by namespaces. This can include modes\n\t* separated by a colon and wildcards.\n\t*\n\t* @param {String} namespaces\n\t* @api public\n\t*/\n\tfunction enable(namespaces) {\n\t\tcreateDebug.save(namespaces);\n\n\t\tcreateDebug.names = [];\n\t\tcreateDebug.skips = [];\n\n\t\tlet i;\n\t\tconst split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n\t\tconst len = split.length;\n\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tif (!split[i]) {\n\t\t\t\t// ignore empty strings\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tnamespaces = split[i].replace(/\\*/g, '.*?');\n\n\t\t\tif (namespaces[0] === '-') {\n\t\t\t\tcreateDebug.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n\t\t\t} else {\n\t\t\t\tcreateDebug.names.push(new RegExp('^' + namespaces + '$'));\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t* Disable debug output.\n\t*\n\t* @return {String} namespaces\n\t* @api public\n\t*/\n\tfunction disable() {\n\t\tconst namespaces = [\n\t\t\t...createDebug.names.map(toNamespace),\n\t\t\t...createDebug.skips.map(toNamespace).map(namespace => '-' + namespace)\n\t\t].join(',');\n\t\tcreateDebug.enable('');\n\t\treturn namespaces;\n\t}\n\n\t/**\n\t* Returns true if the given mode name is enabled, false otherwise.\n\t*\n\t* @param {String} name\n\t* @return {Boolean}\n\t* @api public\n\t*/\n\tfunction enabled(name) {\n\t\tif (name[name.length - 1] === '*') {\n\t\t\treturn true;\n\t\t}\n\n\t\tlet i;\n\t\tlet len;\n\n\t\tfor (i = 0, len = createDebug.skips.length; i < len; i++) {\n\t\t\tif (createDebug.skips[i].test(name)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0, len = createDebug.names.length; i < len; i++) {\n\t\t\tif (createDebug.names[i].test(name)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t* Convert regexp to namespace\n\t*\n\t* @param {RegExp} regxep\n\t* @return {String} namespace\n\t* @api private\n\t*/\n\tfunction toNamespace(regexp) {\n\t\treturn regexp.toString()\n\t\t\t.substring(2, regexp.toString().length - 2)\n\t\t\t.replace(/\\.\\*\\?$/, '*');\n\t}\n\n\t/**\n\t* Coerce `val`.\n\t*\n\t* @param {Mixed} val\n\t* @return {Mixed}\n\t* @api private\n\t*/\n\tfunction coerce(val) {\n\t\tif (val instanceof Error) {\n\t\t\treturn val.stack || val.message;\n\t\t}\n\t\treturn val;\n\t}\n\n\t/**\n\t* XXX DO NOT USE. This is a temporary stub function.\n\t* XXX It WILL be removed in the next major release.\n\t*/\n\tfunction destroy() {\n\t\tconsole.warn('Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.');\n\t}\n\n\tcreateDebug.enable(createDebug.load());\n\n\treturn createDebug;\n}\n\nmodule.exports = setup;\n", "/* eslint-env browser */\n\n/**\n * This is the web browser implementation of `debug()`.\n */\n\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = localstorage();\nexports.destroy = (() => {\n\tlet warned = false;\n\n\treturn () => {\n\t\tif (!warned) {\n\t\t\twarned = true;\n\t\t\tconsole.warn('Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.');\n\t\t}\n\t};\n})();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n\t'#0000CC',\n\t'#0000FF',\n\t'#0033CC',\n\t'#0033FF',\n\t'#0066CC',\n\t'#0066FF',\n\t'#0099CC',\n\t'#0099FF',\n\t'#00CC00',\n\t'#00CC33',\n\t'#00CC66',\n\t'#00CC99',\n\t'#00CCCC',\n\t'#00CCFF',\n\t'#3300CC',\n\t'#3300FF',\n\t'#3333CC',\n\t'#3333FF',\n\t'#3366CC',\n\t'#3366FF',\n\t'#3399CC',\n\t'#3399FF',\n\t'#33CC00',\n\t'#33CC33',\n\t'#33CC66',\n\t'#33CC99',\n\t'#33CCCC',\n\t'#33CCFF',\n\t'#6600CC',\n\t'#6600FF',\n\t'#6633CC',\n\t'#6633FF',\n\t'#66CC00',\n\t'#66CC33',\n\t'#9900CC',\n\t'#9900FF',\n\t'#9933CC',\n\t'#9933FF',\n\t'#99CC00',\n\t'#99CC33',\n\t'#CC0000',\n\t'#CC0033',\n\t'#CC0066',\n\t'#CC0099',\n\t'#CC00CC',\n\t'#CC00FF',\n\t'#CC3300',\n\t'#CC3333',\n\t'#CC3366',\n\t'#CC3399',\n\t'#CC33CC',\n\t'#CC33FF',\n\t'#CC6600',\n\t'#CC6633',\n\t'#CC9900',\n\t'#CC9933',\n\t'#CCCC00',\n\t'#CCCC33',\n\t'#FF0000',\n\t'#FF0033',\n\t'#FF0066',\n\t'#FF0099',\n\t'#FF00CC',\n\t'#FF00FF',\n\t'#FF3300',\n\t'#FF3333',\n\t'#FF3366',\n\t'#FF3399',\n\t'#FF33CC',\n\t'#FF33FF',\n\t'#FF6600',\n\t'#FF6633',\n\t'#FF9900',\n\t'#FF9933',\n\t'#FFCC00',\n\t'#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\n// eslint-disable-next-line complexity\nfunction useColors() {\n\t// NB: In an Electron preload script, document will be defined but not fully\n\t// initialized. Since we know we're in Chrome, we'll just detect this case\n\t// explicitly\n\tif (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {\n\t\treturn true;\n\t}\n\n\t// Internet Explorer and Edge do not support colors.\n\tif (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n\t\treturn false;\n\t}\n\n\t// Is webkit? http://stackoverflow.com/a/16459606/376773\n\t// document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n\treturn (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n\t\t// Is firebug? http://stackoverflow.com/a/398120/376773\n\t\t(typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n\t\t// Is firefox >= v31?\n\t\t// https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n\t\t// Double check webkit in userAgent just in case we are in a worker\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n\targs[0] = (this.useColors ? '%c' : '') +\n\t\tthis.namespace +\n\t\t(this.useColors ? ' %c' : ' ') +\n\t\targs[0] +\n\t\t(this.useColors ? '%c ' : ' ') +\n\t\t'+' + module.exports.humanize(this.diff);\n\n\tif (!this.useColors) {\n\t\treturn;\n\t}\n\n\tconst c = 'color: ' + this.color;\n\targs.splice(1, 0, c, 'color: inherit');\n\n\t// The final \"%c\" is somewhat tricky, because there could be other\n\t// arguments passed either before or after the %c, so we need to\n\t// figure out the correct index to insert the CSS into\n\tlet index = 0;\n\tlet lastC = 0;\n\targs[0].replace(/%[a-zA-Z%]/g, match => {\n\t\tif (match === '%%') {\n\t\t\treturn;\n\t\t}\n\t\tindex++;\n\t\tif (match === '%c') {\n\t\t\t// We only are interested in the *last* %c\n\t\t\t// (the user may have provided their own)\n\t\t\tlastC = index;\n\t\t}\n\t});\n\n\targs.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.debug()` when available.\n * No-op when `console.debug` is not a \"function\".\n * If `console.debug` is not available, falls back\n * to `console.log`.\n *\n * @api public\n */\nexports.log = console.debug || console.log || (() => {});\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\nfunction save(namespaces) {\n\ttry {\n\t\tif (namespaces) {\n\t\t\texports.storage.setItem('debug', namespaces);\n\t\t} else {\n\t\t\texports.storage.removeItem('debug');\n\t\t}\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\nfunction load() {\n\tlet r;\n\ttry {\n\t\tr = exports.storage.getItem('debug');\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n\n\t// If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\tif (!r && typeof process !== 'undefined' && 'env' in process) {\n\t\tr = process.env.DEBUG;\n\t}\n\n\treturn r;\n}\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n\ttry {\n\t\t// TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context\n\t\t// The Browser also has localStorage in the global context.\n\t\treturn localStorage;\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\nmodule.exports = require('./common')(exports);\n\nconst {formatters} = module.exports;\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nformatters.j = function (v) {\n\ttry {\n\t\treturn JSON.stringify(v);\n\t} catch (error) {\n\t\treturn '[UnexpectedJSONParseError]: ' + error.message;\n\t}\n};\n", "'use strict';\nmodule.exports = (flag, argv) => {\n\targv = argv || process.argv;\n\tconst prefix = flag.startsWith('-') ? '' : (flag.length === 1 ? '-' : '--');\n\tconst pos = argv.indexOf(prefix + flag);\n\tconst terminatorPos = argv.indexOf('--');\n\treturn pos !== -1 && (terminatorPos === -1 ? true : pos < terminatorPos);\n};\n", "'use strict';\nconst os = require('os');\nconst hasFlag = require('has-flag');\n\nconst env = process.env;\n\nlet forceColor;\nif (hasFlag('no-color') ||\n\thasFlag('no-colors') ||\n\thasFlag('color=false')) {\n\tforceColor = false;\n} else if (hasFlag('color') ||\n\thasFlag('colors') ||\n\thasFlag('color=true') ||\n\thasFlag('color=always')) {\n\tforceColor = true;\n}\nif ('FORCE_COLOR' in env) {\n\tforceColor = env.FORCE_COLOR.length === 0 || parseInt(env.FORCE_COLOR, 10) !== 0;\n}\n\nfunction translateLevel(level) {\n\tif (level === 0) {\n\t\treturn false;\n\t}\n\n\treturn {\n\t\tlevel,\n\t\thasBasic: true,\n\t\thas256: level >= 2,\n\t\thas16m: level >= 3\n\t};\n}\n\nfunction supportsColor(stream) {\n\tif (forceColor === false) {\n\t\treturn 0;\n\t}\n\n\tif (hasFlag('color=16m') ||\n\t\thasFlag('color=full') ||\n\t\thasFlag('color=truecolor')) {\n\t\treturn 3;\n\t}\n\n\tif (hasFlag('color=256')) {\n\t\treturn 2;\n\t}\n\n\tif (stream && !stream.isTTY && forceColor !== true) {\n\t\treturn 0;\n\t}\n\n\tconst min = forceColor ? 1 : 0;\n\n\tif (process.platform === 'win32') {\n\t\t// Node.js 7.5.0 is the first version of Node.js to include a patch to\n\t\t// libuv that enables 256 color output on Windows. Anything earlier and it\n\t\t// won't work. However, here we target Node.js 8 at minimum as it is an LTS\n\t\t// release, and Node.js 7 is not. Windows 10 build 10586 is the first Windows\n\t\t// release that supports 256 colors. Windows 10 build 14931 is the first release\n\t\t// that supports 16m/TrueColor.\n\t\tconst osRelease = os.release().split('.');\n\t\tif (\n\t\t\tNumber(process.versions.node.split('.')[0]) >= 8 &&\n\t\t\tNumber(osRelease[0]) >= 10 &&\n\t\t\tNumber(osRelease[2]) >= 10586\n\t\t) {\n\t\t\treturn Number(osRelease[2]) >= 14931 ? 3 : 2;\n\t\t}\n\n\t\treturn 1;\n\t}\n\n\tif ('CI' in env) {\n\t\tif (['TRAVIS', 'CIRCLECI', 'APPVEYOR', 'GITLAB_CI'].some(sign => sign in env) || env.CI_NAME === 'codeship') {\n\t\t\treturn 1;\n\t\t}\n\n\t\treturn min;\n\t}\n\n\tif ('TEAMCITY_VERSION' in env) {\n\t\treturn /^(9\\.(0*[1-9]\\d*)\\.|\\d{2,}\\.)/.test(env.TEAMCITY_VERSION) ? 1 : 0;\n\t}\n\n\tif (env.COLORTERM === 'truecolor') {\n\t\treturn 3;\n\t}\n\n\tif ('TERM_PROGRAM' in env) {\n\t\tconst version = parseInt((env.TERM_PROGRAM_VERSION || '').split('.')[0], 10);\n\n\t\tswitch (env.TERM_PROGRAM) {\n\t\t\tcase 'iTerm.app':\n\t\t\t\treturn version >= 3 ? 3 : 2;\n\t\t\tcase 'Apple_Terminal':\n\t\t\t\treturn 2;\n\t\t\t// No default\n\t\t}\n\t}\n\n\tif (/-256(color)?$/i.test(env.TERM)) {\n\t\treturn 2;\n\t}\n\n\tif (/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(env.TERM)) {\n\t\treturn 1;\n\t}\n\n\tif ('COLORTERM' in env) {\n\t\treturn 1;\n\t}\n\n\tif (env.TERM === 'dumb') {\n\t\treturn min;\n\t}\n\n\treturn min;\n}\n\nfunction getSupportLevel(stream) {\n\tconst level = supportsColor(stream);\n\treturn translateLevel(level);\n}\n\nmodule.exports = {\n\tsupportsColor: getSupportLevel,\n\tstdout: getSupportLevel(process.stdout),\n\tstderr: getSupportLevel(process.stderr)\n};\n", "/**\n * Module dependencies.\n */\n\nconst tty = require('tty');\nconst util = require('util');\n\n/**\n * This is the Node.js implementation of `debug()`.\n */\n\nexports.init = init;\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.destroy = util.deprecate(\n\t() => {},\n\t'Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.'\n);\n\n/**\n * Colors.\n */\n\nexports.colors = [6, 2, 3, 4, 5, 1];\n\ntry {\n\t// Optional dependency (as in, doesn't need to be installed, NOT like optionalDependencies in package.json)\n\t// eslint-disable-next-line import/no-extraneous-dependencies\n\tconst supportsColor = require('supports-color');\n\n\tif (supportsColor && (supportsColor.stderr || supportsColor).level >= 2) {\n\t\texports.colors = [\n\t\t\t20,\n\t\t\t21,\n\t\t\t26,\n\t\t\t27,\n\t\t\t32,\n\t\t\t33,\n\t\t\t38,\n\t\t\t39,\n\t\t\t40,\n\t\t\t41,\n\t\t\t42,\n\t\t\t43,\n\t\t\t44,\n\t\t\t45,\n\t\t\t56,\n\t\t\t57,\n\t\t\t62,\n\t\t\t63,\n\t\t\t68,\n\t\t\t69,\n\t\t\t74,\n\t\t\t75,\n\t\t\t76,\n\t\t\t77,\n\t\t\t78,\n\t\t\t79,\n\t\t\t80,\n\t\t\t81,\n\t\t\t92,\n\t\t\t93,\n\t\t\t98,\n\t\t\t99,\n\t\t\t112,\n\t\t\t113,\n\t\t\t128,\n\t\t\t129,\n\t\t\t134,\n\t\t\t135,\n\t\t\t148,\n\t\t\t149,\n\t\t\t160,\n\t\t\t161,\n\t\t\t162,\n\t\t\t163,\n\t\t\t164,\n\t\t\t165,\n\t\t\t166,\n\t\t\t167,\n\t\t\t168,\n\t\t\t169,\n\t\t\t170,\n\t\t\t171,\n\t\t\t172,\n\t\t\t173,\n\t\t\t178,\n\t\t\t179,\n\t\t\t184,\n\t\t\t185,\n\t\t\t196,\n\t\t\t197,\n\t\t\t198,\n\t\t\t199,\n\t\t\t200,\n\t\t\t201,\n\t\t\t202,\n\t\t\t203,\n\t\t\t204,\n\t\t\t205,\n\t\t\t206,\n\t\t\t207,\n\t\t\t208,\n\t\t\t209,\n\t\t\t214,\n\t\t\t215,\n\t\t\t220,\n\t\t\t221\n\t\t];\n\t}\n} catch (error) {\n\t// Swallow - we only care if `supports-color` is available; it doesn't have to be.\n}\n\n/**\n * Build up the default `inspectOpts` object from the environment variables.\n *\n *   $ DEBUG_COLORS=no DEBUG_DEPTH=10 DEBUG_SHOW_HIDDEN=enabled node script.js\n */\n\nexports.inspectOpts = Object.keys(process.env).filter(key => {\n\treturn /^debug_/i.test(key);\n}).reduce((obj, key) => {\n\t// Camel-case\n\tconst prop = key\n\t\t.substring(6)\n\t\t.toLowerCase()\n\t\t.replace(/_([a-z])/g, (_, k) => {\n\t\t\treturn k.toUpperCase();\n\t\t});\n\n\t// Coerce string value into JS value\n\tlet val = process.env[key];\n\tif (/^(yes|on|true|enabled)$/i.test(val)) {\n\t\tval = true;\n\t} else if (/^(no|off|false|disabled)$/i.test(val)) {\n\t\tval = false;\n\t} else if (val === 'null') {\n\t\tval = null;\n\t} else {\n\t\tval = Number(val);\n\t}\n\n\tobj[prop] = val;\n\treturn obj;\n}, {});\n\n/**\n * Is stdout a TTY? Colored output is enabled when `true`.\n */\n\nfunction useColors() {\n\treturn 'colors' in exports.inspectOpts ?\n\t\tBoolean(exports.inspectOpts.colors) :\n\t\ttty.isatty(process.stderr.fd);\n}\n\n/**\n * Adds ANSI color escape codes if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n\tconst {namespace: name, useColors} = this;\n\n\tif (useColors) {\n\t\tconst c = this.color;\n\t\tconst colorCode = '\\u001B[3' + (c < 8 ? c : '8;5;' + c);\n\t\tconst prefix = `  ${colorCode};1m${name} \\u001B[0m`;\n\n\t\targs[0] = prefix + args[0].split('\\n').join('\\n' + prefix);\n\t\targs.push(colorCode + 'm+' + module.exports.humanize(this.diff) + '\\u001B[0m');\n\t} else {\n\t\targs[0] = getDate() + name + ' ' + args[0];\n\t}\n}\n\nfunction getDate() {\n\tif (exports.inspectOpts.hideDate) {\n\t\treturn '';\n\t}\n\treturn new Date().toISOString() + ' ';\n}\n\n/**\n * Invokes `util.format()` with the specified arguments and writes to stderr.\n */\n\nfunction log(...args) {\n\treturn process.stderr.write(util.format(...args) + '\\n');\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\nfunction save(namespaces) {\n\tif (namespaces) {\n\t\tprocess.env.DEBUG = namespaces;\n\t} else {\n\t\t// If you set a process.env field to null or undefined, it gets cast to the\n\t\t// string 'null' or 'undefined'. Just delete instead.\n\t\tdelete process.env.DEBUG;\n\t}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n\treturn process.env.DEBUG;\n}\n\n/**\n * Init logic for `debug` instances.\n *\n * Create a new `inspectOpts` object in case `useColors` is set\n * differently for a particular `debug` instance.\n */\n\nfunction init(debug) {\n\tdebug.inspectOpts = {};\n\n\tconst keys = Object.keys(exports.inspectOpts);\n\tfor (let i = 0; i < keys.length; i++) {\n\t\tdebug.inspectOpts[keys[i]] = exports.inspectOpts[keys[i]];\n\t}\n}\n\nmodule.exports = require('./common')(exports);\n\nconst {formatters} = module.exports;\n\n/**\n * Map %o to `util.inspect()`, all on a single line.\n */\n\nformatters.o = function (v) {\n\tthis.inspectOpts.colors = this.useColors;\n\treturn util.inspect(v, this.inspectOpts)\n\t\t.split('\\n')\n\t\t.map(str => str.trim())\n\t\t.join(' ');\n};\n\n/**\n * Map %O to `util.inspect()`, allowing multiple lines if needed.\n */\n\nformatters.O = function (v) {\n\tthis.inspectOpts.colors = this.useColors;\n\treturn util.inspect(v, this.inspectOpts);\n};\n", "/**\n * Detect Electron renderer / nwjs process, which is node, but we should\n * treat as a browser.\n */\n\nif (typeof process === 'undefined' || process.type === 'renderer' || process.browser === true || process.__nwjs) {\n\tmodule.exports = require('./browser.js');\n} else {\n\tmodule.exports = require('./node.js');\n}\n", null, null, null, null, null, "import { eventToSentryRequest, sessionToSentryRequest } from '@sentry/core';\nimport { Event, Response, Session, SessionAggregates, TransportOptions } from '@sentry/types';\nimport * as http from 'http';\n\nimport { BaseTransport } from './base';\n\n/** Node http module transport */\nexport class HTTPTransport extends BaseTransport {\n  /** Create a new instance and set this.agent */\n  public constructor(public options: TransportOptions) {\n    super(options);\n    const proxy = this._getProxy('http');\n    this.module = http;\n    this.client = proxy\n      ? (new (require('https-proxy-agent'))(proxy) as http.Agent)\n      : new http.Agent({ keepAlive: false, maxSockets: 30, timeout: 2000 });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public sendEvent(event: Event): Promise<Response> {\n    return this._send(eventToSentryRequest(event, this._api), event);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public sendSession(session: Session | SessionAggregates): PromiseLike<Response> {\n    return this._send(sessionToSentryRequest(session, this._api), session);\n  }\n}\n", "import { eventToSentryRequest, sessionToSentryRequest } from '@sentry/core';\nimport { Event, Response, Session, SessionAggregates, TransportOptions } from '@sentry/types';\nimport * as https from 'https';\n\nimport { BaseTransport } from './base';\n\n/** Node https module transport */\nexport class HTTPSTransport extends BaseTransport {\n  /** Create a new instance and set this.agent */\n  public constructor(public options: TransportOptions) {\n    super(options);\n    const proxy = this._getProxy('https');\n    this.module = https;\n    this.client = proxy\n      ? (new (require('https-proxy-agent'))(proxy) as https.Agent)\n      : new https.Agent({ keepAlive: false, maxSockets: 30, timeout: 2000 });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public sendEvent(event: Event): Promise<Response> {\n    return this._send(eventToSentryRequest(event, this._api), event);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public sendSession(session: Session | SessionAggregates): PromiseLike<Response> {\n    return this._send(sessionToSentryRequest(session, this._api), session);\n  }\n}\n", "export { BaseTransport } from './base';\nexport { HTTPTransport } from './http';\nexport { HTTPSTransport } from './https';\n", "import { BaseBackend, getCurrentHub } from '@sentry/core';\nimport { Event, EventHint, Mechanism, Severity, Transport, TransportOptions } from '@sentry/types';\nimport {\n  addExceptionMechanism,\n  addExceptionTypeValue,\n  Dsn,\n  extractExceptionKeysForMessage,\n  isError,\n  isPlainObject,\n  normalizeToSize,\n  SyncPromise,\n} from '@sentry/utils';\n\nimport { extractStackFromError, parseError, parseStack, prepareFramesForEvent } from './parsers';\nimport { HTTPSTransport, HTTPTransport } from './transports';\nimport { NodeOptions } from './types';\n\n/**\n * The Sentry Node SDK Backend.\n * @hidden\n */\nexport class NodeBackend extends BaseBackend<NodeOptions> {\n  /**\n   * @inheritDoc\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\n  public eventFromException(exception: any, hint?: EventHint): PromiseLike<Event> {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    let ex: any = exception;\n    const providedMechanism: Mechanism | undefined =\n      hint && hint.data && (hint.data as { mechanism: Mechanism }).mechanism;\n    const mechanism: Mechanism = providedMechanism || {\n      handled: true,\n      type: 'generic',\n    };\n\n    if (!isError(exception)) {\n      if (isPlainObject(exception)) {\n        // This will allow us to group events based on top-level keys\n        // which is much better than creating new group when any key/value change\n        const message = `Non-Error exception captured with keys: ${extractExceptionKeysForMessage(exception)}`;\n\n        getCurrentHub().configureScope(scope => {\n          scope.setExtra('__serialized__', normalizeToSize(exception as Record<string, unknown>));\n        });\n\n        ex = (hint && hint.syntheticException) || new Error(message);\n        (ex as Error).message = message;\n      } else {\n        // This handles when someone does: `throw \"something awesome\";`\n        // We use synthesized Error here so we can extract a (rough) stack trace.\n        ex = (hint && hint.syntheticException) || new Error(exception as string);\n        (ex as Error).message = exception;\n      }\n      mechanism.synthetic = true;\n    }\n\n    return new SyncPromise<Event>((resolve, reject) =>\n      parseError(ex as Error, this._options)\n        .then(event => {\n          addExceptionTypeValue(event, undefined, undefined);\n          addExceptionMechanism(event, mechanism);\n\n          resolve({\n            ...event,\n            event_id: hint && hint.event_id,\n          });\n        })\n        .then(null, reject),\n    );\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public eventFromMessage(message: string, level: Severity = Severity.Info, hint?: EventHint): PromiseLike<Event> {\n    const event: Event = {\n      event_id: hint && hint.event_id,\n      level,\n      message,\n    };\n\n    return new SyncPromise<Event>(resolve => {\n      if (this._options.attachStacktrace && hint && hint.syntheticException) {\n        const stack = hint.syntheticException ? extractStackFromError(hint.syntheticException) : [];\n        void parseStack(stack, this._options)\n          .then(frames => {\n            event.stacktrace = {\n              frames: prepareFramesForEvent(frames),\n            };\n            resolve(event);\n          })\n          .then(null, () => {\n            resolve(event);\n          });\n      } else {\n        resolve(event);\n      }\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  protected _setupTransport(): Transport {\n    if (!this._options.dsn) {\n      // We return the noop transport here in case there is no Dsn.\n      return super._setupTransport();\n    }\n\n    const dsn = new Dsn(this._options.dsn);\n\n    const transportOptions: TransportOptions = {\n      ...this._options.transportOptions,\n      ...(this._options.httpProxy && { httpProxy: this._options.httpProxy }),\n      ...(this._options.httpsProxy && { httpsProxy: this._options.httpsProxy }),\n      ...(this._options.caCerts && { caCerts: this._options.caCerts }),\n      dsn: this._options.dsn,\n      tunnel: this._options.tunnel,\n      _metadata: this._options._metadata,\n    };\n\n    if (this._options.transport) {\n      return new this._options.transport(transportOptions);\n    }\n    if (dsn.protocol === 'http') {\n      return new HTTPTransport(transportOptions);\n    }\n    return new HTTPSTransport(transportOptions);\n  }\n}\n", "import { BaseClient, Scope, SDK_VERSION } from '@sentry/core';\nimport { SessionFlusher } from '@sentry/hub';\nimport { Event, EventHint, RequestSessionStatus } from '@sentry/types';\nimport { logger } from '@sentry/utils';\n\nimport { NodeBackend } from './backend';\nimport { NodeOptions } from './types';\n\n/**\n * The Sentry Node SDK Client.\n *\n * @see NodeOptions for documentation on configuration options.\n * @see SentryClient for usage documentation.\n */\nexport class NodeClient extends BaseClient<NodeBackend, NodeOptions> {\n  protected _sessionFlusher: SessionFlusher | undefined;\n\n  /**\n   * Creates a new Node SDK instance.\n   * @param options Configuration options for this SDK.\n   */\n  public constructor(options: NodeOptions) {\n    options._metadata = options._metadata || {};\n    options._metadata.sdk = options._metadata.sdk || {\n      name: 'sentry.javascript.node',\n      packages: [\n        {\n          name: 'npm:@sentry/node',\n          version: SDK_VERSION,\n        },\n      ],\n      version: SDK_VERSION,\n    };\n\n    super(NodeBackend, options);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\n  public captureException(exception: any, hint?: EventHint, scope?: Scope): string | undefined {\n    // Check if the flag `autoSessionTracking` is enabled, and if `_sessionFlusher` exists because it is initialised only\n    // when the `requestHandler` middleware is used, and hence the expectation is to have SessionAggregates payload\n    // sent to the Server only when the `requestHandler` middleware is used\n    if (this._options.autoSessionTracking && this._sessionFlusher && scope) {\n      const requestSession = scope.getRequestSession();\n\n      // Necessary checks to ensure this is code block is executed only within a request\n      // Should override the status only if `requestSession.status` is `Ok`, which is its initial stage\n      if (requestSession && requestSession.status === RequestSessionStatus.Ok) {\n        requestSession.status = RequestSessionStatus.Errored;\n      }\n    }\n\n    return super.captureException(exception, hint, scope);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public captureEvent(event: Event, hint?: EventHint, scope?: Scope): string | undefined {\n    // Check if the flag `autoSessionTracking` is enabled, and if `_sessionFlusher` exists because it is initialised only\n    // when the `requestHandler` middleware is used, and hence the expectation is to have SessionAggregates payload\n    // sent to the Server only when the `requestHandler` middleware is used\n    if (this._options.autoSessionTracking && this._sessionFlusher && scope) {\n      const eventType = event.type || 'exception';\n      const isException =\n        eventType === 'exception' && event.exception && event.exception.values && event.exception.values.length > 0;\n\n      // If the event is of type Exception, then a request session should be captured\n      if (isException) {\n        const requestSession = scope.getRequestSession();\n\n        // Ensure that this is happening within the bounds of a request, and make sure not to override\n        // Session Status if Errored / Crashed\n        if (requestSession && requestSession.status === RequestSessionStatus.Ok) {\n          requestSession.status = RequestSessionStatus.Errored;\n        }\n      }\n    }\n\n    return super.captureEvent(event, hint, scope);\n  }\n\n  /**\n   *\n   * @inheritdoc\n   */\n  public close(timeout?: number): PromiseLike<boolean> {\n    this._sessionFlusher?.close();\n    return super.close(timeout);\n  }\n\n  /** Method that initialises an instance of SessionFlusher on Client */\n  public initSessionFlusher(): void {\n    const { release, environment } = this._options;\n    if (!release) {\n      logger.warn('Cannot initialise an instance of SessionFlusher if no release is provided!');\n    } else {\n      this._sessionFlusher = new SessionFlusher(this._backend.getTransport(), {\n        release,\n        environment,\n      });\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  protected _prepareEvent(event: Event, scope?: Scope, hint?: EventHint): PromiseLike<Event | null> {\n    event.platform = event.platform || 'node';\n    if (this.getOptions().serverName) {\n      event.server_name = this.getOptions().serverName;\n    }\n    return super._prepareEvent(event, scope, hint);\n  }\n\n  /**\n   * Method responsible for capturing/ending a request session by calling `incrementSessionStatusCount` to increment\n   * appropriate session aggregates bucket\n   */\n  protected _captureRequestSession(): void {\n    if (!this._sessionFlusher) {\n      logger.warn('Discarded request mode session because autoSessionTracking option was disabled');\n    } else {\n      this._sessionFlusher.incrementSessionStatusCount();\n    }\n  }\n}\n", "import { getCurrentHub } from '@sentry/core';\nimport { Integration, Severity } from '@sentry/types';\nimport { fill } from '@sentry/utils';\nimport * as util from 'util';\n\n/** Console module integration */\nexport class Console implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'Console';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = Console.id;\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(): void {\n    for (const level of ['debug', 'info', 'warn', 'error', 'log']) {\n      fill(console, level, createConsoleWrapper(level));\n    }\n  }\n}\n\n/**\n * Wrapper function that'll be used for every console level\n */\nfunction createConsoleWrapper(level: string): (originalConsoleMethod: () => void) => void {\n  return function consoleWrapper(originalConsoleMethod: () => void): () => void {\n    let sentryLevel: Severity;\n\n    switch (level) {\n      case 'debug':\n        sentryLevel = Severity.Debug;\n        break;\n      case 'error':\n        sentryLevel = Severity.Error;\n        break;\n      case 'info':\n        sentryLevel = Severity.Info;\n        break;\n      case 'warn':\n        sentryLevel = Severity.Warning;\n        break;\n      default:\n        sentryLevel = Severity.Log;\n    }\n\n    return function(this: typeof console): void {\n      if (getCurrentHub().getIntegration(Console)) {\n        getCurrentHub().addBreadcrumb(\n          {\n            category: 'console',\n            level: sentryLevel,\n            message: util.format.apply(undefined, arguments),\n          },\n          {\n            input: [...arguments],\n            level,\n          },\n        );\n      }\n\n      originalConsoleMethod.apply(this, arguments);\n    };\n  };\n}\n", "import { getCurrentHub } from '@sentry/core';\nimport * as http from 'http';\nimport { URL } from 'url';\n\n/**\n * Checks whether given url points to Sentry server\n * @param url url to verify\n */\nexport function isSentryRequest(url: string): boolean {\n  const dsn = getCurrentHub()\n    .getClient()\n    ?.getDsn();\n  return dsn ? url.includes(dsn.host) : false;\n}\n\n/**\n * Assemble a URL to be used for breadcrumbs and spans.\n *\n * @param requestOptions RequestOptions object containing the component parts for a URL\n * @returns Fully-formed URL\n */\nexport function extractUrl(requestOptions: RequestOptions): string {\n  const protocol = requestOptions.protocol || '';\n  const hostname = requestOptions.hostname || requestOptions.host || '';\n  // Don't log standard :80 (http) and :443 (https) ports to reduce the noise\n  const port =\n    !requestOptions.port || requestOptions.port === 80 || requestOptions.port === 443 ? '' : `:${requestOptions.port}`;\n  const path = requestOptions.path ? requestOptions.path : '/';\n\n  return `${protocol}//${hostname}${port}${path}`;\n}\n\n/**\n * Handle various edge cases in the span description (for spans representing http(s) requests).\n *\n * @param description current `description` property of the span representing the request\n * @param requestOptions Configuration data for the request\n * @param Request Request object\n *\n * @returns The cleaned description\n */\nexport function cleanSpanDescription(\n  description: string | undefined,\n  requestOptions: RequestOptions,\n  request: http.ClientRequest,\n): string | undefined {\n  // nothing to clean\n  if (!description) {\n    return description;\n  }\n\n  // eslint-disable-next-line prefer-const\n  let [method, requestUrl] = description.split(' ');\n\n  // superagent sticks the protocol in a weird place (we check for host because if both host *and* protocol are missing,\n  // we're likely dealing with an internal route and this doesn't apply)\n  if (requestOptions.host && !requestOptions.protocol) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-explicit-any\n    requestOptions.protocol = (request as any)?.agent?.protocol; // worst comes to worst, this is undefined and nothing changes\n    requestUrl = extractUrl(requestOptions);\n  }\n\n  // internal routes can end up starting with a triple slash rather than a single one\n  if (requestUrl?.startsWith('///')) {\n    requestUrl = requestUrl.slice(2);\n  }\n\n  return `${method} ${requestUrl}`;\n}\n\n// the node types are missing a few properties which node's `urlToOptions` function spits out\nexport type RequestOptions = http.RequestOptions & { hash?: string; search?: string; pathname?: string; href?: string };\ntype RequestCallback = (response: http.IncomingMessage) => void;\nexport type RequestMethodArgs =\n  | [RequestOptions | string | URL, RequestCallback?]\n  | [string | URL, RequestOptions, RequestCallback?];\nexport type RequestMethod = (...args: RequestMethodArgs) => http.ClientRequest;\n\n/**\n * Convert a URL object into a RequestOptions object.\n *\n * Copied from Node's internals (where it's used in http(s).request() and http(s).get()), modified only to use the\n * RequestOptions type above.\n *\n * See https://github.com/nodejs/node/blob/master/lib/internal/url.js.\n */\nexport function urlToOptions(url: URL): RequestOptions {\n  const options: RequestOptions = {\n    protocol: url.protocol,\n    hostname:\n      typeof url.hostname === 'string' && url.hostname.startsWith('[') ? url.hostname.slice(1, -1) : url.hostname,\n    hash: url.hash,\n    search: url.search,\n    pathname: url.pathname,\n    path: `${url.pathname || ''}${url.search || ''}`,\n    href: url.href,\n  };\n  if (url.port !== '') {\n    options.port = Number(url.port);\n  }\n  if (url.username || url.password) {\n    options.auth = `${url.username}:${url.password}`;\n  }\n  return options;\n}\n\n/**\n * Normalize inputs to `http(s).request()` and `http(s).get()`.\n *\n * Legal inputs to `http(s).request()` and `http(s).get()` can take one of ten forms:\n *     [ RequestOptions | string | URL ],\n *     [ RequestOptions | string | URL, RequestCallback ],\n *     [ string | URL, RequestOptions ], and\n *     [ string | URL, RequestOptions, RequestCallback ].\n *\n * This standardizes to one of two forms: [ RequestOptions ] and [ RequestOptions, RequestCallback ]. A similar thing is\n * done as the first step of `http(s).request()` and `http(s).get()`; this just does it early so that we can interact\n * with the args in a standard way.\n *\n * @param requestArgs The inputs to `http(s).request()` or `http(s).get()`, as an array.\n *\n * @returns Equivalent args of the form [ RequestOptions ] or [ RequestOptions, RequestCallback ].\n */\nexport function normalizeRequestArgs(\n  requestArgs: RequestMethodArgs,\n): [RequestOptions] | [RequestOptions, RequestCallback] {\n  let callback, requestOptions;\n\n  // pop off the callback, if there is one\n  if (typeof requestArgs[requestArgs.length - 1] === 'function') {\n    callback = requestArgs.pop() as RequestCallback;\n  }\n\n  // create a RequestOptions object of whatever's at index 0\n  if (typeof requestArgs[0] === 'string') {\n    requestOptions = urlToOptions(new URL(requestArgs[0]));\n  } else if (requestArgs[0] instanceof URL) {\n    requestOptions = urlToOptions(requestArgs[0]);\n  } else {\n    requestOptions = requestArgs[0];\n  }\n\n  // if the options were given separately from the URL, fold them in\n  if (requestArgs.length === 2) {\n    requestOptions = { ...requestOptions, ...requestArgs[1] };\n  }\n\n  // return args in standardized form\n  if (callback) {\n    return [requestOptions, callback];\n  } else {\n    return [requestOptions];\n  }\n}\n", "import { getCurrentHub } from '@sentry/core';\nimport { Integration, Span } from '@sentry/types';\nimport { fill, logger, parseSemver } from '@sentry/utils';\nimport * as http from 'http';\nimport * as https from 'https';\n\nimport {\n  cleanSpanDescription,\n  extractUrl,\n  isSentryRequest,\n  normalizeRequestArgs,\n  RequestMethod,\n  RequestMethodArgs,\n} from './utils/http';\n\nconst NODE_VERSION = parseSemver(process.versions.node);\n\n/** http module integration */\nexport class Http implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'Http';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = Http.id;\n\n  /**\n   * @inheritDoc\n   */\n  private readonly _breadcrumbs: boolean;\n\n  /**\n   * @inheritDoc\n   */\n  private readonly _tracing: boolean;\n\n  /**\n   * @inheritDoc\n   */\n  public constructor(options: { breadcrumbs?: boolean; tracing?: boolean } = {}) {\n    this._breadcrumbs = typeof options.breadcrumbs === 'undefined' ? true : options.breadcrumbs;\n    this._tracing = typeof options.tracing === 'undefined' ? false : options.tracing;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(): void {\n    // No need to instrument if we don't want to track anything\n    if (!this._breadcrumbs && !this._tracing) {\n      return;\n    }\n\n    const wrappedHandlerMaker = _createWrappedRequestMethodFactory(this._breadcrumbs, this._tracing);\n\n    const httpModule = require('http');\n    fill(httpModule, 'get', wrappedHandlerMaker);\n    fill(httpModule, 'request', wrappedHandlerMaker);\n\n    // NOTE: Prior to Node 9, `https` used internals of `http` module, thus we don't patch it.\n    // If we do, we'd get double breadcrumbs and double spans for `https` calls.\n    // It has been changed in Node 9, so for all versions equal and above, we patch `https` separately.\n    if (NODE_VERSION.major && NODE_VERSION.major > 8) {\n      const httpsModule = require('https');\n      fill(httpsModule, 'get', wrappedHandlerMaker);\n      fill(httpsModule, 'request', wrappedHandlerMaker);\n    }\n  }\n}\n\n// for ease of reading below\ntype OriginalRequestMethod = RequestMethod;\ntype WrappedRequestMethod = RequestMethod;\ntype WrappedRequestMethodFactory = (original: OriginalRequestMethod) => WrappedRequestMethod;\n\n/**\n * Function which creates a function which creates wrapped versions of internal `request` and `get` calls within `http`\n * and `https` modules. (NB: Not a typo - this is a creator^2!)\n *\n * @param breadcrumbsEnabled Whether or not to record outgoing requests as breadcrumbs\n * @param tracingEnabled Whether or not to record outgoing requests as tracing spans\n *\n * @returns A function which accepts the exiting handler and returns a wrapped handler\n */\nfunction _createWrappedRequestMethodFactory(\n  breadcrumbsEnabled: boolean,\n  tracingEnabled: boolean,\n): WrappedRequestMethodFactory {\n  return function wrappedRequestMethodFactory(originalRequestMethod: OriginalRequestMethod): WrappedRequestMethod {\n    return function wrappedMethod(this: typeof http | typeof https, ...args: RequestMethodArgs): http.ClientRequest {\n      // eslint-disable-next-line @typescript-eslint/no-this-alias\n      const httpModule = this;\n\n      const requestArgs = normalizeRequestArgs(args);\n      const requestOptions = requestArgs[0];\n      const requestUrl = extractUrl(requestOptions);\n\n      // we don't want to record requests to Sentry as either breadcrumbs or spans, so just use the original method\n      if (isSentryRequest(requestUrl)) {\n        return originalRequestMethod.apply(httpModule, requestArgs);\n      }\n\n      let span: Span | undefined;\n      let parentSpan: Span | undefined;\n\n      const scope = getCurrentHub().getScope();\n      if (scope && tracingEnabled) {\n        parentSpan = scope.getSpan();\n        if (parentSpan) {\n          span = parentSpan.startChild({\n            description: `${requestOptions.method || 'GET'} ${requestUrl}`,\n            op: 'request',\n          });\n\n          const sentryTraceHeader = span.toTraceparent();\n          logger.log(\n            `[Tracing] Adding sentry-trace header ${sentryTraceHeader} to outgoing request to ${requestUrl}: `,\n          );\n          requestOptions.headers = { ...requestOptions.headers, 'sentry-trace': sentryTraceHeader };\n        }\n      }\n\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      return originalRequestMethod\n        .apply(httpModule, requestArgs)\n        .once('response', function(this: http.ClientRequest, res: http.IncomingMessage): void {\n          // eslint-disable-next-line @typescript-eslint/no-this-alias\n          const req = this;\n          if (breadcrumbsEnabled) {\n            addRequestBreadcrumb('response', requestUrl, req, res);\n          }\n          if (tracingEnabled && span) {\n            if (res.statusCode) {\n              span.setHttpStatus(res.statusCode);\n            }\n            span.description = cleanSpanDescription(span.description, requestOptions, req);\n            span.finish();\n          }\n        })\n        .once('error', function(this: http.ClientRequest): void {\n          // eslint-disable-next-line @typescript-eslint/no-this-alias\n          const req = this;\n\n          if (breadcrumbsEnabled) {\n            addRequestBreadcrumb('error', requestUrl, req);\n          }\n          if (tracingEnabled && span) {\n            span.setHttpStatus(500);\n            span.description = cleanSpanDescription(span.description, requestOptions, req);\n            span.finish();\n          }\n        });\n    };\n  };\n}\n\n/**\n * Captures Breadcrumb based on provided request/response pair\n */\nfunction addRequestBreadcrumb(event: string, url: string, req: http.ClientRequest, res?: http.IncomingMessage): void {\n  if (!getCurrentHub().getIntegration(Http)) {\n    return;\n  }\n\n  getCurrentHub().addBreadcrumb(\n    {\n      category: 'http',\n      data: {\n        method: req.method,\n        status_code: res && res.statusCode,\n        url,\n      },\n      type: 'http',\n    },\n    {\n      event,\n      request: req,\n      response: res,\n    },\n  );\n}\n", "import { getCurrentHub } from '@sentry/core';\nimport { forget, logger } from '@sentry/utils';\n\nimport { NodeClient } from '../../client';\n\nconst DEFAULT_SHUTDOWN_TIMEOUT = 2000;\n\n/**\n * @hidden\n */\nexport function logAndExitProcess(error: Error): void {\n  // eslint-disable-next-line no-console\n  console.error(error && error.stack ? error.stack : error);\n\n  const client = getCurrentHub().getClient<NodeClient>();\n\n  if (client === undefined) {\n    logger.warn('No NodeClient was defined, we are exiting the process now.');\n    global.process.exit(1);\n    return;\n  }\n\n  const options = client.getOptions();\n  const timeout =\n    (options && options.shutdownTimeout && options.shutdownTimeout > 0 && options.shutdownTimeout) ||\n    DEFAULT_SHUTDOWN_TIMEOUT;\n  forget(\n    client.close(timeout).then((result: boolean) => {\n      if (!result) {\n        logger.warn('We reached the timeout for emptying the request buffer, still exiting now!');\n      }\n      global.process.exit(1);\n    }),\n  );\n}\n", "import { getCurrentHub, Scope } from '@sentry/core';\nimport { Integration, Severity } from '@sentry/types';\nimport { logger } from '@sentry/utils';\n\nimport { NodeClient } from '../client';\nimport { logAndExitProcess } from './utils/errorhandling';\n\ntype OnFatalErrorHandler = (firstError: Error, secondError?: Error) => void;\n\n/** Global Promise Rejection handler */\nexport class OnUncaughtException implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'OnUncaughtException';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = OnUncaughtException.id;\n\n  /**\n   * @inheritDoc\n   */\n  public readonly handler: (error: Error) => void = this._makeErrorHandler();\n\n  /**\n   * @inheritDoc\n   */\n  public constructor(\n    private readonly _options: {\n      /**\n       * Default onFatalError handler\n       * @param firstError Error that has been thrown\n       * @param secondError If this was called multiple times this will be set\n       */\n      onFatalError?(firstError: Error, secondError?: Error): void;\n    } = {},\n  ) {}\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(): void {\n    global.process.on('uncaughtException', this.handler.bind(this));\n  }\n\n  /**\n   * @hidden\n   */\n  private _makeErrorHandler(): (error: Error) => void {\n    const timeout = 2000;\n    let caughtFirstError: boolean = false;\n    let caughtSecondError: boolean = false;\n    let calledFatalError: boolean = false;\n    let firstError: Error;\n\n    return (error: Error): void => {\n      let onFatalError: OnFatalErrorHandler = logAndExitProcess;\n      const client = getCurrentHub().getClient<NodeClient>();\n\n      if (this._options.onFatalError) {\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        onFatalError = this._options.onFatalError;\n      } else if (client && client.getOptions().onFatalError) {\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        onFatalError = client.getOptions().onFatalError as OnFatalErrorHandler;\n      }\n\n      if (!caughtFirstError) {\n        const hub = getCurrentHub();\n\n        // this is the first uncaught error and the ultimate reason for shutting down\n        // we want to do absolutely everything possible to ensure it gets captured\n        // also we want to make sure we don't go recursion crazy if more errors happen after this one\n        firstError = error;\n        caughtFirstError = true;\n\n        if (hub.getIntegration(OnUncaughtException)) {\n          hub.withScope((scope: Scope) => {\n            scope.setLevel(Severity.Fatal);\n            hub.captureException(error, {\n              originalException: error,\n              data: { mechanism: { handled: false, type: 'onuncaughtexception' } },\n            });\n            if (!calledFatalError) {\n              calledFatalError = true;\n              onFatalError(error);\n            }\n          });\n        } else {\n          if (!calledFatalError) {\n            calledFatalError = true;\n            onFatalError(error);\n          }\n        }\n      } else if (calledFatalError) {\n        // we hit an error *after* calling onFatalError - pretty boned at this point, just shut it down\n        logger.warn('uncaught exception after calling fatal error shutdown callback - this is bad! forcing shutdown');\n        logAndExitProcess(error);\n      } else if (!caughtSecondError) {\n        // two cases for how we can hit this branch:\n        //   - capturing of first error blew up and we just caught the exception from that\n        //     - quit trying to capture, proceed with shutdown\n        //   - a second independent error happened while waiting for first error to capture\n        //     - want to avoid causing premature shutdown before first error capture finishes\n        // it's hard to immediately tell case 1 from case 2 without doing some fancy/questionable domain stuff\n        // so let's instead just delay a bit before we proceed with our action here\n        // in case 1, we just wait a bit unnecessarily but ultimately do the same thing\n        // in case 2, the delay hopefully made us wait long enough for the capture to finish\n        // two potential nonideal outcomes:\n        //   nonideal case 1: capturing fails fast, we sit around for a few seconds unnecessarily before proceeding correctly by calling onFatalError\n        //   nonideal case 2: case 2 happens, 1st error is captured but slowly, timeout completes before capture and we treat second error as the sendErr of (nonexistent) failure from trying to capture first error\n        // note that after hitting this branch, we might catch more errors where (caughtSecondError && !calledFatalError)\n        //   we ignore them - they don't matter to us, we're just waiting for the second error timeout to finish\n        caughtSecondError = true;\n        setTimeout(() => {\n          if (!calledFatalError) {\n            // it was probably case 1, let's treat err as the sendErr and call onFatalError\n            calledFatalError = true;\n            onFatalError(firstError, error);\n          } else {\n            // it was probably case 2, our first error finished capturing while we waited, cool, do nothing\n          }\n        }, timeout); // capturing could take at least sendTimeout to fail, plus an arbitrary second for how long it takes to collect surrounding source etc\n      }\n    };\n  }\n}\n", "import { getCurrentHub, Scope } from '@sentry/core';\nimport { Integration } from '@sentry/types';\nimport { consoleSandbox } from '@sentry/utils';\n\nimport { logAndExitProcess } from './utils/errorhandling';\n\ntype UnhandledRejectionMode = 'none' | 'warn' | 'strict';\n\n/** Global Promise Rejection handler */\nexport class OnUnhandledRejection implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'OnUnhandledRejection';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = OnUnhandledRejection.id;\n\n  /**\n   * @inheritDoc\n   */\n  public constructor(\n    private readonly _options: {\n      /**\n       * Option deciding what to do after capturing unhandledRejection,\n       * that mimicks behavior of node's --unhandled-rejection flag.\n       */\n      mode: UnhandledRejectionMode;\n    } = { mode: 'warn' },\n  ) {}\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(): void {\n    global.process.on('unhandledRejection', this.sendUnhandledPromise.bind(this));\n  }\n\n  /**\n   * Send an exception with reason\n   * @param reason string\n   * @param promise promise\n   */\n  // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\n  public sendUnhandledPromise(reason: any, promise: any): void {\n    const hub = getCurrentHub();\n\n    if (!hub.getIntegration(OnUnhandledRejection)) {\n      this._handleRejection(reason);\n      return;\n    }\n\n    /* eslint-disable @typescript-eslint/no-unsafe-member-access */\n    const context = (promise.domain && promise.domain.sentryContext) || {};\n\n    hub.withScope((scope: Scope) => {\n      scope.setExtra('unhandledPromiseRejection', true);\n\n      // Preserve backwards compatibility with raven-node for now\n      if (context.user) {\n        scope.setUser(context.user);\n      }\n      if (context.tags) {\n        scope.setTags(context.tags);\n      }\n      if (context.extra) {\n        scope.setExtras(context.extra);\n      }\n\n      hub.captureException(reason, {\n        originalException: promise,\n        data: { mechanism: { handled: false, type: 'onunhandledrejection' } },\n      });\n    });\n    /* eslint-disable @typescript-eslint/no-unsafe-member-access */\n\n    this._handleRejection(reason);\n  }\n\n  /**\n   * Handler for `mode` option\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private _handleRejection(reason: any): void {\n    // https://github.com/nodejs/node/blob/7cf6f9e964aa00772965391c23acda6d71972a9a/lib/internal/process/promises.js#L234-L240\n    const rejectionWarning =\n      'This error originated either by ' +\n      'throwing inside of an async function without a catch block, ' +\n      'or by rejecting a promise which was not handled with .catch().' +\n      ' The promise rejected with the reason:';\n\n    /* eslint-disable no-console */\n    if (this._options.mode === 'warn') {\n      consoleSandbox(() => {\n        console.warn(rejectionWarning);\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        console.error(reason && reason.stack ? reason.stack : reason);\n      });\n    } else if (this._options.mode === 'strict') {\n      consoleSandbox(() => {\n        console.warn(rejectionWarning);\n      });\n      logAndExitProcess(reason);\n    }\n    /* eslint-enable no-console */\n  }\n}\n", "import { addGlobalEventProcessor, getCurrentHub } from '@sentry/core';\nimport { Event, EventHint, Exception, ExtendedError, Integration } from '@sentry/types';\nimport { isInstanceOf, SyncPromise } from '@sentry/utils';\n\nimport { getExceptionFromError } from '../parsers';\n\nconst DEFAULT_KEY = 'cause';\nconst DEFAULT_LIMIT = 5;\n\n/** Adds SDK info to an event. */\nexport class LinkedErrors implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'LinkedErrors';\n\n  /**\n   * @inheritDoc\n   */\n  public readonly name: string = LinkedErrors.id;\n\n  /**\n   * @inheritDoc\n   */\n  private readonly _key: string;\n\n  /**\n   * @inheritDoc\n   */\n  private readonly _limit: number;\n\n  /**\n   * @inheritDoc\n   */\n  public constructor(options: { key?: string; limit?: number } = {}) {\n    this._key = options.key || DEFAULT_KEY;\n    this._limit = options.limit || DEFAULT_LIMIT;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(): void {\n    addGlobalEventProcessor((event: Event, hint?: EventHint) => {\n      const self = getCurrentHub().getIntegration(LinkedErrors);\n      if (self) {\n        const handler = self._handler && self._handler.bind(self);\n        return typeof handler === 'function' ? handler(event, hint) : event;\n      }\n      return event;\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  private _handler(event: Event, hint?: EventHint): PromiseLike<Event> {\n    if (!event.exception || !event.exception.values || !hint || !isInstanceOf(hint.originalException, Error)) {\n      return SyncPromise.resolve(event);\n    }\n\n    return new SyncPromise<Event>(resolve => {\n      void this._walkErrorTree(hint.originalException as Error, this._key)\n        .then((linkedErrors: Exception[]) => {\n          if (event && event.exception && event.exception.values) {\n            event.exception.values = [...linkedErrors, ...event.exception.values];\n          }\n          resolve(event);\n        })\n        .then(null, () => {\n          resolve(event);\n        });\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  private _walkErrorTree(error: ExtendedError, key: string, stack: Exception[] = []): PromiseLike<Exception[]> {\n    if (!isInstanceOf(error[key], Error) || stack.length + 1 >= this._limit) {\n      return SyncPromise.resolve(stack);\n    }\n    return new SyncPromise<Exception[]>((resolve, reject) => {\n      void getExceptionFromError(error[key])\n        .then((exception: Exception) => {\n          void this._walkErrorTree(error[key], key, [exception, ...stack])\n            .then(resolve)\n            .then(null, () => {\n              reject();\n            });\n        })\n        .then(null, () => {\n          reject();\n        });\n    });\n  }\n}\n", "import { EventProcessor, Hub, Integration } from '@sentry/types';\nimport { existsSync, readFileSync } from 'fs';\nimport { dirname, join } from 'path';\n\nlet moduleCache: { [key: string]: string };\n\n/** Extract information about paths */\nfunction getPaths(): string[] {\n  try {\n    return require.cache ? Object.keys(require.cache as Record<string, unknown>) : [];\n  } catch (e) {\n    return [];\n  }\n}\n\n/** Extract information about package.json modules */\nfunction collectModules(): {\n  [name: string]: string;\n} {\n  const mainPaths = (require.main && require.main.paths) || [];\n  const paths = getPaths();\n  const infos: {\n    [name: string]: string;\n  } = {};\n  const seen: {\n    [path: string]: boolean;\n  } = {};\n\n  paths.forEach(path => {\n    let dir = path;\n\n    /** Traverse directories upward in the search of package.json file */\n    const updir = (): void | (() => void) => {\n      const orig = dir;\n      dir = dirname(orig);\n\n      if (!dir || orig === dir || seen[orig]) {\n        return undefined;\n      }\n      if (mainPaths.indexOf(dir) < 0) {\n        return updir();\n      }\n\n      const pkgfile = join(orig, 'package.json');\n      seen[orig] = true;\n\n      if (!existsSync(pkgfile)) {\n        return updir();\n      }\n\n      try {\n        const info = JSON.parse(readFileSync(pkgfile, 'utf8')) as {\n          name: string;\n          version: string;\n        };\n        infos[info.name] = info.version;\n      } catch (_oO) {\n        // no-empty\n      }\n    };\n\n    updir();\n  });\n\n  return infos;\n}\n\n/** Add node modules / packages to the event */\nexport class Modules implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'Modules';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = Modules.id;\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(addGlobalEventProcessor: (callback: EventProcessor) => void, getCurrentHub: () => Hub): void {\n    addGlobalEventProcessor(event => {\n      if (!getCurrentHub().getIntegration(Modules)) {\n        return event;\n      }\n      return {\n        ...event,\n        modules: this._getModules(),\n      };\n    });\n  }\n\n  /** Fetches the list of modules and the versions loaded by the entry file for your node.js app. */\n  private _getModules(): { [key: string]: string } {\n    if (!moduleCache) {\n      moduleCache = collectModules();\n    }\n    return moduleCache;\n  }\n}\n", "export { Console } from './console';\nexport { Http } from './http';\nexport { OnUncaughtException } from './onuncaughtexception';\nexport { OnUnhandledRejection } from './onunhandledrejection';\nexport { LinkedErrors } from './linkederrors';\nexport { Modules } from './modules';\n", "import { getCurrentHub, initAndBind, Integrations as CoreIntegrations } from '@sentry/core';\nimport { getMainCarrier, setHubOnCarrier } from '@sentry/hub';\nimport { SessionStatus } from '@sentry/types';\nimport { getGlobalObject } from '@sentry/utils';\nimport * as domain from 'domain';\n\nimport { NodeClient } from './client';\nimport { Console, Http, LinkedErrors, OnUncaughtException, OnUnhandledRejection } from './integrations';\nimport { NodeOptions } from './types';\n\nexport const defaultIntegrations = [\n  // Common\n  new CoreIntegrations.InboundFilters(),\n  new CoreIntegrations.FunctionToString(),\n  // Native Wrappers\n  new Console(),\n  new Http(),\n  // Global Handlers\n  new OnUncaughtException(),\n  new OnUnhandledRejection(),\n  // Misc\n  new LinkedErrors(),\n];\n\n/**\n * The Sentry Node SDK Client.\n *\n * To use this SDK, call the {@link init} function as early as possible in the\n * main entry module. To set context information or send manual events, use the\n * provided methods.\n *\n * @example\n * ```\n *\n * const { init } = require('@sentry/node');\n *\n * init({\n *   dsn: '__DSN__',\n *   // ...\n * });\n * ```\n *\n * @example\n * ```\n *\n * const { configureScope } = require('@sentry/node');\n * configureScope((scope: Scope) => {\n *   scope.setExtra({ battery: 0.7 });\n *   scope.setTag({ user_mode: 'admin' });\n *   scope.setUser({ id: '4711' });\n * });\n * ```\n *\n * @example\n * ```\n *\n * const { addBreadcrumb } = require('@sentry/node');\n * addBreadcrumb({\n *   message: 'My Breadcrumb',\n *   // ...\n * });\n * ```\n *\n * @example\n * ```\n *\n * const Sentry = require('@sentry/node');\n * Sentry.captureMessage('Hello, world!');\n * Sentry.captureException(new Error('Good bye'));\n * Sentry.captureEvent({\n *   message: 'Manual',\n *   stacktrace: [\n *     // ...\n *   ],\n * });\n * ```\n *\n * @see {@link NodeOptions} for documentation on configuration options.\n */\nexport function init(options: NodeOptions = {}): void {\n  const carrier = getMainCarrier();\n  const autoloadedIntegrations = carrier.__SENTRY__?.integrations || [];\n\n  options.defaultIntegrations =\n    options.defaultIntegrations === false\n      ? []\n      : [\n          ...(Array.isArray(options.defaultIntegrations) ? options.defaultIntegrations : defaultIntegrations),\n          ...autoloadedIntegrations,\n        ];\n\n  if (options.dsn === undefined && process.env.SENTRY_DSN) {\n    options.dsn = process.env.SENTRY_DSN;\n  }\n\n  if (options.tracesSampleRate === undefined && process.env.SENTRY_TRACES_SAMPLE_RATE) {\n    const tracesSampleRate = parseFloat(process.env.SENTRY_TRACES_SAMPLE_RATE);\n    if (isFinite(tracesSampleRate)) {\n      options.tracesSampleRate = tracesSampleRate;\n    }\n  }\n\n  if (options.release === undefined) {\n    const detectedRelease = getSentryRelease();\n    if (detectedRelease !== undefined) {\n      options.release = detectedRelease;\n    } else {\n      // If release is not provided, then we should disable autoSessionTracking\n      options.autoSessionTracking = false;\n    }\n  }\n\n  if (options.autoSessionTracking === undefined) {\n    options.autoSessionTracking = false;\n  }\n\n  if (options.environment === undefined && process.env.SENTRY_ENVIRONMENT) {\n    options.environment = process.env.SENTRY_ENVIRONMENT;\n  }\n\n  if (options.autoSessionTracking === undefined) {\n    options.autoSessionTracking = true;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-explicit-any\n  if ((domain as any).active) {\n    setHubOnCarrier(carrier, getCurrentHub());\n  }\n\n  initAndBind(NodeClient, options);\n\n  if (options.autoSessionTracking) {\n    startSessionTracking();\n  }\n}\n\n/**\n * This is the getter for lastEventId.\n *\n * @returns The last event id of a captured event.\n */\nexport function lastEventId(): string | undefined {\n  return getCurrentHub().lastEventId();\n}\n\n/**\n * A promise that resolves when all current events have been sent.\n * If you provide a timeout and the queue takes longer to drain the promise returns false.\n *\n * @param timeout Maximum time in ms the client should wait.\n */\nexport async function flush(timeout?: number): Promise<boolean> {\n  const client = getCurrentHub().getClient<NodeClient>();\n  if (client) {\n    return client.flush(timeout);\n  }\n  return Promise.reject(false);\n}\n\n/**\n * A promise that resolves when all current events have been sent.\n * If you provide a timeout and the queue takes longer to drain the promise returns false.\n *\n * @param timeout Maximum time in ms the client should wait.\n */\nexport async function close(timeout?: number): Promise<boolean> {\n  const client = getCurrentHub().getClient<NodeClient>();\n  if (client) {\n    return client.close(timeout);\n  }\n  return Promise.reject(false);\n}\n\n/**\n * Function that takes an instance of NodeClient and checks if autoSessionTracking option is enabled for that client\n */\nexport function isAutoSessionTrackingEnabled(client?: NodeClient): boolean {\n  if (client === undefined) {\n    return false;\n  }\n  const clientOptions: NodeOptions = client && client.getOptions();\n  if (clientOptions && clientOptions.autoSessionTracking !== undefined) {\n    return clientOptions.autoSessionTracking;\n  }\n  return false;\n}\n\n/**\n * Returns a release dynamically from environment variables.\n */\nexport function getSentryRelease(fallback?: string): string | undefined {\n  // Always read first as Sentry takes this as precedence\n  if (process.env.SENTRY_RELEASE) {\n    return process.env.SENTRY_RELEASE;\n  }\n\n  // This supports the variable that sentry-webpack-plugin injects\n  const global = getGlobalObject();\n  if (global.SENTRY_RELEASE && global.SENTRY_RELEASE.id) {\n    return global.SENTRY_RELEASE.id;\n  }\n\n  return (\n    // GitHub Actions - https://help.github.com/en/actions/configuring-and-managing-workflows/using-environment-variables#default-environment-variables\n    process.env.GITHUB_SHA ||\n    // Netlify - https://docs.netlify.com/configure-builds/environment-variables/#build-metadata\n    process.env.COMMIT_REF ||\n    // Vercel - https://vercel.com/docs/v2/build-step#system-environment-variables\n    process.env.VERCEL_GIT_COMMIT_SHA ||\n    process.env.VERCEL_GITHUB_COMMIT_SHA ||\n    process.env.VERCEL_GITLAB_COMMIT_SHA ||\n    process.env.VERCEL_BITBUCKET_COMMIT_SHA ||\n    // Zeit (now known as Vercel)\n    process.env.ZEIT_GITHUB_COMMIT_SHA ||\n    process.env.ZEIT_GITLAB_COMMIT_SHA ||\n    process.env.ZEIT_BITBUCKET_COMMIT_SHA ||\n    fallback\n  );\n}\n\n/**\n * Enable automatic Session Tracking for the node process.\n */\nfunction startSessionTracking(): void {\n  const hub = getCurrentHub();\n  hub.startSession();\n  // Emitted in the case of healthy sessions, error of `mechanism.handled: true` and unhandledrejections because\n  // The 'beforeExit' event is not emitted for conditions causing explicit termination,\n  // such as calling process.exit() or uncaught exceptions.\n  // Ref: https://nodejs.org/api/process.html#process_event_beforeexit\n  process.on('beforeExit', () => {\n    const session = hub.getScope()?.getSession();\n    const terminalStates = [SessionStatus.Exited, SessionStatus.Crashed];\n    // Only call endSession, if the Session exists on Scope and SessionStatus is not a\n    // Terminal Status i.e. Exited or Crashed because\n    // \"When a session is moved away from ok it must not be updated anymore.\"\n    // Ref: https://develop.sentry.dev/sdk/sessions/\n    if (session && !terminalStates.includes(session.status)) hub.endSession();\n  });\n}\n", "import * as fs from 'fs';\nimport * as path from 'path';\n\n/**\n * Recursively read the contents of a directory.\n *\n * @param targetDir Absolute or relative path of the directory to scan. All returned paths will be relative to this\n * directory.\n * @returns Array holding all relative paths\n */\nexport function deepReadDirSync(targetDir: string): string[] {\n  const targetDirAbsPath = path.resolve(targetDir);\n\n  if (!fs.existsSync(targetDirAbsPath)) {\n    throw new Error(`Cannot read contents of ${targetDirAbsPath}. Directory does not exist.`);\n  }\n\n  if (!fs.statSync(targetDirAbsPath).isDirectory()) {\n    throw new Error(`Cannot read contents of ${targetDirAbsPath}, because it is not a directory.`);\n  }\n\n  // This does the same thing as its containing function, `deepReadDirSync` (except that - purely for convenience - it\n  // deals in absolute paths rather than relative ones). We need this to be separate from the outer function to preserve\n  // the difference between `targetDirAbsPath` and `currentDirAbsPath`.\n  const deepReadCurrentDir = (currentDirAbsPath: string): string[] => {\n    return fs.readdirSync(currentDirAbsPath).reduce((absPaths: string[], itemName: string) => {\n      const itemAbsPath = path.join(currentDirAbsPath, itemName);\n\n      if (fs.statSync(itemAbsPath).isDirectory()) {\n        return [...absPaths, ...deepReadCurrentDir(itemAbsPath)];\n      }\n\n      return [...absPaths, itemAbsPath];\n    }, []);\n  };\n\n  return deepReadCurrentDir(targetDirAbsPath).map(absPath => path.relative(targetDirAbsPath, absPath));\n}\n", "/** The status of an Span. */\n// eslint-disable-next-line import/export\nexport enum SpanStatus {\n  /** The operation completed successfully. */\n  Ok = 'ok',\n  /** Deadline expired before operation could complete. */\n  DeadlineExceeded = 'deadline_exceeded',\n  /** 401 Unauthorized (actually does mean unauthenticated according to RFC 7235) */\n  Unauthenticated = 'unauthenticated',\n  /** 403 Forbidden */\n  PermissionDenied = 'permission_denied',\n  /** 404 Not Found. Some requested entity (file or directory) was not found. */\n  NotFound = 'not_found',\n  /** 429 Too Many Requests */\n  ResourceExhausted = 'resource_exhausted',\n  /** Client specified an invalid argument. 4xx. */\n  InvalidArgument = 'invalid_argument',\n  /** 501 Not Implemented */\n  Unimplemented = 'unimplemented',\n  /** 503 Service Unavailable */\n  Unavailable = 'unavailable',\n  /** Other/generic 5xx. */\n  InternalError = 'internal_error',\n  /** Unknown. Any non-standard HTTP status code. */\n  UnknownError = 'unknown_error',\n  /** The operation was cancelled (typically by the user). */\n  Cancelled = 'cancelled',\n  /** Already exists (409) */\n  AlreadyExists = 'already_exists',\n  /** Operation was rejected because the system is not in a state required for the operation's */\n  FailedPrecondition = 'failed_precondition',\n  /** The operation was aborted, typically due to a concurrency issue. */\n  Aborted = 'aborted',\n  /** Operation was attempted past the valid range. */\n  OutOfRange = 'out_of_range',\n  /** Unrecoverable data loss or corruption */\n  DataLoss = 'data_loss',\n}\n\n// eslint-disable-next-line @typescript-eslint/no-namespace, import/export\nexport namespace SpanStatus {\n  /**\n   * Converts a HTTP status code into a {@link SpanStatus}.\n   *\n   * @param httpStatus The HTTP response status code.\n   * @returns The span status or {@link SpanStatus.UnknownError}.\n   */\n  export function fromHttpCode(httpStatus: number): SpanStatus {\n    if (httpStatus < 400) {\n      return SpanStatus.Ok;\n    }\n\n    if (httpStatus >= 400 && httpStatus < 500) {\n      switch (httpStatus) {\n        case 401:\n          return SpanStatus.Unauthenticated;\n        case 403:\n          return SpanStatus.PermissionDenied;\n        case 404:\n          return SpanStatus.NotFound;\n        case 409:\n          return SpanStatus.AlreadyExists;\n        case 413:\n          return SpanStatus.FailedPrecondition;\n        case 429:\n          return SpanStatus.ResourceExhausted;\n        default:\n          return SpanStatus.InvalidArgument;\n      }\n    }\n\n    if (httpStatus >= 500 && httpStatus < 600) {\n      switch (httpStatus) {\n        case 501:\n          return SpanStatus.Unimplemented;\n        case 503:\n          return SpanStatus.Unavailable;\n        case 504:\n          return SpanStatus.DeadlineExceeded;\n        default:\n          return SpanStatus.InternalError;\n      }\n    }\n\n    return SpanStatus.UnknownError;\n  }\n}\n", "import { getCurrentHub, Hub } from '@sentry/hub';\nimport { Options, TraceparentData, Transaction } from '@sentry/types';\n\nexport const TRACEPARENT_REGEXP = new RegExp(\n  '^[ \\\\t]*' + // whitespace\n  '([0-9a-f]{32})?' + // trace_id\n  '-?([0-9a-f]{16})?' + // span_id\n  '-?([01])?' + // sampled\n    '[ \\\\t]*$', // whitespace\n);\n\n/**\n * Determines if tracing is currently enabled.\n *\n * Tracing is enabled when at least one of `tracesSampleRate` and `tracesSampler` is defined in the SDK config.\n */\nexport function hasTracingEnabled(\n  options: Options | undefined = getCurrentHub()\n    .getClient()\n    ?.getOptions(),\n): boolean {\n  if (!options) {\n    return false;\n  }\n  return 'tracesSampleRate' in options || 'tracesSampler' in options;\n}\n\n/**\n * Extract transaction context data from a `sentry-trace` header.\n *\n * @param traceparent Traceparent string\n *\n * @returns Object containing data from the header, or undefined if traceparent string is malformed\n */\nexport function extractTraceparentData(traceparent: string): TraceparentData | undefined {\n  const matches = traceparent.match(TRACEPARENT_REGEXP);\n  if (matches) {\n    let parentSampled: boolean | undefined;\n    if (matches[3] === '1') {\n      parentSampled = true;\n    } else if (matches[3] === '0') {\n      parentSampled = false;\n    }\n    return {\n      traceId: matches[1],\n      parentSampled,\n      parentSpanId: matches[2],\n    };\n  }\n  return undefined;\n}\n\n/** Grabs active transaction off scope, if any */\nexport function getActiveTransaction<T extends Transaction>(hub: Hub = getCurrentHub()): T | undefined {\n  return hub?.getScope()?.getTransaction() as T | undefined;\n}\n\n/**\n * Converts from milliseconds to seconds\n * @param time time in ms\n */\nexport function msToSec(time: number): number {\n  return time / 1000;\n}\n\n/**\n * Converts from seconds to milliseconds\n * @param time time in seconds\n */\nexport function secToMs(time: number): number {\n  return time * 1000;\n}\n\n// so it can be used in manual instrumentation without necessitating a hard dependency on @sentry/utils\nexport { stripUrlQueryAndFragment } from '@sentry/utils';\n", "import { addInstrumentationHandler, logger } from '@sentry/utils';\n\nimport { SpanStatus } from './spanstatus';\nimport { getActiveTransaction } from './utils';\n\n/**\n * Configures global error listeners\n */\nexport function registerErrorInstrumentation(): void {\n  addInstrumentationHandler({\n    callback: errorCallback,\n    type: 'error',\n  });\n  addInstrumentationHandler({\n    callback: errorCallback,\n    type: 'unhandledrejection',\n  });\n}\n\n/**\n * If an error or unhandled promise occurs, we mark the active transaction as failed\n */\nfunction errorCallback(): void {\n  const activeTransaction = getActiveTransaction();\n  if (activeTransaction) {\n    logger.log(`[Tracing] Transaction: ${SpanStatus.InternalError} -> Global error occured`);\n    activeTransaction.setStatus(SpanStatus.InternalError);\n  }\n}\n", "/* eslint-disable max-lines */\nimport { Primitive, Span as SpanInterface, SpanContext, Transaction } from '@sentry/types';\nimport { dropUndefinedKeys, timestampWithMs, uuid4 } from '@sentry/utils';\n\nimport { SpanStatus } from './spanstatus';\n\n/**\n * Keeps track of finished spans for a given transaction\n * @internal\n * @hideconstructor\n * @hidden\n */\nexport class SpanRecorder {\n  public spans: Span[] = [];\n\n  private readonly _maxlen: number;\n\n  public constructor(maxlen: number = 1000) {\n    this._maxlen = maxlen;\n  }\n\n  /**\n   * This is just so that we don't run out of memory while recording a lot\n   * of spans. At some point we just stop and flush out the start of the\n   * trace tree (i.e.the first n spans with the smallest\n   * start_timestamp).\n   */\n  public add(span: Span): void {\n    if (this.spans.length > this._maxlen) {\n      span.spanRecorder = undefined;\n    } else {\n      this.spans.push(span);\n    }\n  }\n}\n\n/**\n * Span contains all data about a span\n */\nexport class Span implements SpanInterface {\n  /**\n   * @inheritDoc\n   */\n  public traceId: string = uuid4();\n\n  /**\n   * @inheritDoc\n   */\n  public spanId: string = uuid4().substring(16);\n\n  /**\n   * @inheritDoc\n   */\n  public parentSpanId?: string;\n\n  /**\n   * Internal keeper of the status\n   */\n  public status?: SpanStatus | string;\n\n  /**\n   * @inheritDoc\n   */\n  public sampled?: boolean;\n\n  /**\n   * Timestamp in seconds when the span was created.\n   */\n  public startTimestamp: number = timestampWithMs();\n\n  /**\n   * Timestamp in seconds when the span ended.\n   */\n  public endTimestamp?: number;\n\n  /**\n   * @inheritDoc\n   */\n  public op?: string;\n\n  /**\n   * @inheritDoc\n   */\n  public description?: string;\n\n  /**\n   * @inheritDoc\n   */\n  public tags: { [key: string]: Primitive } = {};\n\n  /**\n   * @inheritDoc\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public data: { [key: string]: any } = {};\n\n  /**\n   * List of spans that were finalized\n   */\n  public spanRecorder?: SpanRecorder;\n\n  /**\n   * @inheritDoc\n   */\n  public transaction?: Transaction;\n\n  /**\n   * You should never call the constructor manually, always use `Sentry.startTransaction()`\n   * or call `startChild()` on an existing span.\n   * @internal\n   * @hideconstructor\n   * @hidden\n   */\n  public constructor(spanContext?: SpanContext) {\n    if (!spanContext) {\n      return this;\n    }\n    if (spanContext.traceId) {\n      this.traceId = spanContext.traceId;\n    }\n    if (spanContext.spanId) {\n      this.spanId = spanContext.spanId;\n    }\n    if (spanContext.parentSpanId) {\n      this.parentSpanId = spanContext.parentSpanId;\n    }\n    // We want to include booleans as well here\n    if ('sampled' in spanContext) {\n      this.sampled = spanContext.sampled;\n    }\n    if (spanContext.op) {\n      this.op = spanContext.op;\n    }\n    if (spanContext.description) {\n      this.description = spanContext.description;\n    }\n    if (spanContext.data) {\n      this.data = spanContext.data;\n    }\n    if (spanContext.tags) {\n      this.tags = spanContext.tags;\n    }\n    if (spanContext.status) {\n      this.status = spanContext.status;\n    }\n    if (spanContext.startTimestamp) {\n      this.startTimestamp = spanContext.startTimestamp;\n    }\n    if (spanContext.endTimestamp) {\n      this.endTimestamp = spanContext.endTimestamp;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   * @deprecated\n   */\n  public child(\n    spanContext?: Pick<SpanContext, Exclude<keyof SpanContext, 'spanId' | 'sampled' | 'traceId' | 'parentSpanId'>>,\n  ): Span {\n    return this.startChild(spanContext);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public startChild(\n    spanContext?: Pick<SpanContext, Exclude<keyof SpanContext, 'spanId' | 'sampled' | 'traceId' | 'parentSpanId'>>,\n  ): Span {\n    const childSpan = new Span({\n      ...spanContext,\n      parentSpanId: this.spanId,\n      sampled: this.sampled,\n      traceId: this.traceId,\n    });\n\n    childSpan.spanRecorder = this.spanRecorder;\n    if (childSpan.spanRecorder) {\n      childSpan.spanRecorder.add(childSpan);\n    }\n\n    childSpan.transaction = this.transaction;\n\n    return childSpan;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setTag(key: string, value: Primitive): this {\n    this.tags = { ...this.tags, [key]: value };\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\n  public setData(key: string, value: any): this {\n    this.data = { ...this.data, [key]: value };\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setStatus(value: SpanStatus): this {\n    this.status = value;\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setHttpStatus(httpStatus: number): this {\n    this.setTag('http.status_code', String(httpStatus));\n    const spanStatus = SpanStatus.fromHttpCode(httpStatus);\n    if (spanStatus !== SpanStatus.UnknownError) {\n      this.setStatus(spanStatus);\n    }\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public isSuccess(): boolean {\n    return this.status === SpanStatus.Ok;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public finish(endTimestamp?: number): void {\n    this.endTimestamp = typeof endTimestamp === 'number' ? endTimestamp : timestampWithMs();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public toTraceparent(): string {\n    let sampledString = '';\n    if (this.sampled !== undefined) {\n      sampledString = this.sampled ? '-1' : '-0';\n    }\n    return `${this.traceId}-${this.spanId}${sampledString}`;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public toContext(): SpanContext {\n    return dropUndefinedKeys({\n      data: this.data,\n      description: this.description,\n      endTimestamp: this.endTimestamp,\n      op: this.op,\n      parentSpanId: this.parentSpanId,\n      sampled: this.sampled,\n      spanId: this.spanId,\n      startTimestamp: this.startTimestamp,\n      status: this.status,\n      tags: this.tags,\n      traceId: this.traceId,\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public updateWithContext(spanContext: SpanContext): this {\n    this.data = spanContext.data ?? {};\n    this.description = spanContext.description;\n    this.endTimestamp = spanContext.endTimestamp;\n    this.op = spanContext.op;\n    this.parentSpanId = spanContext.parentSpanId;\n    this.sampled = spanContext.sampled;\n    this.spanId = spanContext.spanId ?? this.spanId;\n    this.startTimestamp = spanContext.startTimestamp ?? this.startTimestamp;\n    this.status = spanContext.status;\n    this.tags = spanContext.tags ?? {};\n    this.traceId = spanContext.traceId ?? this.traceId;\n\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getTraceContext(): {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    data?: { [key: string]: any };\n    description?: string;\n    op?: string;\n    parent_span_id?: string;\n    span_id: string;\n    status?: string;\n    tags?: { [key: string]: Primitive };\n    trace_id: string;\n  } {\n    return dropUndefinedKeys({\n      data: Object.keys(this.data).length > 0 ? this.data : undefined,\n      description: this.description,\n      op: this.op,\n      parent_span_id: this.parentSpanId,\n      span_id: this.spanId,\n      status: this.status,\n      tags: Object.keys(this.tags).length > 0 ? this.tags : undefined,\n      trace_id: this.traceId,\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public toJSON(): {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    data?: { [key: string]: any };\n    description?: string;\n    op?: string;\n    parent_span_id?: string;\n    span_id: string;\n    start_timestamp: number;\n    status?: string;\n    tags?: { [key: string]: Primitive };\n    timestamp?: number;\n    trace_id: string;\n  } {\n    return dropUndefinedKeys({\n      data: Object.keys(this.data).length > 0 ? this.data : undefined,\n      description: this.description,\n      op: this.op,\n      parent_span_id: this.parentSpanId,\n      span_id: this.spanId,\n      start_timestamp: this.startTimestamp,\n      status: this.status,\n      tags: Object.keys(this.tags).length > 0 ? this.tags : undefined,\n      timestamp: this.endTimestamp,\n      trace_id: this.traceId,\n    });\n  }\n}\n", "import { getCurrentHub, Hub } from '@sentry/hub';\nimport {\n  Event,\n  Measurements,\n  Transaction as TransactionInterface,\n  TransactionContext,\n  TransactionMetadata,\n} from '@sentry/types';\nimport { dropUndefinedKeys, isInstanceOf, logger } from '@sentry/utils';\n\nimport { Span as SpanClass, SpanRecorder } from './span';\n\n/** JSDoc */\nexport class Transaction extends SpanClass implements TransactionInterface {\n  public name: string;\n\n  public metadata: TransactionMetadata;\n\n  private _measurements: Measurements = {};\n\n  /**\n   * The reference to the current hub.\n   */\n  private readonly _hub: Hub = (getCurrentHub() as unknown) as Hub;\n\n  private _trimEnd?: boolean;\n\n  /**\n   * This constructor should never be called manually. Those instrumenting tracing should use\n   * `Sentry.startTransaction()`, and internal methods should use `hub.startTransaction()`.\n   * @internal\n   * @hideconstructor\n   * @hidden\n   */\n  public constructor(transactionContext: TransactionContext, hub?: Hub) {\n    super(transactionContext);\n\n    if (isInstanceOf(hub, Hub)) {\n      this._hub = hub as Hub;\n    }\n\n    this.name = transactionContext.name || '';\n\n    this.metadata = transactionContext.metadata || {};\n    this._trimEnd = transactionContext.trimEnd;\n\n    // this is because transactions are also spans, and spans have a transaction pointer\n    this.transaction = this;\n  }\n\n  /**\n   * JSDoc\n   */\n  public setName(name: string): void {\n    this.name = name;\n  }\n\n  /**\n   * Attaches SpanRecorder to the span itself\n   * @param maxlen maximum number of spans that can be recorded\n   */\n  public initSpanRecorder(maxlen: number = 1000): void {\n    if (!this.spanRecorder) {\n      this.spanRecorder = new SpanRecorder(maxlen);\n    }\n    this.spanRecorder.add(this);\n  }\n\n  /**\n   * Set observed measurements for this transaction.\n   * @hidden\n   */\n  public setMeasurements(measurements: Measurements): void {\n    this._measurements = { ...measurements };\n  }\n\n  /**\n   * Set metadata for this transaction.\n   * @hidden\n   */\n  public setMetadata(newMetadata: TransactionMetadata): void {\n    this.metadata = { ...this.metadata, ...newMetadata };\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public finish(endTimestamp?: number): string | undefined {\n    // This transaction is already finished, so we should not flush it again.\n    if (this.endTimestamp !== undefined) {\n      return undefined;\n    }\n\n    if (!this.name) {\n      logger.warn('Transaction has no name, falling back to `<unlabeled transaction>`.');\n      this.name = '<unlabeled transaction>';\n    }\n\n    // just sets the end timestamp\n    super.finish(endTimestamp);\n\n    if (this.sampled !== true) {\n      // At this point if `sampled !== true` we want to discard the transaction.\n      logger.log('[Tracing] Discarding transaction because its trace was not chosen to be sampled.');\n      return undefined;\n    }\n\n    const finishedSpans = this.spanRecorder ? this.spanRecorder.spans.filter(s => s !== this && s.endTimestamp) : [];\n\n    if (this._trimEnd && finishedSpans.length > 0) {\n      this.endTimestamp = finishedSpans.reduce((prev: SpanClass, current: SpanClass) => {\n        if (prev.endTimestamp && current.endTimestamp) {\n          return prev.endTimestamp > current.endTimestamp ? prev : current;\n        }\n        return prev;\n      }).endTimestamp;\n    }\n\n    const transaction: Event = {\n      contexts: {\n        trace: this.getTraceContext(),\n      },\n      spans: finishedSpans,\n      start_timestamp: this.startTimestamp,\n      tags: this.tags,\n      timestamp: this.endTimestamp,\n      transaction: this.name,\n      type: 'transaction',\n      debug_meta: this.metadata,\n    };\n\n    const hasMeasurements = Object.keys(this._measurements).length > 0;\n\n    if (hasMeasurements) {\n      logger.log('[Measurements] Adding measurements to transaction', JSON.stringify(this._measurements, undefined, 2));\n      transaction.measurements = this._measurements;\n    }\n\n    logger.log(`[Tracing] Finishing ${this.op} transaction: ${this.name}.`);\n\n    return this._hub.captureEvent(transaction);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public toContext(): TransactionContext {\n    const spanContext = super.toContext();\n\n    return dropUndefinedKeys({\n      ...spanContext,\n      name: this.name,\n      trimEnd: this._trimEnd,\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public updateWithContext(transactionContext: TransactionContext): this {\n    super.updateWithContext(transactionContext);\n\n    this.name = transactionContext.name ?? '';\n\n    this._trimEnd = transactionContext.trimEnd;\n\n    return this;\n  }\n}\n", "import { Hub } from '@sentry/hub';\nimport { TransactionContext } from '@sentry/types';\nimport { logger, timestampWithMs } from '@sentry/utils';\n\nimport { Span, SpanRecorder } from './span';\nimport { SpanStatus } from './spanstatus';\nimport { Transaction } from './transaction';\n\nexport const DEFAULT_IDLE_TIMEOUT = 1000;\n\n/**\n * @inheritDoc\n */\nexport class IdleTransactionSpanRecorder extends SpanRecorder {\n  public constructor(\n    private readonly _pushActivity: (id: string) => void,\n    private readonly _popActivity: (id: string) => void,\n    public transactionSpanId: string = '',\n    maxlen?: number,\n  ) {\n    super(maxlen);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public add(span: Span): void {\n    // We should make sure we do not push and pop activities for\n    // the transaction that this span recorder belongs to.\n    if (span.spanId !== this.transactionSpanId) {\n      // We patch span.finish() to pop an activity after setting an endTimestamp.\n      span.finish = (endTimestamp?: number) => {\n        span.endTimestamp = typeof endTimestamp === 'number' ? endTimestamp : timestampWithMs();\n        this._popActivity(span.spanId);\n      };\n\n      // We should only push new activities if the span does not have an end timestamp.\n      if (span.endTimestamp === undefined) {\n        this._pushActivity(span.spanId);\n      }\n    }\n\n    super.add(span);\n  }\n}\n\nexport type BeforeFinishCallback = (transactionSpan: IdleTransaction, endTimestamp: number) => void;\n\n/**\n * An IdleTransaction is a transaction that automatically finishes. It does this by tracking child spans as activities.\n * You can have multiple IdleTransactions active, but if the `onScope` option is specified, the idle transaction will\n * put itself on the scope on creation.\n */\nexport class IdleTransaction extends Transaction {\n  // Activities store a list of active spans\n  public activities: Record<string, boolean> = {};\n\n  // Stores reference to the timeout that calls _beat().\n  private _heartbeatTimer: number = 0;\n\n  // Track state of activities in previous heartbeat\n  private _prevHeartbeatString: string | undefined;\n\n  // Amount of times heartbeat has counted. Will cause transaction to finish after 3 beats.\n  private _heartbeatCounter: number = 0;\n\n  // We should not use heartbeat if we finished a transaction\n  private _finished: boolean = false;\n\n  private readonly _beforeFinishCallbacks: BeforeFinishCallback[] = [];\n\n  // If a transaction is created and no activities are added, we want to make sure that\n  // it times out properly. This is cleared and not used when activities are added.\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private _initTimeout: any;\n\n  public constructor(\n    transactionContext: TransactionContext,\n    private readonly _idleHub?: Hub,\n    // The time to wait in ms until the idle transaction will be finished. Default: 1000\n    private readonly _idleTimeout: number = DEFAULT_IDLE_TIMEOUT,\n    // If an idle transaction should be put itself on and off the scope automatically.\n    private readonly _onScope: boolean = false,\n  ) {\n    super(transactionContext, _idleHub);\n\n    if (_idleHub && _onScope) {\n      // There should only be one active transaction on the scope\n      clearActiveTransaction(_idleHub);\n\n      // We set the transaction here on the scope so error events pick up the trace\n      // context and attach it to the error.\n      logger.log(`Setting idle transaction on scope. Span ID: ${this.spanId}`);\n      _idleHub.configureScope(scope => scope.setSpan(this));\n    }\n\n    this._initTimeout = setTimeout(() => {\n      if (!this._finished) {\n        this.finish();\n      }\n    }, this._idleTimeout);\n  }\n\n  /** {@inheritDoc} */\n  public finish(endTimestamp: number = timestampWithMs()): string | undefined {\n    this._finished = true;\n    this.activities = {};\n\n    if (this.spanRecorder) {\n      logger.log('[Tracing] finishing IdleTransaction', new Date(endTimestamp * 1000).toISOString(), this.op);\n\n      for (const callback of this._beforeFinishCallbacks) {\n        callback(this, endTimestamp);\n      }\n\n      this.spanRecorder.spans = this.spanRecorder.spans.filter((span: Span) => {\n        // If we are dealing with the transaction itself, we just return it\n        if (span.spanId === this.spanId) {\n          return true;\n        }\n\n        // We cancel all pending spans with status \"cancelled\" to indicate the idle transaction was finished early\n        if (!span.endTimestamp) {\n          span.endTimestamp = endTimestamp;\n          span.setStatus(SpanStatus.Cancelled);\n          logger.log('[Tracing] cancelling span since transaction ended early', JSON.stringify(span, undefined, 2));\n        }\n\n        const keepSpan = span.startTimestamp < endTimestamp;\n        if (!keepSpan) {\n          logger.log(\n            '[Tracing] discarding Span since it happened after Transaction was finished',\n            JSON.stringify(span, undefined, 2),\n          );\n        }\n        return keepSpan;\n      });\n\n      logger.log('[Tracing] flushing IdleTransaction');\n    } else {\n      logger.log('[Tracing] No active IdleTransaction');\n    }\n\n    // this._onScope is true if the transaction was previously on the scope.\n    if (this._onScope) {\n      clearActiveTransaction(this._idleHub);\n    }\n\n    return super.finish(endTimestamp);\n  }\n\n  /**\n   * Register a callback function that gets excecuted before the transaction finishes.\n   * Useful for cleanup or if you want to add any additional spans based on current context.\n   *\n   * This is exposed because users have no other way of running something before an idle transaction\n   * finishes.\n   */\n  public registerBeforeFinishCallback(callback: BeforeFinishCallback): void {\n    this._beforeFinishCallbacks.push(callback);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public initSpanRecorder(maxlen?: number): void {\n    if (!this.spanRecorder) {\n      const pushActivity = (id: string): void => {\n        if (this._finished) {\n          return;\n        }\n        this._pushActivity(id);\n      };\n      const popActivity = (id: string): void => {\n        if (this._finished) {\n          return;\n        }\n        this._popActivity(id);\n      };\n\n      this.spanRecorder = new IdleTransactionSpanRecorder(pushActivity, popActivity, this.spanId, maxlen);\n\n      // Start heartbeat so that transactions do not run forever.\n      logger.log('Starting heartbeat');\n      this._pingHeartbeat();\n    }\n    this.spanRecorder.add(this);\n  }\n\n  /**\n   * Start tracking a specific activity.\n   * @param spanId The span id that represents the activity\n   */\n  private _pushActivity(spanId: string): void {\n    if (this._initTimeout) {\n      clearTimeout(this._initTimeout);\n      this._initTimeout = undefined;\n    }\n    logger.log(`[Tracing] pushActivity: ${spanId}`);\n    this.activities[spanId] = true;\n    logger.log('[Tracing] new activities count', Object.keys(this.activities).length);\n  }\n\n  /**\n   * Remove an activity from usage\n   * @param spanId The span id that represents the activity\n   */\n  private _popActivity(spanId: string): void {\n    if (this.activities[spanId]) {\n      logger.log(`[Tracing] popActivity ${spanId}`);\n      // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n      delete this.activities[spanId];\n      logger.log('[Tracing] new activities count', Object.keys(this.activities).length);\n    }\n\n    if (Object.keys(this.activities).length === 0) {\n      const timeout = this._idleTimeout;\n      // We need to add the timeout here to have the real endtimestamp of the transaction\n      // Remember timestampWithMs is in seconds, timeout is in ms\n      const end = timestampWithMs() + timeout / 1000;\n\n      setTimeout(() => {\n        if (!this._finished) {\n          this.finish(end);\n        }\n      }, timeout);\n    }\n  }\n\n  /**\n   * Checks when entries of this.activities are not changing for 3 beats.\n   * If this occurs we finish the transaction.\n   */\n  private _beat(): void {\n    clearTimeout(this._heartbeatTimer);\n    // We should not be running heartbeat if the idle transaction is finished.\n    if (this._finished) {\n      return;\n    }\n\n    const keys = Object.keys(this.activities);\n    const heartbeatString = keys.length ? keys.reduce((prev: string, current: string) => prev + current) : '';\n\n    if (heartbeatString === this._prevHeartbeatString) {\n      this._heartbeatCounter += 1;\n    } else {\n      this._heartbeatCounter = 1;\n    }\n\n    this._prevHeartbeatString = heartbeatString;\n\n    if (this._heartbeatCounter >= 3) {\n      logger.log(`[Tracing] Transaction finished because of no change for 3 heart beats`);\n      this.setStatus(SpanStatus.DeadlineExceeded);\n      this.setTag('heartbeat', 'failed');\n      this.finish();\n    } else {\n      this._pingHeartbeat();\n    }\n  }\n\n  /**\n   * Pings the heartbeat\n   */\n  private _pingHeartbeat(): void {\n    logger.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`);\n    this._heartbeatTimer = (setTimeout(() => {\n      this._beat();\n    }, 5000) as unknown) as number;\n  }\n}\n\n/**\n * Reset active transaction on scope\n */\nfunction clearActiveTransaction(hub?: Hub): void {\n  if (hub) {\n    const scope = hub.getScope();\n    if (scope) {\n      const transaction = scope.getTransaction();\n      if (transaction) {\n        scope.setSpan(undefined);\n      }\n    }\n  }\n}\n", "import { getMainCarrier, Hub } from '@sentry/hub';\nimport {\n  CustomSamplingContext,\n  Integration,\n  IntegrationClass,\n  Options,\n  SamplingContext,\n  TransactionContext,\n  TransactionSamplingMethod,\n} from '@sentry/types';\nimport { dynamicRequire, isNodeEnv, loadModule, logger } from '@sentry/utils';\n\nimport { registerErrorInstrumentation } from './errors';\nimport { IdleTransaction } from './idletransaction';\nimport { Transaction } from './transaction';\nimport { hasTracingEnabled } from './utils';\n\n/** Returns all trace headers that are currently on the top scope. */\nfunction traceHeaders(this: Hub): { [key: string]: string } {\n  const scope = this.getScope();\n  if (scope) {\n    const span = scope.getSpan();\n    if (span) {\n      return {\n        'sentry-trace': span.toTraceparent(),\n      };\n    }\n  }\n  return {};\n}\n\n/**\n * Makes a sampling decision for the given transaction and stores it on the transaction.\n *\n * Called every time a transaction is created. Only transactions which emerge with a `sampled` value of `true` will be\n * sent to Sentry.\n *\n * @param hub: The hub off of which to read config options\n * @param transaction: The transaction needing a sampling decision\n * @param samplingContext: Default and user-provided data which may be used to help make the decision\n *\n * @returns The given transaction with its `sampled` value set\n */\nfunction sample<T extends Transaction>(transaction: T, options: Options, samplingContext: SamplingContext): T {\n  // nothing to do if tracing is not enabled\n  if (!hasTracingEnabled()) {\n    transaction.sampled = false;\n    return transaction;\n  }\n\n  // if the user has forced a sampling decision by passing a `sampled` value in their transaction context, go with that\n  if (transaction.sampled !== undefined) {\n    transaction.setMetadata({\n      transactionSampling: { method: TransactionSamplingMethod.Explicit },\n    });\n    return transaction;\n  }\n\n  // we would have bailed already if neither `tracesSampler` nor `tracesSampleRate` were defined, so one of these should\n  // work; prefer the hook if so\n  let sampleRate;\n  if (typeof options.tracesSampler === 'function') {\n    sampleRate = options.tracesSampler(samplingContext);\n    transaction.setMetadata({\n      transactionSampling: {\n        method: TransactionSamplingMethod.Sampler,\n        // cast to number in case it's a boolean\n        rate: Number(sampleRate),\n      },\n    });\n  } else if (samplingContext.parentSampled !== undefined) {\n    sampleRate = samplingContext.parentSampled;\n    transaction.setMetadata({\n      transactionSampling: { method: TransactionSamplingMethod.Inheritance },\n    });\n  } else {\n    sampleRate = options.tracesSampleRate;\n    transaction.setMetadata({\n      transactionSampling: {\n        method: TransactionSamplingMethod.Rate,\n        // cast to number in case it's a boolean\n        rate: Number(sampleRate),\n      },\n    });\n  }\n\n  // Since this is coming from the user (or from a function provided by the user), who knows what we might get. (The\n  // only valid values are booleans or numbers between 0 and 1.)\n  if (!isValidSampleRate(sampleRate)) {\n    logger.warn(`[Tracing] Discarding transaction because of invalid sample rate.`);\n    transaction.sampled = false;\n    return transaction;\n  }\n\n  // if the function returned 0 (or false), or if `tracesSampleRate` is 0, it's a sign the transaction should be dropped\n  if (!sampleRate) {\n    logger.log(\n      `[Tracing] Discarding transaction because ${\n        typeof options.tracesSampler === 'function'\n          ? 'tracesSampler returned 0 or false'\n          : 'a negative sampling decision was inherited or tracesSampleRate is set to 0'\n      }`,\n    );\n    transaction.sampled = false;\n    return transaction;\n  }\n\n  // Now we roll the dice. Math.random is inclusive of 0, but not of 1, so strict < is safe here. In case sampleRate is\n  // a boolean, the < comparison will cause it to be automatically cast to 1 if it's true and 0 if it's false.\n  transaction.sampled = Math.random() < (sampleRate as number | boolean);\n\n  // if we're not going to keep it, we're done\n  if (!transaction.sampled) {\n    logger.log(\n      `[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(\n        sampleRate,\n      )})`,\n    );\n    return transaction;\n  }\n\n  logger.log(`[Tracing] starting ${transaction.op} transaction - ${transaction.name}`);\n  return transaction;\n}\n\n/**\n * Checks the given sample rate to make sure it is valid type and value (a boolean, or a number between 0 and 1).\n */\nfunction isValidSampleRate(rate: unknown): boolean {\n  // we need to check NaN explicitly because it's of type 'number' and therefore wouldn't get caught by this typecheck\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  if (isNaN(rate as any) || !(typeof rate === 'number' || typeof rate === 'boolean')) {\n    logger.warn(\n      `[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(\n        rate,\n      )} of type ${JSON.stringify(typeof rate)}.`,\n    );\n    return false;\n  }\n\n  // in case sampleRate is a boolean, it will get automatically cast to 1 if it's true and 0 if it's false\n  if (rate < 0 || rate > 1) {\n    logger.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${rate}.`);\n    return false;\n  }\n  return true;\n}\n\n/**\n * Creates a new transaction and adds a sampling decision if it doesn't yet have one.\n *\n * The Hub.startTransaction method delegates to this method to do its work, passing the Hub instance in as `this`, as if\n * it had been called on the hub directly. Exists as a separate function so that it can be injected into the class as an\n * \"extension method.\"\n *\n * @param this: The Hub starting the transaction\n * @param transactionContext: Data used to configure the transaction\n * @param CustomSamplingContext: Optional data to be provided to the `tracesSampler` function (if any)\n *\n * @returns The new transaction\n *\n * @see {@link Hub.startTransaction}\n */\nfunction _startTransaction(\n  this: Hub,\n  transactionContext: TransactionContext,\n  customSamplingContext?: CustomSamplingContext,\n): Transaction {\n  const options = this.getClient()?.getOptions() || {};\n\n  let transaction = new Transaction(transactionContext, this);\n  transaction = sample(transaction, options, {\n    parentSampled: transactionContext.parentSampled,\n    transactionContext,\n    ...customSamplingContext,\n  });\n  if (transaction.sampled) {\n    transaction.initSpanRecorder(options._experiments?.maxSpans as number);\n  }\n  return transaction;\n}\n\n/**\n * Create new idle transaction.\n */\nexport function startIdleTransaction(\n  hub: Hub,\n  transactionContext: TransactionContext,\n  idleTimeout?: number,\n  onScope?: boolean,\n  customSamplingContext?: CustomSamplingContext,\n): IdleTransaction {\n  const options = hub.getClient()?.getOptions() || {};\n\n  let transaction = new IdleTransaction(transactionContext, hub, idleTimeout, onScope);\n  transaction = sample(transaction, options, {\n    parentSampled: transactionContext.parentSampled,\n    transactionContext,\n    ...customSamplingContext,\n  });\n  if (transaction.sampled) {\n    transaction.initSpanRecorder(options._experiments?.maxSpans as number);\n  }\n  return transaction;\n}\n\n/**\n * @private\n */\nexport function _addTracingExtensions(): void {\n  const carrier = getMainCarrier();\n  if (!carrier.__SENTRY__) {\n    return;\n  }\n  carrier.__SENTRY__.extensions = carrier.__SENTRY__.extensions || {};\n  if (!carrier.__SENTRY__.extensions.startTransaction) {\n    carrier.__SENTRY__.extensions.startTransaction = _startTransaction;\n  }\n  if (!carrier.__SENTRY__.extensions.traceHeaders) {\n    carrier.__SENTRY__.extensions.traceHeaders = traceHeaders;\n  }\n}\n\n/**\n * @private\n */\nfunction _autoloadDatabaseIntegrations(): void {\n  const carrier = getMainCarrier();\n  if (!carrier.__SENTRY__) {\n    return;\n  }\n\n  const packageToIntegrationMapping: Record<string, () => Integration> = {\n    mongodb() {\n      const integration = dynamicRequire(module, './integrations/mongo') as { Mongo: IntegrationClass<Integration> };\n      return new integration.Mongo();\n    },\n    mongoose() {\n      const integration = dynamicRequire(module, './integrations/mongo') as { Mongo: IntegrationClass<Integration> };\n      return new integration.Mongo({ mongoose: true });\n    },\n    mysql() {\n      const integration = dynamicRequire(module, './integrations/mysql') as { Mysql: IntegrationClass<Integration> };\n      return new integration.Mysql();\n    },\n    pg() {\n      const integration = dynamicRequire(module, './integrations/postgres') as {\n        Postgres: IntegrationClass<Integration>;\n      };\n      return new integration.Postgres();\n    },\n  };\n\n  const mappedPackages = Object.keys(packageToIntegrationMapping)\n    .filter(moduleName => !!loadModule(moduleName))\n    .map(pkg => {\n      try {\n        return packageToIntegrationMapping[pkg]();\n      } catch (e) {\n        return undefined;\n      }\n    })\n    .filter(p => p) as Integration[];\n\n  if (mappedPackages.length > 0) {\n    carrier.__SENTRY__.integrations = [...(carrier.__SENTRY__.integrations || []), ...mappedPackages];\n  }\n}\n\n/**\n * This patches the global object and injects the Tracing extensions methods\n */\nexport function addExtensionMethods(): void {\n  _addTracingExtensions();\n\n  // Detect and automatically load specified integrations.\n  if (isNodeEnv()) {\n    _autoloadDatabaseIntegrations();\n  }\n\n  // If an error happens globally, we should make sure transaction status is set to error.\n  registerErrorInstrumentation();\n}\n", "import { getGlobalObject, logger } from '@sentry/utils';\n\nimport { IdleTransaction } from '../idletransaction';\nimport { SpanStatus } from '../spanstatus';\nimport { getActiveTransaction } from '../utils';\n\nconst global = getGlobalObject<Window>();\n\n/**\n * Add a listener that cancels and finishes a transaction when the global\n * document is hidden.\n */\nexport function registerBackgroundTabDetection(): void {\n  if (global && global.document) {\n    global.document.addEventListener('visibilitychange', () => {\n      const activeTransaction = getActiveTransaction() as IdleTransaction;\n      if (global.document.hidden && activeTransaction) {\n        logger.log(\n          `[Tracing] Transaction: ${SpanStatus.Cancelled} -> since tab moved to the background, op: ${activeTransaction.op}`,\n        );\n        // We should not set status if it is already set, this prevent important statuses like\n        // error or data loss from being overwritten on transaction.\n        if (!activeTransaction.status) {\n          activeTransaction.setStatus(SpanStatus.Cancelled);\n        }\n        activeTransaction.setTag('visibilitychange', 'document.hidden');\n        activeTransaction.finish();\n      }\n    });\n  } else {\n    logger.warn('[Tracing] Could not set up background tab detection due to lack of global document');\n  }\n}\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Metric, ReportHandler } from '../types';\n\nexport const bindReporter = (\n  callback: ReportHandler,\n  metric: Metric,\n  po: PerformanceObserver | undefined,\n  observeAllUpdates?: boolean,\n): (() => void) => {\n  let prevValue: number;\n  return () => {\n    if (po && metric.isFinal) {\n      po.disconnect();\n    }\n    if (metric.value >= 0) {\n      if (observeAllUpdates || metric.isFinal || document.visibilityState === 'hidden') {\n        metric.delta = metric.value - (prevValue || 0);\n\n        // Report the metric if there's a non-zero delta, if the metric is\n        // final, or if no previous value exists (which can happen in the case\n        // of the document becoming hidden when the metric value is 0).\n        // See: https://github.com/GoogleChrome/web-vitals/issues/14\n        if (metric.delta || metric.isFinal || prevValue === undefined) {\n          callback(metric);\n          prevValue = metric.value;\n        }\n      }\n    }\n  };\n};\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Performantly generate a unique, 27-char string by combining the current\n * timestamp with a 13-digit random number.\n * @return {string}\n */\nexport const generateUniqueID = (): string => {\n  return `${Date.now()}-${Math.floor(Math.random() * (9e12 - 1)) + 1e12}`;\n};\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Metric } from '../types';\nimport { generateUniqueID } from './generateUniqueID';\n\nexport const initMetric = (name: Metric['name'], value = -1): Metric => {\n  return {\n    name,\n    value,\n    delta: 0,\n    entries: [],\n    id: generateUniqueID(),\n    isFinal: false,\n  };\n};\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface PerformanceEntryHandler {\n  (entry: PerformanceEntry): void;\n}\n\n/**\n * Takes a performance entry type and a callback function, and creates a\n * `PerformanceObserver` instance that will observe the specified entry type\n * with buffering enabled and call the callback _for each entry_.\n *\n * This function also feature-detects entry support and wraps the logic in a\n * try/catch to avoid errors in unsupporting browsers.\n */\nexport const observe = (type: string, callback: PerformanceEntryHandler): PerformanceObserver | undefined => {\n  try {\n    if (PerformanceObserver.supportedEntryTypes.includes(type)) {\n      const po: PerformanceObserver = new PerformanceObserver(l => l.getEntries().map(callback));\n\n      po.observe({ type, buffered: true });\n      return po;\n    }\n  } catch (e) {\n    // Do nothing.\n  }\n  return;\n};\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface OnHiddenCallback {\n  // TODO(philipwalton): add `isPersisted` if needed for bfcache.\n  ({ timeStamp, isUnloading }: { timeStamp: number; isUnloading: boolean }): void;\n}\n\nlet isUnloading = false;\nlet listenersAdded = false;\n\nconst onPageHide = (event: PageTransitionEvent): void => {\n  isUnloading = !event.persisted;\n};\n\nconst addListeners = (): void => {\n  addEventListener('pagehide', onPageHide);\n\n  // `beforeunload` is needed to fix this bug:\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=987409\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  addEventListener('beforeunload', () => {});\n};\n\nexport const onHidden = (cb: OnHiddenCallback, once = false): void => {\n  if (!listenersAdded) {\n    addListeners();\n    listenersAdded = true;\n  }\n\n  addEventListener(\n    'visibilitychange',\n    ({ timeStamp }) => {\n      if (document.visibilityState === 'hidden') {\n        cb({ timeStamp, isUnloading });\n      }\n    },\n    { capture: true, once },\n  );\n};\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { bindReporter } from './lib/bindReporter';\nimport { initMetric } from './lib/initMetric';\nimport { observe, PerformanceEntryHandler } from './lib/observe';\nimport { onHidden } from './lib/onHidden';\nimport { ReportHandler } from './types';\n\n// https://wicg.github.io/layout-instability/#sec-layout-shift\nexport interface LayoutShift extends PerformanceEntry {\n  value: number;\n  hadRecentInput: boolean;\n  sources: Array<LayoutShiftAttribution>;\n  toJSON(): Record<string, unknown>;\n}\n\nexport interface LayoutShiftAttribution {\n  node?: Node;\n  previousRect: DOMRectReadOnly;\n  currentRect: DOMRectReadOnly;\n}\n\nexport const getCLS = (onReport: ReportHandler, reportAllChanges = false): void => {\n  const metric = initMetric('CLS', 0);\n\n  let report: ReturnType<typeof bindReporter>;\n\n  const entryHandler = (entry: LayoutShift): void => {\n    // Only count layout shifts without recent user input.\n    if (!entry.hadRecentInput) {\n      (metric.value as number) += entry.value;\n      metric.entries.push(entry);\n      report();\n    }\n  };\n\n  const po = observe('layout-shift', entryHandler as PerformanceEntryHandler);\n  if (po) {\n    report = bindReporter(onReport, metric, po, reportAllChanges);\n\n    onHidden(({ isUnloading }) => {\n      po.takeRecords().map(entryHandler as PerformanceEntryHandler);\n\n      if (isUnloading) {\n        metric.isFinal = true;\n      }\n      report();\n    });\n  }\n};\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { onHidden } from './onHidden';\n\nlet firstHiddenTime: number;\n\ntype HiddenType = {\n  readonly timeStamp: number;\n};\n\nexport const getFirstHidden = (): HiddenType => {\n  if (firstHiddenTime === undefined) {\n    // If the document is hidden when this code runs, assume it was hidden\n    // since navigation start. This isn't a perfect heuristic, but it's the\n    // best we can do until an API is available to support querying past\n    // visibilityState.\n    firstHiddenTime = document.visibilityState === 'hidden' ? 0 : Infinity;\n\n    // Update the time if/when the document becomes hidden.\n    onHidden(({ timeStamp }) => (firstHiddenTime = timeStamp), true);\n  }\n\n  return {\n    get timeStamp() {\n      return firstHiddenTime;\n    },\n  };\n};\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { bindReporter } from './lib/bindReporter';\nimport { getFirstHidden } from './lib/getFirstHidden';\nimport { initMetric } from './lib/initMetric';\nimport { observe, PerformanceEntryHandler } from './lib/observe';\nimport { onHidden } from './lib/onHidden';\nimport { ReportHandler } from './types';\n\ninterface FIDPolyfillCallback {\n  (value: number, event: Event): void;\n}\n\ninterface FIDPolyfill {\n  onFirstInputDelay: (onReport: FIDPolyfillCallback) => void;\n}\n\ndeclare global {\n  interface Window {\n    perfMetrics: FIDPolyfill;\n  }\n}\n\n// https://wicg.github.io/event-timing/#sec-performance-event-timing\ninterface PerformanceEventTiming extends PerformanceEntry {\n  processingStart: DOMHighResTimeStamp;\n  cancelable?: boolean;\n  target?: Element;\n}\n\nexport const getFID = (onReport: ReportHandler): void => {\n  const metric = initMetric('FID');\n  const firstHidden = getFirstHidden();\n\n  const entryHandler = (entry: PerformanceEventTiming): void => {\n    // Only report if the page wasn't hidden prior to the first input.\n    if (entry.startTime < firstHidden.timeStamp) {\n      metric.value = entry.processingStart - entry.startTime;\n      metric.entries.push(entry);\n      metric.isFinal = true;\n      report();\n    }\n  };\n\n  const po = observe('first-input', entryHandler as PerformanceEntryHandler);\n  const report = bindReporter(onReport, metric, po);\n\n  if (po) {\n    onHidden(() => {\n      po.takeRecords().map(entryHandler as PerformanceEntryHandler);\n      po.disconnect();\n    }, true);\n  } else {\n    if (window.perfMetrics && window.perfMetrics.onFirstInputDelay) {\n      window.perfMetrics.onFirstInputDelay((value: number, event: Event) => {\n        // Only report if the page wasn't hidden prior to the first input.\n        if (event.timeStamp < firstHidden.timeStamp) {\n          metric.value = value;\n          metric.isFinal = true;\n          metric.entries = [\n            {\n              entryType: 'first-input',\n              name: event.type,\n              target: event.target,\n              cancelable: event.cancelable,\n              startTime: event.timeStamp,\n              processingStart: event.timeStamp + value,\n            } as PerformanceEventTiming,\n          ];\n          report();\n        }\n      });\n    }\n  }\n};\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlet inputPromise: Promise<Event>;\n\nexport const whenInput = (): Promise<Event> => {\n  if (!inputPromise) {\n    inputPromise = new Promise(r => {\n      return ['scroll', 'keydown', 'pointerdown'].map(type => {\n        addEventListener(type, r, {\n          once: true,\n          passive: true,\n          capture: true,\n        });\n      });\n    });\n  }\n  return inputPromise;\n};\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { bindReporter } from './lib/bindReporter';\nimport { getFirstHidden } from './lib/getFirstHidden';\nimport { initMetric } from './lib/initMetric';\nimport { observe, PerformanceEntryHandler } from './lib/observe';\nimport { onHidden } from './lib/onHidden';\nimport { whenInput } from './lib/whenInput';\nimport { ReportHandler } from './types';\n\n// https://wicg.github.io/largest-contentful-paint/#sec-largest-contentful-paint-interface\nexport interface LargestContentfulPaint extends PerformanceEntry {\n  renderTime: DOMHighResTimeStamp;\n  loadTime: DOMHighResTimeStamp;\n  size: number;\n  id: string;\n  url: string;\n  element?: Element;\n  toJSON(): Record<string, string>;\n}\n\nexport const getLCP = (onReport: ReportHandler, reportAllChanges = false): void => {\n  const metric = initMetric('LCP');\n  const firstHidden = getFirstHidden();\n\n  let report: ReturnType<typeof bindReporter>;\n\n  const entryHandler = (entry: PerformanceEntry): void => {\n    // The startTime attribute returns the value of the renderTime if it is not 0,\n    // and the value of the loadTime otherwise.\n    const value = entry.startTime;\n\n    // If the page was hidden prior to paint time of the entry,\n    // ignore it and mark the metric as final, otherwise add the entry.\n    if (value < firstHidden.timeStamp) {\n      metric.value = value;\n      metric.entries.push(entry);\n    } else {\n      metric.isFinal = true;\n    }\n\n    report();\n  };\n\n  const po = observe('largest-contentful-paint', entryHandler);\n\n  if (po) {\n    report = bindReporter(onReport, metric, po, reportAllChanges);\n\n    const onFinal = (): void => {\n      if (!metric.isFinal) {\n        po.takeRecords().map(entryHandler as PerformanceEntryHandler);\n        metric.isFinal = true;\n        report();\n      }\n    };\n\n    void whenInput().then(onFinal);\n    onHidden(onFinal, true);\n  }\n};\n", "/* eslint-disable max-lines */\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { Measurements, SpanContext } from '@sentry/types';\nimport { browserPerformanceTimeOrigin, getGlobalObject, htmlTreeAsString, isNodeEnv, logger } from '@sentry/utils';\n\nimport { Span } from '../span';\nimport { Transaction } from '../transaction';\nimport { msToSec } from '../utils';\nimport { getCLS, LayoutShift } from './web-vitals/getCLS';\nimport { getFID } from './web-vitals/getFID';\nimport { getLCP, LargestContentfulPaint } from './web-vitals/getLCP';\nimport { getFirstHidden } from './web-vitals/lib/getFirstHidden';\nimport { NavigatorDeviceMemory, NavigatorNetworkInformation } from './web-vitals/types';\n\nconst global = getGlobalObject<Window>();\n\n/** Class tracking metrics  */\nexport class MetricsInstrumentation {\n  private _measurements: Measurements = {};\n\n  private _performanceCursor: number = 0;\n  private _lcpEntry: LargestContentfulPaint | undefined;\n  private _clsEntry: LayoutShift | undefined;\n\n  public constructor() {\n    if (!isNodeEnv() && global?.performance) {\n      if (global.performance.mark) {\n        global.performance.mark('sentry-tracing-init');\n      }\n\n      this._trackCLS();\n      this._trackLCP();\n      this._trackFID();\n    }\n  }\n\n  /** Add performance related spans to a transaction */\n  public addPerformanceEntries(transaction: Transaction): void {\n    if (!global || !global.performance || !global.performance.getEntries || !browserPerformanceTimeOrigin) {\n      // Gatekeeper if performance API not available\n      return;\n    }\n\n    logger.log('[Tracing] Adding & adjusting spans using Performance API');\n\n    const timeOrigin = msToSec(browserPerformanceTimeOrigin);\n    let entryScriptSrc: string | undefined;\n\n    if (global.document) {\n      // eslint-disable-next-line @typescript-eslint/prefer-for-of\n      for (let i = 0; i < document.scripts.length; i++) {\n        // We go through all scripts on the page and look for 'data-entry'\n        // We remember the name and measure the time between this script finished loading and\n        // our mark 'sentry-tracing-init'\n        if (document.scripts[i].dataset.entry === 'true') {\n          entryScriptSrc = document.scripts[i].src;\n          break;\n        }\n      }\n    }\n\n    let entryScriptStartTimestamp: number | undefined;\n    let tracingInitMarkStartTime: number | undefined;\n    let responseStartTimestamp: number | undefined;\n    let requestStartTimestamp: number | undefined;\n\n    global.performance\n      .getEntries()\n      .slice(this._performanceCursor)\n      .forEach((entry: Record<string, any>) => {\n        const startTime = msToSec(entry.startTime as number);\n        const duration = msToSec(entry.duration as number);\n\n        if (transaction.op === 'navigation' && timeOrigin + startTime < transaction.startTimestamp) {\n          return;\n        }\n\n        switch (entry.entryType) {\n          case 'navigation': {\n            addNavigationSpans(transaction, entry, timeOrigin);\n            responseStartTimestamp = timeOrigin + msToSec(entry.responseStart as number);\n            requestStartTimestamp = timeOrigin + msToSec(entry.requestStart as number);\n            break;\n          }\n          case 'mark':\n          case 'paint':\n          case 'measure': {\n            const startTimestamp = addMeasureSpans(transaction, entry, startTime, duration, timeOrigin);\n            if (tracingInitMarkStartTime === undefined && entry.name === 'sentry-tracing-init') {\n              tracingInitMarkStartTime = startTimestamp;\n            }\n\n            // capture web vitals\n\n            const firstHidden = getFirstHidden();\n            // Only report if the page wasn't hidden prior to the web vital.\n            const shouldRecord = entry.startTime < firstHidden.timeStamp;\n\n            if (entry.name === 'first-paint' && shouldRecord) {\n              logger.log('[Measurements] Adding FP');\n              this._measurements['fp'] = { value: entry.startTime };\n              this._measurements['mark.fp'] = { value: startTimestamp };\n            }\n\n            if (entry.name === 'first-contentful-paint' && shouldRecord) {\n              logger.log('[Measurements] Adding FCP');\n              this._measurements['fcp'] = { value: entry.startTime };\n              this._measurements['mark.fcp'] = { value: startTimestamp };\n            }\n\n            break;\n          }\n          case 'resource': {\n            const resourceName = (entry.name as string).replace(window.location.origin, '');\n            const endTimestamp = addResourceSpans(transaction, entry, resourceName, startTime, duration, timeOrigin);\n            // We remember the entry script end time to calculate the difference to the first init mark\n            if (entryScriptStartTimestamp === undefined && (entryScriptSrc || '').indexOf(resourceName) > -1) {\n              entryScriptStartTimestamp = endTimestamp;\n            }\n            break;\n          }\n          default:\n          // Ignore other entry types.\n        }\n      });\n\n    if (entryScriptStartTimestamp !== undefined && tracingInitMarkStartTime !== undefined) {\n      _startChild(transaction, {\n        description: 'evaluation',\n        endTimestamp: tracingInitMarkStartTime,\n        op: 'script',\n        startTimestamp: entryScriptStartTimestamp,\n      });\n    }\n\n    this._performanceCursor = Math.max(performance.getEntries().length - 1, 0);\n\n    this._trackNavigator(transaction);\n\n    // Measurements are only available for pageload transactions\n    if (transaction.op === 'pageload') {\n      // normalize applicable web vital values to be relative to transaction.startTimestamp\n\n      const timeOrigin = msToSec(browserPerformanceTimeOrigin);\n\n      // Generate TTFB (Time to First Byte), which measured as the time between the beginning of the transaction and the\n      // start of the response in milliseconds\n      if (typeof responseStartTimestamp === 'number') {\n        logger.log('[Measurements] Adding TTFB');\n        this._measurements['ttfb'] = { value: (responseStartTimestamp - transaction.startTimestamp) * 1000 };\n\n        if (typeof requestStartTimestamp === 'number' && requestStartTimestamp <= responseStartTimestamp) {\n          // Capture the time spent making the request and receiving the first byte of the response.\n          // This is the time between the start of the request and the start of the response in milliseconds.\n          this._measurements['ttfb.requestTime'] = { value: (responseStartTimestamp - requestStartTimestamp) * 1000 };\n        }\n      }\n\n      ['fcp', 'fp', 'lcp'].forEach(name => {\n        if (!this._measurements[name] || timeOrigin >= transaction.startTimestamp) {\n          return;\n        }\n\n        // The web vitals, fcp, fp, lcp, and ttfb, all measure relative to timeOrigin.\n        // Unfortunately, timeOrigin is not captured within the transaction span data, so these web vitals will need\n        // to be adjusted to be relative to transaction.startTimestamp.\n\n        const oldValue = this._measurements[name].value;\n        const measurementTimestamp = timeOrigin + msToSec(oldValue);\n        // normalizedValue should be in milliseconds\n        const normalizedValue = Math.abs((measurementTimestamp - transaction.startTimestamp) * 1000);\n\n        const delta = normalizedValue - oldValue;\n        logger.log(`[Measurements] Normalized ${name} from ${oldValue} to ${normalizedValue} (${delta})`);\n\n        this._measurements[name].value = normalizedValue;\n      });\n\n      if (this._measurements['mark.fid'] && this._measurements['fid']) {\n        // create span for FID\n\n        _startChild(transaction, {\n          description: 'first input delay',\n          endTimestamp: this._measurements['mark.fid'].value + msToSec(this._measurements['fid'].value),\n          op: 'web.vitals',\n          startTimestamp: this._measurements['mark.fid'].value,\n        });\n      }\n\n      transaction.setMeasurements(this._measurements);\n      this._tagMetricInfo(transaction);\n    }\n  }\n\n  /** Add LCP / CLS data to transaction to allow debugging */\n  private _tagMetricInfo(transaction: Transaction): void {\n    if (this._lcpEntry) {\n      logger.log('[Measurements] Adding LCP Data');\n      // Capture Properties of the LCP element that contributes to the LCP.\n\n      if (this._lcpEntry.element) {\n        transaction.setTag('lcp.element', htmlTreeAsString(this._lcpEntry.element));\n      }\n\n      if (this._lcpEntry.id) {\n        transaction.setTag('lcp.id', this._lcpEntry.id);\n      }\n\n      if (this._lcpEntry.url) {\n        // Trim URL to the first 200 characters.\n        transaction.setTag('lcp.url', this._lcpEntry.url.trim().slice(0, 200));\n      }\n\n      transaction.setTag('lcp.size', this._lcpEntry.size);\n    }\n\n    if (this._clsEntry) {\n      logger.log('[Measurements] Adding CLS Data');\n      this._clsEntry.sources.map((source, index) =>\n        transaction.setTag(`cls.source.${index + 1}`, htmlTreeAsString(source.node)),\n      );\n    }\n  }\n\n  /** Starts tracking the Cumulative Layout Shift on the current page. */\n  private _trackCLS(): void {\n    getCLS(metric => {\n      const entry = metric.entries.pop();\n\n      if (!entry) {\n        return;\n      }\n\n      logger.log('[Measurements] Adding CLS');\n      this._measurements['cls'] = { value: metric.value };\n      this._clsEntry = entry as LayoutShift;\n    });\n  }\n\n  /**\n   * Capture the information of the user agent.\n   */\n  private _trackNavigator(transaction: Transaction): void {\n    const navigator = global.navigator as null | (Navigator & NavigatorNetworkInformation & NavigatorDeviceMemory);\n\n    if (!navigator) {\n      return;\n    }\n\n    // track network connectivity\n\n    const connection = navigator.connection;\n    if (connection) {\n      if (connection.effectiveType) {\n        transaction.setTag('effectiveConnectionType', connection.effectiveType);\n      }\n\n      if (connection.type) {\n        transaction.setTag('connectionType', connection.type);\n      }\n\n      if (isMeasurementValue(connection.rtt)) {\n        this._measurements['connection.rtt'] = { value: connection.rtt as number };\n      }\n\n      if (isMeasurementValue(connection.downlink)) {\n        this._measurements['connection.downlink'] = { value: connection.downlink as number };\n      }\n    }\n\n    if (isMeasurementValue(navigator.deviceMemory)) {\n      transaction.setTag('deviceMemory', String(navigator.deviceMemory));\n    }\n\n    if (isMeasurementValue(navigator.hardwareConcurrency)) {\n      transaction.setTag('hardwareConcurrency', String(navigator.hardwareConcurrency));\n    }\n  }\n\n  /** Starts tracking the Largest Contentful Paint on the current page. */\n  private _trackLCP(): void {\n    getLCP(metric => {\n      const entry = metric.entries.pop();\n\n      if (!entry) {\n        return;\n      }\n\n      const timeOrigin = msToSec(browserPerformanceTimeOrigin as number);\n      const startTime = msToSec(entry.startTime as number);\n      logger.log('[Measurements] Adding LCP');\n      this._measurements['lcp'] = { value: metric.value };\n      this._measurements['mark.lcp'] = { value: timeOrigin + startTime };\n      this._lcpEntry = entry as LargestContentfulPaint;\n    });\n  }\n\n  /** Starts tracking the First Input Delay on the current page. */\n  private _trackFID(): void {\n    getFID(metric => {\n      const entry = metric.entries.pop();\n\n      if (!entry) {\n        return;\n      }\n\n      const timeOrigin = msToSec(browserPerformanceTimeOrigin as number);\n      const startTime = msToSec(entry.startTime as number);\n      logger.log('[Measurements] Adding FID');\n      this._measurements['fid'] = { value: metric.value };\n      this._measurements['mark.fid'] = { value: timeOrigin + startTime };\n    });\n  }\n}\n\n/** Instrument navigation entries */\nfunction addNavigationSpans(transaction: Transaction, entry: Record<string, any>, timeOrigin: number): void {\n  addPerformanceNavigationTiming({ transaction, entry, event: 'unloadEvent', timeOrigin });\n  addPerformanceNavigationTiming({ transaction, entry, event: 'redirect', timeOrigin });\n  addPerformanceNavigationTiming({ transaction, entry, event: 'domContentLoadedEvent', timeOrigin });\n  addPerformanceNavigationTiming({ transaction, entry, event: 'loadEvent', timeOrigin });\n  addPerformanceNavigationTiming({ transaction, entry, event: 'connect', timeOrigin });\n  addPerformanceNavigationTiming({\n    transaction,\n    entry,\n    event: 'secureConnection',\n    timeOrigin,\n    eventEnd: 'connectEnd',\n    description: 'TLS/SSL',\n  });\n  addPerformanceNavigationTiming({\n    transaction,\n    entry,\n    event: 'fetch',\n    timeOrigin,\n    eventEnd: 'domainLookupStart',\n    description: 'cache',\n  });\n  addPerformanceNavigationTiming({ transaction, entry, event: 'domainLookup', timeOrigin, description: 'DNS' });\n  addRequest(transaction, entry, timeOrigin);\n}\n\n/** Create measure related spans */\nfunction addMeasureSpans(\n  transaction: Transaction,\n  entry: Record<string, any>,\n  startTime: number,\n  duration: number,\n  timeOrigin: number,\n): number {\n  const measureStartTimestamp = timeOrigin + startTime;\n  const measureEndTimestamp = measureStartTimestamp + duration;\n\n  _startChild(transaction, {\n    description: entry.name as string,\n    endTimestamp: measureEndTimestamp,\n    op: entry.entryType as string,\n    startTimestamp: measureStartTimestamp,\n  });\n\n  return measureStartTimestamp;\n}\n\nexport interface ResourceEntry extends Record<string, unknown> {\n  initiatorType?: string;\n  transferSize?: number;\n  encodedBodySize?: number;\n  decodedBodySize?: number;\n}\n\n/** Create resource-related spans */\nexport function addResourceSpans(\n  transaction: Transaction,\n  entry: ResourceEntry,\n  resourceName: string,\n  startTime: number,\n  duration: number,\n  timeOrigin: number,\n): number | undefined {\n  // we already instrument based on fetch and xhr, so we don't need to\n  // duplicate spans here.\n  if (entry.initiatorType === 'xmlhttprequest' || entry.initiatorType === 'fetch') {\n    return undefined;\n  }\n\n  const data: Record<string, any> = {};\n  if ('transferSize' in entry) {\n    data['Transfer Size'] = entry.transferSize;\n  }\n  if ('encodedBodySize' in entry) {\n    data['Encoded Body Size'] = entry.encodedBodySize;\n  }\n  if ('decodedBodySize' in entry) {\n    data['Decoded Body Size'] = entry.decodedBodySize;\n  }\n\n  const startTimestamp = timeOrigin + startTime;\n  const endTimestamp = startTimestamp + duration;\n\n  _startChild(transaction, {\n    description: resourceName,\n    endTimestamp,\n    op: entry.initiatorType ? `resource.${entry.initiatorType}` : 'resource',\n    startTimestamp,\n    data,\n  });\n\n  return endTimestamp;\n}\n\n/** Create performance navigation related spans */\nfunction addPerformanceNavigationTiming(props: {\n  transaction: Transaction;\n  entry: Record<string, any>;\n  event: string;\n  timeOrigin: number;\n  eventEnd?: string;\n  description?: string;\n}): void {\n  const { transaction, entry, event, timeOrigin, eventEnd, description } = props;\n\n  const end = eventEnd ? (entry[eventEnd] as number | undefined) : (entry[`${event}End`] as number | undefined);\n  const start = entry[`${event}Start`] as number | undefined;\n  if (!start || !end) {\n    return;\n  }\n  _startChild(transaction, {\n    op: 'browser',\n    description: description ?? event,\n    startTimestamp: timeOrigin + msToSec(start),\n    endTimestamp: timeOrigin + msToSec(end),\n  });\n}\n\n/** Create request and response related spans */\nfunction addRequest(transaction: Transaction, entry: Record<string, any>, timeOrigin: number): void {\n  _startChild(transaction, {\n    op: 'browser',\n    description: 'request',\n    startTimestamp: timeOrigin + msToSec(entry.requestStart as number),\n    endTimestamp: timeOrigin + msToSec(entry.responseEnd as number),\n  });\n\n  _startChild(transaction, {\n    op: 'browser',\n    description: 'response',\n    startTimestamp: timeOrigin + msToSec(entry.responseStart as number),\n    endTimestamp: timeOrigin + msToSec(entry.responseEnd as number),\n  });\n}\n\n/**\n * Helper function to start child on transactions. This function will make sure that the transaction will\n * use the start timestamp of the created child span if it is earlier than the transactions actual\n * start timestamp.\n */\nexport function _startChild(transaction: Transaction, { startTimestamp, ...ctx }: SpanContext): Span {\n  if (startTimestamp && transaction.startTimestamp > startTimestamp) {\n    transaction.startTimestamp = startTimestamp;\n  }\n\n  return transaction.startChild({\n    startTimestamp,\n    ...ctx,\n  });\n}\n\n/**\n * Checks if a given value is a valid measurement value.\n */\nfunction isMeasurementValue(value: any): boolean {\n  return typeof value === 'number' && isFinite(value);\n}\n", "import { addInstrumentationHandler, isInstanceOf, isMatchingPattern } from '@sentry/utils';\n\nimport { Span } from '../span';\nimport { SpanStatus } from '../spanstatus';\nimport { getActiveTransaction, hasTracingEnabled } from '../utils';\n\nexport const DEFAULT_TRACING_ORIGINS = ['localhost', /^\\//];\n\n/** Options for Request Instrumentation */\nexport interface RequestInstrumentationOptions {\n  /**\n   * List of strings / regex where the integration should create Spans out of. Additionally this will be used\n   * to define which outgoing requests the `sentry-trace` header will be attached to.\n   *\n   * Default: ['localhost', /^\\//] {@see DEFAULT_TRACING_ORIGINS}\n   */\n  tracingOrigins: Array<string | RegExp>;\n\n  /**\n   * Flag to disable patching all together for fetch requests.\n   *\n   * Default: true\n   */\n  traceFetch: boolean;\n\n  /**\n   * Flag to disable patching all together for xhr requests.\n   *\n   * Default: true\n   */\n  traceXHR: boolean;\n\n  /**\n   * This function will be called before creating a span for a request with the given url.\n   * Return false if you don't want a span for the given url.\n   *\n   * By default it uses the `tracingOrigins` options as a url match.\n   */\n  shouldCreateSpanForRequest?(url: string): boolean;\n}\n\n/** Data returned from fetch callback */\nexport interface FetchData {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  args: any[]; // the arguments passed to the fetch call itself\n  fetchData?: {\n    method: string;\n    url: string;\n    // span_id\n    __span?: string;\n  };\n\n  // TODO Should this be unknown instead? If we vendor types, make it a Response\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  response?: any;\n  error?: unknown;\n\n  startTimestamp: number;\n  endTimestamp?: number;\n}\n\n/** Data returned from XHR request */\nexport interface XHRData {\n  xhr?: {\n    __sentry_xhr__?: {\n      method: string;\n      url: string;\n      status_code: number;\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      data: Record<string, any>;\n    };\n    __sentry_xhr_span_id__?: string;\n    setRequestHeader?: (key: string, val: string) => void;\n    __sentry_own_request__?: boolean;\n  };\n  startTimestamp: number;\n  endTimestamp?: number;\n}\n\nexport const defaultRequestInstrumentationOptions: RequestInstrumentationOptions = {\n  traceFetch: true,\n  traceXHR: true,\n  tracingOrigins: DEFAULT_TRACING_ORIGINS,\n};\n\n/** Registers span creators for xhr and fetch requests  */\nexport function instrumentOutgoingRequests(_options?: Partial<RequestInstrumentationOptions>): void {\n  // eslint-disable-next-line @typescript-eslint/unbound-method\n  const { traceFetch, traceXHR, tracingOrigins, shouldCreateSpanForRequest } = {\n    ...defaultRequestInstrumentationOptions,\n    ..._options,\n  };\n\n  // We should cache url -> decision so that we don't have to compute\n  // regexp everytime we create a request.\n  const urlMap: Record<string, boolean> = {};\n\n  const defaultShouldCreateSpan = (url: string): boolean => {\n    if (urlMap[url]) {\n      return urlMap[url];\n    }\n    const origins = tracingOrigins;\n    urlMap[url] =\n      origins.some((origin: string | RegExp) => isMatchingPattern(url, origin)) &&\n      !isMatchingPattern(url, 'sentry_key');\n    return urlMap[url];\n  };\n\n  // We want that our users don't have to re-implement shouldCreateSpanForRequest themselves\n  // That's why we filter out already unwanted Spans from tracingOrigins\n  let shouldCreateSpan = defaultShouldCreateSpan;\n  if (typeof shouldCreateSpanForRequest === 'function') {\n    shouldCreateSpan = (url: string) => {\n      return defaultShouldCreateSpan(url) && shouldCreateSpanForRequest(url);\n    };\n  }\n\n  const spans: Record<string, Span> = {};\n\n  if (traceFetch) {\n    addInstrumentationHandler({\n      callback: (handlerData: FetchData) => {\n        fetchCallback(handlerData, shouldCreateSpan, spans);\n      },\n      type: 'fetch',\n    });\n  }\n\n  if (traceXHR) {\n    addInstrumentationHandler({\n      callback: (handlerData: XHRData) => {\n        xhrCallback(handlerData, shouldCreateSpan, spans);\n      },\n      type: 'xhr',\n    });\n  }\n}\n\n/**\n * Create and track fetch request spans\n */\nexport function fetchCallback(\n  handlerData: FetchData,\n  shouldCreateSpan: (url: string) => boolean,\n  spans: Record<string, Span>,\n): void {\n  if (!hasTracingEnabled() || !(handlerData.fetchData && shouldCreateSpan(handlerData.fetchData.url))) {\n    return;\n  }\n\n  if (handlerData.endTimestamp && handlerData.fetchData.__span) {\n    const span = spans[handlerData.fetchData.__span];\n    if (span) {\n      if (handlerData.response) {\n        // TODO (kmclb) remove this once types PR goes through\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        span.setHttpStatus(handlerData.response.status);\n      } else if (handlerData.error) {\n        span.setStatus(SpanStatus.InternalError);\n      }\n      span.finish();\n\n      // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n      delete spans[handlerData.fetchData.__span];\n    }\n    return;\n  }\n\n  const activeTransaction = getActiveTransaction();\n  if (activeTransaction) {\n    const span = activeTransaction.startChild({\n      data: {\n        ...handlerData.fetchData,\n        type: 'fetch',\n      },\n      description: `${handlerData.fetchData.method} ${handlerData.fetchData.url}`,\n      op: 'http',\n    });\n\n    handlerData.fetchData.__span = span.spanId;\n    spans[span.spanId] = span;\n\n    const request = (handlerData.args[0] = handlerData.args[0] as string | Request);\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const options = (handlerData.args[1] = (handlerData.args[1] as { [key: string]: any }) || {});\n    let headers = options.headers;\n    if (isInstanceOf(request, Request)) {\n      headers = (request as Request).headers;\n    }\n    if (headers) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      if (typeof headers.append === 'function') {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        headers.append('sentry-trace', span.toTraceparent());\n      } else if (Array.isArray(headers)) {\n        headers = [...headers, ['sentry-trace', span.toTraceparent()]];\n      } else {\n        headers = { ...headers, 'sentry-trace': span.toTraceparent() };\n      }\n    } else {\n      headers = { 'sentry-trace': span.toTraceparent() };\n    }\n    options.headers = headers;\n  }\n}\n\n/**\n * Create and track xhr request spans\n */\nexport function xhrCallback(\n  handlerData: XHRData,\n  shouldCreateSpan: (url: string) => boolean,\n  spans: Record<string, Span>,\n): void {\n  if (\n    !hasTracingEnabled() ||\n    handlerData.xhr?.__sentry_own_request__ ||\n    !(handlerData.xhr?.__sentry_xhr__ && shouldCreateSpan(handlerData.xhr.__sentry_xhr__.url))\n  ) {\n    return;\n  }\n\n  const xhr = handlerData.xhr.__sentry_xhr__;\n\n  // check first if the request has finished and is tracked by an existing span which should now end\n  if (handlerData.endTimestamp && handlerData.xhr.__sentry_xhr_span_id__) {\n    const span = spans[handlerData.xhr.__sentry_xhr_span_id__];\n    if (span) {\n      span.setHttpStatus(xhr.status_code);\n      span.finish();\n\n      // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n      delete spans[handlerData.xhr.__sentry_xhr_span_id__];\n    }\n    return;\n  }\n\n  // if not, create a new span to track it\n  const activeTransaction = getActiveTransaction();\n  if (activeTransaction) {\n    const span = activeTransaction.startChild({\n      data: {\n        ...xhr.data,\n        type: 'xhr',\n        method: xhr.method,\n        url: xhr.url,\n      },\n      description: `${xhr.method} ${xhr.url}`,\n      op: 'http',\n    });\n\n    handlerData.xhr.__sentry_xhr_span_id__ = span.spanId;\n    spans[handlerData.xhr.__sentry_xhr_span_id__] = span;\n\n    if (handlerData.xhr.setRequestHeader) {\n      try {\n        handlerData.xhr.setRequestHeader('sentry-trace', span.toTraceparent());\n      } catch (_) {\n        // Error: InvalidStateError: Failed to execute 'setRequestHeader' on 'XMLHttpRequest': The object's state must be OPENED.\n      }\n    }\n  }\n}\n", "import { Transaction, TransactionContext } from '@sentry/types';\nimport { addInstrumentationHandler, getGlobalObject, logger } from '@sentry/utils';\n\nconst global = getGlobalObject<Window>();\n\n/**\n * Default function implementing pageload and navigation transactions\n */\nexport function instrumentRoutingWithDefaults<T extends Transaction>(\n  customStartTransaction: (context: TransactionContext) => T | undefined,\n  startTransactionOnPageLoad: boolean = true,\n  startTransactionOnLocationChange: boolean = true,\n): void {\n  if (!global || !global.location) {\n    logger.warn('Could not initialize routing instrumentation due to invalid location');\n    return;\n  }\n\n  let startingUrl: string | undefined = global.location.href;\n\n  let activeTransaction: T | undefined;\n  if (startTransactionOnPageLoad) {\n    activeTransaction = customStartTransaction({ name: global.location.pathname, op: 'pageload' });\n  }\n\n  if (startTransactionOnLocationChange) {\n    addInstrumentationHandler({\n      callback: ({ to, from }: { to: string; from?: string }) => {\n        /**\n         * This early return is there to account for some cases where a navigation transaction starts right after\n         * long-running pageload. We make sure that if `from` is undefined and a valid `startingURL` exists, we don't\n         * create an uneccessary navigation transaction.\n         *\n         * This was hard to duplicate, but this behavior stopped as soon as this fix was applied. This issue might also\n         * only be caused in certain development environments where the usage of a hot module reloader is causing\n         * errors.\n         */\n        if (from === undefined && startingUrl && startingUrl.indexOf(to) !== -1) {\n          startingUrl = undefined;\n          return;\n        }\n\n        if (from !== to) {\n          startingUrl = undefined;\n          if (activeTransaction) {\n            logger.log(`[Tracing] Finishing current transaction with op: ${activeTransaction.op}`);\n            // If there's an open transaction on the scope, we need to finish it before creating an new one.\n            activeTransaction.finish();\n          }\n          activeTransaction = customStartTransaction({ name: global.location.pathname, op: 'navigation' });\n        }\n      },\n      type: 'history',\n    });\n  }\n}\n", "import { Hub } from '@sentry/hub';\nimport { EventProcessor, Integration, Transaction, TransactionContext } from '@sentry/types';\nimport { getGlobalObject, logger } from '@sentry/utils';\n\nimport { startIdleTransaction } from '../hubextensions';\nimport { DEFAULT_IDLE_TIMEOUT, IdleTransaction } from '../idletransaction';\nimport { SpanStatus } from '../spanstatus';\nimport { extractTraceparentData, secToMs } from '../utils';\nimport { registerBackgroundTabDetection } from './backgroundtab';\nimport { MetricsInstrumentation } from './metrics';\nimport {\n  defaultRequestInstrumentationOptions,\n  instrumentOutgoingRequests,\n  RequestInstrumentationOptions,\n} from './request';\nimport { instrumentRoutingWithDefaults } from './router';\n\nexport const DEFAULT_MAX_TRANSACTION_DURATION_SECONDS = 600;\n\n/** Options for Browser Tracing integration */\nexport interface BrowserTracingOptions extends RequestInstrumentationOptions {\n  /**\n   * The time to wait in ms until the transaction will be finished. The transaction will use the end timestamp of\n   * the last finished span as the endtime for the transaction.\n   * Time is in ms.\n   *\n   * Default: 1000\n   */\n  idleTimeout: number;\n\n  /**\n   * Flag to enable/disable creation of `navigation` transaction on history changes.\n   *\n   * Default: true\n   */\n  startTransactionOnLocationChange: boolean;\n\n  /**\n   * Flag to enable/disable creation of `pageload` transaction on first pageload.\n   *\n   * Default: true\n   */\n  startTransactionOnPageLoad: boolean;\n\n  /**\n   * The maximum duration of a transaction before it will be marked as \"deadline_exceeded\".\n   * If you never want to mark a transaction set it to 0.\n   * Time is in seconds.\n   *\n   * Default: 600\n   */\n  maxTransactionDuration: number;\n\n  /**\n   * Flag Transactions where tabs moved to background with \"cancelled\". Browser background tab timing is\n   * not suited towards doing precise measurements of operations. By default, we recommend that this option\n   * be enabled as background transactions can mess up your statistics in nondeterministic ways.\n   *\n   * Default: true\n   */\n  markBackgroundTransactions: boolean;\n\n  /**\n   * beforeNavigate is called before a pageload/navigation transaction is created and allows users to modify transaction\n   * context data, or drop the transaction entirely (by setting `sampled = false` in the context).\n   *\n   * Note: For legacy reasons, transactions can also be dropped by returning `undefined`.\n   *\n   * @param context: The context data which will be passed to `startTransaction` by default\n   *\n   * @returns A (potentially) modified context object, with `sampled = false` if the transaction should be dropped.\n   */\n  beforeNavigate?(context: TransactionContext): TransactionContext | undefined;\n\n  /**\n   * Instrumentation that creates routing change transactions. By default creates\n   * pageload and navigation transactions.\n   */\n  routingInstrumentation<T extends Transaction>(\n    customStartTransaction: (context: TransactionContext) => T | undefined,\n    startTransactionOnPageLoad?: boolean,\n    startTransactionOnLocationChange?: boolean,\n  ): void;\n}\n\nconst DEFAULT_BROWSER_TRACING_OPTIONS = {\n  idleTimeout: DEFAULT_IDLE_TIMEOUT,\n  markBackgroundTransactions: true,\n  maxTransactionDuration: DEFAULT_MAX_TRANSACTION_DURATION_SECONDS,\n  routingInstrumentation: instrumentRoutingWithDefaults,\n  startTransactionOnLocationChange: true,\n  startTransactionOnPageLoad: true,\n  ...defaultRequestInstrumentationOptions,\n};\n\n/**\n * The Browser Tracing integration automatically instruments browser pageload/navigation\n * actions as transactions, and captures requests, metrics and errors as spans.\n *\n * The integration can be configured with a variety of options, and can be extended to use\n * any routing library. This integration uses {@see IdleTransaction} to create transactions.\n */\nexport class BrowserTracing implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'BrowserTracing';\n\n  /** Browser Tracing integration options */\n  public options: BrowserTracingOptions;\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = BrowserTracing.id;\n\n  private _getCurrentHub?: () => Hub;\n\n  private readonly _metrics: MetricsInstrumentation = new MetricsInstrumentation();\n\n  private readonly _emitOptionsWarning: boolean = false;\n\n  public constructor(_options?: Partial<BrowserTracingOptions>) {\n    let tracingOrigins = defaultRequestInstrumentationOptions.tracingOrigins;\n    // NOTE: Logger doesn't work in constructors, as it's initialized after integrations instances\n    if (\n      _options &&\n      _options.tracingOrigins &&\n      Array.isArray(_options.tracingOrigins) &&\n      _options.tracingOrigins.length !== 0\n    ) {\n      tracingOrigins = _options.tracingOrigins;\n    } else {\n      this._emitOptionsWarning = true;\n    }\n\n    this.options = {\n      ...DEFAULT_BROWSER_TRACING_OPTIONS,\n      ..._options,\n      tracingOrigins,\n    };\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(_: (callback: EventProcessor) => void, getCurrentHub: () => Hub): void {\n    this._getCurrentHub = getCurrentHub;\n\n    if (this._emitOptionsWarning) {\n      logger.warn(\n        '[Tracing] You need to define `tracingOrigins` in the options. Set an array of urls or patterns to trace.',\n      );\n      logger.warn(\n        `[Tracing] We added a reasonable default for you: ${defaultRequestInstrumentationOptions.tracingOrigins}`,\n      );\n    }\n\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const {\n      routingInstrumentation: instrumentRouting,\n      startTransactionOnLocationChange,\n      startTransactionOnPageLoad,\n      markBackgroundTransactions,\n      traceFetch,\n      traceXHR,\n      tracingOrigins,\n      shouldCreateSpanForRequest,\n    } = this.options;\n\n    instrumentRouting(\n      (context: TransactionContext) => this._createRouteTransaction(context),\n      startTransactionOnPageLoad,\n      startTransactionOnLocationChange,\n    );\n\n    if (markBackgroundTransactions) {\n      registerBackgroundTabDetection();\n    }\n\n    instrumentOutgoingRequests({ traceFetch, traceXHR, tracingOrigins, shouldCreateSpanForRequest });\n  }\n\n  /** Create routing idle transaction. */\n  private _createRouteTransaction(context: TransactionContext): Transaction | undefined {\n    if (!this._getCurrentHub) {\n      logger.warn(`[Tracing] Did not create ${context.op} transaction because _getCurrentHub is invalid.`);\n      return undefined;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const { beforeNavigate, idleTimeout, maxTransactionDuration } = this.options;\n\n    const parentContextFromHeader = context.op === 'pageload' ? getHeaderContext() : undefined;\n\n    const expandedContext = {\n      ...context,\n      ...parentContextFromHeader,\n      trimEnd: true,\n    };\n    const modifiedContext = typeof beforeNavigate === 'function' ? beforeNavigate(expandedContext) : expandedContext;\n\n    // For backwards compatibility reasons, beforeNavigate can return undefined to \"drop\" the transaction (prevent it\n    // from being sent to Sentry).\n    const finalContext = modifiedContext === undefined ? { ...expandedContext, sampled: false } : modifiedContext;\n\n    if (finalContext.sampled === false) {\n      logger.log(`[Tracing] Will not send ${finalContext.op} transaction because of beforeNavigate.`);\n    }\n\n    logger.log(`[Tracing] Starting ${finalContext.op} transaction on scope`);\n\n    const hub = this._getCurrentHub();\n    const { location } = getGlobalObject() as WindowOrWorkerGlobalScope & { location: Location };\n\n    const idleTransaction = startIdleTransaction(\n      hub,\n      finalContext,\n      idleTimeout,\n      true,\n      { location }, // for use in the tracesSampler\n    );\n    idleTransaction.registerBeforeFinishCallback((transaction, endTimestamp) => {\n      this._metrics.addPerformanceEntries(transaction);\n      adjustTransactionDuration(secToMs(maxTransactionDuration), transaction, endTimestamp);\n    });\n\n    return idleTransaction as Transaction;\n  }\n}\n\n/**\n * Gets transaction context from a sentry-trace meta.\n *\n * @returns Transaction context data from the header or undefined if there's no header or the header is malformed\n */\nexport function getHeaderContext(): Partial<TransactionContext> | undefined {\n  const header = getMetaContent('sentry-trace');\n  if (header) {\n    return extractTraceparentData(header);\n  }\n\n  return undefined;\n}\n\n/** Returns the value of a meta tag */\nexport function getMetaContent(metaName: string): string | null {\n  const el = document.querySelector(`meta[name=${metaName}]`);\n  return el ? el.getAttribute('content') : null;\n}\n\n/** Adjusts transaction value based on max transaction duration */\nfunction adjustTransactionDuration(maxDuration: number, transaction: IdleTransaction, endTimestamp: number): void {\n  const diff = endTimestamp - transaction.startTimestamp;\n  const isOutdatedTransaction = endTimestamp && (diff > maxDuration || diff < 0);\n  if (isOutdatedTransaction) {\n    transaction.setStatus(SpanStatus.DeadlineExceeded);\n    transaction.setTag('maxTransactionDurationExceeded', 'true');\n  }\n}\n", "export { BrowserTracing } from './browsertracing';\nexport {\n  instrumentOutgoingRequests,\n  RequestInstrumentationOptions,\n  defaultRequestInstrumentationOptions,\n} from './request';\n", "import { Integration, Transaction } from '@sentry/types';\nimport { logger } from '@sentry/utils';\n\ntype Method =\n  | 'all'\n  | 'get'\n  | 'post'\n  | 'put'\n  | 'delete'\n  | 'patch'\n  | 'options'\n  | 'head'\n  | 'checkout'\n  | 'copy'\n  | 'lock'\n  | 'merge'\n  | 'mkactivity'\n  | 'mkcol'\n  | 'move'\n  | 'm-search'\n  | 'notify'\n  | 'purge'\n  | 'report'\n  | 'search'\n  | 'subscribe'\n  | 'trace'\n  | 'unlock'\n  | 'unsubscribe'\n  | 'use';\n\ntype Router = {\n  [method in Method]: (...args: any) => any; // eslint-disable-line @typescript-eslint/no-explicit-any\n};\n\ninterface ExpressResponse {\n  once(name: string, callback: () => void): void;\n}\n\n/**\n * Internal helper for `__sentry_transaction`\n * @hidden\n */\ninterface SentryTracingResponse {\n  __sentry_transaction?: Transaction;\n}\n\n/**\n * Express integration\n *\n * Provides an request and error handler for Express framework as well as tracing capabilities\n */\nexport class Express implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'Express';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = Express.id;\n\n  /**\n   * Express App instance\n   */\n  private readonly _router?: Router;\n  private readonly _methods?: Method[];\n\n  /**\n   * @inheritDoc\n   */\n  public constructor(options: { app?: Router; router?: Router; methods?: Method[] } = {}) {\n    this._router = options.router || options.app;\n    this._methods = (Array.isArray(options.methods) ? options.methods : []).concat('use');\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(): void {\n    if (!this._router) {\n      logger.error('ExpressIntegration is missing an Express instance');\n      return;\n    }\n    instrumentMiddlewares(this._router, this._methods);\n  }\n}\n\n/**\n * Wraps original middleware function in a tracing call, which stores the info about the call as a span,\n * and finishes it once the middleware is done invoking.\n *\n * Express middlewares have 3 various forms, thus we have to take care of all of them:\n * // sync\n * app.use(function (req, res) { ... })\n * // async\n * app.use(function (req, res, next) { ... })\n * // error handler\n * app.use(function (err, req, res, next) { ... })\n *\n * They all internally delegate to the `router[method]` of the given application instance.\n */\n// eslint-disable-next-line @typescript-eslint/ban-types, @typescript-eslint/no-explicit-any\nfunction wrap(fn: Function, method: Method): (...args: any[]) => void {\n  const arity = fn.length;\n\n  switch (arity) {\n    case 2: {\n      return function(this: NodeJS.Global, req: unknown, res: ExpressResponse & SentryTracingResponse): void {\n        const transaction = res.__sentry_transaction;\n        if (transaction) {\n          const span = transaction.startChild({\n            description: fn.name,\n            op: `middleware.${method}`,\n          });\n          res.once('finish', () => {\n            span.finish();\n          });\n        }\n        return fn.call(this, req, res);\n      };\n    }\n    case 3: {\n      return function(\n        this: NodeJS.Global,\n        req: unknown,\n        res: ExpressResponse & SentryTracingResponse,\n        next: () => void,\n      ): void {\n        const transaction = res.__sentry_transaction;\n        const span = transaction?.startChild({\n          description: fn.name,\n          op: `middleware.${method}`,\n        });\n        fn.call(this, req, res, function(this: NodeJS.Global, ...args: unknown[]): void {\n          span?.finish();\n          next.call(this, ...args);\n        });\n      };\n    }\n    case 4: {\n      return function(\n        this: NodeJS.Global,\n        err: Error,\n        req: Request,\n        res: Response & SentryTracingResponse,\n        next: () => void,\n      ): void {\n        const transaction = res.__sentry_transaction;\n        const span = transaction?.startChild({\n          description: fn.name,\n          op: `middleware.${method}`,\n        });\n        fn.call(this, err, req, res, function(this: NodeJS.Global, ...args: unknown[]): void {\n          span?.finish();\n          next.call(this, ...args);\n        });\n      };\n    }\n    default: {\n      throw new Error(`Express middleware takes 2-4 arguments. Got: ${arity}`);\n    }\n  }\n}\n\n/**\n * Takes all the function arguments passed to the original `app` or `router` method, eg. `app.use` or `router.use`\n * and wraps every function, as well as array of functions with a call to our `wrap` method.\n * We have to take care of the arrays as well as iterate over all of the arguments,\n * as `app.use` can accept middlewares in few various forms.\n *\n * app.use([<path>], <fn>)\n * app.use([<path>], <fn>, ...<fn>)\n * app.use([<path>], ...<fn>[])\n */\nfunction wrapMiddlewareArgs(args: unknown[], method: Method): unknown[] {\n  return args.map((arg: unknown) => {\n    if (typeof arg === 'function') {\n      return wrap(arg, method);\n    }\n\n    if (Array.isArray(arg)) {\n      return arg.map((a: unknown) => {\n        if (typeof a === 'function') {\n          return wrap(a, method);\n        }\n        return a;\n      });\n    }\n\n    return arg;\n  });\n}\n\n/**\n * Patches original router to utilize our tracing functionality\n */\nfunction patchMiddleware(router: Router, method: Method): Router {\n  const originalCallback = router[method];\n\n  router[method] = function(...args: unknown[]): void {\n    return originalCallback.call(this, ...wrapMiddlewareArgs(args, method));\n  };\n\n  return router;\n}\n\n/**\n * Patches original router methods\n */\nfunction instrumentMiddlewares(router: Router, methods: Method[] = []): void {\n  methods.forEach((method: Method) => patchMiddleware(router, method));\n}\n", "import { Hub } from '@sentry/hub';\nimport { EventProcessor, Integration } from '@sentry/types';\nimport { fill, isThenable, loadModule, logger } from '@sentry/utils';\n\ninterface PgClient {\n  prototype: {\n    query: () => void | Promise<unknown>;\n  };\n}\n\n/** Tracing integration for node-postgres package */\nexport class Postgres implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'Postgres';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = Postgres.id;\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(_: (callback: EventProcessor) => void, getCurrentHub: () => Hub): void {\n    const pkg = loadModule<{ Client: PgClient }>('pg');\n\n    if (!pkg) {\n      logger.error('Postgres Integration was unable to require `pg` package.');\n      return;\n    }\n\n    /**\n     * function (query, callback) => void\n     * function (query, params, callback) => void\n     * function (query) => Promise\n     * function (query, params) => Promise\n     * function (pg.Cursor) => pg.Cursor\n     */\n    fill(pkg.Client.prototype, 'query', function(orig: () => void | Promise<unknown>) {\n      return function(this: unknown, config: unknown, values: unknown, callback: unknown) {\n        const scope = getCurrentHub().getScope();\n        const parentSpan = scope?.getSpan();\n        const span = parentSpan?.startChild({\n          description: typeof config === 'string' ? config : (config as { text: string }).text,\n          op: `db`,\n        });\n\n        if (typeof callback === 'function') {\n          return orig.call(this, config, values, function(err: Error, result: unknown) {\n            span?.finish();\n            callback(err, result);\n          });\n        }\n\n        if (typeof values === 'function') {\n          return orig.call(this, config, function(err: Error, result: unknown) {\n            span?.finish();\n            values(err, result);\n          });\n        }\n\n        const rv = typeof values !== 'undefined' ? orig.call(this, config, values) : orig.call(this, config);\n\n        if (isThenable(rv)) {\n          return (rv as Promise<unknown>).then((res: unknown) => {\n            span?.finish();\n            return res;\n          });\n        }\n\n        span?.finish();\n        return rv;\n      };\n    });\n  }\n}\n", "import { Hub } from '@sentry/hub';\nimport { EventProcessor, Integration } from '@sentry/types';\nimport { fill, loadModule, logger } from '@sentry/utils';\n\ninterface MysqlConnection {\n  createQuery: () => void;\n}\n\n/** Tracing integration for node-mysql package */\nexport class Mysql implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'Mysql';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = Mysql.id;\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(_: (callback: EventProcessor) => void, getCurrentHub: () => Hub): void {\n    const pkg = loadModule<MysqlConnection>('mysql/lib/Connection.js');\n\n    if (!pkg) {\n      logger.error('Mysql Integration was unable to require `mysql` package.');\n      return;\n    }\n\n    // The original function will have one of these signatures:\n    //    function (callback) => void\n    //    function (options, callback) => void\n    //    function (options, values, callback) => void\n    fill(pkg, 'createQuery', function(orig: () => void) {\n      return function(this: unknown, options: unknown, values: unknown, callback: unknown) {\n        const scope = getCurrentHub().getScope();\n        const parentSpan = scope?.getSpan();\n        const span = parentSpan?.startChild({\n          description: typeof options === 'string' ? options : (options as { sql: string }).sql,\n          op: `db`,\n        });\n\n        if (typeof callback === 'function') {\n          return orig.call(this, options, values, function(err: Error, result: unknown, fields: unknown) {\n            span?.finish();\n            callback(err, result, fields);\n          });\n        }\n\n        if (typeof values === 'function') {\n          return orig.call(this, options, function(err: Error, result: unknown, fields: unknown) {\n            span?.finish();\n            values(err, result, fields);\n          });\n        }\n\n        return orig.call(this, options, values, callback);\n      };\n    });\n  }\n}\n", "import { Hub } from '@sentry/hub';\nimport { EventProcessor, Integration, SpanContext } from '@sentry/types';\nimport { fill, isThenable, loadModule, logger } from '@sentry/utils';\n\n// This allows us to use the same array for both defaults options and the type itself.\n// (note `as const` at the end to make it a union of string literal types (i.e. \"a\" | \"b\" | ... )\n// and not just a string[])\ntype Operation = typeof OPERATIONS[number];\nconst OPERATIONS = [\n  'aggregate', // aggregate(pipeline, options, callback)\n  'bulkWrite', // bulkWrite(operations, options, callback)\n  'countDocuments', // countDocuments(query, options, callback)\n  'createIndex', // createIndex(fieldOrSpec, options, callback)\n  'createIndexes', // createIndexes(indexSpecs, options, callback)\n  'deleteMany', // deleteMany(filter, options, callback)\n  'deleteOne', // deleteOne(filter, options, callback)\n  'distinct', // distinct(key, query, options, callback)\n  'drop', // drop(options, callback)\n  'dropIndex', // dropIndex(indexName, options, callback)\n  'dropIndexes', // dropIndexes(options, callback)\n  'estimatedDocumentCount', // estimatedDocumentCount(options, callback)\n  'find', // find(query, options, callback)\n  'findOne', // findOne(query, options, callback)\n  'findOneAndDelete', // findOneAndDelete(filter, options, callback)\n  'findOneAndReplace', // findOneAndReplace(filter, replacement, options, callback)\n  'findOneAndUpdate', // findOneAndUpdate(filter, update, options, callback)\n  'indexes', // indexes(options, callback)\n  'indexExists', // indexExists(indexes, options, callback)\n  'indexInformation', // indexInformation(options, callback)\n  'initializeOrderedBulkOp', // initializeOrderedBulkOp(options, callback)\n  'insertMany', // insertMany(docs, options, callback)\n  'insertOne', // insertOne(doc, options, callback)\n  'isCapped', // isCapped(options, callback)\n  'mapReduce', // mapReduce(map, reduce, options, callback)\n  'options', // options(options, callback)\n  'parallelCollectionScan', // parallelCollectionScan(options, callback)\n  'rename', // rename(newName, options, callback)\n  'replaceOne', // replaceOne(filter, doc, options, callback)\n  'stats', // stats(options, callback)\n  'updateMany', // updateMany(filter, update, options, callback)\n  'updateOne', // updateOne(filter, update, options, callback)\n] as const;\n\n// All of the operations above take `options` and `callback` as their final parameters, but some of them\n// take additional parameters as well. For those operations, this is a map of\n// { <operation name>:  [<names of additional parameters>] }, as a way to know what to call the operation's\n// positional arguments when we add them to the span's `data` object later\nconst OPERATION_SIGNATURES: {\n  [op in Operation]?: string[];\n} = {\n  // aggregate intentionally not included because `pipeline` arguments are too complex to serialize well\n  // see https://github.com/getsentry/sentry-javascript/pull/3102\n  bulkWrite: ['operations'],\n  countDocuments: ['query'],\n  createIndex: ['fieldOrSpec'],\n  createIndexes: ['indexSpecs'],\n  deleteMany: ['filter'],\n  deleteOne: ['filter'],\n  distinct: ['key', 'query'],\n  dropIndex: ['indexName'],\n  find: ['query'],\n  findOne: ['query'],\n  findOneAndDelete: ['filter'],\n  findOneAndReplace: ['filter', 'replacement'],\n  findOneAndUpdate: ['filter', 'update'],\n  indexExists: ['indexes'],\n  insertMany: ['docs'],\n  insertOne: ['doc'],\n  mapReduce: ['map', 'reduce'],\n  rename: ['newName'],\n  replaceOne: ['filter', 'doc'],\n  updateMany: ['filter', 'update'],\n  updateOne: ['filter', 'update'],\n};\n\ninterface MongoCollection {\n  collectionName: string;\n  dbName: string;\n  namespace: string;\n  prototype: {\n    [operation in Operation]: (...args: unknown[]) => unknown;\n  };\n}\n\ninterface MongoOptions {\n  operations?: Operation[];\n  describeOperations?: boolean | Operation[];\n  useMongoose?: boolean;\n}\n\n/** Tracing integration for mongo package */\nexport class Mongo implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'Mongo';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = Mongo.id;\n\n  private _operations: Operation[];\n  private _describeOperations?: boolean | Operation[];\n  private _useMongoose: boolean;\n\n  /**\n   * @inheritDoc\n   */\n  public constructor(options: MongoOptions = {}) {\n    this._operations = Array.isArray(options.operations)\n      ? options.operations\n      : ((OPERATIONS as unknown) as Operation[]);\n    this._describeOperations = 'describeOperations' in options ? options.describeOperations : true;\n    this._useMongoose = !!options.useMongoose;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(_: (callback: EventProcessor) => void, getCurrentHub: () => Hub): void {\n    const moduleName = this._useMongoose ? 'mongoose' : 'mongodb';\n    const pkg = loadModule<{ Collection: MongoCollection }>(moduleName);\n\n    if (!pkg) {\n      logger.error(`Mongo Integration was unable to require \\`${moduleName}\\` package.`);\n      return;\n    }\n\n    this._instrumentOperations(pkg.Collection, this._operations, getCurrentHub);\n  }\n\n  /**\n   * Patches original collection methods\n   */\n  private _instrumentOperations(collection: MongoCollection, operations: Operation[], getCurrentHub: () => Hub): void {\n    operations.forEach((operation: Operation) => this._patchOperation(collection, operation, getCurrentHub));\n  }\n\n  /**\n   * Patches original collection to utilize our tracing functionality\n   */\n  private _patchOperation(collection: MongoCollection, operation: Operation, getCurrentHub: () => Hub): void {\n    if (!(operation in collection.prototype)) return;\n\n    const getSpanContext = this._getSpanContextFromOperationArguments.bind(this);\n\n    fill(collection.prototype, operation, function(orig: () => void | Promise<unknown>) {\n      return function(this: unknown, ...args: unknown[]) {\n        const lastArg = args[args.length - 1];\n        const scope = getCurrentHub().getScope();\n        const parentSpan = scope?.getSpan();\n\n        // Check if the operation was passed a callback. (mapReduce requires a different check, as\n        // its (non-callback) arguments can also be functions.)\n        if (typeof lastArg !== 'function' || (operation === 'mapReduce' && args.length === 2)) {\n          const span = parentSpan?.startChild(getSpanContext(this, operation, args));\n          const maybePromise = orig.call(this, ...args) as Promise<unknown>;\n\n          if (isThenable(maybePromise)) {\n            return maybePromise.then((res: unknown) => {\n              span?.finish();\n              return res;\n            });\n          } else {\n            span?.finish();\n            return maybePromise;\n          }\n        }\n\n        const span = parentSpan?.startChild(getSpanContext(this, operation, args.slice(0, -1)));\n        return orig.call(this, ...args.slice(0, -1), function(err: Error, result: unknown) {\n          span?.finish();\n          lastArg(err, result);\n        });\n      };\n    });\n  }\n\n  /**\n   * Form a SpanContext based on the user input to a given operation.\n   */\n  private _getSpanContextFromOperationArguments(\n    collection: MongoCollection,\n    operation: Operation,\n    args: unknown[],\n  ): SpanContext {\n    const data: { [key: string]: string } = {\n      collectionName: collection.collectionName,\n      dbName: collection.dbName,\n      namespace: collection.namespace,\n    };\n    const spanContext: SpanContext = {\n      op: `db`,\n      description: operation,\n      data,\n    };\n\n    // If the operation takes no arguments besides `options` and `callback`, or if argument\n    // collection is disabled for this operation, just return early.\n    const signature = OPERATION_SIGNATURES[operation];\n    const shouldDescribe = Array.isArray(this._describeOperations)\n      ? this._describeOperations.includes(operation)\n      : this._describeOperations;\n\n    if (!signature || !shouldDescribe) {\n      return spanContext;\n    }\n\n    try {\n      // Special case for `mapReduce`, as the only one accepting functions as arguments.\n      if (operation === 'mapReduce') {\n        const [map, reduce] = args as { name?: string }[];\n        data[signature[0]] = typeof map === 'string' ? map : map.name || '<anonymous>';\n        data[signature[1]] = typeof reduce === 'string' ? reduce : reduce.name || '<anonymous>';\n      } else {\n        for (let i = 0; i < signature.length; i++) {\n          data[signature[i]] = JSON.stringify(args[i]);\n        }\n      }\n    } catch (_oO) {\n      // no-empty\n    }\n\n    return spanContext;\n  }\n}\n", "export { Express } from './express';\nexport { Postgres } from './postgres';\nexport { Mysql } from './mysql';\nexport { Mongo } from './mongo';\n", "import { BrowserTracing } from './browser';\nimport { addExtensionMethods } from './hubextensions';\nimport * as TracingIntegrations from './integrations';\n\nconst Integrations = { ...TracingIntegrations, BrowserTracing };\n\nexport { Integrations };\nexport { Span } from './span';\nexport { Transaction } from './transaction';\nexport {\n  // TODO deprecate old name in v7\n  instrumentOutgoingRequests as registerRequestInstrumentation,\n  RequestInstrumentationOptions,\n  defaultRequestInstrumentationOptions,\n} from './browser';\nexport { SpanStatus } from './spanstatus';\nexport { IdleTransaction } from './idletransaction';\nexport { startIdleTransaction } from './hubextensions';\n\n// We are patching the global object with our hub extension methods\naddExtensionMethods();\n\nexport { addExtensionMethods };\n\nexport {\n  extractTraceparentData,\n  getActiveTransaction,\n  hasTracingEnabled,\n  stripUrlQueryAndFragment,\n  TRACEPARENT_REGEXP,\n} from './utils';\n", "/*!\n * cookie\n * Copyright(c) 2012-2014 Roman Shtylman\n * Copyright(c) 2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module exports.\n * @public\n */\n\nexports.parse = parse;\nexports.serialize = serialize;\n\n/**\n * Module variables.\n * @private\n */\n\nvar decode = decodeURIComponent;\nvar encode = encodeURIComponent;\nvar pairSplitRegExp = /; */;\n\n/**\n * RegExp to match field-content in RFC 7230 sec 3.2\n *\n * field-content = field-vchar [ 1*( SP / HTAB ) field-vchar ]\n * field-vchar   = VCHAR / obs-text\n * obs-text      = %x80-FF\n */\n\nvar fieldContentRegExp = /^[\\u0009\\u0020-\\u007e\\u0080-\\u00ff]+$/;\n\n/**\n * Parse a cookie header.\n *\n * Parse the given cookie header string into an object\n * The object has the various cookies as keys(names) => values\n *\n * @param {string} str\n * @param {object} [options]\n * @return {object}\n * @public\n */\n\nfunction parse(str, options) {\n  if (typeof str !== 'string') {\n    throw new TypeError('argument str must be a string');\n  }\n\n  var obj = {}\n  var opt = options || {};\n  var pairs = str.split(pairSplitRegExp);\n  var dec = opt.decode || decode;\n\n  for (var i = 0; i < pairs.length; i++) {\n    var pair = pairs[i];\n    var eq_idx = pair.indexOf('=');\n\n    // skip things that don't look like key=value\n    if (eq_idx < 0) {\n      continue;\n    }\n\n    var key = pair.substr(0, eq_idx).trim()\n    var val = pair.substr(++eq_idx, pair.length).trim();\n\n    // quoted values\n    if ('\"' == val[0]) {\n      val = val.slice(1, -1);\n    }\n\n    // only assign once\n    if (undefined == obj[key]) {\n      obj[key] = tryDecode(val, dec);\n    }\n  }\n\n  return obj;\n}\n\n/**\n * Serialize data into a cookie header.\n *\n * Serialize the a name value pair into a cookie string suitable for\n * http headers. An optional options object specified cookie parameters.\n *\n * serialize('foo', 'bar', { httpOnly: true })\n *   => \"foo=bar; httpOnly\"\n *\n * @param {string} name\n * @param {string} val\n * @param {object} [options]\n * @return {string}\n * @public\n */\n\nfunction serialize(name, val, options) {\n  var opt = options || {};\n  var enc = opt.encode || encode;\n\n  if (typeof enc !== 'function') {\n    throw new TypeError('option encode is invalid');\n  }\n\n  if (!fieldContentRegExp.test(name)) {\n    throw new TypeError('argument name is invalid');\n  }\n\n  var value = enc(val);\n\n  if (value && !fieldContentRegExp.test(value)) {\n    throw new TypeError('argument val is invalid');\n  }\n\n  var str = name + '=' + value;\n\n  if (null != opt.maxAge) {\n    var maxAge = opt.maxAge - 0;\n\n    if (isNaN(maxAge) || !isFinite(maxAge)) {\n      throw new TypeError('option maxAge is invalid')\n    }\n\n    str += '; Max-Age=' + Math.floor(maxAge);\n  }\n\n  if (opt.domain) {\n    if (!fieldContentRegExp.test(opt.domain)) {\n      throw new TypeError('option domain is invalid');\n    }\n\n    str += '; Domain=' + opt.domain;\n  }\n\n  if (opt.path) {\n    if (!fieldContentRegExp.test(opt.path)) {\n      throw new TypeError('option path is invalid');\n    }\n\n    str += '; Path=' + opt.path;\n  }\n\n  if (opt.expires) {\n    if (typeof opt.expires.toUTCString !== 'function') {\n      throw new TypeError('option expires is invalid');\n    }\n\n    str += '; Expires=' + opt.expires.toUTCString();\n  }\n\n  if (opt.httpOnly) {\n    str += '; HttpOnly';\n  }\n\n  if (opt.secure) {\n    str += '; Secure';\n  }\n\n  if (opt.sameSite) {\n    var sameSite = typeof opt.sameSite === 'string'\n      ? opt.sameSite.toLowerCase() : opt.sameSite;\n\n    switch (sameSite) {\n      case true:\n        str += '; SameSite=Strict';\n        break;\n      case 'lax':\n        str += '; SameSite=Lax';\n        break;\n      case 'strict':\n        str += '; SameSite=Strict';\n        break;\n      case 'none':\n        str += '; SameSite=None';\n        break;\n      default:\n        throw new TypeError('option sameSite is invalid');\n    }\n  }\n\n  return str;\n}\n\n/**\n * Try decoding a string using a decoding function.\n *\n * @param {string} str\n * @param {function} decode\n * @private\n */\n\nfunction tryDecode(str, decode) {\n  try {\n    return decode(str);\n  } catch (e) {\n    return str;\n  }\n}\n", "/* eslint-disable max-lines */\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { captureException, getCurrentHub, startTransaction, withScope } from '@sentry/core';\nimport { extractTraceparentData, Span } from '@sentry/tracing';\nimport { Event, ExtractedNodeRequestData, RequestSessionStatus, Transaction } from '@sentry/types';\nimport { isPlainObject, isString, logger, normalize, stripUrlQueryAndFragment } from '@sentry/utils';\nimport * as cookie from 'cookie';\nimport * as domain from 'domain';\nimport * as http from 'http';\nimport * as os from 'os';\nimport * as url from 'url';\n\nimport { NodeClient } from './client';\nimport { flush, isAutoSessionTrackingEnabled } from './sdk';\n\nexport interface ExpressRequest {\n  baseUrl?: string;\n  connection?: {\n    remoteAddress?: string;\n  };\n  ip?: string;\n  method?: string;\n  originalUrl?: string;\n  route?: {\n    path: string;\n    stack: [\n      {\n        name: string;\n      },\n    ];\n  };\n  query?: {\n    // It can be: undefined | string | string[] | ParsedQs | ParsedQs[] (from `qs` package), but we dont want to pull it.\n    [key: string]: unknown;\n  };\n  url?: string;\n  user?: {\n    [key: string]: any;\n  };\n}\n\n/**\n * Express-compatible tracing handler.\n * @see Exposed as `Handlers.tracingHandler`\n */\nexport function tracingHandler(): (\n  req: http.IncomingMessage,\n  res: http.ServerResponse,\n  next: (error?: any) => void,\n) => void {\n  return function sentryTracingMiddleware(\n    req: http.IncomingMessage,\n    res: http.ServerResponse,\n    next: (error?: any) => void,\n  ): void {\n    // If there is a trace header set, we extract the data from it (parentSpanId, traceId, and sampling decision)\n    let traceparentData;\n    if (req.headers && isString(req.headers['sentry-trace'])) {\n      traceparentData = extractTraceparentData(req.headers['sentry-trace'] as string);\n    }\n\n    const transaction = startTransaction(\n      {\n        name: extractExpressTransactionName(req, { path: true, method: true }),\n        op: 'http.server',\n        ...traceparentData,\n      },\n      // extra context passed to the tracesSampler\n      { request: extractRequestData(req) },\n    );\n\n    // We put the transaction on the scope so users can attach children to it\n    getCurrentHub().configureScope(scope => {\n      scope.setSpan(transaction);\n    });\n\n    // We also set __sentry_transaction on the response so people can grab the transaction there to add\n    // spans to it later.\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    (res as any).__sentry_transaction = transaction;\n\n    res.once('finish', () => {\n      // Push `transaction.finish` to the next event loop so open spans have a chance to finish before the transaction\n      // closes\n      setImmediate(() => {\n        addExpressReqToTransaction(transaction, req);\n        transaction.setHttpStatus(res.statusCode);\n        transaction.finish();\n      });\n    });\n\n    next();\n  };\n}\n\n/**\n * Set parameterized as transaction name e.g.: `GET /users/:id`\n * Also adds more context data on the transaction from the request\n */\nfunction addExpressReqToTransaction(transaction: Transaction | undefined, req: ExpressRequest): void {\n  if (!transaction) return;\n  transaction.name = extractExpressTransactionName(req, { path: true, method: true });\n  transaction.setData('url', req.originalUrl);\n  transaction.setData('baseUrl', req.baseUrl);\n  transaction.setData('query', req.query);\n}\n\n/**\n * Extracts complete generalized path from the request object and uses it to construct transaction name.\n *\n * eg. GET /mountpoint/user/:id\n *\n * @param req The ExpressRequest object\n * @param options What to include in the transaction name (method, path, or both)\n *\n * @returns The fully constructed transaction name\n */\nfunction extractExpressTransactionName(\n  req: ExpressRequest,\n  options: { path?: boolean; method?: boolean } = {},\n): string {\n  const method = req.method?.toUpperCase();\n\n  let path = '';\n  if (req.route) {\n    path = `${req.baseUrl || ''}${req.route.path}`;\n  } else if (req.originalUrl || req.url) {\n    path = stripUrlQueryAndFragment(req.originalUrl || req.url || '');\n  }\n\n  let info = '';\n  if (options.method && method) {\n    info += method;\n  }\n  if (options.method && options.path) {\n    info += ` `;\n  }\n  if (options.path && path) {\n    info += path;\n  }\n\n  return info;\n}\n\ntype TransactionNamingScheme = 'path' | 'methodPath' | 'handler';\n\n/** JSDoc */\nfunction extractTransaction(req: ExpressRequest, type: boolean | TransactionNamingScheme): string {\n  switch (type) {\n    case 'path': {\n      return extractExpressTransactionName(req, { path: true });\n    }\n    case 'handler': {\n      return req.route?.stack[0].name || '<anonymous>';\n    }\n    case 'methodPath':\n    default: {\n      return extractExpressTransactionName(req, { path: true, method: true });\n    }\n  }\n}\n\n/** Default user keys that'll be used to extract data from the request */\nconst DEFAULT_USER_KEYS = ['id', 'username', 'email'];\n\n/** JSDoc */\nfunction extractUserData(\n  user: {\n    [key: string]: any;\n  },\n  keys: boolean | string[],\n): { [key: string]: any } {\n  const extractedUser: { [key: string]: any } = {};\n  const attributes = Array.isArray(keys) ? keys : DEFAULT_USER_KEYS;\n\n  attributes.forEach(key => {\n    if (user && key in user) {\n      extractedUser[key] = user[key];\n    }\n  });\n\n  return extractedUser;\n}\n\n/** Default request keys that'll be used to extract data from the request */\nconst DEFAULT_REQUEST_KEYS = ['cookies', 'data', 'headers', 'method', 'query_string', 'url'];\n\n/**\n * Normalizes data from the request object, accounting for framework differences.\n *\n * @param req The request object from which to extract data\n * @param keys An optional array of keys to include in the normalized data. Defaults to DEFAULT_REQUEST_KEYS if not\n * provided.\n * @returns An object containing normalized request data\n */\nexport function extractRequestData(\n  req: { [key: string]: any },\n  keys: string[] = DEFAULT_REQUEST_KEYS,\n): ExtractedNodeRequestData {\n  const requestData: { [key: string]: any } = {};\n\n  // headers:\n  //   node, express, nextjs: req.headers\n  //   koa: req.header\n  const headers = (req.headers || req.header || {}) as {\n    host?: string;\n    cookie?: string;\n  };\n  // method:\n  //   node, express, koa, nextjs: req.method\n  const method = req.method;\n  // host:\n  //   express: req.hostname in > 4 and req.host in < 4\n  //   koa: req.host\n  //   node, nextjs: req.headers.host\n  const host = req.hostname || req.host || headers.host || '<no host>';\n  // protocol:\n  //   node, nextjs: <n/a>\n  //   express, koa: req.protocol\n  const protocol =\n    req.protocol === 'https' || req.secure || ((req.socket || {}) as { encrypted?: boolean }).encrypted\n      ? 'https'\n      : 'http';\n  // url (including path and query string):\n  //   node, express: req.originalUrl\n  //   koa, nextjs: req.url\n  const originalUrl = (req.originalUrl || req.url || '') as string;\n  // absolute url\n  const absoluteUrl = `${protocol}://${host}${originalUrl}`;\n\n  keys.forEach(key => {\n    switch (key) {\n      case 'headers':\n        requestData.headers = headers;\n        break;\n      case 'method':\n        requestData.method = method;\n        break;\n      case 'url':\n        requestData.url = absoluteUrl;\n        break;\n      case 'cookies':\n        // cookies:\n        //   node, express, koa: req.headers.cookie\n        //   vercel, sails.js, express (w/ cookie middleware), nextjs: req.cookies\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        requestData.cookies = req.cookies || cookie.parse(headers.cookie || '');\n        break;\n      case 'query_string':\n        // query string:\n        //   node: req.url (raw)\n        //   express, koa, nextjs: req.query\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        requestData.query_string = req.query || url.parse(originalUrl || '', false).query;\n        break;\n      case 'data':\n        if (method === 'GET' || method === 'HEAD') {\n          break;\n        }\n        // body data:\n        //   express, koa, nextjs: req.body\n        //\n        //   when using node by itself, you have to read the incoming stream(see\n        //   https://nodejs.dev/learn/get-http-request-body-data-using-nodejs); if a user is doing that, we can't know\n        //   where they're going to store the final result, so they'll have to capture this data themselves\n        if (req.body !== undefined) {\n          requestData.data = isString(req.body) ? req.body : JSON.stringify(normalize(req.body));\n        }\n        break;\n      default:\n        if ({}.hasOwnProperty.call(req, key)) {\n          requestData[key] = (req as { [key: string]: any })[key];\n        }\n    }\n  });\n\n  return requestData;\n}\n\n/**\n * Options deciding what parts of the request to use when enhancing an event\n */\nexport interface ParseRequestOptions {\n  ip?: boolean;\n  request?: boolean | string[];\n  serverName?: boolean;\n  transaction?: boolean | TransactionNamingScheme;\n  user?: boolean | string[];\n  version?: boolean;\n}\n\n/**\n * Enriches passed event with request data.\n *\n * @param event Will be mutated and enriched with req data\n * @param req Request object\n * @param options object containing flags to enable functionality\n * @hidden\n */\nexport function parseRequest(event: Event, req: ExpressRequest, options?: ParseRequestOptions): Event {\n  // eslint-disable-next-line no-param-reassign\n  options = {\n    ip: false,\n    request: true,\n    serverName: true,\n    transaction: true,\n    user: true,\n    version: true,\n    ...options,\n  };\n\n  if (options.version) {\n    event.contexts = {\n      ...event.contexts,\n      runtime: {\n        name: 'node',\n        version: global.process.version,\n      },\n    };\n  }\n\n  if (options.request) {\n    // if the option value is `true`, use the default set of keys by not passing anything to `extractRequestData()`\n    const extractedRequestData = Array.isArray(options.request)\n      ? extractRequestData(req, options.request)\n      : extractRequestData(req);\n    event.request = {\n      ...event.request,\n      ...extractedRequestData,\n    };\n  }\n\n  if (options.serverName && !event.server_name) {\n    event.server_name = global.process.env.SENTRY_NAME || os.hostname();\n  }\n\n  if (options.user) {\n    const extractedUser = req.user && isPlainObject(req.user) ? extractUserData(req.user, options.user) : {};\n\n    if (Object.keys(extractedUser)) {\n      event.user = {\n        ...event.user,\n        ...extractedUser,\n      };\n    }\n  }\n\n  // client ip:\n  //   node, nextjs: req.connection.remoteAddress\n  //   express, koa: req.ip\n  if (options.ip) {\n    const ip = req.ip || (req.connection && req.connection.remoteAddress);\n    if (ip) {\n      event.user = {\n        ...event.user,\n        ip_address: ip,\n      };\n    }\n  }\n\n  if (options.transaction && !event.transaction) {\n    // TODO do we even need this anymore?\n    // TODO make this work for nextjs\n    event.transaction = extractTransaction(req, options.transaction);\n  }\n\n  return event;\n}\n\nexport type RequestHandlerOptions = ParseRequestOptions & {\n  flushTimeout?: number;\n};\n\n/**\n * Express compatible request handler.\n * @see Exposed as `Handlers.requestHandler`\n */\nexport function requestHandler(\n  options?: RequestHandlerOptions,\n): (req: http.IncomingMessage, res: http.ServerResponse, next: (error?: any) => void) => void {\n  const currentHub = getCurrentHub();\n  const client = currentHub.getClient<NodeClient>();\n  // Initialise an instance of SessionFlusher on the client when `autoSessionTracking` is enabled and the\n  // `requestHandler` middleware is used indicating that we are running in SessionAggregates mode\n  if (client && isAutoSessionTrackingEnabled(client)) {\n    client.initSessionFlusher();\n\n    // If Scope contains a Single mode Session, it is removed in favor of using Session Aggregates mode\n    const scope = currentHub.getScope();\n    if (scope && scope.getSession()) {\n      scope.setSession();\n    }\n  }\n  return function sentryRequestMiddleware(\n    req: http.IncomingMessage,\n    res: http.ServerResponse,\n    next: (error?: any) => void,\n  ): void {\n    if (options && options.flushTimeout && options.flushTimeout > 0) {\n      // eslint-disable-next-line @typescript-eslint/unbound-method\n      const _end = res.end;\n      res.end = function(chunk?: any | (() => void), encoding?: string | (() => void), cb?: () => void): void {\n        void flush(options.flushTimeout)\n          .then(() => {\n            _end.call(this, chunk, encoding, cb);\n          })\n          .then(null, e => {\n            logger.error(e);\n          });\n      };\n    }\n    const local = domain.create();\n    local.add(req);\n    local.add(res);\n    local.on('error', next);\n\n    local.run(() => {\n      const currentHub = getCurrentHub();\n\n      currentHub.configureScope(scope => {\n        scope.addEventProcessor((event: Event) => parseRequest(event, req, options));\n        const client = currentHub.getClient<NodeClient>();\n        if (isAutoSessionTrackingEnabled(client)) {\n          const scope = currentHub.getScope();\n          if (scope) {\n            // Set `status` of `RequestSession` to Ok, at the beginning of the request\n            scope.setRequestSession({ status: RequestSessionStatus.Ok });\n          }\n        }\n      });\n\n      res.once('finish', () => {\n        const client = currentHub.getClient<NodeClient>();\n        if (isAutoSessionTrackingEnabled(client)) {\n          setImmediate(() => {\n            if (client) {\n              // Calling _captureRequestSession to capture request session at the end of the request by incrementing\n              // the correct SessionAggregates bucket i.e. crashed, errored or exited\n              // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n              (client as any)._captureRequestSession();\n            }\n          });\n        }\n      });\n      next();\n    });\n  };\n}\n\n/** JSDoc */\ninterface MiddlewareError extends Error {\n  status?: number | string;\n  statusCode?: number | string;\n  status_code?: number | string;\n  output?: {\n    statusCode?: number | string;\n  };\n}\n\n/** JSDoc */\nfunction getStatusCodeFromResponse(error: MiddlewareError): number {\n  const statusCode = error.status || error.statusCode || error.status_code || (error.output && error.output.statusCode);\n  return statusCode ? parseInt(statusCode as string, 10) : 500;\n}\n\n/** Returns true if response code is internal server error */\nfunction defaultShouldHandleError(error: MiddlewareError): boolean {\n  const status = getStatusCodeFromResponse(error);\n  return status >= 500;\n}\n\n/**\n * Express compatible error handler.\n * @see Exposed as `Handlers.errorHandler`\n */\nexport function errorHandler(options?: {\n  /**\n   * Callback method deciding whether error should be captured and sent to Sentry\n   * @param error Captured middleware error\n   */\n  shouldHandleError?(error: MiddlewareError): boolean;\n}): (\n  error: MiddlewareError,\n  req: http.IncomingMessage,\n  res: http.ServerResponse,\n  next: (error: MiddlewareError) => void,\n) => void {\n  return function sentryErrorMiddleware(\n    error: MiddlewareError,\n    _req: http.IncomingMessage,\n    res: http.ServerResponse,\n    next: (error: MiddlewareError) => void,\n  ): void {\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const shouldHandleError = (options && options.shouldHandleError) || defaultShouldHandleError;\n\n    if (shouldHandleError(error)) {\n      withScope(_scope => {\n        // For some reason we need to set the transaction on the scope again\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        const transaction = (res as any).__sentry_transaction as Span;\n        if (transaction && _scope.getSpan() === undefined) {\n          _scope.setSpan(transaction);\n        }\n\n        const client = getCurrentHub().getClient<NodeClient>();\n        if (client && isAutoSessionTrackingEnabled(client)) {\n          // Check if the `SessionFlusher` is instantiated on the client to go into this branch that marks the\n          // `requestSession.status` as `Crashed`, and this check is necessary because the `SessionFlusher` is only\n          // instantiated when the the`requestHandler` middleware is initialised, which indicates that we should be\n          // running in SessionAggregates mode\n          // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n          const isSessionAggregatesMode = (client as any)._sessionFlusher !== undefined;\n          if (isSessionAggregatesMode) {\n            const requestSession = _scope.getRequestSession();\n            // If an error bubbles to the `errorHandler`, then this is an unhandled error, and should be reported as a\n            // Crashed session. The `_requestSession.status` is checked to ensure that this error is happening within\n            // the bounds of a request, and if so the status is updated\n            if (requestSession && requestSession.status !== undefined)\n              requestSession.status = RequestSessionStatus.Crashed;\n          }\n        }\n\n        const eventId = captureException(error);\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        (res as any).sentry = eventId;\n        next(error);\n      });\n\n      return;\n    }\n\n    next(error);\n  };\n}\n", "export {\n  Breadcrumb,\n  BreadcrumbHint,\n  Request,\n  SdkInfo,\n  Event,\n  EventHint,\n  Exception,\n  Response,\n  Severity,\n  StackFrame,\n  Stacktrace,\n  Status,\n  Thread,\n  User,\n} from '@sentry/types';\n\nexport {\n  addGlobalEventProcessor,\n  addBreadcrumb,\n  captureException,\n  captureEvent,\n  captureMessage,\n  configureScope,\n  getHubFromCarrier,\n  getCurrentHub,\n  Hub,\n  makeMain,\n  Scope,\n  startTransaction,\n  SDK_VERSION,\n  setContext,\n  setExtra,\n  setExtras,\n  setTag,\n  setTags,\n  setUser,\n  withScope,\n} from '@sentry/core';\n\nexport { NodeOptions } from './types';\nexport { NodeBackend } from './backend';\nexport { NodeClient } from './client';\nexport { defaultIntegrations, init, lastEventId, flush, close, getSentryRelease } from './sdk';\nexport { deepReadDirSync } from './utils';\nexport { SDK_NAME } from './version';\n\nimport { Integrations as CoreIntegrations } from '@sentry/core';\nimport { getMainCarrier } from '@sentry/hub';\nimport * as domain from 'domain';\n\nimport * as Handlers from './handlers';\nimport * as NodeIntegrations from './integrations';\nimport * as Transports from './transports';\n\nconst INTEGRATIONS = {\n  ...CoreIntegrations,\n  ...NodeIntegrations,\n};\n\nexport { INTEGRATIONS as Integrations, Transports, Handlers };\n\n// We need to patch domain on the global __SENTRY__ object to make it work for node in cross-platform packages like\n// @sentry/hub. If we don't do this, browser bundlers will have troubles resolving `require('domain')`.\nconst carrier = getMainCarrier();\nif (carrier.__SENTRY__) {\n  carrier.__SENTRY__.extensions = carrier.__SENTRY__.extensions || {};\n  carrier.__SENTRY__.extensions.domain = carrier.__SENTRY__.extensions.domain || domain;\n}\n", "/**\n * Consumes the promise and logs the error when it rejects.\n * @param promise A promise to forget.\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function forget(promise: PromiseLike<any>): void {\n  void promise.then(null, e => {\n    // TODO: Use a better logging mechanism\n    // eslint-disable-next-line no-console\n    console.error(e);\n  });\n}\n", "/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\n\nimport { Primitive } from '@sentry/types';\n/**\n * Checks whether given value's type is one of a few Error or Error-like\n * {@link isError}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isError(wat: any): boolean {\n  switch (Object.prototype.toString.call(wat)) {\n    case '[object Error]':\n      return true;\n    case '[object Exception]':\n      return true;\n    case '[object DOMException]':\n      return true;\n    default:\n      return isInstanceOf(wat, Error);\n  }\n}\n\n/**\n * Checks whether given value's type is ErrorEvent\n * {@link isErrorEvent}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isErrorEvent(wat: any): boolean {\n  return Object.prototype.toString.call(wat) === '[object ErrorEvent]';\n}\n\n/**\n * Checks whether given value's type is DOMError\n * {@link isDOMError}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isDOMError(wat: any): boolean {\n  return Object.prototype.toString.call(wat) === '[object DOMError]';\n}\n\n/**\n * Checks whether given value's type is DOMException\n * {@link isDOMException}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isDOMException(wat: any): boolean {\n  return Object.prototype.toString.call(wat) === '[object DOMException]';\n}\n\n/**\n * Checks whether given value's type is a string\n * {@link isString}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isString(wat: any): boolean {\n  return Object.prototype.toString.call(wat) === '[object String]';\n}\n\n/**\n * Checks whether given value's is a primitive (undefined, null, number, boolean, string, bigint, symbol)\n * {@link isPrimitive}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isPrimitive(wat: any): wat is Primitive {\n  return wat === null || (typeof wat !== 'object' && typeof wat !== 'function');\n}\n\n/**\n * Checks whether given value's type is an object literal\n * {@link isPlainObject}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isPlainObject(wat: any): boolean {\n  return Object.prototype.toString.call(wat) === '[object Object]';\n}\n\n/**\n * Checks whether given value's type is an Event instance\n * {@link isEvent}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isEvent(wat: any): boolean {\n  return typeof Event !== 'undefined' && isInstanceOf(wat, Event);\n}\n\n/**\n * Checks whether given value's type is an Element instance\n * {@link isElement}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isElement(wat: any): boolean {\n  return typeof Element !== 'undefined' && isInstanceOf(wat, Element);\n}\n\n/**\n * Checks whether given value's type is an regexp\n * {@link isRegExp}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isRegExp(wat: any): boolean {\n  return Object.prototype.toString.call(wat) === '[object RegExp]';\n}\n\n/**\n * Checks whether given value has a then function.\n * @param wat A value to be checked.\n */\nexport function isThenable(wat: any): boolean {\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n  return Boolean(wat && wat.then && typeof wat.then === 'function');\n}\n\n/**\n * Checks whether given value's type is a SyntheticEvent\n * {@link isSyntheticEvent}.\n *\n * @param wat A value to be checked.\n * @returns A boolean representing the result.\n */\nexport function isSyntheticEvent(wat: any): boolean {\n  return isPlainObject(wat) && 'nativeEvent' in wat && 'preventDefault' in wat && 'stopPropagation' in wat;\n}\n/**\n * Checks whether given value's type is an instance of provided constructor.\n * {@link isInstanceOf}.\n *\n * @param wat A value to be checked.\n * @param base A constructor to be used in a check.\n * @returns A boolean representing the result.\n */\nexport function isInstanceOf(wat: any, base: any): boolean {\n  try {\n    return wat instanceof base;\n  } catch (_e) {\n    return false;\n  }\n}\n", "import { isString } from './is';\n\n/**\n * Given a child DOM element, returns a query-selector statement describing that\n * and its ancestors\n * e.g. [HTMLElement] => body > div > input#foo.btn[name=baz]\n * @returns generated DOM path\n */\nexport function htmlTreeAsString(elem: unknown, keyAttrs?: string[]): string {\n  type SimpleNode = {\n    parentNode: SimpleNode;\n  } | null;\n\n  // try/catch both:\n  // - accessing event.target (see getsentry/raven-js#838, #768)\n  // - `htmlTreeAsString` because it's complex, and just accessing the DOM incorrectly\n  // - can throw an exception in some circumstances.\n  try {\n    let currentElem = elem as SimpleNode;\n    const MAX_TRAVERSE_HEIGHT = 5;\n    const MAX_OUTPUT_LEN = 80;\n    const out = [];\n    let height = 0;\n    let len = 0;\n    const separator = ' > ';\n    const sepLength = separator.length;\n    let nextStr;\n\n    // eslint-disable-next-line no-plusplus\n    while (currentElem && height++ < MAX_TRAVERSE_HEIGHT) {\n      nextStr = _htmlElementAsString(currentElem, keyAttrs);\n      // bail out if\n      // - nextStr is the 'html' element\n      // - the length of the string that would be created exceeds MAX_OUTPUT_LEN\n      //   (ignore this limit if we are on the first iteration)\n      if (nextStr === 'html' || (height > 1 && len + out.length * sepLength + nextStr.length >= MAX_OUTPUT_LEN)) {\n        break;\n      }\n\n      out.push(nextStr);\n\n      len += nextStr.length;\n      currentElem = currentElem.parentNode;\n    }\n\n    return out.reverse().join(separator);\n  } catch (_oO) {\n    return '<unknown>';\n  }\n}\n\n/**\n * Returns a simple, query-selector representation of a DOM element\n * e.g. [HTMLElement] => input#foo.btn[name=baz]\n * @returns generated DOM path\n */\nfunction _htmlElementAsString(el: unknown, keyAttrs?: string[]): string {\n  const elem = el as {\n    tagName?: string;\n    id?: string;\n    className?: string;\n    getAttribute(key: string): string;\n  };\n\n  const out = [];\n  let className;\n  let classes;\n  let key;\n  let attr;\n  let i;\n\n  if (!elem || !elem.tagName) {\n    return '';\n  }\n\n  out.push(elem.tagName.toLowerCase());\n\n  // Pairs of attribute keys defined in `serializeAttribute` and their values on element.\n  const keyAttrPairs = keyAttrs?.length\n    ? keyAttrs.filter(keyAttr => elem.getAttribute(keyAttr)).map(keyAttr => [keyAttr, elem.getAttribute(keyAttr)])\n    : null;\n\n  if (keyAttrPairs?.length) {\n    keyAttrPairs.forEach(keyAttrPair => {\n      out.push(`[${keyAttrPair[0]}=\"${keyAttrPair[1]}\"]`);\n    });\n  } else {\n    if (elem.id) {\n      out.push(`#${elem.id}`);\n    }\n\n    // eslint-disable-next-line prefer-const\n    className = elem.className;\n    if (className && isString(className)) {\n      classes = className.split(/\\s+/);\n      for (i = 0; i < classes.length; i++) {\n        out.push(`.${classes[i]}`);\n      }\n    }\n  }\n  const allowedAttrs = ['type', 'name', 'title', 'alt'];\n  for (i = 0; i < allowedAttrs.length; i++) {\n    key = allowedAttrs[i];\n    attr = elem.getAttribute(key);\n    if (attr) {\n      out.push(`[${key}=\"${attr}\"]`);\n    }\n  }\n  return out.join('');\n}\n", "export const setPrototypeOf =\n  Object.setPrototypeOf || ({ __proto__: [] } instanceof Array ? setProtoOf : mixinProperties);\n\n/**\n * setPrototypeOf polyfill using __proto__\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nfunction setProtoOf<TTarget extends object, TProto>(obj: TTarget, proto: TProto): TTarget & TProto {\n  // @ts-ignore __proto__ does not exist on obj\n  obj.__proto__ = proto;\n  return obj as TTarget & TProto;\n}\n\n/**\n * setPrototypeOf polyfill using mixin\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nfunction mixinProperties<TTarget extends object, TProto>(obj: TTarget, proto: TProto): TTarget & TProto {\n  for (const prop in proto) {\n    // eslint-disable-next-line no-prototype-builtins\n    if (!obj.hasOwnProperty(prop)) {\n      // @ts-ignore typescript complains about indexing so we remove\n      obj[prop] = proto[prop];\n    }\n  }\n\n  return obj as TTarget & TProto;\n}\n", "import { setPrototypeOf } from './polyfill';\n\n/** An error emitted by Sentry SDKs and related utilities. */\nexport class SentryError extends Error {\n  /** Display name of this error instance. */\n  public name: string;\n\n  public constructor(public message: string) {\n    super(message);\n\n    this.name = new.target.prototype.constructor.name;\n    setPrototypeOf(this, new.target.prototype);\n  }\n}\n", "import { DsnComponents, DsnLike, DsnProtocol } from '@sentry/types';\n\nimport { SentryError } from './error';\n\n/** Regular expression used to parse a Dsn. */\nconst DSN_REGEX = /^(?:(\\w+):)\\/\\/(?:(\\w+)(?::(\\w+))?@)([\\w.-]+)(?::(\\d+))?\\/(.+)/;\n\n/** Error message */\nconst ERROR_MESSAGE = 'Invalid Dsn';\n\n/** The Sentry Dsn, identifying a Sentry instance and project. */\nexport class Dsn implements DsnComponents {\n  /** Protocol used to connect to Sentry. */\n  public protocol!: DsnProtocol;\n  /** Public authorization key (deprecated, renamed to publicKey). */\n  public user!: string;\n  /** Public authorization key. */\n  public publicKey!: string;\n  /** Private authorization key (deprecated, optional). */\n  public pass!: string;\n  /** Hostname of the Sentry instance. */\n  public host!: string;\n  /** Port of the Sentry instance. */\n  public port!: string;\n  /** Path */\n  public path!: string;\n  /** Project ID */\n  public projectId!: string;\n\n  /** Creates a new Dsn component */\n  public constructor(from: DsnLike) {\n    if (typeof from === 'string') {\n      this._fromString(from);\n    } else {\n      this._fromComponents(from);\n    }\n\n    this._validate();\n  }\n\n  /**\n   * Renders the string representation of this Dsn.\n   *\n   * By default, this will render the public representation without the password\n   * component. To get the deprecated private representation, set `withPassword`\n   * to true.\n   *\n   * @param withPassword When set to true, the password will be included.\n   */\n  public toString(withPassword: boolean = false): string {\n    const { host, path, pass, port, projectId, protocol, publicKey } = this;\n    return (\n      `${protocol}://${publicKey}${withPassword && pass ? `:${pass}` : ''}` +\n      `@${host}${port ? `:${port}` : ''}/${path ? `${path}/` : path}${projectId}`\n    );\n  }\n\n  /** Parses a string into this Dsn. */\n  private _fromString(str: string): void {\n    const match = DSN_REGEX.exec(str);\n\n    if (!match) {\n      throw new SentryError(ERROR_MESSAGE);\n    }\n\n    const [protocol, publicKey, pass = '', host, port = '', lastPath] = match.slice(1);\n    let path = '';\n    let projectId = lastPath;\n\n    const split = projectId.split('/');\n    if (split.length > 1) {\n      path = split.slice(0, -1).join('/');\n      projectId = split.pop() as string;\n    }\n\n    if (projectId) {\n      const projectMatch = projectId.match(/^\\d+/);\n      if (projectMatch) {\n        projectId = projectMatch[0];\n      }\n    }\n\n    this._fromComponents({ host, pass, path, projectId, port, protocol: protocol as DsnProtocol, publicKey });\n  }\n\n  /** Maps Dsn components into this instance. */\n  private _fromComponents(components: DsnComponents): void {\n    // TODO this is for backwards compatibility, and can be removed in a future version\n    if ('user' in components && !('publicKey' in components)) {\n      components.publicKey = components.user;\n    }\n    this.user = components.publicKey || '';\n\n    this.protocol = components.protocol;\n    this.publicKey = components.publicKey || '';\n    this.pass = components.pass || '';\n    this.host = components.host;\n    this.port = components.port || '';\n    this.path = components.path || '';\n    this.projectId = components.projectId;\n  }\n\n  /** Validates this Dsn and throws on error. */\n  private _validate(): void {\n    ['protocol', 'publicKey', 'host', 'projectId'].forEach(component => {\n      if (!this[component as keyof DsnComponents]) {\n        throw new SentryError(`${ERROR_MESSAGE}: ${component} missing`);\n      }\n    });\n\n    if (!this.projectId.match(/^\\d+$/)) {\n      throw new SentryError(`${ERROR_MESSAGE}: Invalid projectId ${this.projectId}`);\n    }\n\n    if (this.protocol !== 'http' && this.protocol !== 'https') {\n      throw new SentryError(`${ERROR_MESSAGE}: Invalid protocol ${this.protocol}`);\n    }\n\n    if (this.port && isNaN(parseInt(this.port, 10))) {\n      throw new SentryError(`${ERROR_MESSAGE}: Invalid port ${this.port}`);\n    }\n  }\n}\n", "/**\n * Checks whether we're in the Node.js or Browser environment\n *\n * @returns Answer to given question\n */\nexport function isNodeEnv(): boolean {\n  return Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]';\n}\n\n/**\n * Requires a module which is protected against bundler minification.\n *\n * @param request The module path to resolve\n */\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any\nexport function dynamicRequire(mod: any, request: string): any {\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n  return mod.require(request);\n}\n\n/**\n * Helper for dynamically loading module that should work with linked dependencies.\n * The problem is that we _should_ be using `require(require.resolve(moduleName, { paths: [cwd()] }))`\n * However it's _not possible_ to do that with Webpack, as it has to know all the dependencies during\n * build time. `require.resolve` is also not available in any other way, so we cannot create,\n * a fake helper like we do with `dynamicRequire`.\n *\n * We always prefer to use local package, thus the value is not returned early from each `try/catch` block.\n * That is to mimic the behavior of `require.resolve` exactly.\n *\n * @param moduleName module name to require\n * @returns possibly required module\n */\nexport function loadModule<T>(moduleName: string): T | undefined {\n  let mod: T | undefined;\n\n  try {\n    mod = dynamicRequire(module, moduleName);\n  } catch (e) {\n    // no-empty\n  }\n\n  try {\n    const { cwd } = dynamicRequire(module, 'process');\n    mod = dynamicRequire(module, `${cwd()}/node_modules/${moduleName}`) as T;\n  } catch (e) {\n    // no-empty\n  }\n\n  return mod;\n}\n", "import { isRegExp, isString } from './is';\n\n/**\n * Truncates given string to the maximum characters count\n *\n * @param str An object that contains serializable values\n * @param max Maximum number of characters in truncated string (0 = unlimited)\n * @returns string Encoded\n */\nexport function truncate(str: string, max: number = 0): string {\n  if (typeof str !== 'string' || max === 0) {\n    return str;\n  }\n  return str.length <= max ? str : `${str.substr(0, max)}...`;\n}\n\n/**\n * This is basically just `trim_line` from\n * https://github.com/getsentry/sentry/blob/master/src/sentry/lang/javascript/processor.py#L67\n *\n * @param str An object that contains serializable values\n * @param max Maximum number of characters in truncated string\n * @returns string Encoded\n */\nexport function snipLine(line: string, colno: number): string {\n  let newLine = line;\n  const ll = newLine.length;\n  if (ll <= 150) {\n    return newLine;\n  }\n  if (colno > ll) {\n    // eslint-disable-next-line no-param-reassign\n    colno = ll;\n  }\n\n  let start = Math.max(colno - 60, 0);\n  if (start < 5) {\n    start = 0;\n  }\n\n  let end = Math.min(start + 140, ll);\n  if (end > ll - 5) {\n    end = ll;\n  }\n  if (end === ll) {\n    start = Math.max(end - 140, 0);\n  }\n\n  newLine = newLine.slice(start, end);\n  if (start > 0) {\n    newLine = `'{snip} ${newLine}`;\n  }\n  if (end < ll) {\n    newLine += ' {snip}';\n  }\n\n  return newLine;\n}\n\n/**\n * Join values in array\n * @param input array of values to be joined together\n * @param delimiter string to be placed in-between values\n * @returns Joined values\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function safeJoin(input: any[], delimiter?: string): string {\n  if (!Array.isArray(input)) {\n    return '';\n  }\n\n  const output = [];\n  // eslint-disable-next-line @typescript-eslint/prefer-for-of\n  for (let i = 0; i < input.length; i++) {\n    const value = input[i];\n    try {\n      output.push(String(value));\n    } catch (e) {\n      output.push('[value cannot be serialized]');\n    }\n  }\n\n  return output.join(delimiter);\n}\n\n/**\n * Checks if the value matches a regex or includes the string\n * @param value The string value to be checked against\n * @param pattern Either a regex or a string that must be contained in value\n */\nexport function isMatchingPattern(value: string, pattern: RegExp | string): boolean {\n  if (!isString(value)) {\n    return false;\n  }\n\n  if (isRegExp(pattern)) {\n    return (pattern as RegExp).test(value);\n  }\n  if (typeof pattern === 'string') {\n    return value.indexOf(pattern) !== -1;\n  }\n  return false;\n}\n", "/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { Event, Integration, StackFrame, WrappedFunction } from '@sentry/types';\n\nimport { isNodeEnv } from './node';\nimport { snipLine } from './string';\n\n/** Internal */\ninterface SentryGlobal {\n  Sentry?: {\n    Integrations?: Integration[];\n  };\n  SENTRY_ENVIRONMENT?: string;\n  SENTRY_DSN?: string;\n  SENTRY_RELEASE?: {\n    id?: string;\n  };\n  __SENTRY__: {\n    globalEventProcessors: any;\n    hub: any;\n    logger: any;\n  };\n}\n\nconst fallbackGlobalObject = {};\n\n/**\n * Safely get global scope object\n *\n * @returns Global scope object\n */\nexport function getGlobalObject<T>(): T & SentryGlobal {\n  return (isNodeEnv()\n    ? global\n    : typeof window !== 'undefined'\n    ? window\n    : typeof self !== 'undefined'\n    ? self\n    : fallbackGlobalObject) as T & SentryGlobal;\n}\n\n/**\n * Extended Window interface that allows for Crypto API usage in IE browsers\n */\ninterface MsCryptoWindow extends Window {\n  msCrypto?: Crypto;\n}\n\n/**\n * UUID4 generator\n *\n * @returns string Generated UUID4.\n */\nexport function uuid4(): string {\n  const global = getGlobalObject() as MsCryptoWindow;\n  const crypto = global.crypto || global.msCrypto;\n\n  if (!(crypto === void 0) && crypto.getRandomValues) {\n    // Use window.crypto API if available\n    const arr = new Uint16Array(8);\n    crypto.getRandomValues(arr);\n\n    // set 4 in byte 7\n    // eslint-disable-next-line no-bitwise\n    arr[3] = (arr[3] & 0xfff) | 0x4000;\n    // set 2 most significant bits of byte 9 to '10'\n    // eslint-disable-next-line no-bitwise\n    arr[4] = (arr[4] & 0x3fff) | 0x8000;\n\n    const pad = (num: number): string => {\n      let v = num.toString(16);\n      while (v.length < 4) {\n        v = `0${v}`;\n      }\n      return v;\n    };\n\n    return (\n      pad(arr[0]) + pad(arr[1]) + pad(arr[2]) + pad(arr[3]) + pad(arr[4]) + pad(arr[5]) + pad(arr[6]) + pad(arr[7])\n    );\n  }\n  // http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/2117523#2117523\n  return 'xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx'.replace(/[xy]/g, c => {\n    // eslint-disable-next-line no-bitwise\n    const r = (Math.random() * 16) | 0;\n    // eslint-disable-next-line no-bitwise\n    const v = c === 'x' ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n}\n\n/**\n * Parses string form of URL into an object\n * // borrowed from https://tools.ietf.org/html/rfc3986#appendix-B\n * // intentionally using regex and not <a/> href parsing trick because React Native and other\n * // environments where DOM might not be available\n * @returns parsed URL object\n */\nexport function parseUrl(\n  url: string,\n): {\n  host?: string;\n  path?: string;\n  protocol?: string;\n  relative?: string;\n} {\n  if (!url) {\n    return {};\n  }\n\n  const match = url.match(/^(([^:/?#]+):)?(\\/\\/([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$/);\n\n  if (!match) {\n    return {};\n  }\n\n  // coerce to undefined values to empty string so we don't get 'undefined'\n  const query = match[6] || '';\n  const fragment = match[8] || '';\n  return {\n    host: match[4],\n    path: match[5],\n    protocol: match[2],\n    relative: match[5] + query + fragment, // everything minus origin\n  };\n}\n\n/**\n * Extracts either message or type+value from an event that can be used for user-facing logs\n * @returns event's description\n */\nexport function getEventDescription(event: Event): string {\n  if (event.message) {\n    return event.message;\n  }\n  if (event.exception && event.exception.values && event.exception.values[0]) {\n    const exception = event.exception.values[0];\n\n    if (exception.type && exception.value) {\n      return `${exception.type}: ${exception.value}`;\n    }\n    return exception.type || exception.value || event.event_id || '<unknown>';\n  }\n  return event.event_id || '<unknown>';\n}\n\n/** JSDoc */\ninterface ExtensibleConsole extends Console {\n  [key: string]: any;\n}\n\n/** JSDoc */\nexport function consoleSandbox(callback: () => any): any {\n  const global = getGlobalObject<Window>();\n  const levels = ['debug', 'info', 'warn', 'error', 'log', 'assert'];\n\n  if (!('console' in global)) {\n    return callback();\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n  const originalConsole = (global as any).console as ExtensibleConsole;\n  const wrappedLevels: { [key: string]: any } = {};\n\n  // Restore all wrapped console methods\n  levels.forEach(level => {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    if (level in (global as any).console && (originalConsole[level] as WrappedFunction).__sentry_original__) {\n      wrappedLevels[level] = originalConsole[level] as WrappedFunction;\n      originalConsole[level] = (originalConsole[level] as WrappedFunction).__sentry_original__;\n    }\n  });\n\n  // Perform callback manipulations\n  const result = callback();\n\n  // Revert restoration to wrapped state\n  Object.keys(wrappedLevels).forEach(level => {\n    originalConsole[level] = wrappedLevels[level];\n  });\n\n  return result;\n}\n\n/**\n * Adds exception values, type and value to an synthetic Exception.\n * @param event The event to modify.\n * @param value Value of the exception.\n * @param type Type of the exception.\n * @hidden\n */\nexport function addExceptionTypeValue(event: Event, value?: string, type?: string): void {\n  event.exception = event.exception || {};\n  event.exception.values = event.exception.values || [];\n  event.exception.values[0] = event.exception.values[0] || {};\n  event.exception.values[0].value = event.exception.values[0].value || value || '';\n  event.exception.values[0].type = event.exception.values[0].type || type || 'Error';\n}\n\n/**\n * Adds exception mechanism to a given event.\n * @param event The event to modify.\n * @param mechanism Mechanism of the mechanism.\n * @hidden\n */\nexport function addExceptionMechanism(\n  event: Event,\n  mechanism: {\n    [key: string]: any;\n  } = {},\n): void {\n  // TODO: Use real type with `keyof Mechanism` thingy and maybe make it better?\n  try {\n    // @ts-ignore Type 'Mechanism | {}' is not assignable to type 'Mechanism | undefined'\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    event.exception!.values![0].mechanism = event.exception!.values![0].mechanism || {};\n    Object.keys(mechanism).forEach(key => {\n      // @ts-ignore Mechanism has no index signature\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      event.exception!.values![0].mechanism[key] = mechanism[key];\n    });\n  } catch (_oO) {\n    // no-empty\n  }\n}\n\n/**\n * A safe form of location.href\n */\nexport function getLocationHref(): string {\n  try {\n    return document.location.href;\n  } catch (oO) {\n    return '';\n  }\n}\n\n// https://semver.org/#is-there-a-suggested-regular-expression-regex-to-check-a-semver-string\nconst SEMVER_REGEXP = /^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$/;\n\n/**\n * Represents Semantic Versioning object\n */\ninterface SemVer {\n  major?: number;\n  minor?: number;\n  patch?: number;\n  prerelease?: string;\n  buildmetadata?: string;\n}\n\n/**\n * Parses input into a SemVer interface\n * @param input string representation of a semver version\n */\nexport function parseSemver(input: string): SemVer {\n  const match = input.match(SEMVER_REGEXP) || [];\n  const major = parseInt(match[1], 10);\n  const minor = parseInt(match[2], 10);\n  const patch = parseInt(match[3], 10);\n  return {\n    buildmetadata: match[5],\n    major: isNaN(major) ? undefined : major,\n    minor: isNaN(minor) ? undefined : minor,\n    patch: isNaN(patch) ? undefined : patch,\n    prerelease: match[4],\n  };\n}\n\nconst defaultRetryAfter = 60 * 1000; // 60 seconds\n\n/**\n * Extracts Retry-After value from the request header or returns default value\n * @param now current unix timestamp\n * @param header string representation of 'Retry-After' header\n */\nexport function parseRetryAfterHeader(now: number, header?: string | number | null): number {\n  if (!header) {\n    return defaultRetryAfter;\n  }\n\n  const headerDelay = parseInt(`${header}`, 10);\n  if (!isNaN(headerDelay)) {\n    return headerDelay * 1000;\n  }\n\n  const headerDate = Date.parse(`${header}`);\n  if (!isNaN(headerDate)) {\n    return headerDate - now;\n  }\n\n  return defaultRetryAfter;\n}\n\n/**\n * This function adds context (pre/post/line) lines to the provided frame\n *\n * @param lines string[] containing all lines\n * @param frame StackFrame that will be mutated\n * @param linesOfContext number of context lines we want to add pre/post\n */\nexport function addContextToFrame(lines: string[], frame: StackFrame, linesOfContext: number = 5): void {\n  const lineno = frame.lineno || 0;\n  const maxLines = lines.length;\n  const sourceLine = Math.max(Math.min(maxLines, lineno - 1), 0);\n\n  frame.pre_context = lines\n    .slice(Math.max(0, sourceLine - linesOfContext), sourceLine)\n    .map((line: string) => snipLine(line, 0));\n\n  frame.context_line = snipLine(lines[Math.min(maxLines - 1, sourceLine)], frame.colno || 0);\n\n  frame.post_context = lines\n    .slice(Math.min(sourceLine + 1, maxLines), sourceLine + 1 + linesOfContext)\n    .map((line: string) => snipLine(line, 0));\n}\n\n/**\n * Strip the query string and fragment off of a given URL or path (if present)\n *\n * @param urlPath Full URL or path, including possible query string and/or fragment\n * @returns URL or path without query string or fragment\n */\nexport function stripUrlQueryAndFragment(urlPath: string): string {\n  // eslint-disable-next-line no-useless-escape\n  return urlPath.split(/[\\?#]/, 1)[0];\n}\n", "/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { consoleSandbox, getGlobalObject } from './misc';\n\n// TODO: Implement different loggers for different environments\nconst global = getGlobalObject<Window | NodeJS.Global>();\n\n/** Prefix for logging strings */\nconst PREFIX = 'Sentry Logger ';\n\n/** JSDoc */\nclass Logger {\n  /** JSDoc */\n  private _enabled: boolean;\n\n  /** JSDoc */\n  public constructor() {\n    this._enabled = false;\n  }\n\n  /** JSDoc */\n  public disable(): void {\n    this._enabled = false;\n  }\n\n  /** JSDoc */\n  public enable(): void {\n    this._enabled = true;\n  }\n\n  /** JSDoc */\n  public log(...args: any[]): void {\n    if (!this._enabled) {\n      return;\n    }\n    consoleSandbox(() => {\n      global.console.log(`${PREFIX}[Log]: ${args.join(' ')}`);\n    });\n  }\n\n  /** JSDoc */\n  public warn(...args: any[]): void {\n    if (!this._enabled) {\n      return;\n    }\n    consoleSandbox(() => {\n      global.console.warn(`${PREFIX}[Warn]: ${args.join(' ')}`);\n    });\n  }\n\n  /** JSDoc */\n  public error(...args: any[]): void {\n    if (!this._enabled) {\n      return;\n    }\n    consoleSandbox(() => {\n      global.console.error(`${PREFIX}[Error]: ${args.join(' ')}`);\n    });\n  }\n}\n\n// Ensure we only have a single logger instance, even if multiple versions of @sentry/utils are being used\nglobal.__SENTRY__ = global.__SENTRY__ || {};\nconst logger = (global.__SENTRY__.logger as Logger) || (global.__SENTRY__.logger = new Logger());\n\nexport { logger };\n", "/* eslint-disable @typescript-eslint/no-unsafe-member-access */\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\n/**\n * Memo class used for decycle json objects. Uses WeakSet if available otherwise array.\n */\nexport class Memo {\n  /** Determines if WeakSet is available */\n  private readonly _hasWeakSet: boolean;\n  /** Either WeakSet or Array */\n  private readonly _inner: any;\n\n  public constructor() {\n    this._hasWeakSet = typeof WeakSet === 'function';\n    this._inner = this._hasWeakSet ? new WeakSet() : [];\n  }\n\n  /**\n   * Sets obj to remember.\n   * @param obj Object to remember\n   */\n  public memoize(obj: any): boolean {\n    if (this._hasWeakSet) {\n      if (this._inner.has(obj)) {\n        return true;\n      }\n      this._inner.add(obj);\n      return false;\n    }\n    // eslint-disable-next-line @typescript-eslint/prefer-for-of\n    for (let i = 0; i < this._inner.length; i++) {\n      const value = this._inner[i];\n      if (value === obj) {\n        return true;\n      }\n    }\n    this._inner.push(obj);\n    return false;\n  }\n\n  /**\n   * Removes object from internal storage.\n   * @param obj Object to forget\n   */\n  public unmemoize(obj: any): void {\n    if (this._hasWeakSet) {\n      this._inner.delete(obj);\n    } else {\n      for (let i = 0; i < this._inner.length; i++) {\n        if (this._inner[i] === obj) {\n          this._inner.splice(i, 1);\n          break;\n        }\n      }\n    }\n  }\n}\n", "const defaultFunctionName = '<anonymous>';\n\n/**\n * Safely extract function name from itself\n */\nexport function getFunctionName(fn: unknown): string {\n  try {\n    if (!fn || typeof fn !== 'function') {\n      return defaultFunctionName;\n    }\n    return fn.name || defaultFunctionName;\n  } catch (e) {\n    // Just accessing custom props in some Selenium environments\n    // can cause a \"Permission denied\" exception (see raven-js#495).\n    return defaultFunctionName;\n  }\n}\n", "/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { ExtendedError, WrappedFunction } from '@sentry/types';\n\nimport { htmlTreeAsString } from './browser';\nimport { isElement, isError, isEvent, isInstanceOf, isPlainObject, isPrimitive, isSyntheticEvent } from './is';\nimport { Memo } from './memo';\nimport { getFunctionName } from './stacktrace';\nimport { truncate } from './string';\n\n/**\n * Replace a method in an object with a wrapped version of itself.\n *\n * @param source An object that contains a method to be wrapped.\n * @param name The name of the method to be wrapped.\n * @param replacementFactory A higher-order function that takes the original version of the given method and returns a\n * wrapped version. Note: The function returned by `replacementFactory` needs to be a non-arrow function, in order to\n * preserve the correct value of `this`, and the original method must be called using `origMethod.call(this, <other\n * args>)` or `origMethod.apply(this, [<other args>])` (rather than being called directly), again to preserve `this`.\n * @returns void\n */\nexport function fill(source: { [key: string]: any }, name: string, replacementFactory: (...args: any[]) => any): void {\n  if (!(name in source)) {\n    return;\n  }\n\n  const original = source[name] as () => any;\n  const wrapped = replacementFactory(original) as WrappedFunction;\n\n  // Make sure it's a function first, as we need to attach an empty prototype for `defineProperties` to work\n  // otherwise it'll throw \"TypeError: Object.defineProperties called on non-object\"\n  if (typeof wrapped === 'function') {\n    try {\n      wrapped.prototype = wrapped.prototype || {};\n      Object.defineProperties(wrapped, {\n        __sentry_original__: {\n          enumerable: false,\n          value: original,\n        },\n      });\n    } catch (_Oo) {\n      // This can throw if multiple fill happens on a global object like XMLHttpRequest\n      // Fixes https://github.com/getsentry/sentry-javascript/issues/2043\n    }\n  }\n\n  source[name] = wrapped;\n}\n\n/**\n * Encodes given object into url-friendly format\n *\n * @param object An object that contains serializable values\n * @returns string Encoded\n */\nexport function urlEncode(object: { [key: string]: any }): string {\n  return Object.keys(object)\n    .map(key => `${encodeURIComponent(key)}=${encodeURIComponent(object[key])}`)\n    .join('&');\n}\n\n/**\n * Transforms any object into an object literal with all its attributes\n * attached to it.\n *\n * @param value Initial source that we have to transform in order for it to be usable by the serializer\n */\nfunction getWalkSource(\n  value: any,\n): {\n  [key: string]: any;\n} {\n  if (isError(value)) {\n    const error = value as ExtendedError;\n    const err: {\n      [key: string]: any;\n      stack: string | undefined;\n      message: string;\n      name: string;\n    } = {\n      message: error.message,\n      name: error.name,\n      stack: error.stack,\n    };\n\n    for (const i in error) {\n      if (Object.prototype.hasOwnProperty.call(error, i)) {\n        err[i] = error[i];\n      }\n    }\n\n    return err;\n  }\n\n  if (isEvent(value)) {\n    /**\n     * Event-like interface that's usable in browser and node\n     */\n    interface SimpleEvent {\n      [key: string]: unknown;\n      type: string;\n      target?: unknown;\n      currentTarget?: unknown;\n    }\n\n    const event = value as SimpleEvent;\n\n    const source: {\n      [key: string]: any;\n    } = {};\n\n    source.type = event.type;\n\n    // Accessing event.target can throw (see getsentry/raven-js#838, #768)\n    try {\n      source.target = isElement(event.target)\n        ? htmlTreeAsString(event.target)\n        : Object.prototype.toString.call(event.target);\n    } catch (_oO) {\n      source.target = '<unknown>';\n    }\n\n    try {\n      source.currentTarget = isElement(event.currentTarget)\n        ? htmlTreeAsString(event.currentTarget)\n        : Object.prototype.toString.call(event.currentTarget);\n    } catch (_oO) {\n      source.currentTarget = '<unknown>';\n    }\n\n    if (typeof CustomEvent !== 'undefined' && isInstanceOf(value, CustomEvent)) {\n      source.detail = event.detail;\n    }\n\n    for (const i in event) {\n      if (Object.prototype.hasOwnProperty.call(event, i)) {\n        source[i] = event;\n      }\n    }\n\n    return source;\n  }\n\n  return value as {\n    [key: string]: any;\n  };\n}\n\n/** Calculates bytes size of input string */\nfunction utf8Length(value: string): number {\n  // eslint-disable-next-line no-bitwise\n  return ~-encodeURI(value).split(/%..|./).length;\n}\n\n/** Calculates bytes size of input object */\nfunction jsonSize(value: any): number {\n  return utf8Length(JSON.stringify(value));\n}\n\n/** JSDoc */\nexport function normalizeToSize<T>(\n  object: { [key: string]: any },\n  // Default Node.js REPL depth\n  depth: number = 3,\n  // 100kB, as 200kB is max payload size, so half sounds reasonable\n  maxSize: number = 100 * 1024,\n): T {\n  const serialized = normalize(object, depth);\n\n  if (jsonSize(serialized) > maxSize) {\n    return normalizeToSize(object, depth - 1, maxSize);\n  }\n\n  return serialized as T;\n}\n\n/**\n * Transform any non-primitive, BigInt, or Symbol-type value into a string. Acts as a no-op on strings, numbers,\n * booleans, null, and undefined.\n *\n * @param value The value to stringify\n * @returns For non-primitive, BigInt, and Symbol-type values, a string denoting the value's type, type and value, or\n *  type and `description` property, respectively. For non-BigInt, non-Symbol primitives, returns the original value,\n *  unchanged.\n */\nfunction serializeValue(value: any): any {\n  const type = Object.prototype.toString.call(value);\n\n  // Node.js REPL notation\n  if (typeof value === 'string') {\n    return value;\n  }\n  if (type === '[object Object]') {\n    return '[Object]';\n  }\n  if (type === '[object Array]') {\n    return '[Array]';\n  }\n\n  const normalized = normalizeValue(value);\n  return isPrimitive(normalized) ? normalized : type;\n}\n\n/**\n * normalizeValue()\n *\n * Takes unserializable input and make it serializable friendly\n *\n * - translates undefined/NaN values to \"[undefined]\"/\"[NaN]\" respectively,\n * - serializes Error objects\n * - filter global objects\n */\nfunction normalizeValue<T>(value: T, key?: any): T | string {\n  if (key === 'domain' && value && typeof value === 'object' && ((value as unknown) as { _events: any })._events) {\n    return '[Domain]';\n  }\n\n  if (key === 'domainEmitter') {\n    return '[DomainEmitter]';\n  }\n\n  if (typeof (global as any) !== 'undefined' && (value as unknown) === global) {\n    return '[Global]';\n  }\n\n  if (typeof (window as any) !== 'undefined' && (value as unknown) === window) {\n    return '[Window]';\n  }\n\n  if (typeof (document as any) !== 'undefined' && (value as unknown) === document) {\n    return '[Document]';\n  }\n\n  // React's SyntheticEvent thingy\n  if (isSyntheticEvent(value)) {\n    return '[SyntheticEvent]';\n  }\n\n  if (typeof value === 'number' && value !== value) {\n    return '[NaN]';\n  }\n\n  if (value === void 0) {\n    return '[undefined]';\n  }\n\n  if (typeof value === 'function') {\n    return `[Function: ${getFunctionName(value)}]`;\n  }\n\n  // symbols and bigints are considered primitives by TS, but aren't natively JSON-serilaizable\n\n  if (typeof value === 'symbol') {\n    return `[${String(value)}]`;\n  }\n\n  if (typeof value === 'bigint') {\n    return `[BigInt: ${String(value)}]`;\n  }\n\n  return value;\n}\n\n/**\n * Walks an object to perform a normalization on it\n *\n * @param key of object that's walked in current iteration\n * @param value object to be walked\n * @param depth Optional number indicating how deep should walking be performed\n * @param memo Optional Memo class handling decycling\n */\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function walk(key: string, value: any, depth: number = +Infinity, memo: Memo = new Memo()): any {\n  // If we reach the maximum depth, serialize whatever has left\n  if (depth === 0) {\n    return serializeValue(value);\n  }\n\n  /* eslint-disable @typescript-eslint/no-unsafe-member-access */\n  // If value implements `toJSON` method, call it and return early\n  if (value !== null && value !== undefined && typeof value.toJSON === 'function') {\n    return value.toJSON();\n  }\n  /* eslint-enable @typescript-eslint/no-unsafe-member-access */\n\n  // If normalized value is a primitive, there are no branches left to walk, so we can just bail out, as theres no point in going down that branch any further\n  const normalized = normalizeValue(value, key);\n  if (isPrimitive(normalized)) {\n    return normalized;\n  }\n\n  // Create source that we will use for next itterations, either objectified error object (Error type with extracted keys:value pairs) or the input itself\n  const source = getWalkSource(value);\n\n  // Create an accumulator that will act as a parent for all future itterations of that branch\n  const acc = Array.isArray(value) ? [] : {};\n\n  // If we already walked that branch, bail out, as it's circular reference\n  if (memo.memoize(value)) {\n    return '[Circular ~]';\n  }\n\n  // Walk all keys of the source\n  for (const innerKey in source) {\n    // Avoid iterating over fields in the prototype if they've somehow been exposed to enumeration.\n    if (!Object.prototype.hasOwnProperty.call(source, innerKey)) {\n      continue;\n    }\n    // Recursively walk through all the child nodes\n    (acc as { [key: string]: any })[innerKey] = walk(innerKey, source[innerKey], depth - 1, memo);\n  }\n\n  // Once walked through all the branches, remove the parent from memo storage\n  memo.unmemoize(value);\n\n  // Return accumulated values\n  return acc;\n}\n\n/**\n * normalize()\n *\n * - Creates a copy to prevent original input mutation\n * - Skip non-enumerablers\n * - Calls `toJSON` if implemented\n * - Removes circular references\n * - Translates non-serializeable values (undefined/NaN/Functions) to serializable format\n * - Translates known global objects/Classes to a string representations\n * - Takes care of Error objects serialization\n * - Optionally limit depth of final output\n */\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function normalize(input: any, depth?: number): any {\n  try {\n    return JSON.parse(JSON.stringify(input, (key: string, value: any) => walk(key, value, depth)));\n  } catch (_oO) {\n    return '**non-serializable**';\n  }\n}\n\n/**\n * Given any captured exception, extract its keys and create a sorted\n * and truncated list that will be used inside the event message.\n * eg. `Non-error exception captured with keys: foo, bar, baz`\n */\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function extractExceptionKeysForMessage(exception: any, maxLength: number = 40): string {\n  const keys = Object.keys(getWalkSource(exception));\n  keys.sort();\n\n  if (!keys.length) {\n    return '[object has no keys]';\n  }\n\n  if (keys[0].length >= maxLength) {\n    return truncate(keys[0], maxLength);\n  }\n\n  for (let includedKeys = keys.length; includedKeys > 0; includedKeys--) {\n    const serialized = keys.slice(0, includedKeys).join(', ');\n    if (serialized.length > maxLength) {\n      continue;\n    }\n    if (includedKeys === keys.length) {\n      return serialized;\n    }\n    return truncate(serialized, maxLength);\n  }\n\n  return '';\n}\n\n/**\n * Given any object, return the new object with removed keys that value was `undefined`.\n * Works recursively on objects and arrays.\n */\nexport function dropUndefinedKeys<T>(val: T): T {\n  if (isPlainObject(val)) {\n    const obj = val as { [key: string]: any };\n    const rv: { [key: string]: any } = {};\n    for (const key of Object.keys(obj)) {\n      if (typeof obj[key] !== 'undefined') {\n        rv[key] = dropUndefinedKeys(obj[key]);\n      }\n    }\n    return rv as T;\n  }\n\n  if (Array.isArray(val)) {\n    return (val as any[]).map(dropUndefinedKeys) as any;\n  }\n\n  return val;\n}\n", "import { logger } from './logger';\nimport { getGlobalObject } from './misc';\n\n/**\n * Tells whether current environment supports ErrorEvent objects\n * {@link supportsErrorEvent}.\n *\n * @returns Answer to the given question.\n */\nexport function supportsErrorEvent(): boolean {\n  try {\n    new ErrorEvent('');\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Tells whether current environment supports DOMError objects\n * {@link supportsDOMError}.\n *\n * @returns Answer to the given question.\n */\nexport function supportsDOMError(): boolean {\n  try {\n    // Chrome: VM89:1 Uncaught TypeError: Failed to construct 'DOMError':\n    // 1 argument required, but only 0 present.\n    // @ts-ignore It really needs 1 argument, not 0.\n    new DOMError('');\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Tells whether current environment supports DOMException objects\n * {@link supportsDOMException}.\n *\n * @returns Answer to the given question.\n */\nexport function supportsDOMException(): boolean {\n  try {\n    new DOMException('');\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Tells whether current environment supports Fetch API\n * {@link supportsFetch}.\n *\n * @returns Answer to the given question.\n */\nexport function supportsFetch(): boolean {\n  if (!('fetch' in getGlobalObject<Window>())) {\n    return false;\n  }\n\n  try {\n    new Headers();\n    new Request('');\n    new Response();\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n/**\n * isNativeFetch checks if the given function is a native implementation of fetch()\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function isNativeFetch(func: Function): boolean {\n  return func && /^function fetch\\(\\)\\s+\\{\\s+\\[native code\\]\\s+\\}$/.test(func.toString());\n}\n\n/**\n * Tells whether current environment supports Fetch API natively\n * {@link supportsNativeFetch}.\n *\n * @returns true if `window.fetch` is natively implemented, false otherwise\n */\nexport function supportsNativeFetch(): boolean {\n  if (!supportsFetch()) {\n    return false;\n  }\n\n  const global = getGlobalObject<Window>();\n\n  // Fast path to avoid DOM I/O\n  // eslint-disable-next-line @typescript-eslint/unbound-method\n  if (isNativeFetch(global.fetch)) {\n    return true;\n  }\n\n  // window.fetch is implemented, but is polyfilled or already wrapped (e.g: by a chrome extension)\n  // so create a \"pure\" iframe to see if that has native fetch\n  let result = false;\n  const doc = global.document;\n  // eslint-disable-next-line deprecation/deprecation\n  if (doc && typeof (doc.createElement as unknown) === `function`) {\n    try {\n      const sandbox = doc.createElement('iframe');\n      sandbox.hidden = true;\n      doc.head.appendChild(sandbox);\n      if (sandbox.contentWindow && sandbox.contentWindow.fetch) {\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        result = isNativeFetch(sandbox.contentWindow.fetch);\n      }\n      doc.head.removeChild(sandbox);\n    } catch (err) {\n      logger.warn('Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ', err);\n    }\n  }\n\n  return result;\n}\n\n/**\n * Tells whether current environment supports ReportingObserver API\n * {@link supportsReportingObserver}.\n *\n * @returns Answer to the given question.\n */\nexport function supportsReportingObserver(): boolean {\n  return 'ReportingObserver' in getGlobalObject();\n}\n\n/**\n * Tells whether current environment supports Referrer Policy API\n * {@link supportsReferrerPolicy}.\n *\n * @returns Answer to the given question.\n */\nexport function supportsReferrerPolicy(): boolean {\n  // Despite all stars in the sky saying that Edge supports old draft syntax, aka 'never', 'always', 'origin' and 'default\n  // https://caniuse.com/#feat=referrer-policy\n  // It doesn't. And it throw exception instead of ignoring this parameter...\n  // REF: https://github.com/getsentry/raven-js/issues/1233\n\n  if (!supportsFetch()) {\n    return false;\n  }\n\n  try {\n    new Request('_', {\n      referrerPolicy: 'origin' as ReferrerPolicy,\n    });\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Tells whether current environment supports History API\n * {@link supportsHistory}.\n *\n * @returns Answer to the given question.\n */\nexport function supportsHistory(): boolean {\n  // NOTE: in Chrome App environment, touching history.pushState, *even inside\n  //       a try/catch block*, will cause Chrome to output an error to console.error\n  // borrowed from: https://github.com/angular/angular.js/pull/13945/files\n  const global = getGlobalObject<Window>();\n  /* eslint-disable @typescript-eslint/no-unsafe-member-access */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const chrome = (global as any).chrome;\n  const isChromePackagedApp = chrome && chrome.app && chrome.app.runtime;\n  /* eslint-enable @typescript-eslint/no-unsafe-member-access */\n  const hasHistoryApi = 'history' in global && !!global.history.pushState && !!global.history.replaceState;\n\n  return !isChromePackagedApp && hasHistoryApi;\n}\n", "/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/ban-types */\nimport { WrappedFunction } from '@sentry/types';\n\nimport { isInstanceOf, isString } from './is';\nimport { logger } from './logger';\nimport { getGlobalObject } from './misc';\nimport { fill } from './object';\nimport { getFunctionName } from './stacktrace';\nimport { supportsHistory, supportsNativeFetch } from './supports';\n\nconst global = getGlobalObject<Window>();\n\n/** Object describing handler that will be triggered for a given `type` of instrumentation */\ninterface InstrumentHandler {\n  type: InstrumentHandlerType;\n  callback: InstrumentHandlerCallback;\n}\ntype InstrumentHandlerType =\n  | 'console'\n  | 'dom'\n  | 'fetch'\n  | 'history'\n  | 'sentry'\n  | 'xhr'\n  | 'error'\n  | 'unhandledrejection';\ntype InstrumentHandlerCallback = (data: any) => void;\n\n/**\n * Instrument native APIs to call handlers that can be used to create breadcrumbs, APM spans etc.\n *  - Console API\n *  - Fetch API\n *  - XHR API\n *  - History API\n *  - DOM API (click/typing)\n *  - Error API\n *  - UnhandledRejection API\n */\n\nconst handlers: { [key in InstrumentHandlerType]?: InstrumentHandlerCallback[] } = {};\nconst instrumented: { [key in InstrumentHandlerType]?: boolean } = {};\n\n/** Instruments given API */\nfunction instrument(type: InstrumentHandlerType): void {\n  if (instrumented[type]) {\n    return;\n  }\n\n  instrumented[type] = true;\n\n  switch (type) {\n    case 'console':\n      instrumentConsole();\n      break;\n    case 'dom':\n      instrumentDOM();\n      break;\n    case 'xhr':\n      instrumentXHR();\n      break;\n    case 'fetch':\n      instrumentFetch();\n      break;\n    case 'history':\n      instrumentHistory();\n      break;\n    case 'error':\n      instrumentError();\n      break;\n    case 'unhandledrejection':\n      instrumentUnhandledRejection();\n      break;\n    default:\n      logger.warn('unknown instrumentation type:', type);\n  }\n}\n\n/**\n * Add handler that will be called when given type of instrumentation triggers.\n * Use at your own risk, this might break without changelog notice, only used internally.\n * @hidden\n */\nexport function addInstrumentationHandler(handler: InstrumentHandler): void {\n  if (!handler || typeof handler.type !== 'string' || typeof handler.callback !== 'function') {\n    return;\n  }\n  handlers[handler.type] = handlers[handler.type] || [];\n  (handlers[handler.type] as InstrumentHandlerCallback[]).push(handler.callback);\n  instrument(handler.type);\n}\n\n/** JSDoc */\nfunction triggerHandlers(type: InstrumentHandlerType, data: any): void {\n  if (!type || !handlers[type]) {\n    return;\n  }\n\n  for (const handler of handlers[type] || []) {\n    try {\n      handler(data);\n    } catch (e) {\n      logger.error(\n        `Error while triggering instrumentation handler.\\nType: ${type}\\nName: ${getFunctionName(\n          handler,\n        )}\\nError: ${e}`,\n      );\n    }\n  }\n}\n\n/** JSDoc */\nfunction instrumentConsole(): void {\n  if (!('console' in global)) {\n    return;\n  }\n\n  ['debug', 'info', 'warn', 'error', 'log', 'assert'].forEach(function(level: string): void {\n    if (!(level in global.console)) {\n      return;\n    }\n\n    fill(global.console, level, function(originalConsoleLevel: () => any): Function {\n      return function(...args: any[]): void {\n        triggerHandlers('console', { args, level });\n\n        // this fails for some browsers. :(\n        if (originalConsoleLevel) {\n          Function.prototype.apply.call(originalConsoleLevel, global.console, args);\n        }\n      };\n    });\n  });\n}\n\n/** JSDoc */\nfunction instrumentFetch(): void {\n  if (!supportsNativeFetch()) {\n    return;\n  }\n\n  fill(global, 'fetch', function(originalFetch: () => void): () => void {\n    return function(...args: any[]): void {\n      const handlerData = {\n        args,\n        fetchData: {\n          method: getFetchMethod(args),\n          url: getFetchUrl(args),\n        },\n        startTimestamp: Date.now(),\n      };\n\n      triggerHandlers('fetch', {\n        ...handlerData,\n      });\n\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      return originalFetch.apply(global, args).then(\n        (response: Response) => {\n          triggerHandlers('fetch', {\n            ...handlerData,\n            endTimestamp: Date.now(),\n            response,\n          });\n          return response;\n        },\n        (error: Error) => {\n          triggerHandlers('fetch', {\n            ...handlerData,\n            endTimestamp: Date.now(),\n            error,\n          });\n          // NOTE: If you are a Sentry user, and you are seeing this stack frame,\n          //       it means the sentry.javascript SDK caught an error invoking your application code.\n          //       This is expected behavior and NOT indicative of a bug with sentry.javascript.\n          throw error;\n        },\n      );\n    };\n  });\n}\n\ntype XHRSendInput = null | Blob | BufferSource | FormData | URLSearchParams | string;\n\n/** JSDoc */\ninterface SentryWrappedXMLHttpRequest extends XMLHttpRequest {\n  [key: string]: any;\n  __sentry_xhr__?: {\n    method?: string;\n    url?: string;\n    status_code?: number;\n    body?: XHRSendInput;\n  };\n}\n\n/* eslint-disable @typescript-eslint/no-unsafe-member-access */\n/** Extract `method` from fetch call arguments */\nfunction getFetchMethod(fetchArgs: any[] = []): string {\n  if ('Request' in global && isInstanceOf(fetchArgs[0], Request) && fetchArgs[0].method) {\n    return String(fetchArgs[0].method).toUpperCase();\n  }\n  if (fetchArgs[1] && fetchArgs[1].method) {\n    return String(fetchArgs[1].method).toUpperCase();\n  }\n  return 'GET';\n}\n\n/** Extract `url` from fetch call arguments */\nfunction getFetchUrl(fetchArgs: any[] = []): string {\n  if (typeof fetchArgs[0] === 'string') {\n    return fetchArgs[0];\n  }\n  if ('Request' in global && isInstanceOf(fetchArgs[0], Request)) {\n    return fetchArgs[0].url;\n  }\n  return String(fetchArgs[0]);\n}\n/* eslint-enable @typescript-eslint/no-unsafe-member-access */\n\n/** JSDoc */\nfunction instrumentXHR(): void {\n  if (!('XMLHttpRequest' in global)) {\n    return;\n  }\n\n  // Poor man's implementation of ES6 `Map`, tracking and keeping in sync key and value separately.\n  const requestKeys: XMLHttpRequest[] = [];\n  const requestValues: Array<any>[] = [];\n  const xhrproto = XMLHttpRequest.prototype;\n\n  fill(xhrproto, 'open', function(originalOpen: () => void): () => void {\n    return function(this: SentryWrappedXMLHttpRequest, ...args: any[]): void {\n      // eslint-disable-next-line @typescript-eslint/no-this-alias\n      const xhr = this;\n      const url = args[1];\n      xhr.__sentry_xhr__ = {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        method: isString(args[0]) ? args[0].toUpperCase() : args[0],\n        url: args[1],\n      };\n\n      // if Sentry key appears in URL, don't capture it as a request\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      if (isString(url) && xhr.__sentry_xhr__.method === 'POST' && url.match(/sentry_key/)) {\n        xhr.__sentry_own_request__ = true;\n      }\n\n      const onreadystatechangeHandler = function(): void {\n        if (xhr.readyState === 4) {\n          try {\n            // touching statusCode in some platforms throws\n            // an exception\n            if (xhr.__sentry_xhr__) {\n              xhr.__sentry_xhr__.status_code = xhr.status;\n            }\n          } catch (e) {\n            /* do nothing */\n          }\n\n          try {\n            const requestPos = requestKeys.indexOf(xhr);\n            if (requestPos !== -1) {\n              // Make sure to pop both key and value to keep it in sync.\n              requestKeys.splice(requestPos);\n              const args = requestValues.splice(requestPos)[0];\n              if (xhr.__sentry_xhr__ && args[0] !== undefined) {\n                xhr.__sentry_xhr__.body = args[0] as XHRSendInput;\n              }\n            }\n          } catch (e) {\n            /* do nothing */\n          }\n\n          triggerHandlers('xhr', {\n            args,\n            endTimestamp: Date.now(),\n            startTimestamp: Date.now(),\n            xhr,\n          });\n        }\n      };\n\n      if ('onreadystatechange' in xhr && typeof xhr.onreadystatechange === 'function') {\n        fill(xhr, 'onreadystatechange', function(original: WrappedFunction): Function {\n          return function(...readyStateArgs: any[]): void {\n            onreadystatechangeHandler();\n            return original.apply(xhr, readyStateArgs);\n          };\n        });\n      } else {\n        xhr.addEventListener('readystatechange', onreadystatechangeHandler);\n      }\n\n      return originalOpen.apply(xhr, args);\n    };\n  });\n\n  fill(xhrproto, 'send', function(originalSend: () => void): () => void {\n    return function(this: SentryWrappedXMLHttpRequest, ...args: any[]): void {\n      requestKeys.push(this);\n      requestValues.push(args);\n\n      triggerHandlers('xhr', {\n        args,\n        startTimestamp: Date.now(),\n        xhr: this,\n      });\n\n      return originalSend.apply(this, args);\n    };\n  });\n}\n\nlet lastHref: string;\n\n/** JSDoc */\nfunction instrumentHistory(): void {\n  if (!supportsHistory()) {\n    return;\n  }\n\n  const oldOnPopState = global.onpopstate;\n  global.onpopstate = function(this: WindowEventHandlers, ...args: any[]): any {\n    const to = global.location.href;\n    // keep track of the current URL state, as we always receive only the updated state\n    const from = lastHref;\n    lastHref = to;\n    triggerHandlers('history', {\n      from,\n      to,\n    });\n    if (oldOnPopState) {\n      // Apparently this can throw in Firefox when incorrectly implemented plugin is installed.\n      // https://github.com/getsentry/sentry-javascript/issues/3344\n      // https://github.com/bugsnag/bugsnag-js/issues/469\n      try {\n        return oldOnPopState.apply(this, args);\n      } catch (_oO) {\n        // no-empty\n      }\n    }\n  };\n\n  /** @hidden */\n  function historyReplacementFunction(originalHistoryFunction: () => void): () => void {\n    return function(this: History, ...args: any[]): void {\n      const url = args.length > 2 ? args[2] : undefined;\n      if (url) {\n        // coerce to string (this is what pushState does)\n        const from = lastHref;\n        const to = String(url);\n        // keep track of the current URL state, as we always receive only the updated state\n        lastHref = to;\n        triggerHandlers('history', {\n          from,\n          to,\n        });\n      }\n      return originalHistoryFunction.apply(this, args);\n    };\n  }\n\n  fill(global.history, 'pushState', historyReplacementFunction);\n  fill(global.history, 'replaceState', historyReplacementFunction);\n}\n\nconst debounceDuration = 1000;\nlet debounceTimerID: number | undefined;\nlet lastCapturedEvent: Event | undefined;\n\n/**\n * Decide whether the current event should finish the debounce of previously captured one.\n * @param previous previously captured event\n * @param current event to be captured\n */\nfunction shouldShortcircuitPreviousDebounce(previous: Event | undefined, current: Event): boolean {\n  // If there was no previous event, it should always be swapped for the new one.\n  if (!previous) {\n    return true;\n  }\n\n  // If both events have different type, then user definitely performed two separate actions. e.g. click + keypress.\n  if (previous.type !== current.type) {\n    return true;\n  }\n\n  try {\n    // If both events have the same type, it's still possible that actions were performed on different targets.\n    // e.g. 2 clicks on different buttons.\n    if (previous.target !== current.target) {\n      return true;\n    }\n  } catch (e) {\n    // just accessing `target` property can throw an exception in some rare circumstances\n    // see: https://github.com/getsentry/sentry-javascript/issues/838\n  }\n\n  // If both events have the same type _and_ same `target` (an element which triggered an event, _not necessarily_\n  // to which an event listener was attached), we treat them as the same action, as we want to capture\n  // only one breadcrumb. e.g. multiple clicks on the same button, or typing inside a user input box.\n  return false;\n}\n\n/**\n * Decide whether an event should be captured.\n * @param event event to be captured\n */\nfunction shouldSkipDOMEvent(event: Event): boolean {\n  // We are only interested in filtering `keypress` events for now.\n  if (event.type !== 'keypress') {\n    return false;\n  }\n\n  try {\n    const target = event.target as HTMLElement;\n\n    if (!target || !target.tagName) {\n      return true;\n    }\n\n    // Only consider keypress events on actual input elements. This will disregard keypresses targeting body\n    // e.g.tabbing through elements, hotkeys, etc.\n    if (target.tagName === 'INPUT' || target.tagName === 'TEXTAREA' || target.isContentEditable) {\n      return false;\n    }\n  } catch (e) {\n    // just accessing `target` property can throw an exception in some rare circumstances\n    // see: https://github.com/getsentry/sentry-javascript/issues/838\n  }\n\n  return true;\n}\n\n/**\n * Wraps addEventListener to capture UI breadcrumbs\n * @param handler function that will be triggered\n * @param globalListener indicates whether event was captured by the global event listener\n * @returns wrapped breadcrumb events handler\n * @hidden\n */\nfunction makeDOMEventHandler(handler: Function, globalListener: boolean = false): (event: Event) => void {\n  return (event: Event): void => {\n    // It's possible this handler might trigger multiple times for the same\n    // event (e.g. event propagation through node ancestors).\n    // Ignore if we've already captured that event.\n    if (!event || lastCapturedEvent === event) {\n      return;\n    }\n\n    // We always want to skip _some_ events.\n    if (shouldSkipDOMEvent(event)) {\n      return;\n    }\n\n    const name = event.type === 'keypress' ? 'input' : event.type;\n\n    // If there is no debounce timer, it means that we can safely capture the new event and store it for future comparisons.\n    if (debounceTimerID === undefined) {\n      handler({\n        event: event,\n        name,\n        global: globalListener,\n      });\n      lastCapturedEvent = event;\n    }\n    // If there is a debounce awaiting, see if the new event is different enough to treat it as a unique one.\n    // If that's the case, emit the previous event and store locally the newly-captured DOM event.\n    else if (shouldShortcircuitPreviousDebounce(lastCapturedEvent, event)) {\n      handler({\n        event: event,\n        name,\n        global: globalListener,\n      });\n      lastCapturedEvent = event;\n    }\n\n    // Start a new debounce timer that will prevent us from capturing multiple events that should be grouped together.\n    clearTimeout(debounceTimerID);\n    debounceTimerID = global.setTimeout(() => {\n      debounceTimerID = undefined;\n    }, debounceDuration);\n  };\n}\n\ntype AddEventListener = (\n  type: string,\n  listener: EventListenerOrEventListenerObject,\n  options?: boolean | AddEventListenerOptions,\n) => void;\ntype RemoveEventListener = (\n  type: string,\n  listener: EventListenerOrEventListenerObject,\n  options?: boolean | EventListenerOptions,\n) => void;\n\ntype InstrumentedElement = Element & {\n  __sentry_instrumentation_handlers__?: {\n    [key in 'click' | 'keypress']?: {\n      handler?: Function;\n      /** The number of custom listeners attached to this element */\n      refCount: number;\n    };\n  };\n};\n\n/** JSDoc */\nfunction instrumentDOM(): void {\n  if (!('document' in global)) {\n    return;\n  }\n\n  // Make it so that any click or keypress that is unhandled / bubbled up all the way to the document triggers our dom\n  // handlers. (Normally we have only one, which captures a breadcrumb for each click or keypress.) Do this before\n  // we instrument `addEventListener` so that we don't end up attaching this handler twice.\n  const triggerDOMHandler = triggerHandlers.bind(null, 'dom');\n  const globalDOMEventHandler = makeDOMEventHandler(triggerDOMHandler, true);\n  global.document.addEventListener('click', globalDOMEventHandler, false);\n  global.document.addEventListener('keypress', globalDOMEventHandler, false);\n\n  // After hooking into click and keypress events bubbled up to `document`, we also hook into user-handled\n  // clicks & keypresses, by adding an event listener of our own to any element to which they add a listener. That\n  // way, whenever one of their handlers is triggered, ours will be, too. (This is needed because their handler\n  // could potentially prevent the event from bubbling up to our global listeners. This way, our handler are still\n  // guaranteed to fire at least once.)\n  ['EventTarget', 'Node'].forEach((target: string) => {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    const proto = (global as any)[target] && (global as any)[target].prototype;\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, no-prototype-builtins\n    if (!proto || !proto.hasOwnProperty || !proto.hasOwnProperty('addEventListener')) {\n      return;\n    }\n\n    fill(proto, 'addEventListener', function(originalAddEventListener: AddEventListener): AddEventListener {\n      return function(\n        this: Element,\n        type: string,\n        listener: EventListenerOrEventListenerObject,\n        options?: boolean | AddEventListenerOptions,\n      ): AddEventListener {\n        if (type === 'click' || type == 'keypress') {\n          try {\n            const el = this as InstrumentedElement;\n            const handlers = (el.__sentry_instrumentation_handlers__ = el.__sentry_instrumentation_handlers__ || {});\n            const handlerForType = (handlers[type] = handlers[type] || { refCount: 0 });\n\n            if (!handlerForType.handler) {\n              const handler = makeDOMEventHandler(triggerDOMHandler);\n              handlerForType.handler = handler;\n              originalAddEventListener.call(this, type, handler, options);\n            }\n\n            handlerForType.refCount += 1;\n          } catch (e) {\n            // Accessing dom properties is always fragile.\n            // Also allows us to skip `addEventListenrs` calls with no proper `this` context.\n          }\n        }\n\n        return originalAddEventListener.call(this, type, listener, options);\n      };\n    });\n\n    fill(proto, 'removeEventListener', function(originalRemoveEventListener: RemoveEventListener): RemoveEventListener {\n      return function(\n        this: Element,\n        type: string,\n        listener: EventListenerOrEventListenerObject,\n        options?: boolean | EventListenerOptions,\n      ): () => void {\n        if (type === 'click' || type == 'keypress') {\n          try {\n            const el = this as InstrumentedElement;\n            const handlers = el.__sentry_instrumentation_handlers__ || {};\n            const handlerForType = handlers[type];\n\n            if (handlerForType) {\n              handlerForType.refCount -= 1;\n              // If there are no longer any custom handlers of the current type on this element, we can remove ours, too.\n              if (handlerForType.refCount <= 0) {\n                originalRemoveEventListener.call(this, type, handlerForType.handler, options);\n                handlerForType.handler = undefined;\n                delete handlers[type]; // eslint-disable-line @typescript-eslint/no-dynamic-delete\n              }\n\n              // If there are no longer any custom handlers of any type on this element, cleanup everything.\n              if (Object.keys(handlers).length === 0) {\n                delete el.__sentry_instrumentation_handlers__;\n              }\n            }\n          } catch (e) {\n            // Accessing dom properties is always fragile.\n            // Also allows us to skip `addEventListenrs` calls with no proper `this` context.\n          }\n        }\n\n        return originalRemoveEventListener.call(this, type, listener, options);\n      };\n    });\n  });\n}\n\nlet _oldOnErrorHandler: OnErrorEventHandler = null;\n/** JSDoc */\nfunction instrumentError(): void {\n  _oldOnErrorHandler = global.onerror;\n\n  global.onerror = function(msg: any, url: any, line: any, column: any, error: any): boolean {\n    triggerHandlers('error', {\n      column,\n      error,\n      line,\n      msg,\n      url,\n    });\n\n    if (_oldOnErrorHandler) {\n      // eslint-disable-next-line prefer-rest-params\n      return _oldOnErrorHandler.apply(this, arguments);\n    }\n\n    return false;\n  };\n}\n\nlet _oldOnUnhandledRejectionHandler: ((e: any) => void) | null = null;\n/** JSDoc */\nfunction instrumentUnhandledRejection(): void {\n  _oldOnUnhandledRejectionHandler = global.onunhandledrejection;\n\n  global.onunhandledrejection = function(e: any): boolean {\n    triggerHandlers('unhandledrejection', e);\n\n    if (_oldOnUnhandledRejectionHandler) {\n      // eslint-disable-next-line prefer-rest-params\n      return _oldOnUnhandledRejectionHandler.apply(this, arguments);\n    }\n\n    return true;\n  };\n}\n", "// Slightly modified (no IE8 support, ES6) and transcribed to TypeScript\n// https://raw.githubusercontent.com/calvinmetcalf/rollup-plugin-node-builtins/master/src/es6/path.js\n\n/** JSDoc */\nfunction normalizeArray(parts: string[], allowAboveRoot?: boolean): string[] {\n  // if the path tries to go above the root, `up` ends up > 0\n  let up = 0;\n  for (let i = parts.length - 1; i >= 0; i--) {\n    const last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      // eslint-disable-next-line no-plusplus\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      // eslint-disable-next-line no-plusplus\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    // eslint-disable-next-line no-plusplus\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// Split a filename into [root, dir, basename, ext], unix version\n// 'root' is just a slash, or nothing.\nconst splitPathRe = /^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^/]+?|)(\\.[^./]*|))(?:[/]*)$/;\n/** JSDoc */\nfunction splitPath(filename: string): string[] {\n  const parts = splitPathRe.exec(filename);\n  return parts ? parts.slice(1) : [];\n}\n\n// path.resolve([from ...], to)\n// posix version\n/** JSDoc */\nexport function resolve(...args: string[]): string {\n  let resolvedPath = '';\n  let resolvedAbsolute = false;\n\n  for (let i = args.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    const path = i >= 0 ? args[i] : '/';\n\n    // Skip empty entries\n    if (!path) {\n      continue;\n    }\n\n    resolvedPath = `${path}/${resolvedPath}`;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(\n    resolvedPath.split('/').filter(p => !!p),\n    !resolvedAbsolute,\n  ).join('/');\n\n  return (resolvedAbsolute ? '/' : '') + resolvedPath || '.';\n}\n\n/** JSDoc */\nfunction trim(arr: string[]): string[] {\n  let start = 0;\n  for (; start < arr.length; start++) {\n    if (arr[start] !== '') {\n      break;\n    }\n  }\n\n  let end = arr.length - 1;\n  for (; end >= 0; end--) {\n    if (arr[end] !== '') {\n      break;\n    }\n  }\n\n  if (start > end) {\n    return [];\n  }\n  return arr.slice(start, end - start + 1);\n}\n\n// path.relative(from, to)\n// posix version\n/** JSDoc */\nexport function relative(from: string, to: string): string {\n  /* eslint-disable no-param-reassign */\n  from = resolve(from).substr(1);\n  to = resolve(to).substr(1);\n  /* eslint-enable no-param-reassign */\n\n  const fromParts = trim(from.split('/'));\n  const toParts = trim(to.split('/'));\n\n  const length = Math.min(fromParts.length, toParts.length);\n  let samePartsLength = length;\n  for (let i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  let outputParts = [];\n  for (let i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n}\n\n// path.normalize(path)\n// posix version\n/** JSDoc */\nexport function normalizePath(path: string): string {\n  const isPathAbsolute = isAbsolute(path);\n  const trailingSlash = path.substr(-1) === '/';\n\n  // Normalize the path\n  let normalizedPath = normalizeArray(\n    path.split('/').filter(p => !!p),\n    !isPathAbsolute,\n  ).join('/');\n\n  if (!normalizedPath && !isPathAbsolute) {\n    normalizedPath = '.';\n  }\n  if (normalizedPath && trailingSlash) {\n    normalizedPath += '/';\n  }\n\n  return (isPathAbsolute ? '/' : '') + normalizedPath;\n}\n\n// posix version\n/** JSDoc */\nexport function isAbsolute(path: string): boolean {\n  return path.charAt(0) === '/';\n}\n\n// posix version\n/** JSDoc */\nexport function join(...args: string[]): string {\n  return normalizePath(args.join('/'));\n}\n\n/** JSDoc */\nexport function dirname(path: string): string {\n  const result = splitPath(path);\n  const root = result[0];\n  let dir = result[1];\n\n  if (!root && !dir) {\n    // No dirname whatsoever\n    return '.';\n  }\n\n  if (dir) {\n    // It has a dirname, strip trailing slash\n    dir = dir.substr(0, dir.length - 1);\n  }\n\n  return root + dir;\n}\n\n/** JSDoc */\nexport function basename(path: string, ext?: string): string {\n  let f = splitPath(path)[2];\n  if (ext && f.substr(ext.length * -1) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n}\n", "/* eslint-disable @typescript-eslint/explicit-function-return-type */\n/* eslint-disable @typescript-eslint/typedef */\n/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { isThenable } from './is';\n\n/** SyncPromise internal states */\nenum States {\n  /** Pending */\n  PENDING = 'PENDING',\n  /** Resolved / OK */\n  RESOLVED = 'RESOLVED',\n  /** Rejected / Error */\n  REJECTED = 'REJECTED',\n}\n\n/**\n * Thenable class that behaves like a Promise and follows it's interface\n * but is not async internally\n */\nclass SyncPromise<T> implements PromiseLike<T> {\n  private _state: States = States.PENDING;\n  private _handlers: Array<{\n    done: boolean;\n    onfulfilled?: ((value: T) => T | PromiseLike<T>) | null;\n    onrejected?: ((reason: any) => any) | null;\n  }> = [];\n  private _value: any;\n\n  public constructor(\n    executor: (resolve: (value?: T | PromiseLike<T> | null) => void, reject: (reason?: any) => void) => void,\n  ) {\n    try {\n      executor(this._resolve, this._reject);\n    } catch (e) {\n      this._reject(e);\n    }\n  }\n\n  /** JSDoc */\n  public static resolve<T>(value: T | PromiseLike<T>): PromiseLike<T> {\n    return new SyncPromise(resolve => {\n      resolve(value);\n    });\n  }\n\n  /** JSDoc */\n  public static reject<T = never>(reason?: any): PromiseLike<T> {\n    return new SyncPromise((_, reject) => {\n      reject(reason);\n    });\n  }\n\n  /** JSDoc */\n  public static all<U = any>(collection: Array<U | PromiseLike<U>>): PromiseLike<U[]> {\n    return new SyncPromise<U[]>((resolve, reject) => {\n      if (!Array.isArray(collection)) {\n        reject(new TypeError(`Promise.all requires an array as input.`));\n        return;\n      }\n\n      if (collection.length === 0) {\n        resolve([]);\n        return;\n      }\n\n      let counter = collection.length;\n      const resolvedCollection: U[] = [];\n\n      collection.forEach((item, index) => {\n        void SyncPromise.resolve(item)\n          .then(value => {\n            resolvedCollection[index] = value;\n            counter -= 1;\n\n            if (counter !== 0) {\n              return;\n            }\n            resolve(resolvedCollection);\n          })\n          .then(null, reject);\n      });\n    });\n  }\n\n  /** JSDoc */\n  public then<TResult1 = T, TResult2 = never>(\n    onfulfilled?: ((value: T) => TResult1 | PromiseLike<TResult1>) | null,\n    onrejected?: ((reason: any) => TResult2 | PromiseLike<TResult2>) | null,\n  ): PromiseLike<TResult1 | TResult2> {\n    return new SyncPromise((resolve, reject) => {\n      this._attachHandler({\n        done: false,\n        onfulfilled: result => {\n          if (!onfulfilled) {\n            // TODO: \u00AF\\_(\u30C4)_/\u00AF\n            // TODO: FIXME\n            resolve(result as any);\n            return;\n          }\n          try {\n            resolve(onfulfilled(result));\n            return;\n          } catch (e) {\n            reject(e);\n            return;\n          }\n        },\n        onrejected: reason => {\n          if (!onrejected) {\n            reject(reason);\n            return;\n          }\n          try {\n            resolve(onrejected(reason));\n            return;\n          } catch (e) {\n            reject(e);\n            return;\n          }\n        },\n      });\n    });\n  }\n\n  /** JSDoc */\n  public catch<TResult = never>(\n    onrejected?: ((reason: any) => TResult | PromiseLike<TResult>) | null,\n  ): PromiseLike<T | TResult> {\n    return this.then(val => val, onrejected);\n  }\n\n  /** JSDoc */\n  public finally<TResult>(onfinally?: (() => void) | null): PromiseLike<TResult> {\n    return new SyncPromise<TResult>((resolve, reject) => {\n      let val: TResult | any;\n      let isRejected: boolean;\n\n      return this.then(\n        value => {\n          isRejected = false;\n          val = value;\n          if (onfinally) {\n            onfinally();\n          }\n        },\n        reason => {\n          isRejected = true;\n          val = reason;\n          if (onfinally) {\n            onfinally();\n          }\n        },\n      ).then(() => {\n        if (isRejected) {\n          reject(val);\n          return;\n        }\n\n        resolve((val as unknown) as any);\n      });\n    });\n  }\n\n  /** JSDoc */\n  public toString(): string {\n    return '[object SyncPromise]';\n  }\n\n  /** JSDoc */\n  private readonly _resolve = (value?: T | PromiseLike<T> | null) => {\n    this._setResult(States.RESOLVED, value);\n  };\n\n  /** JSDoc */\n  private readonly _reject = (reason?: any) => {\n    this._setResult(States.REJECTED, reason);\n  };\n\n  /** JSDoc */\n  private readonly _setResult = (state: States, value?: T | PromiseLike<T> | any) => {\n    if (this._state !== States.PENDING) {\n      return;\n    }\n\n    if (isThenable(value)) {\n      void (value as PromiseLike<T>).then(this._resolve, this._reject);\n      return;\n    }\n\n    this._state = state;\n    this._value = value;\n\n    this._executeHandlers();\n  };\n\n  // TODO: FIXME\n  /** JSDoc */\n  private readonly _attachHandler = (handler: {\n    /** JSDoc */\n    done: boolean;\n    /** JSDoc */\n    onfulfilled?(value: T): any;\n    /** JSDoc */\n    onrejected?(reason: any): any;\n  }) => {\n    this._handlers = this._handlers.concat(handler);\n    this._executeHandlers();\n  };\n\n  /** JSDoc */\n  private readonly _executeHandlers = () => {\n    if (this._state === States.PENDING) {\n      return;\n    }\n\n    const cachedHandlers = this._handlers.slice();\n    this._handlers = [];\n\n    cachedHandlers.forEach(handler => {\n      if (handler.done) {\n        return;\n      }\n\n      if (this._state === States.RESOLVED) {\n        if (handler.onfulfilled) {\n          // eslint-disable-next-line @typescript-eslint/no-floating-promises\n          handler.onfulfilled((this._value as unknown) as any);\n        }\n      }\n\n      if (this._state === States.REJECTED) {\n        if (handler.onrejected) {\n          handler.onrejected(this._value);\n        }\n      }\n\n      handler.done = true;\n    });\n  };\n}\n\nexport { SyncPromise };\n", "import { SentryError } from './error';\nimport { SyncPromise } from './syncpromise';\n\n/** A simple queue that holds promises. */\nexport class PromiseBuffer<T> {\n  /** Internal set of queued Promises */\n  private readonly _buffer: Array<PromiseLike<T>> = [];\n\n  public constructor(protected _limit?: number) {}\n\n  /**\n   * Says if the buffer is ready to take more requests\n   */\n  public isReady(): boolean {\n    return this._limit === undefined || this.length() < this._limit;\n  }\n\n  /**\n   * Add a promise to the queue.\n   *\n   * @param taskProducer A function producing any PromiseLike<T>; In previous versions this used to be `task: PromiseLike<T>`,\n   *        however, Promises were instantly created on the call-site, making them fall through the buffer limit.\n   * @returns The original promise.\n   */\n  public add(taskProducer: () => PromiseLike<T>): PromiseLike<T> {\n    if (!this.isReady()) {\n      return SyncPromise.reject(new SentryError('Not adding Promise due to buffer limit reached.'));\n    }\n    const task = taskProducer();\n    if (this._buffer.indexOf(task) === -1) {\n      this._buffer.push(task);\n    }\n    void task\n      .then(() => this.remove(task))\n      .then(null, () =>\n        this.remove(task).then(null, () => {\n          // We have to add this catch here otherwise we have an unhandledPromiseRejection\n          // because it's a new Promise chain.\n        }),\n      );\n    return task;\n  }\n\n  /**\n   * Remove a promise to the queue.\n   *\n   * @param task Can be any PromiseLike<T>\n   * @returns Removed promise.\n   */\n  public remove(task: PromiseLike<T>): PromiseLike<T> {\n    const removedTask = this._buffer.splice(this._buffer.indexOf(task), 1)[0];\n    return removedTask;\n  }\n\n  /**\n   * This function returns the number of unresolved promises in the queue.\n   */\n  public length(): number {\n    return this._buffer.length;\n  }\n\n  /**\n   * This will drain the whole queue, returns true if queue is empty or drained.\n   * If timeout is provided and the queue takes longer to drain, the promise still resolves but with false.\n   *\n   * @param timeout Number in ms to wait until it resolves with false.\n   */\n  public drain(timeout?: number): PromiseLike<boolean> {\n    return new SyncPromise<boolean>(resolve => {\n      const capturedSetTimeout = setTimeout(() => {\n        if (timeout && timeout > 0) {\n          resolve(false);\n        }\n      }, timeout);\n      void SyncPromise.all(this._buffer)\n        .then(() => {\n          clearTimeout(capturedSetTimeout);\n          resolve(true);\n        })\n        .then(null, () => {\n          resolve(true);\n        });\n    });\n  }\n}\n", "import { getGlobalObject } from './misc';\nimport { dynamicRequire, isNodeEnv } from './node';\n\n/**\n * An object that can return the current timestamp in seconds since the UNIX epoch.\n */\ninterface TimestampSource {\n  nowSeconds(): number;\n}\n\n/**\n * A TimestampSource implementation for environments that do not support the Performance Web API natively.\n *\n * Note that this TimestampSource does not use a monotonic clock. A call to `nowSeconds` may return a timestamp earlier\n * than a previously returned value. We do not try to emulate a monotonic behavior in order to facilitate debugging. It\n * is more obvious to explain \"why does my span have negative duration\" than \"why my spans have zero duration\".\n */\nconst dateTimestampSource: TimestampSource = {\n  nowSeconds: () => Date.now() / 1000,\n};\n\n/**\n * A partial definition of the [Performance Web API]{@link https://developer.mozilla.org/en-US/docs/Web/API/Performance}\n * for accessing a high resolution monotonic clock.\n */\ninterface Performance {\n  /**\n   * The millisecond timestamp at which measurement began, measured in Unix time.\n   */\n  timeOrigin: number;\n  /**\n   * Returns the current millisecond timestamp, where 0 represents the start of measurement.\n   */\n  now(): number;\n}\n\n/**\n * Returns a wrapper around the native Performance API browser implementation, or undefined for browsers that do not\n * support the API.\n *\n * Wrapping the native API works around differences in behavior from different browsers.\n */\nfunction getBrowserPerformance(): Performance | undefined {\n  const { performance } = getGlobalObject<Window>();\n  if (!performance || !performance.now) {\n    return undefined;\n  }\n\n  // Replace performance.timeOrigin with our own timeOrigin based on Date.now().\n  //\n  // This is a partial workaround for browsers reporting performance.timeOrigin such that performance.timeOrigin +\n  // performance.now() gives a date arbitrarily in the past.\n  //\n  // Additionally, computing timeOrigin in this way fills the gap for browsers where performance.timeOrigin is\n  // undefined.\n  //\n  // The assumption that performance.timeOrigin + performance.now() ~= Date.now() is flawed, but we depend on it to\n  // interact with data coming out of performance entries.\n  //\n  // Note that despite recommendations against it in the spec, browsers implement the Performance API with a clock that\n  // might stop when the computer is asleep (and perhaps under other circumstances). Such behavior causes\n  // performance.timeOrigin + performance.now() to have an arbitrary skew over Date.now(). In laptop computers, we have\n  // observed skews that can be as long as days, weeks or months.\n  //\n  // See https://github.com/getsentry/sentry-javascript/issues/2590.\n  //\n  // BUG: despite our best intentions, this workaround has its limitations. It mostly addresses timings of pageload\n  // transactions, but ignores the skew built up over time that can aversely affect timestamps of navigation\n  // transactions of long-lived web pages.\n  const timeOrigin = Date.now() - performance.now();\n\n  return {\n    now: () => performance.now(),\n    timeOrigin,\n  };\n}\n\n/**\n * Returns the native Performance API implementation from Node.js. Returns undefined in old Node.js versions that don't\n * implement the API.\n */\nfunction getNodePerformance(): Performance | undefined {\n  try {\n    const perfHooks = dynamicRequire(module, 'perf_hooks') as { performance: Performance };\n    return perfHooks.performance;\n  } catch (_) {\n    return undefined;\n  }\n}\n\n/**\n * The Performance API implementation for the current platform, if available.\n */\nconst platformPerformance: Performance | undefined = isNodeEnv() ? getNodePerformance() : getBrowserPerformance();\n\nconst timestampSource: TimestampSource =\n  platformPerformance === undefined\n    ? dateTimestampSource\n    : {\n        nowSeconds: () => (platformPerformance.timeOrigin + platformPerformance.now()) / 1000,\n      };\n\n/**\n * Returns a timestamp in seconds since the UNIX epoch using the Date API.\n */\nexport const dateTimestampInSeconds: () => number = dateTimestampSource.nowSeconds.bind(dateTimestampSource);\n\n/**\n * Returns a timestamp in seconds since the UNIX epoch using either the Performance or Date APIs, depending on the\n * availability of the Performance API.\n *\n * See `usingPerformanceAPI` to test whether the Performance API is used.\n *\n * BUG: Note that because of how browsers implement the Performance API, the clock might stop when the computer is\n * asleep. This creates a skew between `dateTimestampInSeconds` and `timestampInSeconds`. The\n * skew can grow to arbitrary amounts like days, weeks or months.\n * See https://github.com/getsentry/sentry-javascript/issues/2590.\n */\nexport const timestampInSeconds: () => number = timestampSource.nowSeconds.bind(timestampSource);\n\n// Re-exported with an old name for backwards-compatibility.\nexport const timestampWithMs = timestampInSeconds;\n\n/**\n * A boolean that is true when timestampInSeconds uses the Performance API to produce monotonic timestamps.\n */\nexport const usingPerformanceAPI = platformPerformance !== undefined;\n\n/**\n * Internal helper to store what is the source of browserPerformanceTimeOrigin below. For debugging only.\n */\nexport let _browserPerformanceTimeOriginMode: string;\n\n/**\n * The number of milliseconds since the UNIX epoch. This value is only usable in a browser, and only when the\n * performance API is available.\n */\nexport const browserPerformanceTimeOrigin = ((): number | undefined => {\n  // Unfortunately browsers may report an inaccurate time origin data, through either performance.timeOrigin or\n  // performance.timing.navigationStart, which results in poor results in performance data. We only treat time origin\n  // data as reliable if they are within a reasonable threshold of the current time.\n\n  const { performance } = getGlobalObject<Window>();\n  if (!performance || !performance.now) {\n    _browserPerformanceTimeOriginMode = 'none';\n    return undefined;\n  }\n\n  const threshold = 3600 * 1000;\n  const performanceNow = performance.now();\n  const dateNow = Date.now();\n\n  // if timeOrigin isn't available set delta to threshold so it isn't used\n  const timeOriginDelta = performance.timeOrigin\n    ? Math.abs(performance.timeOrigin + performanceNow - dateNow)\n    : threshold;\n  const timeOriginIsReliable = timeOriginDelta < threshold;\n\n  // While performance.timing.navigationStart is deprecated in favor of performance.timeOrigin, performance.timeOrigin\n  // is not as widely supported. Namely, performance.timeOrigin is undefined in Safari as of writing.\n  // Also as of writing, performance.timing is not available in Web Workers in mainstream browsers, so it is not always\n  // a valid fallback. In the absence of an initial time provided by the browser, fallback to the current time from the\n  // Date API.\n  // eslint-disable-next-line deprecation/deprecation\n  const navigationStart = performance.timing && performance.timing.navigationStart;\n  const hasNavigationStart = typeof navigationStart === 'number';\n  // if navigationStart isn't available set delta to threshold so it isn't used\n  const navigationStartDelta = hasNavigationStart ? Math.abs(navigationStart + performanceNow - dateNow) : threshold;\n  const navigationStartIsReliable = navigationStartDelta < threshold;\n\n  if (timeOriginIsReliable || navigationStartIsReliable) {\n    // Use the more reliable time origin\n    if (timeOriginDelta <= navigationStartDelta) {\n      _browserPerformanceTimeOriginMode = 'timeOrigin';\n      return performance.timeOrigin;\n    } else {\n      _browserPerformanceTimeOriginMode = 'navigationStart';\n      return navigationStart;\n    }\n  }\n\n  // Either both timeOrigin and navigationStart are skewed or neither is available, fallback to Date.\n  _browserPerformanceTimeOriginMode = 'dateNow';\n  return dateNow;\n})();\n", "export * from './async';\nexport * from './browser';\nexport * from './dsn';\nexport * from './error';\nexport * from './instrument';\nexport * from './is';\nexport * from './logger';\nexport * from './memo';\nexport * from './misc';\nexport * from './node';\nexport * from './object';\nexport * from './path';\nexport * from './promisebuffer';\nexport * from './stacktrace';\nexport * from './string';\nexport * from './supports';\nexport * from './syncpromise';\nexport * from './time';\n", "/* eslint-disable max-lines */\nimport {\n  Breadcrumb,\n  CaptureContext,\n  Context,\n  Contexts,\n  Event,\n  EventHint,\n  EventProcessor,\n  Extra,\n  Extras,\n  Primitive,\n  RequestSession,\n  Scope as ScopeInterface,\n  ScopeContext,\n  Severity,\n  Span,\n  Transaction,\n  User,\n} from '@sentry/types';\nimport { dateTimestampInSeconds, getGlobalObject, isPlainObject, isThenable, SyncPromise } from '@sentry/utils';\n\nimport { Session } from './session';\n\n/**\n * Absolute maximum number of breadcrumbs added to an event.\n * The `maxBreadcrumbs` option cannot be higher than this value.\n */\nconst MAX_BREADCRUMBS = 100;\n\n/**\n * Holds additional event information. {@link Scope.applyToEvent} will be\n * called by the client before an event will be sent.\n */\nexport class Scope implements ScopeInterface {\n  /** Flag if notifiying is happening. */\n  protected _notifyingListeners: boolean = false;\n\n  /** Callback for client to receive scope changes. */\n  protected _scopeListeners: Array<(scope: Scope) => void> = [];\n\n  /** Callback list that will be called after {@link applyToEvent}. */\n  protected _eventProcessors: EventProcessor[] = [];\n\n  /** Array of breadcrumbs. */\n  protected _breadcrumbs: Breadcrumb[] = [];\n\n  /** User */\n  protected _user: User = {};\n\n  /** Tags */\n  protected _tags: { [key: string]: Primitive } = {};\n\n  /** Extra */\n  protected _extra: Extras = {};\n\n  /** Contexts */\n  protected _contexts: Contexts = {};\n\n  /** Fingerprint */\n  protected _fingerprint?: string[];\n\n  /** Severity */\n  protected _level?: Severity;\n\n  /** Transaction Name */\n  protected _transactionName?: string;\n\n  /** Span */\n  protected _span?: Span;\n\n  /** Session */\n  protected _session?: Session;\n\n  /** Request Mode Session Status */\n  protected _requestSession?: RequestSession;\n\n  /**\n   * Inherit values from the parent scope.\n   * @param scope to clone.\n   */\n  public static clone(scope?: Scope): Scope {\n    const newScope = new Scope();\n    if (scope) {\n      newScope._breadcrumbs = [...scope._breadcrumbs];\n      newScope._tags = { ...scope._tags };\n      newScope._extra = { ...scope._extra };\n      newScope._contexts = { ...scope._contexts };\n      newScope._user = scope._user;\n      newScope._level = scope._level;\n      newScope._span = scope._span;\n      newScope._session = scope._session;\n      newScope._transactionName = scope._transactionName;\n      newScope._fingerprint = scope._fingerprint;\n      newScope._eventProcessors = [...scope._eventProcessors];\n      newScope._requestSession = scope._requestSession;\n    }\n    return newScope;\n  }\n\n  /**\n   * Add internal on change listener. Used for sub SDKs that need to store the scope.\n   * @hidden\n   */\n  public addScopeListener(callback: (scope: Scope) => void): void {\n    this._scopeListeners.push(callback);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public addEventProcessor(callback: EventProcessor): this {\n    this._eventProcessors.push(callback);\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setUser(user: User | null): this {\n    this._user = user || {};\n    if (this._session) {\n      this._session.update({ user });\n    }\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getUser(): User | undefined {\n    return this._user;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getRequestSession(): RequestSession | undefined {\n    return this._requestSession;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setRequestSession(requestSession?: RequestSession): this {\n    this._requestSession = requestSession;\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setTags(tags: { [key: string]: Primitive }): this {\n    this._tags = {\n      ...this._tags,\n      ...tags,\n    };\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setTag(key: string, value: Primitive): this {\n    this._tags = { ...this._tags, [key]: value };\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setExtras(extras: Extras): this {\n    this._extra = {\n      ...this._extra,\n      ...extras,\n    };\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setExtra(key: string, extra: Extra): this {\n    this._extra = { ...this._extra, [key]: extra };\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setFingerprint(fingerprint: string[]): this {\n    this._fingerprint = fingerprint;\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setLevel(level: Severity): this {\n    this._level = level;\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setTransactionName(name?: string): this {\n    this._transactionName = name;\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * Can be removed in major version.\n   * @deprecated in favor of {@link this.setTransactionName}\n   */\n  public setTransaction(name?: string): this {\n    return this.setTransactionName(name);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setContext(key: string, context: Context | null): this {\n    if (context === null) {\n      // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n      delete this._contexts[key];\n    } else {\n      this._contexts = { ...this._contexts, [key]: context };\n    }\n\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setSpan(span?: Span): this {\n    this._span = span;\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getSpan(): Span | undefined {\n    return this._span;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getTransaction(): Transaction | undefined {\n    // often, this span will be a transaction, but it's not guaranteed to be\n    const span = this.getSpan() as undefined | (Span & { spanRecorder: { spans: Span[] } });\n\n    // try it the new way first\n    if (span?.transaction) {\n      return span?.transaction;\n    }\n\n    // fallback to the old way (known bug: this only finds transactions with sampled = true)\n    if (span?.spanRecorder?.spans[0]) {\n      return span.spanRecorder.spans[0] as Transaction;\n    }\n\n    // neither way found a transaction\n    return undefined;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setSession(session?: Session): this {\n    if (!session) {\n      delete this._session;\n    } else {\n      this._session = session;\n    }\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getSession(): Session | undefined {\n    return this._session;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public update(captureContext?: CaptureContext): this {\n    if (!captureContext) {\n      return this;\n    }\n\n    if (typeof captureContext === 'function') {\n      const updatedScope = (captureContext as <T>(scope: T) => T)(this);\n      return updatedScope instanceof Scope ? updatedScope : this;\n    }\n\n    if (captureContext instanceof Scope) {\n      this._tags = { ...this._tags, ...captureContext._tags };\n      this._extra = { ...this._extra, ...captureContext._extra };\n      this._contexts = { ...this._contexts, ...captureContext._contexts };\n      if (captureContext._user && Object.keys(captureContext._user).length) {\n        this._user = captureContext._user;\n      }\n      if (captureContext._level) {\n        this._level = captureContext._level;\n      }\n      if (captureContext._fingerprint) {\n        this._fingerprint = captureContext._fingerprint;\n      }\n      if (captureContext._requestSession) {\n        this._requestSession = captureContext._requestSession;\n      }\n    } else if (isPlainObject(captureContext)) {\n      // eslint-disable-next-line no-param-reassign\n      captureContext = captureContext as ScopeContext;\n      this._tags = { ...this._tags, ...captureContext.tags };\n      this._extra = { ...this._extra, ...captureContext.extra };\n      this._contexts = { ...this._contexts, ...captureContext.contexts };\n      if (captureContext.user) {\n        this._user = captureContext.user;\n      }\n      if (captureContext.level) {\n        this._level = captureContext.level;\n      }\n      if (captureContext.fingerprint) {\n        this._fingerprint = captureContext.fingerprint;\n      }\n      if (captureContext.requestSession) {\n        this._requestSession = captureContext.requestSession;\n      }\n    }\n\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public clear(): this {\n    this._breadcrumbs = [];\n    this._tags = {};\n    this._extra = {};\n    this._user = {};\n    this._contexts = {};\n    this._level = undefined;\n    this._transactionName = undefined;\n    this._fingerprint = undefined;\n    this._requestSession = undefined;\n    this._span = undefined;\n    this._session = undefined;\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public addBreadcrumb(breadcrumb: Breadcrumb, maxBreadcrumbs?: number): this {\n    const maxCrumbs = typeof maxBreadcrumbs === 'number' ? Math.min(maxBreadcrumbs, MAX_BREADCRUMBS) : MAX_BREADCRUMBS;\n\n    // No data has been changed, so don't notify scope listeners\n    if (maxCrumbs <= 0) {\n      return this;\n    }\n\n    const mergedBreadcrumb = {\n      timestamp: dateTimestampInSeconds(),\n      ...breadcrumb,\n    };\n    this._breadcrumbs = [...this._breadcrumbs, mergedBreadcrumb].slice(-maxCrumbs);\n    this._notifyScopeListeners();\n\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public clearBreadcrumbs(): this {\n    this._breadcrumbs = [];\n    this._notifyScopeListeners();\n    return this;\n  }\n\n  /**\n   * Applies the current context and fingerprint to the event.\n   * Note that breadcrumbs will be added by the client.\n   * Also if the event has already breadcrumbs on it, we do not merge them.\n   * @param event Event\n   * @param hint May contain additional informartion about the original exception.\n   * @hidden\n   */\n  public applyToEvent(event: Event, hint?: EventHint): PromiseLike<Event | null> {\n    if (this._extra && Object.keys(this._extra).length) {\n      event.extra = { ...this._extra, ...event.extra };\n    }\n    if (this._tags && Object.keys(this._tags).length) {\n      event.tags = { ...this._tags, ...event.tags };\n    }\n    if (this._user && Object.keys(this._user).length) {\n      event.user = { ...this._user, ...event.user };\n    }\n    if (this._contexts && Object.keys(this._contexts).length) {\n      event.contexts = { ...this._contexts, ...event.contexts };\n    }\n    if (this._level) {\n      event.level = this._level;\n    }\n    if (this._transactionName) {\n      event.transaction = this._transactionName;\n    }\n    // We want to set the trace context for normal events only if there isn't already\n    // a trace context on the event. There is a product feature in place where we link\n    // errors with transaction and it relys on that.\n    if (this._span) {\n      event.contexts = { trace: this._span.getTraceContext(), ...event.contexts };\n      const transactionName = this._span.transaction?.name;\n      if (transactionName) {\n        event.tags = { transaction: transactionName, ...event.tags };\n      }\n    }\n\n    this._applyFingerprint(event);\n\n    event.breadcrumbs = [...(event.breadcrumbs || []), ...this._breadcrumbs];\n    event.breadcrumbs = event.breadcrumbs.length > 0 ? event.breadcrumbs : undefined;\n\n    return this._notifyEventProcessors([...getGlobalEventProcessors(), ...this._eventProcessors], event, hint);\n  }\n\n  /**\n   * This will be called after {@link applyToEvent} is finished.\n   */\n  protected _notifyEventProcessors(\n    processors: EventProcessor[],\n    event: Event | null,\n    hint?: EventHint,\n    index: number = 0,\n  ): PromiseLike<Event | null> {\n    return new SyncPromise<Event | null>((resolve, reject) => {\n      const processor = processors[index];\n      if (event === null || typeof processor !== 'function') {\n        resolve(event);\n      } else {\n        const result = processor({ ...event }, hint) as Event | null;\n        if (isThenable(result)) {\n          void (result as PromiseLike<Event | null>)\n            .then(final => this._notifyEventProcessors(processors, final, hint, index + 1).then(resolve))\n            .then(null, reject);\n        } else {\n          void this._notifyEventProcessors(processors, result, hint, index + 1)\n            .then(resolve)\n            .then(null, reject);\n        }\n      }\n    });\n  }\n\n  /**\n   * This will be called on every set call.\n   */\n  protected _notifyScopeListeners(): void {\n    // We need this check for this._notifyingListeners to be able to work on scope during updates\n    // If this check is not here we'll produce endless recursion when something is done with the scope\n    // during the callback.\n    if (!this._notifyingListeners) {\n      this._notifyingListeners = true;\n      this._scopeListeners.forEach(callback => {\n        callback(this);\n      });\n      this._notifyingListeners = false;\n    }\n  }\n\n  /**\n   * Applies fingerprint from the scope to the event if there's one,\n   * uses message if there's one instead or get rid of empty fingerprint\n   */\n  private _applyFingerprint(event: Event): void {\n    // Make sure it's an array first and we actually have something in place\n    event.fingerprint = event.fingerprint\n      ? Array.isArray(event.fingerprint)\n        ? event.fingerprint\n        : [event.fingerprint]\n      : [];\n\n    // If we have something on the scope, then merge it with event\n    if (this._fingerprint) {\n      event.fingerprint = event.fingerprint.concat(this._fingerprint);\n    }\n\n    // If we have no data at all, remove empty array default\n    if (event.fingerprint && !event.fingerprint.length) {\n      delete event.fingerprint;\n    }\n  }\n}\n\n/**\n * Retruns the global event processors.\n */\nfunction getGlobalEventProcessors(): EventProcessor[] {\n  /* eslint-disable @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-member-access  */\n  const global = getGlobalObject<any>();\n  global.__SENTRY__ = global.__SENTRY__ || {};\n  global.__SENTRY__.globalEventProcessors = global.__SENTRY__.globalEventProcessors || [];\n  return global.__SENTRY__.globalEventProcessors;\n  /* eslint-enable @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-member-access */\n}\n\n/**\n * Add a EventProcessor to be kept globally.\n * @param callback EventProcessor to add\n */\nexport function addGlobalEventProcessor(callback: EventProcessor): void {\n  getGlobalEventProcessors().push(callback);\n}\n", "/** Console logging verbosity for the SDK. */\nexport enum LogLevel {\n  /** No logs will be generated. */\n  None = 0,\n  /** Only SDK internal errors will be logged. */\n  Error = 1,\n  /** Information useful for debugging the SDK will be logged. */\n  Debug = 2,\n  /** All SDK actions will be logged. */\n  Verbose = 3,\n}\n", "import { User } from './user';\n\n/**\n * @inheritdoc\n */\nexport interface Session extends SessionContext {\n  /** JSDoc */\n  update(context?: SessionContext): void;\n\n  /** JSDoc */\n  close(status?: SessionStatus): void;\n\n  /** JSDoc */\n  toJSON(): {\n    init: boolean;\n    sid: string;\n    did?: string;\n    timestamp: string;\n    started: string;\n    duration?: number;\n    status: SessionStatus;\n    errors: number;\n    attrs?: {\n      release?: string;\n      environment?: string;\n      user_agent?: string;\n      ip_address?: string;\n    };\n  };\n}\n\nexport interface RequestSession {\n  status?: RequestSessionStatus;\n}\n\n/**\n * Session Context\n */\nexport interface SessionContext {\n  sid?: string;\n  did?: string;\n  init?: boolean;\n  // seconds since the UNIX epoch\n  timestamp?: number;\n  // seconds since the UNIX epoch\n  started?: number;\n  duration?: number;\n  status?: SessionStatus;\n  release?: string;\n  environment?: string;\n  userAgent?: string;\n  ipAddress?: string;\n  errors?: number;\n  user?: User | null;\n  ignoreDuration?: boolean;\n}\n\n/**\n * Session Status\n */\nexport enum SessionStatus {\n  /** JSDoc */\n  Ok = 'ok',\n  /** JSDoc */\n  Exited = 'exited',\n  /** JSDoc */\n  Crashed = 'crashed',\n  /** JSDoc */\n  Abnormal = 'abnormal',\n}\n\nexport enum RequestSessionStatus {\n  /** JSDoc */\n  Ok = 'ok',\n  /** JSDoc */\n  Errored = 'errored',\n  /** JSDoc */\n  Crashed = 'crashed',\n}\n\n/** JSDoc */\nexport interface SessionAggregates {\n  attrs?: {\n    environment?: string;\n    release?: string;\n  };\n  aggregates: Array<AggregationCounts>;\n}\n\nexport interface SessionFlusherLike {\n  /**\n   * Increments the Session Status bucket in SessionAggregates Object corresponding to the status of the session\n   * captured\n   */\n  incrementSessionStatusCount(): void;\n\n  /** Submits the aggregates request mode sessions to Sentry */\n  sendSessionAggregates(sessionAggregates: SessionAggregates): void;\n\n  /** Empties Aggregate Buckets and Sends them to Transport Buffer */\n  flush(): void;\n\n  /** Clears setInterval and calls flush */\n  close(): void;\n}\n\nexport interface AggregationCounts {\n  started: string;\n  errored?: number;\n  exited?: number;\n  crashed?: number;\n}\n", "/** JSDoc */\n// eslint-disable-next-line import/export\nexport enum Severity {\n  /** JSDoc */\n  Fatal = 'fatal',\n  /** JSDoc */\n  Error = 'error',\n  /** JSDoc */\n  Warning = 'warning',\n  /** JSDoc */\n  Log = 'log',\n  /** JSDoc */\n  Info = 'info',\n  /** JSDoc */\n  Debug = 'debug',\n  /** JSDoc */\n  Critical = 'critical',\n}\n\n// eslint-disable-next-line @typescript-eslint/no-namespace, import/export\nexport namespace Severity {\n  /**\n   * Converts a string-based level into a {@link Severity}.\n   *\n   * @param level string representation of Severity\n   * @returns Severity\n   */\n  export function fromString(level: string): Severity {\n    switch (level) {\n      case 'debug':\n        return Severity.Debug;\n      case 'info':\n        return Severity.Info;\n      case 'warn':\n      case 'warning':\n        return Severity.Warning;\n      case 'error':\n        return Severity.Error;\n      case 'fatal':\n        return Severity.Fatal;\n      case 'critical':\n        return Severity.Critical;\n      case 'log':\n      default:\n        return Severity.Log;\n    }\n  }\n}\n", "/** The status of an event. */\n// eslint-disable-next-line import/export\nexport enum Status {\n  /** The status could not be determined. */\n  Unknown = 'unknown',\n  /** The event was skipped due to configuration or callbacks. */\n  Skipped = 'skipped',\n  /** The event was sent to Sentry successfully. */\n  Success = 'success',\n  /** The client is currently rate limited and will try again later. */\n  RateLimit = 'rate_limit',\n  /** The event could not be processed. */\n  Invalid = 'invalid',\n  /** A server-side error ocurred during submission. */\n  Failed = 'failed',\n}\n\n// eslint-disable-next-line @typescript-eslint/no-namespace, import/export\nexport namespace Status {\n  /**\n   * Converts a HTTP status code into a {@link Status}.\n   *\n   * @param code The HTTP response status code.\n   * @returns The send status or {@link Status.Unknown}.\n   */\n  export function fromHttpCode(code: number): Status {\n    if (code >= 200 && code < 300) {\n      return Status.Success;\n    }\n\n    if (code === 429) {\n      return Status.RateLimit;\n    }\n\n    if (code >= 400 && code < 500) {\n      return Status.Invalid;\n    }\n\n    if (code >= 500) {\n      return Status.Failed;\n    }\n\n    return Status.Unknown;\n  }\n}\n", "import { ExtractedNodeRequestData, Primitive, WorkerLocation } from './misc';\nimport { Span, SpanContext } from './span';\n\n/**\n * Interface holding Transaction-specific properties\n */\nexport interface TransactionContext extends SpanContext {\n  /**\n   * Human-readable identifier for the transaction\n   */\n  name: string;\n\n  /**\n   * If true, sets the end timestamp of the transaction to the highest timestamp of child spans, trimming\n   * the duration of the transaction. This is useful to discard extra time in the transaction that is not\n   * accounted for in child spans, like what happens in the idle transaction Tracing integration, where we finish the\n   * transaction after a given \"idle time\" and we don't want this \"idle time\" to be part of the transaction.\n   */\n  trimEnd?: boolean;\n\n  /**\n   * If this transaction has a parent, the parent's sampling decision\n   */\n  parentSampled?: boolean;\n\n  /**\n   * Metadata associated with the transaction, for internal SDK use.\n   */\n  metadata?: TransactionMetadata;\n}\n\n/**\n * Data pulled from a `sentry-trace` header\n */\nexport type TraceparentData = Pick<TransactionContext, 'traceId' | 'parentSpanId' | 'parentSampled'>;\n\n/**\n * Transaction \"Class\", inherits Span only has `setName`\n */\nexport interface Transaction extends TransactionContext, Span {\n  /**\n   * @inheritDoc\n   */\n  spanId: string;\n\n  /**\n   * @inheritDoc\n   */\n  traceId: string;\n\n  /**\n   * @inheritDoc\n   */\n  startTimestamp: number;\n\n  /**\n   * @inheritDoc\n   */\n  tags: { [key: string]: Primitive };\n\n  /**\n   * @inheritDoc\n   */\n  data: { [key: string]: any };\n\n  /**\n   * Metadata about the transaction\n   */\n  metadata: TransactionMetadata;\n\n  /**\n   * Set the name of the transaction\n   */\n  setName(name: string): void;\n\n  /** Returns the current transaction properties as a `TransactionContext` */\n  toContext(): TransactionContext;\n\n  /** Updates the current transaction with a new `TransactionContext` */\n  updateWithContext(transactionContext: TransactionContext): this;\n}\n\n/**\n * Context data passed by the user when starting a transaction, to be used by the tracesSampler method.\n */\nexport interface CustomSamplingContext {\n  [key: string]: any;\n}\n\n/**\n * Data passed to the `tracesSampler` function, which forms the basis for whatever decisions it might make.\n *\n * Adds default data to data provided by the user. See {@link Hub.startTransaction}\n */\nexport interface SamplingContext extends CustomSamplingContext {\n  /**\n   * Context data with which transaction being sampled was created\n   */\n  transactionContext: TransactionContext;\n\n  /**\n   * Sampling decision from the parent transaction, if any.\n   */\n  parentSampled?: boolean;\n\n  /**\n   * Object representing the URL of the current page or worker script. Passed by default when using the `BrowserTracing`\n   * integration.\n   */\n  location?: WorkerLocation;\n\n  /**\n   * Object representing the incoming request to a node server. Passed by default when using the TracingHandler.\n   */\n  request?: ExtractedNodeRequestData;\n}\n\nexport type Measurements = Record<string, { value: number }>;\n\nexport enum TransactionSamplingMethod {\n  Explicit = 'explicitly_set',\n  Sampler = 'client_sampler',\n  Rate = 'client_rate',\n  Inheritance = 'inheritance',\n}\n\nexport interface TransactionMetadata {\n  transactionSampling?: { rate?: number; method?: string };\n\n  /** The two halves (sentry and third-party) of a transaction's tracestate header, used for dynamic sampling */\n  tracestate?: {\n    sentry?: string;\n    thirdparty?: string;\n  };\n\n  /** For transactions tracing server-side request handling, the path of the request being tracked. */\n  requestPath?: string;\n}\n", "export { Breadcrumb, BreadcrumbHint } from './breadcrumb';\nexport { Client } from './client';\nexport { Context, Contexts } from './context';\nexport { Dsn, DsnComponents, DsnLike, DsnProtocol } from './dsn';\nexport { DebugImage, DebugImageType, DebugMeta } from './debugMeta';\nexport { ExtendedError } from './error';\nexport { Event, EventHint } from './event';\nexport { EventProcessor } from './eventprocessor';\nexport { Exception } from './exception';\nexport { Extra, Extras } from './extra';\nexport { Hub } from './hub';\nexport { Integration, IntegrationClass } from './integration';\nexport { LogLevel } from './loglevel';\nexport { Mechanism } from './mechanism';\nexport { ExtractedNodeRequestData, Primitive, WorkerLocation } from './misc';\nexport { Options } from './options';\nexport { Package } from './package';\nexport { QueryParams, Request, SentryRequest, SentryRequestType } from './request';\nexport { Response } from './response';\nexport { Runtime } from './runtime';\nexport { CaptureContext, Scope, ScopeContext } from './scope';\nexport { SdkInfo } from './sdkinfo';\nexport { SdkMetadata } from './sdkmetadata';\nexport {\n  SessionAggregates,\n  AggregationCounts,\n  Session,\n  SessionContext,\n  SessionStatus,\n  RequestSession,\n  RequestSessionStatus,\n  SessionFlusherLike,\n} from './session';\nexport { Severity } from './severity';\nexport { Span, SpanContext } from './span';\nexport { StackFrame } from './stackframe';\nexport { Stacktrace } from './stacktrace';\nexport { Status } from './status';\nexport {\n  CustomSamplingContext,\n  Measurements,\n  SamplingContext,\n  TraceparentData,\n  Transaction,\n  TransactionContext,\n  TransactionMetadata,\n  TransactionSamplingMethod,\n} from './transaction';\nexport { Thread } from './thread';\nexport { Transport, TransportOptions, TransportClass } from './transport';\nexport { User } from './user';\nexport { WrappedFunction } from './wrappedfunction';\n", "import { Session as SessionInterface, SessionContext, SessionStatus } from '@sentry/types';\nimport { dropUndefinedKeys, timestampInSeconds, uuid4 } from '@sentry/utils';\n\n/**\n * @inheritdoc\n */\nexport class Session implements SessionInterface {\n  public userAgent?: string;\n  public errors: number = 0;\n  public release?: string;\n  public sid: string = uuid4();\n  public did?: string;\n  public timestamp: number;\n  public started: number;\n  public duration?: number = 0;\n  public status: SessionStatus = SessionStatus.Ok;\n  public environment?: string;\n  public ipAddress?: string;\n  public init: boolean = true;\n  public ignoreDuration: boolean = false;\n\n  public constructor(context?: Omit<SessionContext, 'started' | 'status'>) {\n    // Both timestamp and started are in seconds since the UNIX epoch.\n    const startingTime = timestampInSeconds();\n    this.timestamp = startingTime;\n    this.started = startingTime;\n    if (context) {\n      this.update(context);\n    }\n  }\n\n  /** JSDoc */\n  // eslint-disable-next-line complexity\n  public update(context: SessionContext = {}): void {\n    if (context.user) {\n      if (!this.ipAddress && context.user.ip_address) {\n        this.ipAddress = context.user.ip_address;\n      }\n\n      if (!this.did && !context.did) {\n        this.did = context.user.id || context.user.email || context.user.username;\n      }\n    }\n\n    this.timestamp = context.timestamp || timestampInSeconds();\n    if (context.ignoreDuration) {\n      this.ignoreDuration = context.ignoreDuration;\n    }\n    if (context.sid) {\n      // Good enough uuid validation. \u2014 Kamil\n      this.sid = context.sid.length === 32 ? context.sid : uuid4();\n    }\n    if (context.init !== undefined) {\n      this.init = context.init;\n    }\n    if (!this.did && context.did) {\n      this.did = `${context.did}`;\n    }\n    if (typeof context.started === 'number') {\n      this.started = context.started;\n    }\n    if (this.ignoreDuration) {\n      this.duration = undefined;\n    } else if (typeof context.duration === 'number') {\n      this.duration = context.duration;\n    } else {\n      const duration = this.timestamp - this.started;\n      this.duration = duration >= 0 ? duration : 0;\n    }\n    if (context.release) {\n      this.release = context.release;\n    }\n    if (context.environment) {\n      this.environment = context.environment;\n    }\n    if (!this.ipAddress && context.ipAddress) {\n      this.ipAddress = context.ipAddress;\n    }\n    if (!this.userAgent && context.userAgent) {\n      this.userAgent = context.userAgent;\n    }\n    if (typeof context.errors === 'number') {\n      this.errors = context.errors;\n    }\n    if (context.status) {\n      this.status = context.status;\n    }\n  }\n\n  /** JSDoc */\n  public close(status?: Exclude<SessionStatus, SessionStatus.Ok>): void {\n    if (status) {\n      this.update({ status });\n    } else if (this.status === SessionStatus.Ok) {\n      this.update({ status: SessionStatus.Exited });\n    } else {\n      this.update();\n    }\n  }\n\n  /** JSDoc */\n  public toJSON(): {\n    init: boolean;\n    sid: string;\n    did?: string;\n    timestamp: string;\n    started: string;\n    duration?: number;\n    status: SessionStatus;\n    errors: number;\n    attrs?: {\n      release?: string;\n      environment?: string;\n      user_agent?: string;\n      ip_address?: string;\n    };\n  } {\n    return dropUndefinedKeys({\n      sid: `${this.sid}`,\n      init: this.init,\n      // Make sure that sec is converted to ms for date constructor\n      started: new Date(this.started * 1000).toISOString(),\n      timestamp: new Date(this.timestamp * 1000).toISOString(),\n      status: this.status,\n      errors: this.errors,\n      did: typeof this.did === 'number' || typeof this.did === 'string' ? `${this.did}` : undefined,\n      duration: this.duration,\n      attrs: dropUndefinedKeys({\n        release: this.release,\n        environment: this.environment,\n        ip_address: this.ipAddress,\n        user_agent: this.userAgent,\n      }),\n    });\n  }\n}\n", "/* eslint-disable max-lines */\nimport {\n  Breadcrumb,\n  BreadcrumbHint,\n  Client,\n  CustomSamplingContext,\n  Event,\n  EventHint,\n  Extra,\n  Extras,\n  Hub as HubInterface,\n  Integration,\n  IntegrationClass,\n  Primitive,\n  SessionContext,\n  SessionStatus,\n  Severity,\n  Span,\n  SpanContext,\n  Transaction,\n  TransactionContext,\n  User,\n} from '@sentry/types';\nimport { consoleSandbox, dateTimestampInSeconds, getGlobalObject, isNodeEnv, logger, uuid4 } from '@sentry/utils';\n\nimport { Scope } from './scope';\nimport { Session } from './session';\n\n/**\n * API compatibility version of this hub.\n *\n * WARNING: This number should only be increased when the global interface\n * changes and new methods are introduced.\n *\n * @hidden\n */\nexport const API_VERSION = 4;\n\n/**\n * Default maximum number of breadcrumbs added to an event. Can be overwritten\n * with {@link Options.maxBreadcrumbs}.\n */\nconst DEFAULT_BREADCRUMBS = 100;\n\n/**\n * A layer in the process stack.\n * @hidden\n */\nexport interface Layer {\n  client?: Client;\n  scope?: Scope;\n}\n\n/**\n * An object that contains a hub and maintains a scope stack.\n * @hidden\n */\nexport interface Carrier {\n  __SENTRY__?: {\n    hub?: Hub;\n    /**\n     * Extra Hub properties injected by various SDKs\n     */\n    integrations?: Integration[];\n    extensions?: {\n      /** Hack to prevent bundlers from breaking our usage of the domain package in the cross-platform Hub package */\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      domain?: { [key: string]: any };\n    } & {\n      /** Extension methods for the hub, which are bound to the current Hub instance */\n      // eslint-disable-next-line @typescript-eslint/ban-types\n      [key: string]: Function;\n    };\n  };\n}\n\n/**\n * @hidden\n * @deprecated Can be removed once `Hub.getActiveDomain` is removed.\n */\nexport interface DomainAsCarrier extends Carrier {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  members: { [key: string]: any }[];\n}\n\n/**\n * @inheritDoc\n */\nexport class Hub implements HubInterface {\n  /** Is a {@link Layer}[] containing the client and scope */\n  private readonly _stack: Layer[] = [{}];\n\n  /** Contains the last event id of a captured event.  */\n  private _lastEventId?: string;\n\n  /**\n   * Creates a new instance of the hub, will push one {@link Layer} into the\n   * internal stack on creation.\n   *\n   * @param client bound to the hub.\n   * @param scope bound to the hub.\n   * @param version number, higher number means higher priority.\n   */\n  public constructor(client?: Client, scope: Scope = new Scope(), private readonly _version: number = API_VERSION) {\n    this.getStackTop().scope = scope;\n    this.bindClient(client);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public isOlderThan(version: number): boolean {\n    return this._version < version;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public bindClient(client?: Client): void {\n    const top = this.getStackTop();\n    top.client = client;\n    if (client && client.setupIntegrations) {\n      client.setupIntegrations();\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public pushScope(): Scope {\n    // We want to clone the content of prev scope\n    const scope = Scope.clone(this.getScope());\n    this.getStack().push({\n      client: this.getClient(),\n      scope,\n    });\n    return scope;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public popScope(): boolean {\n    if (this.getStack().length <= 1) return false;\n    return !!this.getStack().pop();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public withScope(callback: (scope: Scope) => void): void {\n    const scope = this.pushScope();\n    try {\n      callback(scope);\n    } finally {\n      this.popScope();\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getClient<C extends Client>(): C | undefined {\n    return this.getStackTop().client as C;\n  }\n\n  /** Returns the scope of the top stack. */\n  public getScope(): Scope | undefined {\n    return this.getStackTop().scope;\n  }\n\n  /** Returns the scope stack for domains or the process. */\n  public getStack(): Layer[] {\n    return this._stack;\n  }\n\n  /** Returns the topmost scope layer in the order domain > local > process. */\n  public getStackTop(): Layer {\n    return this._stack[this._stack.length - 1];\n  }\n\n  /**\n   * @inheritDoc\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\n  public captureException(exception: any, hint?: EventHint): string {\n    const eventId = (this._lastEventId = uuid4());\n    let finalHint = hint;\n\n    // If there's no explicit hint provided, mimick the same thing that would happen\n    // in the minimal itself to create a consistent behavior.\n    // We don't do this in the client, as it's the lowest level API, and doing this,\n    // would prevent user from having full control over direct calls.\n    if (!hint) {\n      let syntheticException: Error;\n      try {\n        throw new Error('Sentry syntheticException');\n      } catch (exception) {\n        syntheticException = exception as Error;\n      }\n      finalHint = {\n        originalException: exception,\n        syntheticException,\n      };\n    }\n\n    this._invokeClient('captureException', exception, {\n      ...finalHint,\n      event_id: eventId,\n    });\n    return eventId;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public captureMessage(message: string, level?: Severity, hint?: EventHint): string {\n    const eventId = (this._lastEventId = uuid4());\n    let finalHint = hint;\n\n    // If there's no explicit hint provided, mimick the same thing that would happen\n    // in the minimal itself to create a consistent behavior.\n    // We don't do this in the client, as it's the lowest level API, and doing this,\n    // would prevent user from having full control over direct calls.\n    if (!hint) {\n      let syntheticException: Error;\n      try {\n        throw new Error(message);\n      } catch (exception) {\n        syntheticException = exception as Error;\n      }\n      finalHint = {\n        originalException: message,\n        syntheticException,\n      };\n    }\n\n    this._invokeClient('captureMessage', message, level, {\n      ...finalHint,\n      event_id: eventId,\n    });\n    return eventId;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public captureEvent(event: Event, hint?: EventHint): string {\n    const eventId = (this._lastEventId = uuid4());\n    this._invokeClient('captureEvent', event, {\n      ...hint,\n      event_id: eventId,\n    });\n    return eventId;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public lastEventId(): string | undefined {\n    return this._lastEventId;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public addBreadcrumb(breadcrumb: Breadcrumb, hint?: BreadcrumbHint): void {\n    const { scope, client } = this.getStackTop();\n\n    if (!scope || !client) return;\n\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const { beforeBreadcrumb = null, maxBreadcrumbs = DEFAULT_BREADCRUMBS } =\n      (client.getOptions && client.getOptions()) || {};\n\n    if (maxBreadcrumbs <= 0) return;\n\n    const timestamp = dateTimestampInSeconds();\n    const mergedBreadcrumb = { timestamp, ...breadcrumb };\n    const finalBreadcrumb = beforeBreadcrumb\n      ? (consoleSandbox(() => beforeBreadcrumb(mergedBreadcrumb, hint)) as Breadcrumb | null)\n      : mergedBreadcrumb;\n\n    if (finalBreadcrumb === null) return;\n\n    scope.addBreadcrumb(finalBreadcrumb, maxBreadcrumbs);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setUser(user: User | null): void {\n    const scope = this.getScope();\n    if (scope) scope.setUser(user);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setTags(tags: { [key: string]: Primitive }): void {\n    const scope = this.getScope();\n    if (scope) scope.setTags(tags);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setExtras(extras: Extras): void {\n    const scope = this.getScope();\n    if (scope) scope.setExtras(extras);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setTag(key: string, value: Primitive): void {\n    const scope = this.getScope();\n    if (scope) scope.setTag(key, value);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setExtra(key: string, extra: Extra): void {\n    const scope = this.getScope();\n    if (scope) scope.setExtra(key, extra);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public setContext(name: string, context: { [key: string]: any } | null): void {\n    const scope = this.getScope();\n    if (scope) scope.setContext(name, context);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public configureScope(callback: (scope: Scope) => void): void {\n    const { scope, client } = this.getStackTop();\n    if (scope && client) {\n      callback(scope);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public run(callback: (hub: Hub) => void): void {\n    const oldHub = makeMain(this);\n    try {\n      callback(this);\n    } finally {\n      makeMain(oldHub);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getIntegration<T extends Integration>(integration: IntegrationClass<T>): T | null {\n    const client = this.getClient();\n    if (!client) return null;\n    try {\n      return client.getIntegration(integration);\n    } catch (_oO) {\n      logger.warn(`Cannot retrieve integration ${integration.id} from the current Hub`);\n      return null;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public startSpan(context: SpanContext): Span {\n    return this._callExtensionMethod('startSpan', context);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public startTransaction(context: TransactionContext, customSamplingContext?: CustomSamplingContext): Transaction {\n    return this._callExtensionMethod('startTransaction', context, customSamplingContext);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public traceHeaders(): { [key: string]: string } {\n    return this._callExtensionMethod<{ [key: string]: string }>('traceHeaders');\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public captureSession(endSession: boolean = false): void {\n    // both send the update and pull the session from the scope\n    if (endSession) {\n      return this.endSession();\n    }\n\n    // only send the update\n    this._sendSessionUpdate();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public endSession(): void {\n    this.getStackTop()\n      ?.scope?.getSession()\n      ?.close();\n    this._sendSessionUpdate();\n\n    // the session is over; take it off of the scope\n    this.getStackTop()?.scope?.setSession();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public startSession(context?: SessionContext): Session {\n    const { scope, client } = this.getStackTop();\n    const { release, environment } = (client && client.getOptions()) || {};\n\n    // Will fetch userAgent if called from browser sdk\n    const global = getGlobalObject<{ navigator?: { userAgent?: string } }>();\n    const { userAgent } = global.navigator || {};\n\n    const session = new Session({\n      release,\n      environment,\n      ...(scope && { user: scope.getUser() }),\n      ...(userAgent && { userAgent }),\n      ...context,\n    });\n\n    if (scope) {\n      // End existing session if there's one\n      const currentSession = scope.getSession && scope.getSession();\n      if (currentSession && currentSession.status === SessionStatus.Ok) {\n        currentSession.update({ status: SessionStatus.Exited });\n      }\n      this.endSession();\n\n      // Afterwards we set the new session on the scope\n      scope.setSession(session);\n    }\n\n    return session;\n  }\n\n  /**\n   * Sends the current Session on the scope\n   */\n  private _sendSessionUpdate(): void {\n    const { scope, client } = this.getStackTop();\n    if (!scope) return;\n\n    const session = scope.getSession && scope.getSession();\n    if (session) {\n      if (client && client.captureSession) {\n        client.captureSession(session);\n      }\n    }\n  }\n\n  /**\n   * Internal helper function to call a method on the top client if it exists.\n   *\n   * @param method The method to call on the client.\n   * @param args Arguments to pass to the client function.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private _invokeClient<M extends keyof Client>(method: M, ...args: any[]): void {\n    const { scope, client } = this.getStackTop();\n    if (client && client[method]) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-explicit-any\n      (client as any)[method](...args, scope);\n    }\n  }\n\n  /**\n   * Calls global extension method and binding current instance to the function call\n   */\n  // @ts-ignore Function lacks ending return statement and return type does not include 'undefined'. ts(2366)\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private _callExtensionMethod<T>(method: string, ...args: any[]): T {\n    const carrier = getMainCarrier();\n    const sentry = carrier.__SENTRY__;\n    if (sentry && sentry.extensions && typeof sentry.extensions[method] === 'function') {\n      return sentry.extensions[method].apply(this, args);\n    }\n    logger.warn(`Extension method ${method} couldn't be found, doing nothing.`);\n  }\n}\n\n/**\n * Returns the global shim registry.\n *\n * FIXME: This function is problematic, because despite always returning a valid Carrier,\n * it has an optional `__SENTRY__` property, which then in turn requires us to always perform an unnecessary check\n * at the call-site. We always access the carrier through this function, so we can guarantee that `__SENTRY__` is there.\n **/\nexport function getMainCarrier(): Carrier {\n  const carrier = getGlobalObject();\n  carrier.__SENTRY__ = carrier.__SENTRY__ || {\n    extensions: {},\n    hub: undefined,\n  };\n  return carrier;\n}\n\n/**\n * Replaces the current main hub with the passed one on the global object\n *\n * @returns The old replaced hub\n */\nexport function makeMain(hub: Hub): Hub {\n  const registry = getMainCarrier();\n  const oldHub = getHubFromCarrier(registry);\n  setHubOnCarrier(registry, hub);\n  return oldHub;\n}\n\n/**\n * Returns the default hub instance.\n *\n * If a hub is already registered in the global carrier but this module\n * contains a more recent version, it replaces the registered version.\n * Otherwise, the currently registered hub will be returned.\n */\nexport function getCurrentHub(): Hub {\n  // Get main carrier (global for every environment)\n  const registry = getMainCarrier();\n\n  // If there's no hub, or its an old API, assign a new one\n  if (!hasHubOnCarrier(registry) || getHubFromCarrier(registry).isOlderThan(API_VERSION)) {\n    setHubOnCarrier(registry, new Hub());\n  }\n\n  // Prefer domains over global if they are there (applicable only to Node environment)\n  if (isNodeEnv()) {\n    return getHubFromActiveDomain(registry);\n  }\n  // Return hub that lives on a global object\n  return getHubFromCarrier(registry);\n}\n\n/**\n * Returns the active domain, if one exists\n * @deprecated No longer used; remove in v7\n * @returns The domain, or undefined if there is no active domain\n */\n// eslint-disable-next-line deprecation/deprecation\nexport function getActiveDomain(): DomainAsCarrier | undefined {\n  logger.warn('Function `getActiveDomain` is deprecated and will be removed in a future version.');\n\n  const sentry = getMainCarrier().__SENTRY__;\n\n  return sentry && sentry.extensions && sentry.extensions.domain && sentry.extensions.domain.active;\n}\n\n/**\n * Try to read the hub from an active domain, and fallback to the registry if one doesn't exist\n * @returns discovered hub\n */\nfunction getHubFromActiveDomain(registry: Carrier): Hub {\n  try {\n    const activeDomain = getMainCarrier().__SENTRY__?.extensions?.domain?.active;\n\n    // If there's no active domain, just return global hub\n    if (!activeDomain) {\n      return getHubFromCarrier(registry);\n    }\n\n    // If there's no hub on current domain, or it's an old API, assign a new one\n    if (!hasHubOnCarrier(activeDomain) || getHubFromCarrier(activeDomain).isOlderThan(API_VERSION)) {\n      const registryHubTopStack = getHubFromCarrier(registry).getStackTop();\n      setHubOnCarrier(activeDomain, new Hub(registryHubTopStack.client, Scope.clone(registryHubTopStack.scope)));\n    }\n\n    // Return hub that lives on a domain\n    return getHubFromCarrier(activeDomain);\n  } catch (_Oo) {\n    // Return hub that lives on a global object\n    return getHubFromCarrier(registry);\n  }\n}\n\n/**\n * This will tell whether a carrier has a hub on it or not\n * @param carrier object\n */\nfunction hasHubOnCarrier(carrier: Carrier): boolean {\n  return !!(carrier && carrier.__SENTRY__ && carrier.__SENTRY__.hub);\n}\n\n/**\n * This will create a new {@link Hub} and add to the passed object on\n * __SENTRY__.hub.\n * @param carrier object\n * @hidden\n */\nexport function getHubFromCarrier(carrier: Carrier): Hub {\n  if (carrier && carrier.__SENTRY__ && carrier.__SENTRY__.hub) return carrier.__SENTRY__.hub;\n  carrier.__SENTRY__ = carrier.__SENTRY__ || {};\n  carrier.__SENTRY__.hub = new Hub();\n  return carrier.__SENTRY__.hub;\n}\n\n/**\n * This will set passed {@link Hub} on the passed object's __SENTRY__.hub attribute\n * @param carrier object\n * @param hub Hub\n * @returns A boolean indicating success or failure\n */\nexport function setHubOnCarrier(carrier: Carrier, hub: Hub): boolean {\n  if (!carrier) return false;\n  carrier.__SENTRY__ = carrier.__SENTRY__ || {};\n  carrier.__SENTRY__.hub = hub;\n  return true;\n}\n", "import {\n  AggregationCounts,\n  RequestSessionStatus,\n  SessionAggregates,\n  SessionFlusherLike,\n  Transport,\n} from '@sentry/types';\nimport { dropUndefinedKeys, logger } from '@sentry/utils';\n\nimport { getCurrentHub } from './hub';\n\ntype ReleaseHealthAttributes = {\n  environment?: string;\n  release: string;\n};\n\n/**\n * @inheritdoc\n */\nexport class SessionFlusher implements SessionFlusherLike {\n  public readonly flushTimeout: number = 60;\n  private _pendingAggregates: Record<number, AggregationCounts> = {};\n  private _sessionAttrs: ReleaseHealthAttributes;\n  private _intervalId: ReturnType<typeof setInterval>;\n  private _isEnabled: boolean = true;\n  private _transport: Transport;\n\n  public constructor(transport: Transport, attrs: ReleaseHealthAttributes) {\n    this._transport = transport;\n    // Call to setInterval, so that flush is called every 60 seconds\n    this._intervalId = setInterval(() => this.flush(), this.flushTimeout * 1000);\n    this._sessionAttrs = attrs;\n  }\n\n  /** Sends session aggregates to Transport */\n  public sendSessionAggregates(sessionAggregates: SessionAggregates): void {\n    if (!this._transport.sendSession) {\n      logger.warn(\"Dropping session because custom transport doesn't implement sendSession\");\n      return;\n    }\n    void this._transport.sendSession(sessionAggregates).then(null, reason => {\n      logger.error(`Error while sending session: ${reason}`);\n    });\n  }\n\n  /** Checks if `pendingAggregates` has entries, and if it does flushes them by calling `sendSessions` */\n  public flush(): void {\n    const sessionAggregates = this.getSessionAggregates();\n    if (sessionAggregates.aggregates.length === 0) {\n      return;\n    }\n    this._pendingAggregates = {};\n    this.sendSessionAggregates(sessionAggregates);\n  }\n\n  /** Massages the entries in `pendingAggregates` and returns aggregated sessions */\n  public getSessionAggregates(): SessionAggregates {\n    const aggregates: AggregationCounts[] = Object.keys(this._pendingAggregates).map((key: string) => {\n      return this._pendingAggregates[parseInt(key)];\n    });\n\n    const sessionAggregates: SessionAggregates = {\n      attrs: this._sessionAttrs,\n      aggregates,\n    };\n    return dropUndefinedKeys(sessionAggregates);\n  }\n\n  /** JSDoc */\n  public close(): void {\n    clearInterval(this._intervalId);\n    this._isEnabled = false;\n    this.flush();\n  }\n\n  /**\n   * Wrapper function for _incrementSessionStatusCount that checks if the instance of SessionFlusher is enabled then\n   * fetches the session status of the request from `Scope.getRequestSession().status` on the scope and passes them to\n   * `_incrementSessionStatusCount` along with the start date\n   */\n  public incrementSessionStatusCount(): void {\n    if (!this._isEnabled) {\n      return;\n    }\n    const scope = getCurrentHub().getScope();\n    const requestSession = scope?.getRequestSession();\n\n    if (requestSession && requestSession.status) {\n      this._incrementSessionStatusCount(requestSession.status, new Date());\n      // This is not entirely necessarily but is added as a safe guard to indicate the bounds of a request and so in\n      // case captureRequestSession is called more than once to prevent double count\n      scope?.setRequestSession(undefined);\n\n      /* eslint-enable @typescript-eslint/no-unsafe-member-access */\n    }\n  }\n\n  /**\n   * Increments status bucket in pendingAggregates buffer (internal state) corresponding to status of\n   * the session received\n   */\n  private _incrementSessionStatusCount(status: RequestSessionStatus, date: Date): number {\n    // Truncate minutes and seconds on Session Started attribute to have one minute bucket keys\n    const sessionStartedTrunc = new Date(date).setSeconds(0, 0);\n    this._pendingAggregates[sessionStartedTrunc] = this._pendingAggregates[sessionStartedTrunc] || {};\n\n    // corresponds to aggregated sessions in one specific minute bucket\n    // for example, {\"started\":\"2021-03-16T08:00:00.000Z\",\"exited\":4, \"errored\": 1}\n    const aggregationCounts: AggregationCounts = this._pendingAggregates[sessionStartedTrunc];\n    if (!aggregationCounts.started) {\n      aggregationCounts.started = new Date(sessionStartedTrunc).toISOString();\n    }\n\n    switch (status) {\n      case RequestSessionStatus.Errored:\n        aggregationCounts.errored = (aggregationCounts.errored || 0) + 1;\n        return aggregationCounts.errored;\n      case RequestSessionStatus.Ok:\n        aggregationCounts.exited = (aggregationCounts.exited || 0) + 1;\n        return aggregationCounts.exited;\n      case RequestSessionStatus.Crashed:\n        aggregationCounts.crashed = (aggregationCounts.crashed || 0) + 1;\n        return aggregationCounts.crashed;\n    }\n  }\n}\n", "export { addGlobalEventProcessor, Scope } from './scope';\nexport { Session } from './session';\nexport { SessionFlusher } from './sessionflusher';\nexport {\n  // eslint-disable-next-line deprecation/deprecation\n  getActiveDomain,\n  getCurrentHub,\n  getHubFromCarrier,\n  getMainCarrier,\n  Hub,\n  makeMain,\n  setHubOnCarrier,\n  Carrier,\n  // eslint-disable-next-line deprecation/deprecation\n  DomainAsCarrier,\n  Layer,\n} from './hub';\n", "/** The status of an Span. */\n// eslint-disable-next-line import/export\nexport enum SpanStatus {\n  /** The operation completed successfully. */\n  Ok = 'ok',\n  /** Deadline expired before operation could complete. */\n  DeadlineExceeded = 'deadline_exceeded',\n  /** 401 Unauthorized (actually does mean unauthenticated according to RFC 7235) */\n  Unauthenticated = 'unauthenticated',\n  /** 403 Forbidden */\n  PermissionDenied = 'permission_denied',\n  /** 404 Not Found. Some requested entity (file or directory) was not found. */\n  NotFound = 'not_found',\n  /** 429 Too Many Requests */\n  ResourceExhausted = 'resource_exhausted',\n  /** Client specified an invalid argument. 4xx. */\n  InvalidArgument = 'invalid_argument',\n  /** 501 Not Implemented */\n  Unimplemented = 'unimplemented',\n  /** 503 Service Unavailable */\n  Unavailable = 'unavailable',\n  /** Other/generic 5xx. */\n  InternalError = 'internal_error',\n  /** Unknown. Any non-standard HTTP status code. */\n  UnknownError = 'unknown_error',\n  /** The operation was cancelled (typically by the user). */\n  Cancelled = 'cancelled',\n  /** Already exists (409) */\n  AlreadyExists = 'already_exists',\n  /** Operation was rejected because the system is not in a state required for the operation's */\n  FailedPrecondition = 'failed_precondition',\n  /** The operation was aborted, typically due to a concurrency issue. */\n  Aborted = 'aborted',\n  /** Operation was attempted past the valid range. */\n  OutOfRange = 'out_of_range',\n  /** Unrecoverable data loss or corruption */\n  DataLoss = 'data_loss',\n}\n\n// eslint-disable-next-line @typescript-eslint/no-namespace, import/export\nexport namespace SpanStatus {\n  /**\n   * Converts a HTTP status code into a {@link SpanStatus}.\n   *\n   * @param httpStatus The HTTP response status code.\n   * @returns The span status or {@link SpanStatus.UnknownError}.\n   */\n  export function fromHttpCode(httpStatus: number): SpanStatus {\n    if (httpStatus < 400) {\n      return SpanStatus.Ok;\n    }\n\n    if (httpStatus >= 400 && httpStatus < 500) {\n      switch (httpStatus) {\n        case 401:\n          return SpanStatus.Unauthenticated;\n        case 403:\n          return SpanStatus.PermissionDenied;\n        case 404:\n          return SpanStatus.NotFound;\n        case 409:\n          return SpanStatus.AlreadyExists;\n        case 413:\n          return SpanStatus.FailedPrecondition;\n        case 429:\n          return SpanStatus.ResourceExhausted;\n        default:\n          return SpanStatus.InvalidArgument;\n      }\n    }\n\n    if (httpStatus >= 500 && httpStatus < 600) {\n      switch (httpStatus) {\n        case 501:\n          return SpanStatus.Unimplemented;\n        case 503:\n          return SpanStatus.Unavailable;\n        case 504:\n          return SpanStatus.DeadlineExceeded;\n        default:\n          return SpanStatus.InternalError;\n      }\n    }\n\n    return SpanStatus.UnknownError;\n  }\n}\n", "import { getCurrentHub, Hub } from '@sentry/hub';\nimport { Options, TraceparentData, Transaction } from '@sentry/types';\n\nexport const TRACEPARENT_REGEXP = new RegExp(\n  '^[ \\\\t]*' + // whitespace\n  '([0-9a-f]{32})?' + // trace_id\n  '-?([0-9a-f]{16})?' + // span_id\n  '-?([01])?' + // sampled\n    '[ \\\\t]*$', // whitespace\n);\n\n/**\n * Determines if tracing is currently enabled.\n *\n * Tracing is enabled when at least one of `tracesSampleRate` and `tracesSampler` is defined in the SDK config.\n */\nexport function hasTracingEnabled(\n  options: Options | undefined = getCurrentHub()\n    .getClient()\n    ?.getOptions(),\n): boolean {\n  if (!options) {\n    return false;\n  }\n  return 'tracesSampleRate' in options || 'tracesSampler' in options;\n}\n\n/**\n * Extract transaction context data from a `sentry-trace` header.\n *\n * @param traceparent Traceparent string\n *\n * @returns Object containing data from the header, or undefined if traceparent string is malformed\n */\nexport function extractTraceparentData(traceparent: string): TraceparentData | undefined {\n  const matches = traceparent.match(TRACEPARENT_REGEXP);\n  if (matches) {\n    let parentSampled: boolean | undefined;\n    if (matches[3] === '1') {\n      parentSampled = true;\n    } else if (matches[3] === '0') {\n      parentSampled = false;\n    }\n    return {\n      traceId: matches[1],\n      parentSampled,\n      parentSpanId: matches[2],\n    };\n  }\n  return undefined;\n}\n\n/** Grabs active transaction off scope, if any */\nexport function getActiveTransaction<T extends Transaction>(hub: Hub = getCurrentHub()): T | undefined {\n  return hub?.getScope()?.getTransaction() as T | undefined;\n}\n\n/**\n * Converts from milliseconds to seconds\n * @param time time in ms\n */\nexport function msToSec(time: number): number {\n  return time / 1000;\n}\n\n/**\n * Converts from seconds to milliseconds\n * @param time time in seconds\n */\nexport function secToMs(time: number): number {\n  return time * 1000;\n}\n\n// so it can be used in manual instrumentation without necessitating a hard dependency on @sentry/utils\nexport { stripUrlQueryAndFragment } from '@sentry/utils';\n", "import { addInstrumentationHandler, logger } from '@sentry/utils';\n\nimport { SpanStatus } from './spanstatus';\nimport { getActiveTransaction } from './utils';\n\n/**\n * Configures global error listeners\n */\nexport function registerErrorInstrumentation(): void {\n  addInstrumentationHandler({\n    callback: errorCallback,\n    type: 'error',\n  });\n  addInstrumentationHandler({\n    callback: errorCallback,\n    type: 'unhandledrejection',\n  });\n}\n\n/**\n * If an error or unhandled promise occurs, we mark the active transaction as failed\n */\nfunction errorCallback(): void {\n  const activeTransaction = getActiveTransaction();\n  if (activeTransaction) {\n    logger.log(`[Tracing] Transaction: ${SpanStatus.InternalError} -> Global error occured`);\n    activeTransaction.setStatus(SpanStatus.InternalError);\n  }\n}\n", "/* eslint-disable max-lines */\nimport { Primitive, Span as SpanInterface, SpanContext, Transaction } from '@sentry/types';\nimport { dropUndefinedKeys, timestampWithMs, uuid4 } from '@sentry/utils';\n\nimport { SpanStatus } from './spanstatus';\n\n/**\n * Keeps track of finished spans for a given transaction\n * @internal\n * @hideconstructor\n * @hidden\n */\nexport class SpanRecorder {\n  public spans: Span[] = [];\n\n  private readonly _maxlen: number;\n\n  public constructor(maxlen: number = 1000) {\n    this._maxlen = maxlen;\n  }\n\n  /**\n   * This is just so that we don't run out of memory while recording a lot\n   * of spans. At some point we just stop and flush out the start of the\n   * trace tree (i.e.the first n spans with the smallest\n   * start_timestamp).\n   */\n  public add(span: Span): void {\n    if (this.spans.length > this._maxlen) {\n      span.spanRecorder = undefined;\n    } else {\n      this.spans.push(span);\n    }\n  }\n}\n\n/**\n * Span contains all data about a span\n */\nexport class Span implements SpanInterface {\n  /**\n   * @inheritDoc\n   */\n  public traceId: string = uuid4();\n\n  /**\n   * @inheritDoc\n   */\n  public spanId: string = uuid4().substring(16);\n\n  /**\n   * @inheritDoc\n   */\n  public parentSpanId?: string;\n\n  /**\n   * Internal keeper of the status\n   */\n  public status?: SpanStatus | string;\n\n  /**\n   * @inheritDoc\n   */\n  public sampled?: boolean;\n\n  /**\n   * Timestamp in seconds when the span was created.\n   */\n  public startTimestamp: number = timestampWithMs();\n\n  /**\n   * Timestamp in seconds when the span ended.\n   */\n  public endTimestamp?: number;\n\n  /**\n   * @inheritDoc\n   */\n  public op?: string;\n\n  /**\n   * @inheritDoc\n   */\n  public description?: string;\n\n  /**\n   * @inheritDoc\n   */\n  public tags: { [key: string]: Primitive } = {};\n\n  /**\n   * @inheritDoc\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public data: { [key: string]: any } = {};\n\n  /**\n   * List of spans that were finalized\n   */\n  public spanRecorder?: SpanRecorder;\n\n  /**\n   * @inheritDoc\n   */\n  public transaction?: Transaction;\n\n  /**\n   * You should never call the constructor manually, always use `Sentry.startTransaction()`\n   * or call `startChild()` on an existing span.\n   * @internal\n   * @hideconstructor\n   * @hidden\n   */\n  public constructor(spanContext?: SpanContext) {\n    if (!spanContext) {\n      return this;\n    }\n    if (spanContext.traceId) {\n      this.traceId = spanContext.traceId;\n    }\n    if (spanContext.spanId) {\n      this.spanId = spanContext.spanId;\n    }\n    if (spanContext.parentSpanId) {\n      this.parentSpanId = spanContext.parentSpanId;\n    }\n    // We want to include booleans as well here\n    if ('sampled' in spanContext) {\n      this.sampled = spanContext.sampled;\n    }\n    if (spanContext.op) {\n      this.op = spanContext.op;\n    }\n    if (spanContext.description) {\n      this.description = spanContext.description;\n    }\n    if (spanContext.data) {\n      this.data = spanContext.data;\n    }\n    if (spanContext.tags) {\n      this.tags = spanContext.tags;\n    }\n    if (spanContext.status) {\n      this.status = spanContext.status;\n    }\n    if (spanContext.startTimestamp) {\n      this.startTimestamp = spanContext.startTimestamp;\n    }\n    if (spanContext.endTimestamp) {\n      this.endTimestamp = spanContext.endTimestamp;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   * @deprecated\n   */\n  public child(\n    spanContext?: Pick<SpanContext, Exclude<keyof SpanContext, 'spanId' | 'sampled' | 'traceId' | 'parentSpanId'>>,\n  ): Span {\n    return this.startChild(spanContext);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public startChild(\n    spanContext?: Pick<SpanContext, Exclude<keyof SpanContext, 'spanId' | 'sampled' | 'traceId' | 'parentSpanId'>>,\n  ): Span {\n    const childSpan = new Span({\n      ...spanContext,\n      parentSpanId: this.spanId,\n      sampled: this.sampled,\n      traceId: this.traceId,\n    });\n\n    childSpan.spanRecorder = this.spanRecorder;\n    if (childSpan.spanRecorder) {\n      childSpan.spanRecorder.add(childSpan);\n    }\n\n    childSpan.transaction = this.transaction;\n\n    return childSpan;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setTag(key: string, value: Primitive): this {\n    this.tags = { ...this.tags, [key]: value };\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/explicit-module-boundary-types\n  public setData(key: string, value: any): this {\n    this.data = { ...this.data, [key]: value };\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setStatus(value: SpanStatus): this {\n    this.status = value;\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setHttpStatus(httpStatus: number): this {\n    this.setTag('http.status_code', String(httpStatus));\n    const spanStatus = SpanStatus.fromHttpCode(httpStatus);\n    if (spanStatus !== SpanStatus.UnknownError) {\n      this.setStatus(spanStatus);\n    }\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public isSuccess(): boolean {\n    return this.status === SpanStatus.Ok;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public finish(endTimestamp?: number): void {\n    this.endTimestamp = typeof endTimestamp === 'number' ? endTimestamp : timestampWithMs();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public toTraceparent(): string {\n    let sampledString = '';\n    if (this.sampled !== undefined) {\n      sampledString = this.sampled ? '-1' : '-0';\n    }\n    return `${this.traceId}-${this.spanId}${sampledString}`;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public toContext(): SpanContext {\n    return dropUndefinedKeys({\n      data: this.data,\n      description: this.description,\n      endTimestamp: this.endTimestamp,\n      op: this.op,\n      parentSpanId: this.parentSpanId,\n      sampled: this.sampled,\n      spanId: this.spanId,\n      startTimestamp: this.startTimestamp,\n      status: this.status,\n      tags: this.tags,\n      traceId: this.traceId,\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public updateWithContext(spanContext: SpanContext): this {\n    this.data = spanContext.data ?? {};\n    this.description = spanContext.description;\n    this.endTimestamp = spanContext.endTimestamp;\n    this.op = spanContext.op;\n    this.parentSpanId = spanContext.parentSpanId;\n    this.sampled = spanContext.sampled;\n    this.spanId = spanContext.spanId ?? this.spanId;\n    this.startTimestamp = spanContext.startTimestamp ?? this.startTimestamp;\n    this.status = spanContext.status;\n    this.tags = spanContext.tags ?? {};\n    this.traceId = spanContext.traceId ?? this.traceId;\n\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getTraceContext(): {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    data?: { [key: string]: any };\n    description?: string;\n    op?: string;\n    parent_span_id?: string;\n    span_id: string;\n    status?: string;\n    tags?: { [key: string]: Primitive };\n    trace_id: string;\n  } {\n    return dropUndefinedKeys({\n      data: Object.keys(this.data).length > 0 ? this.data : undefined,\n      description: this.description,\n      op: this.op,\n      parent_span_id: this.parentSpanId,\n      span_id: this.spanId,\n      status: this.status,\n      tags: Object.keys(this.tags).length > 0 ? this.tags : undefined,\n      trace_id: this.traceId,\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public toJSON(): {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    data?: { [key: string]: any };\n    description?: string;\n    op?: string;\n    parent_span_id?: string;\n    span_id: string;\n    start_timestamp: number;\n    status?: string;\n    tags?: { [key: string]: Primitive };\n    timestamp?: number;\n    trace_id: string;\n  } {\n    return dropUndefinedKeys({\n      data: Object.keys(this.data).length > 0 ? this.data : undefined,\n      description: this.description,\n      op: this.op,\n      parent_span_id: this.parentSpanId,\n      span_id: this.spanId,\n      start_timestamp: this.startTimestamp,\n      status: this.status,\n      tags: Object.keys(this.tags).length > 0 ? this.tags : undefined,\n      timestamp: this.endTimestamp,\n      trace_id: this.traceId,\n    });\n  }\n}\n", "import { getCurrentHub, Hub } from '@sentry/hub';\nimport {\n  Event,\n  Measurements,\n  Transaction as TransactionInterface,\n  TransactionContext,\n  TransactionMetadata,\n} from '@sentry/types';\nimport { dropUndefinedKeys, isInstanceOf, logger } from '@sentry/utils';\n\nimport { Span as SpanClass, SpanRecorder } from './span';\n\n/** JSDoc */\nexport class Transaction extends SpanClass implements TransactionInterface {\n  public name: string;\n\n  public metadata: TransactionMetadata;\n\n  private _measurements: Measurements = {};\n\n  /**\n   * The reference to the current hub.\n   */\n  private readonly _hub: Hub = (getCurrentHub() as unknown) as Hub;\n\n  private _trimEnd?: boolean;\n\n  /**\n   * This constructor should never be called manually. Those instrumenting tracing should use\n   * `Sentry.startTransaction()`, and internal methods should use `hub.startTransaction()`.\n   * @internal\n   * @hideconstructor\n   * @hidden\n   */\n  public constructor(transactionContext: TransactionContext, hub?: Hub) {\n    super(transactionContext);\n\n    if (isInstanceOf(hub, Hub)) {\n      this._hub = hub as Hub;\n    }\n\n    this.name = transactionContext.name || '';\n\n    this.metadata = transactionContext.metadata || {};\n    this._trimEnd = transactionContext.trimEnd;\n\n    // this is because transactions are also spans, and spans have a transaction pointer\n    this.transaction = this;\n  }\n\n  /**\n   * JSDoc\n   */\n  public setName(name: string): void {\n    this.name = name;\n  }\n\n  /**\n   * Attaches SpanRecorder to the span itself\n   * @param maxlen maximum number of spans that can be recorded\n   */\n  public initSpanRecorder(maxlen: number = 1000): void {\n    if (!this.spanRecorder) {\n      this.spanRecorder = new SpanRecorder(maxlen);\n    }\n    this.spanRecorder.add(this);\n  }\n\n  /**\n   * Set observed measurements for this transaction.\n   * @hidden\n   */\n  public setMeasurements(measurements: Measurements): void {\n    this._measurements = { ...measurements };\n  }\n\n  /**\n   * Set metadata for this transaction.\n   * @hidden\n   */\n  public setMetadata(newMetadata: TransactionMetadata): void {\n    this.metadata = { ...this.metadata, ...newMetadata };\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public finish(endTimestamp?: number): string | undefined {\n    // This transaction is already finished, so we should not flush it again.\n    if (this.endTimestamp !== undefined) {\n      return undefined;\n    }\n\n    if (!this.name) {\n      logger.warn('Transaction has no name, falling back to `<unlabeled transaction>`.');\n      this.name = '<unlabeled transaction>';\n    }\n\n    // just sets the end timestamp\n    super.finish(endTimestamp);\n\n    if (this.sampled !== true) {\n      // At this point if `sampled !== true` we want to discard the transaction.\n      logger.log('[Tracing] Discarding transaction because its trace was not chosen to be sampled.');\n      return undefined;\n    }\n\n    const finishedSpans = this.spanRecorder ? this.spanRecorder.spans.filter(s => s !== this && s.endTimestamp) : [];\n\n    if (this._trimEnd && finishedSpans.length > 0) {\n      this.endTimestamp = finishedSpans.reduce((prev: SpanClass, current: SpanClass) => {\n        if (prev.endTimestamp && current.endTimestamp) {\n          return prev.endTimestamp > current.endTimestamp ? prev : current;\n        }\n        return prev;\n      }).endTimestamp;\n    }\n\n    const transaction: Event = {\n      contexts: {\n        trace: this.getTraceContext(),\n      },\n      spans: finishedSpans,\n      start_timestamp: this.startTimestamp,\n      tags: this.tags,\n      timestamp: this.endTimestamp,\n      transaction: this.name,\n      type: 'transaction',\n      debug_meta: this.metadata,\n    };\n\n    const hasMeasurements = Object.keys(this._measurements).length > 0;\n\n    if (hasMeasurements) {\n      logger.log('[Measurements] Adding measurements to transaction', JSON.stringify(this._measurements, undefined, 2));\n      transaction.measurements = this._measurements;\n    }\n\n    logger.log(`[Tracing] Finishing ${this.op} transaction: ${this.name}.`);\n\n    return this._hub.captureEvent(transaction);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public toContext(): TransactionContext {\n    const spanContext = super.toContext();\n\n    return dropUndefinedKeys({\n      ...spanContext,\n      name: this.name,\n      trimEnd: this._trimEnd,\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public updateWithContext(transactionContext: TransactionContext): this {\n    super.updateWithContext(transactionContext);\n\n    this.name = transactionContext.name ?? '';\n\n    this._trimEnd = transactionContext.trimEnd;\n\n    return this;\n  }\n}\n", "import { Hub } from '@sentry/hub';\nimport { TransactionContext } from '@sentry/types';\nimport { logger, timestampWithMs } from '@sentry/utils';\n\nimport { Span, SpanRecorder } from './span';\nimport { SpanStatus } from './spanstatus';\nimport { Transaction } from './transaction';\n\nexport const DEFAULT_IDLE_TIMEOUT = 1000;\n\n/**\n * @inheritDoc\n */\nexport class IdleTransactionSpanRecorder extends SpanRecorder {\n  public constructor(\n    private readonly _pushActivity: (id: string) => void,\n    private readonly _popActivity: (id: string) => void,\n    public transactionSpanId: string = '',\n    maxlen?: number,\n  ) {\n    super(maxlen);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public add(span: Span): void {\n    // We should make sure we do not push and pop activities for\n    // the transaction that this span recorder belongs to.\n    if (span.spanId !== this.transactionSpanId) {\n      // We patch span.finish() to pop an activity after setting an endTimestamp.\n      span.finish = (endTimestamp?: number) => {\n        span.endTimestamp = typeof endTimestamp === 'number' ? endTimestamp : timestampWithMs();\n        this._popActivity(span.spanId);\n      };\n\n      // We should only push new activities if the span does not have an end timestamp.\n      if (span.endTimestamp === undefined) {\n        this._pushActivity(span.spanId);\n      }\n    }\n\n    super.add(span);\n  }\n}\n\nexport type BeforeFinishCallback = (transactionSpan: IdleTransaction, endTimestamp: number) => void;\n\n/**\n * An IdleTransaction is a transaction that automatically finishes. It does this by tracking child spans as activities.\n * You can have multiple IdleTransactions active, but if the `onScope` option is specified, the idle transaction will\n * put itself on the scope on creation.\n */\nexport class IdleTransaction extends Transaction {\n  // Activities store a list of active spans\n  public activities: Record<string, boolean> = {};\n\n  // Stores reference to the timeout that calls _beat().\n  private _heartbeatTimer: number = 0;\n\n  // Track state of activities in previous heartbeat\n  private _prevHeartbeatString: string | undefined;\n\n  // Amount of times heartbeat has counted. Will cause transaction to finish after 3 beats.\n  private _heartbeatCounter: number = 0;\n\n  // We should not use heartbeat if we finished a transaction\n  private _finished: boolean = false;\n\n  private readonly _beforeFinishCallbacks: BeforeFinishCallback[] = [];\n\n  // If a transaction is created and no activities are added, we want to make sure that\n  // it times out properly. This is cleared and not used when activities are added.\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private _initTimeout: any;\n\n  public constructor(\n    transactionContext: TransactionContext,\n    private readonly _idleHub?: Hub,\n    // The time to wait in ms until the idle transaction will be finished. Default: 1000\n    private readonly _idleTimeout: number = DEFAULT_IDLE_TIMEOUT,\n    // If an idle transaction should be put itself on and off the scope automatically.\n    private readonly _onScope: boolean = false,\n  ) {\n    super(transactionContext, _idleHub);\n\n    if (_idleHub && _onScope) {\n      // There should only be one active transaction on the scope\n      clearActiveTransaction(_idleHub);\n\n      // We set the transaction here on the scope so error events pick up the trace\n      // context and attach it to the error.\n      logger.log(`Setting idle transaction on scope. Span ID: ${this.spanId}`);\n      _idleHub.configureScope(scope => scope.setSpan(this));\n    }\n\n    this._initTimeout = setTimeout(() => {\n      if (!this._finished) {\n        this.finish();\n      }\n    }, this._idleTimeout);\n  }\n\n  /** {@inheritDoc} */\n  public finish(endTimestamp: number = timestampWithMs()): string | undefined {\n    this._finished = true;\n    this.activities = {};\n\n    if (this.spanRecorder) {\n      logger.log('[Tracing] finishing IdleTransaction', new Date(endTimestamp * 1000).toISOString(), this.op);\n\n      for (const callback of this._beforeFinishCallbacks) {\n        callback(this, endTimestamp);\n      }\n\n      this.spanRecorder.spans = this.spanRecorder.spans.filter((span: Span) => {\n        // If we are dealing with the transaction itself, we just return it\n        if (span.spanId === this.spanId) {\n          return true;\n        }\n\n        // We cancel all pending spans with status \"cancelled\" to indicate the idle transaction was finished early\n        if (!span.endTimestamp) {\n          span.endTimestamp = endTimestamp;\n          span.setStatus(SpanStatus.Cancelled);\n          logger.log('[Tracing] cancelling span since transaction ended early', JSON.stringify(span, undefined, 2));\n        }\n\n        const keepSpan = span.startTimestamp < endTimestamp;\n        if (!keepSpan) {\n          logger.log(\n            '[Tracing] discarding Span since it happened after Transaction was finished',\n            JSON.stringify(span, undefined, 2),\n          );\n        }\n        return keepSpan;\n      });\n\n      logger.log('[Tracing] flushing IdleTransaction');\n    } else {\n      logger.log('[Tracing] No active IdleTransaction');\n    }\n\n    // this._onScope is true if the transaction was previously on the scope.\n    if (this._onScope) {\n      clearActiveTransaction(this._idleHub);\n    }\n\n    return super.finish(endTimestamp);\n  }\n\n  /**\n   * Register a callback function that gets excecuted before the transaction finishes.\n   * Useful for cleanup or if you want to add any additional spans based on current context.\n   *\n   * This is exposed because users have no other way of running something before an idle transaction\n   * finishes.\n   */\n  public registerBeforeFinishCallback(callback: BeforeFinishCallback): void {\n    this._beforeFinishCallbacks.push(callback);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public initSpanRecorder(maxlen?: number): void {\n    if (!this.spanRecorder) {\n      const pushActivity = (id: string): void => {\n        if (this._finished) {\n          return;\n        }\n        this._pushActivity(id);\n      };\n      const popActivity = (id: string): void => {\n        if (this._finished) {\n          return;\n        }\n        this._popActivity(id);\n      };\n\n      this.spanRecorder = new IdleTransactionSpanRecorder(pushActivity, popActivity, this.spanId, maxlen);\n\n      // Start heartbeat so that transactions do not run forever.\n      logger.log('Starting heartbeat');\n      this._pingHeartbeat();\n    }\n    this.spanRecorder.add(this);\n  }\n\n  /**\n   * Start tracking a specific activity.\n   * @param spanId The span id that represents the activity\n   */\n  private _pushActivity(spanId: string): void {\n    if (this._initTimeout) {\n      clearTimeout(this._initTimeout);\n      this._initTimeout = undefined;\n    }\n    logger.log(`[Tracing] pushActivity: ${spanId}`);\n    this.activities[spanId] = true;\n    logger.log('[Tracing] new activities count', Object.keys(this.activities).length);\n  }\n\n  /**\n   * Remove an activity from usage\n   * @param spanId The span id that represents the activity\n   */\n  private _popActivity(spanId: string): void {\n    if (this.activities[spanId]) {\n      logger.log(`[Tracing] popActivity ${spanId}`);\n      // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n      delete this.activities[spanId];\n      logger.log('[Tracing] new activities count', Object.keys(this.activities).length);\n    }\n\n    if (Object.keys(this.activities).length === 0) {\n      const timeout = this._idleTimeout;\n      // We need to add the timeout here to have the real endtimestamp of the transaction\n      // Remember timestampWithMs is in seconds, timeout is in ms\n      const end = timestampWithMs() + timeout / 1000;\n\n      setTimeout(() => {\n        if (!this._finished) {\n          this.finish(end);\n        }\n      }, timeout);\n    }\n  }\n\n  /**\n   * Checks when entries of this.activities are not changing for 3 beats.\n   * If this occurs we finish the transaction.\n   */\n  private _beat(): void {\n    clearTimeout(this._heartbeatTimer);\n    // We should not be running heartbeat if the idle transaction is finished.\n    if (this._finished) {\n      return;\n    }\n\n    const keys = Object.keys(this.activities);\n    const heartbeatString = keys.length ? keys.reduce((prev: string, current: string) => prev + current) : '';\n\n    if (heartbeatString === this._prevHeartbeatString) {\n      this._heartbeatCounter += 1;\n    } else {\n      this._heartbeatCounter = 1;\n    }\n\n    this._prevHeartbeatString = heartbeatString;\n\n    if (this._heartbeatCounter >= 3) {\n      logger.log(`[Tracing] Transaction finished because of no change for 3 heart beats`);\n      this.setStatus(SpanStatus.DeadlineExceeded);\n      this.setTag('heartbeat', 'failed');\n      this.finish();\n    } else {\n      this._pingHeartbeat();\n    }\n  }\n\n  /**\n   * Pings the heartbeat\n   */\n  private _pingHeartbeat(): void {\n    logger.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`);\n    this._heartbeatTimer = (setTimeout(() => {\n      this._beat();\n    }, 5000) as unknown) as number;\n  }\n}\n\n/**\n * Reset active transaction on scope\n */\nfunction clearActiveTransaction(hub?: Hub): void {\n  if (hub) {\n    const scope = hub.getScope();\n    if (scope) {\n      const transaction = scope.getTransaction();\n      if (transaction) {\n        scope.setSpan(undefined);\n      }\n    }\n  }\n}\n", "import { getMainCarrier, Hub } from '@sentry/hub';\nimport {\n  CustomSamplingContext,\n  Integration,\n  IntegrationClass,\n  Options,\n  SamplingContext,\n  TransactionContext,\n  TransactionSamplingMethod,\n} from '@sentry/types';\nimport { dynamicRequire, isNodeEnv, loadModule, logger } from '@sentry/utils';\n\nimport { registerErrorInstrumentation } from './errors';\nimport { IdleTransaction } from './idletransaction';\nimport { Transaction } from './transaction';\nimport { hasTracingEnabled } from './utils';\n\n/** Returns all trace headers that are currently on the top scope. */\nfunction traceHeaders(this: Hub): { [key: string]: string } {\n  const scope = this.getScope();\n  if (scope) {\n    const span = scope.getSpan();\n    if (span) {\n      return {\n        'sentry-trace': span.toTraceparent(),\n      };\n    }\n  }\n  return {};\n}\n\n/**\n * Makes a sampling decision for the given transaction and stores it on the transaction.\n *\n * Called every time a transaction is created. Only transactions which emerge with a `sampled` value of `true` will be\n * sent to Sentry.\n *\n * @param hub: The hub off of which to read config options\n * @param transaction: The transaction needing a sampling decision\n * @param samplingContext: Default and user-provided data which may be used to help make the decision\n *\n * @returns The given transaction with its `sampled` value set\n */\nfunction sample<T extends Transaction>(transaction: T, options: Options, samplingContext: SamplingContext): T {\n  // nothing to do if tracing is not enabled\n  if (!hasTracingEnabled()) {\n    transaction.sampled = false;\n    return transaction;\n  }\n\n  // if the user has forced a sampling decision by passing a `sampled` value in their transaction context, go with that\n  if (transaction.sampled !== undefined) {\n    transaction.setMetadata({\n      transactionSampling: { method: TransactionSamplingMethod.Explicit },\n    });\n    return transaction;\n  }\n\n  // we would have bailed already if neither `tracesSampler` nor `tracesSampleRate` were defined, so one of these should\n  // work; prefer the hook if so\n  let sampleRate;\n  if (typeof options.tracesSampler === 'function') {\n    sampleRate = options.tracesSampler(samplingContext);\n    transaction.setMetadata({\n      transactionSampling: {\n        method: TransactionSamplingMethod.Sampler,\n        // cast to number in case it's a boolean\n        rate: Number(sampleRate),\n      },\n    });\n  } else if (samplingContext.parentSampled !== undefined) {\n    sampleRate = samplingContext.parentSampled;\n    transaction.setMetadata({\n      transactionSampling: { method: TransactionSamplingMethod.Inheritance },\n    });\n  } else {\n    sampleRate = options.tracesSampleRate;\n    transaction.setMetadata({\n      transactionSampling: {\n        method: TransactionSamplingMethod.Rate,\n        // cast to number in case it's a boolean\n        rate: Number(sampleRate),\n      },\n    });\n  }\n\n  // Since this is coming from the user (or from a function provided by the user), who knows what we might get. (The\n  // only valid values are booleans or numbers between 0 and 1.)\n  if (!isValidSampleRate(sampleRate)) {\n    logger.warn(`[Tracing] Discarding transaction because of invalid sample rate.`);\n    transaction.sampled = false;\n    return transaction;\n  }\n\n  // if the function returned 0 (or false), or if `tracesSampleRate` is 0, it's a sign the transaction should be dropped\n  if (!sampleRate) {\n    logger.log(\n      `[Tracing] Discarding transaction because ${\n        typeof options.tracesSampler === 'function'\n          ? 'tracesSampler returned 0 or false'\n          : 'a negative sampling decision was inherited or tracesSampleRate is set to 0'\n      }`,\n    );\n    transaction.sampled = false;\n    return transaction;\n  }\n\n  // Now we roll the dice. Math.random is inclusive of 0, but not of 1, so strict < is safe here. In case sampleRate is\n  // a boolean, the < comparison will cause it to be automatically cast to 1 if it's true and 0 if it's false.\n  transaction.sampled = Math.random() < (sampleRate as number | boolean);\n\n  // if we're not going to keep it, we're done\n  if (!transaction.sampled) {\n    logger.log(\n      `[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(\n        sampleRate,\n      )})`,\n    );\n    return transaction;\n  }\n\n  logger.log(`[Tracing] starting ${transaction.op} transaction - ${transaction.name}`);\n  return transaction;\n}\n\n/**\n * Checks the given sample rate to make sure it is valid type and value (a boolean, or a number between 0 and 1).\n */\nfunction isValidSampleRate(rate: unknown): boolean {\n  // we need to check NaN explicitly because it's of type 'number' and therefore wouldn't get caught by this typecheck\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  if (isNaN(rate as any) || !(typeof rate === 'number' || typeof rate === 'boolean')) {\n    logger.warn(\n      `[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(\n        rate,\n      )} of type ${JSON.stringify(typeof rate)}.`,\n    );\n    return false;\n  }\n\n  // in case sampleRate is a boolean, it will get automatically cast to 1 if it's true and 0 if it's false\n  if (rate < 0 || rate > 1) {\n    logger.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${rate}.`);\n    return false;\n  }\n  return true;\n}\n\n/**\n * Creates a new transaction and adds a sampling decision if it doesn't yet have one.\n *\n * The Hub.startTransaction method delegates to this method to do its work, passing the Hub instance in as `this`, as if\n * it had been called on the hub directly. Exists as a separate function so that it can be injected into the class as an\n * \"extension method.\"\n *\n * @param this: The Hub starting the transaction\n * @param transactionContext: Data used to configure the transaction\n * @param CustomSamplingContext: Optional data to be provided to the `tracesSampler` function (if any)\n *\n * @returns The new transaction\n *\n * @see {@link Hub.startTransaction}\n */\nfunction _startTransaction(\n  this: Hub,\n  transactionContext: TransactionContext,\n  customSamplingContext?: CustomSamplingContext,\n): Transaction {\n  const options = this.getClient()?.getOptions() || {};\n\n  let transaction = new Transaction(transactionContext, this);\n  transaction = sample(transaction, options, {\n    parentSampled: transactionContext.parentSampled,\n    transactionContext,\n    ...customSamplingContext,\n  });\n  if (transaction.sampled) {\n    transaction.initSpanRecorder(options._experiments?.maxSpans as number);\n  }\n  return transaction;\n}\n\n/**\n * Create new idle transaction.\n */\nexport function startIdleTransaction(\n  hub: Hub,\n  transactionContext: TransactionContext,\n  idleTimeout?: number,\n  onScope?: boolean,\n  customSamplingContext?: CustomSamplingContext,\n): IdleTransaction {\n  const options = hub.getClient()?.getOptions() || {};\n\n  let transaction = new IdleTransaction(transactionContext, hub, idleTimeout, onScope);\n  transaction = sample(transaction, options, {\n    parentSampled: transactionContext.parentSampled,\n    transactionContext,\n    ...customSamplingContext,\n  });\n  if (transaction.sampled) {\n    transaction.initSpanRecorder(options._experiments?.maxSpans as number);\n  }\n  return transaction;\n}\n\n/**\n * @private\n */\nexport function _addTracingExtensions(): void {\n  const carrier = getMainCarrier();\n  if (!carrier.__SENTRY__) {\n    return;\n  }\n  carrier.__SENTRY__.extensions = carrier.__SENTRY__.extensions || {};\n  if (!carrier.__SENTRY__.extensions.startTransaction) {\n    carrier.__SENTRY__.extensions.startTransaction = _startTransaction;\n  }\n  if (!carrier.__SENTRY__.extensions.traceHeaders) {\n    carrier.__SENTRY__.extensions.traceHeaders = traceHeaders;\n  }\n}\n\n/**\n * @private\n */\nfunction _autoloadDatabaseIntegrations(): void {\n  const carrier = getMainCarrier();\n  if (!carrier.__SENTRY__) {\n    return;\n  }\n\n  const packageToIntegrationMapping: Record<string, () => Integration> = {\n    mongodb() {\n      const integration = dynamicRequire(module, './integrations/mongo') as { Mongo: IntegrationClass<Integration> };\n      return new integration.Mongo();\n    },\n    mongoose() {\n      const integration = dynamicRequire(module, './integrations/mongo') as { Mongo: IntegrationClass<Integration> };\n      return new integration.Mongo({ mongoose: true });\n    },\n    mysql() {\n      const integration = dynamicRequire(module, './integrations/mysql') as { Mysql: IntegrationClass<Integration> };\n      return new integration.Mysql();\n    },\n    pg() {\n      const integration = dynamicRequire(module, './integrations/postgres') as {\n        Postgres: IntegrationClass<Integration>;\n      };\n      return new integration.Postgres();\n    },\n  };\n\n  const mappedPackages = Object.keys(packageToIntegrationMapping)\n    .filter(moduleName => !!loadModule(moduleName))\n    .map(pkg => {\n      try {\n        return packageToIntegrationMapping[pkg]();\n      } catch (e) {\n        return undefined;\n      }\n    })\n    .filter(p => p) as Integration[];\n\n  if (mappedPackages.length > 0) {\n    carrier.__SENTRY__.integrations = [...(carrier.__SENTRY__.integrations || []), ...mappedPackages];\n  }\n}\n\n/**\n * This patches the global object and injects the Tracing extensions methods\n */\nexport function addExtensionMethods(): void {\n  _addTracingExtensions();\n\n  // Detect and automatically load specified integrations.\n  if (isNodeEnv()) {\n    _autoloadDatabaseIntegrations();\n  }\n\n  // If an error happens globally, we should make sure transaction status is set to error.\n  registerErrorInstrumentation();\n}\n", "import { getGlobalObject, logger } from '@sentry/utils';\n\nimport { IdleTransaction } from '../idletransaction';\nimport { SpanStatus } from '../spanstatus';\nimport { getActiveTransaction } from '../utils';\n\nconst global = getGlobalObject<Window>();\n\n/**\n * Add a listener that cancels and finishes a transaction when the global\n * document is hidden.\n */\nexport function registerBackgroundTabDetection(): void {\n  if (global && global.document) {\n    global.document.addEventListener('visibilitychange', () => {\n      const activeTransaction = getActiveTransaction() as IdleTransaction;\n      if (global.document.hidden && activeTransaction) {\n        logger.log(\n          `[Tracing] Transaction: ${SpanStatus.Cancelled} -> since tab moved to the background, op: ${activeTransaction.op}`,\n        );\n        // We should not set status if it is already set, this prevent important statuses like\n        // error or data loss from being overwritten on transaction.\n        if (!activeTransaction.status) {\n          activeTransaction.setStatus(SpanStatus.Cancelled);\n        }\n        activeTransaction.setTag('visibilitychange', 'document.hidden');\n        activeTransaction.finish();\n      }\n    });\n  } else {\n    logger.warn('[Tracing] Could not set up background tab detection due to lack of global document');\n  }\n}\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Metric, ReportHandler } from '../types';\n\nexport const bindReporter = (\n  callback: ReportHandler,\n  metric: Metric,\n  po: PerformanceObserver | undefined,\n  observeAllUpdates?: boolean,\n): (() => void) => {\n  let prevValue: number;\n  return () => {\n    if (po && metric.isFinal) {\n      po.disconnect();\n    }\n    if (metric.value >= 0) {\n      if (observeAllUpdates || metric.isFinal || document.visibilityState === 'hidden') {\n        metric.delta = metric.value - (prevValue || 0);\n\n        // Report the metric if there's a non-zero delta, if the metric is\n        // final, or if no previous value exists (which can happen in the case\n        // of the document becoming hidden when the metric value is 0).\n        // See: https://github.com/GoogleChrome/web-vitals/issues/14\n        if (metric.delta || metric.isFinal || prevValue === undefined) {\n          callback(metric);\n          prevValue = metric.value;\n        }\n      }\n    }\n  };\n};\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Performantly generate a unique, 27-char string by combining the current\n * timestamp with a 13-digit random number.\n * @return {string}\n */\nexport const generateUniqueID = (): string => {\n  return `${Date.now()}-${Math.floor(Math.random() * (9e12 - 1)) + 1e12}`;\n};\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Metric } from '../types';\nimport { generateUniqueID } from './generateUniqueID';\n\nexport const initMetric = (name: Metric['name'], value = -1): Metric => {\n  return {\n    name,\n    value,\n    delta: 0,\n    entries: [],\n    id: generateUniqueID(),\n    isFinal: false,\n  };\n};\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface PerformanceEntryHandler {\n  (entry: PerformanceEntry): void;\n}\n\n/**\n * Takes a performance entry type and a callback function, and creates a\n * `PerformanceObserver` instance that will observe the specified entry type\n * with buffering enabled and call the callback _for each entry_.\n *\n * This function also feature-detects entry support and wraps the logic in a\n * try/catch to avoid errors in unsupporting browsers.\n */\nexport const observe = (type: string, callback: PerformanceEntryHandler): PerformanceObserver | undefined => {\n  try {\n    if (PerformanceObserver.supportedEntryTypes.includes(type)) {\n      const po: PerformanceObserver = new PerformanceObserver(l => l.getEntries().map(callback));\n\n      po.observe({ type, buffered: true });\n      return po;\n    }\n  } catch (e) {\n    // Do nothing.\n  }\n  return;\n};\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface OnHiddenCallback {\n  // TODO(philipwalton): add `isPersisted` if needed for bfcache.\n  ({ timeStamp, isUnloading }: { timeStamp: number; isUnloading: boolean }): void;\n}\n\nlet isUnloading = false;\nlet listenersAdded = false;\n\nconst onPageHide = (event: PageTransitionEvent): void => {\n  isUnloading = !event.persisted;\n};\n\nconst addListeners = (): void => {\n  addEventListener('pagehide', onPageHide);\n\n  // `beforeunload` is needed to fix this bug:\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=987409\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  addEventListener('beforeunload', () => {});\n};\n\nexport const onHidden = (cb: OnHiddenCallback, once = false): void => {\n  if (!listenersAdded) {\n    addListeners();\n    listenersAdded = true;\n  }\n\n  addEventListener(\n    'visibilitychange',\n    ({ timeStamp }) => {\n      if (document.visibilityState === 'hidden') {\n        cb({ timeStamp, isUnloading });\n      }\n    },\n    { capture: true, once },\n  );\n};\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { bindReporter } from './lib/bindReporter';\nimport { initMetric } from './lib/initMetric';\nimport { observe, PerformanceEntryHandler } from './lib/observe';\nimport { onHidden } from './lib/onHidden';\nimport { ReportHandler } from './types';\n\n// https://wicg.github.io/layout-instability/#sec-layout-shift\nexport interface LayoutShift extends PerformanceEntry {\n  value: number;\n  hadRecentInput: boolean;\n  sources: Array<LayoutShiftAttribution>;\n  toJSON(): Record<string, unknown>;\n}\n\nexport interface LayoutShiftAttribution {\n  node?: Node;\n  previousRect: DOMRectReadOnly;\n  currentRect: DOMRectReadOnly;\n}\n\nexport const getCLS = (onReport: ReportHandler, reportAllChanges = false): void => {\n  const metric = initMetric('CLS', 0);\n\n  let report: ReturnType<typeof bindReporter>;\n\n  const entryHandler = (entry: LayoutShift): void => {\n    // Only count layout shifts without recent user input.\n    if (!entry.hadRecentInput) {\n      (metric.value as number) += entry.value;\n      metric.entries.push(entry);\n      report();\n    }\n  };\n\n  const po = observe('layout-shift', entryHandler as PerformanceEntryHandler);\n  if (po) {\n    report = bindReporter(onReport, metric, po, reportAllChanges);\n\n    onHidden(({ isUnloading }) => {\n      po.takeRecords().map(entryHandler as PerformanceEntryHandler);\n\n      if (isUnloading) {\n        metric.isFinal = true;\n      }\n      report();\n    });\n  }\n};\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { onHidden } from './onHidden';\n\nlet firstHiddenTime: number;\n\ntype HiddenType = {\n  readonly timeStamp: number;\n};\n\nexport const getFirstHidden = (): HiddenType => {\n  if (firstHiddenTime === undefined) {\n    // If the document is hidden when this code runs, assume it was hidden\n    // since navigation start. This isn't a perfect heuristic, but it's the\n    // best we can do until an API is available to support querying past\n    // visibilityState.\n    firstHiddenTime = document.visibilityState === 'hidden' ? 0 : Infinity;\n\n    // Update the time if/when the document becomes hidden.\n    onHidden(({ timeStamp }) => (firstHiddenTime = timeStamp), true);\n  }\n\n  return {\n    get timeStamp() {\n      return firstHiddenTime;\n    },\n  };\n};\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { bindReporter } from './lib/bindReporter';\nimport { getFirstHidden } from './lib/getFirstHidden';\nimport { initMetric } from './lib/initMetric';\nimport { observe, PerformanceEntryHandler } from './lib/observe';\nimport { onHidden } from './lib/onHidden';\nimport { ReportHandler } from './types';\n\ninterface FIDPolyfillCallback {\n  (value: number, event: Event): void;\n}\n\ninterface FIDPolyfill {\n  onFirstInputDelay: (onReport: FIDPolyfillCallback) => void;\n}\n\ndeclare global {\n  interface Window {\n    perfMetrics: FIDPolyfill;\n  }\n}\n\n// https://wicg.github.io/event-timing/#sec-performance-event-timing\ninterface PerformanceEventTiming extends PerformanceEntry {\n  processingStart: DOMHighResTimeStamp;\n  cancelable?: boolean;\n  target?: Element;\n}\n\nexport const getFID = (onReport: ReportHandler): void => {\n  const metric = initMetric('FID');\n  const firstHidden = getFirstHidden();\n\n  const entryHandler = (entry: PerformanceEventTiming): void => {\n    // Only report if the page wasn't hidden prior to the first input.\n    if (entry.startTime < firstHidden.timeStamp) {\n      metric.value = entry.processingStart - entry.startTime;\n      metric.entries.push(entry);\n      metric.isFinal = true;\n      report();\n    }\n  };\n\n  const po = observe('first-input', entryHandler as PerformanceEntryHandler);\n  const report = bindReporter(onReport, metric, po);\n\n  if (po) {\n    onHidden(() => {\n      po.takeRecords().map(entryHandler as PerformanceEntryHandler);\n      po.disconnect();\n    }, true);\n  } else {\n    if (window.perfMetrics && window.perfMetrics.onFirstInputDelay) {\n      window.perfMetrics.onFirstInputDelay((value: number, event: Event) => {\n        // Only report if the page wasn't hidden prior to the first input.\n        if (event.timeStamp < firstHidden.timeStamp) {\n          metric.value = value;\n          metric.isFinal = true;\n          metric.entries = [\n            {\n              entryType: 'first-input',\n              name: event.type,\n              target: event.target,\n              cancelable: event.cancelable,\n              startTime: event.timeStamp,\n              processingStart: event.timeStamp + value,\n            } as PerformanceEventTiming,\n          ];\n          report();\n        }\n      });\n    }\n  }\n};\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlet inputPromise: Promise<Event>;\n\nexport const whenInput = (): Promise<Event> => {\n  if (!inputPromise) {\n    inputPromise = new Promise(r => {\n      return ['scroll', 'keydown', 'pointerdown'].map(type => {\n        addEventListener(type, r, {\n          once: true,\n          passive: true,\n          capture: true,\n        });\n      });\n    });\n  }\n  return inputPromise;\n};\n", "/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { bindReporter } from './lib/bindReporter';\nimport { getFirstHidden } from './lib/getFirstHidden';\nimport { initMetric } from './lib/initMetric';\nimport { observe, PerformanceEntryHandler } from './lib/observe';\nimport { onHidden } from './lib/onHidden';\nimport { whenInput } from './lib/whenInput';\nimport { ReportHandler } from './types';\n\n// https://wicg.github.io/largest-contentful-paint/#sec-largest-contentful-paint-interface\nexport interface LargestContentfulPaint extends PerformanceEntry {\n  renderTime: DOMHighResTimeStamp;\n  loadTime: DOMHighResTimeStamp;\n  size: number;\n  id: string;\n  url: string;\n  element?: Element;\n  toJSON(): Record<string, string>;\n}\n\nexport const getLCP = (onReport: ReportHandler, reportAllChanges = false): void => {\n  const metric = initMetric('LCP');\n  const firstHidden = getFirstHidden();\n\n  let report: ReturnType<typeof bindReporter>;\n\n  const entryHandler = (entry: PerformanceEntry): void => {\n    // The startTime attribute returns the value of the renderTime if it is not 0,\n    // and the value of the loadTime otherwise.\n    const value = entry.startTime;\n\n    // If the page was hidden prior to paint time of the entry,\n    // ignore it and mark the metric as final, otherwise add the entry.\n    if (value < firstHidden.timeStamp) {\n      metric.value = value;\n      metric.entries.push(entry);\n    } else {\n      metric.isFinal = true;\n    }\n\n    report();\n  };\n\n  const po = observe('largest-contentful-paint', entryHandler);\n\n  if (po) {\n    report = bindReporter(onReport, metric, po, reportAllChanges);\n\n    const onFinal = (): void => {\n      if (!metric.isFinal) {\n        po.takeRecords().map(entryHandler as PerformanceEntryHandler);\n        metric.isFinal = true;\n        report();\n      }\n    };\n\n    void whenInput().then(onFinal);\n    onHidden(onFinal, true);\n  }\n};\n", "/* eslint-disable max-lines */\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { Measurements, SpanContext } from '@sentry/types';\nimport { browserPerformanceTimeOrigin, getGlobalObject, htmlTreeAsString, isNodeEnv, logger } from '@sentry/utils';\n\nimport { Span } from '../span';\nimport { Transaction } from '../transaction';\nimport { msToSec } from '../utils';\nimport { getCLS, LayoutShift } from './web-vitals/getCLS';\nimport { getFID } from './web-vitals/getFID';\nimport { getLCP, LargestContentfulPaint } from './web-vitals/getLCP';\nimport { getFirstHidden } from './web-vitals/lib/getFirstHidden';\nimport { NavigatorDeviceMemory, NavigatorNetworkInformation } from './web-vitals/types';\n\nconst global = getGlobalObject<Window>();\n\n/** Class tracking metrics  */\nexport class MetricsInstrumentation {\n  private _measurements: Measurements = {};\n\n  private _performanceCursor: number = 0;\n  private _lcpEntry: LargestContentfulPaint | undefined;\n  private _clsEntry: LayoutShift | undefined;\n\n  public constructor() {\n    if (!isNodeEnv() && global?.performance) {\n      if (global.performance.mark) {\n        global.performance.mark('sentry-tracing-init');\n      }\n\n      this._trackCLS();\n      this._trackLCP();\n      this._trackFID();\n    }\n  }\n\n  /** Add performance related spans to a transaction */\n  public addPerformanceEntries(transaction: Transaction): void {\n    if (!global || !global.performance || !global.performance.getEntries || !browserPerformanceTimeOrigin) {\n      // Gatekeeper if performance API not available\n      return;\n    }\n\n    logger.log('[Tracing] Adding & adjusting spans using Performance API');\n\n    const timeOrigin = msToSec(browserPerformanceTimeOrigin);\n    let entryScriptSrc: string | undefined;\n\n    if (global.document) {\n      // eslint-disable-next-line @typescript-eslint/prefer-for-of\n      for (let i = 0; i < document.scripts.length; i++) {\n        // We go through all scripts on the page and look for 'data-entry'\n        // We remember the name and measure the time between this script finished loading and\n        // our mark 'sentry-tracing-init'\n        if (document.scripts[i].dataset.entry === 'true') {\n          entryScriptSrc = document.scripts[i].src;\n          break;\n        }\n      }\n    }\n\n    let entryScriptStartTimestamp: number | undefined;\n    let tracingInitMarkStartTime: number | undefined;\n    let responseStartTimestamp: number | undefined;\n    let requestStartTimestamp: number | undefined;\n\n    global.performance\n      .getEntries()\n      .slice(this._performanceCursor)\n      .forEach((entry: Record<string, any>) => {\n        const startTime = msToSec(entry.startTime as number);\n        const duration = msToSec(entry.duration as number);\n\n        if (transaction.op === 'navigation' && timeOrigin + startTime < transaction.startTimestamp) {\n          return;\n        }\n\n        switch (entry.entryType) {\n          case 'navigation': {\n            addNavigationSpans(transaction, entry, timeOrigin);\n            responseStartTimestamp = timeOrigin + msToSec(entry.responseStart as number);\n            requestStartTimestamp = timeOrigin + msToSec(entry.requestStart as number);\n            break;\n          }\n          case 'mark':\n          case 'paint':\n          case 'measure': {\n            const startTimestamp = addMeasureSpans(transaction, entry, startTime, duration, timeOrigin);\n            if (tracingInitMarkStartTime === undefined && entry.name === 'sentry-tracing-init') {\n              tracingInitMarkStartTime = startTimestamp;\n            }\n\n            // capture web vitals\n\n            const firstHidden = getFirstHidden();\n            // Only report if the page wasn't hidden prior to the web vital.\n            const shouldRecord = entry.startTime < firstHidden.timeStamp;\n\n            if (entry.name === 'first-paint' && shouldRecord) {\n              logger.log('[Measurements] Adding FP');\n              this._measurements['fp'] = { value: entry.startTime };\n              this._measurements['mark.fp'] = { value: startTimestamp };\n            }\n\n            if (entry.name === 'first-contentful-paint' && shouldRecord) {\n              logger.log('[Measurements] Adding FCP');\n              this._measurements['fcp'] = { value: entry.startTime };\n              this._measurements['mark.fcp'] = { value: startTimestamp };\n            }\n\n            break;\n          }\n          case 'resource': {\n            const resourceName = (entry.name as string).replace(window.location.origin, '');\n            const endTimestamp = addResourceSpans(transaction, entry, resourceName, startTime, duration, timeOrigin);\n            // We remember the entry script end time to calculate the difference to the first init mark\n            if (entryScriptStartTimestamp === undefined && (entryScriptSrc || '').indexOf(resourceName) > -1) {\n              entryScriptStartTimestamp = endTimestamp;\n            }\n            break;\n          }\n          default:\n          // Ignore other entry types.\n        }\n      });\n\n    if (entryScriptStartTimestamp !== undefined && tracingInitMarkStartTime !== undefined) {\n      _startChild(transaction, {\n        description: 'evaluation',\n        endTimestamp: tracingInitMarkStartTime,\n        op: 'script',\n        startTimestamp: entryScriptStartTimestamp,\n      });\n    }\n\n    this._performanceCursor = Math.max(performance.getEntries().length - 1, 0);\n\n    this._trackNavigator(transaction);\n\n    // Measurements are only available for pageload transactions\n    if (transaction.op === 'pageload') {\n      // normalize applicable web vital values to be relative to transaction.startTimestamp\n\n      const timeOrigin = msToSec(browserPerformanceTimeOrigin);\n\n      // Generate TTFB (Time to First Byte), which measured as the time between the beginning of the transaction and the\n      // start of the response in milliseconds\n      if (typeof responseStartTimestamp === 'number') {\n        logger.log('[Measurements] Adding TTFB');\n        this._measurements['ttfb'] = { value: (responseStartTimestamp - transaction.startTimestamp) * 1000 };\n\n        if (typeof requestStartTimestamp === 'number' && requestStartTimestamp <= responseStartTimestamp) {\n          // Capture the time spent making the request and receiving the first byte of the response.\n          // This is the time between the start of the request and the start of the response in milliseconds.\n          this._measurements['ttfb.requestTime'] = { value: (responseStartTimestamp - requestStartTimestamp) * 1000 };\n        }\n      }\n\n      ['fcp', 'fp', 'lcp'].forEach(name => {\n        if (!this._measurements[name] || timeOrigin >= transaction.startTimestamp) {\n          return;\n        }\n\n        // The web vitals, fcp, fp, lcp, and ttfb, all measure relative to timeOrigin.\n        // Unfortunately, timeOrigin is not captured within the transaction span data, so these web vitals will need\n        // to be adjusted to be relative to transaction.startTimestamp.\n\n        const oldValue = this._measurements[name].value;\n        const measurementTimestamp = timeOrigin + msToSec(oldValue);\n        // normalizedValue should be in milliseconds\n        const normalizedValue = Math.abs((measurementTimestamp - transaction.startTimestamp) * 1000);\n\n        const delta = normalizedValue - oldValue;\n        logger.log(`[Measurements] Normalized ${name} from ${oldValue} to ${normalizedValue} (${delta})`);\n\n        this._measurements[name].value = normalizedValue;\n      });\n\n      if (this._measurements['mark.fid'] && this._measurements['fid']) {\n        // create span for FID\n\n        _startChild(transaction, {\n          description: 'first input delay',\n          endTimestamp: this._measurements['mark.fid'].value + msToSec(this._measurements['fid'].value),\n          op: 'web.vitals',\n          startTimestamp: this._measurements['mark.fid'].value,\n        });\n      }\n\n      transaction.setMeasurements(this._measurements);\n      this._tagMetricInfo(transaction);\n    }\n  }\n\n  /** Add LCP / CLS data to transaction to allow debugging */\n  private _tagMetricInfo(transaction: Transaction): void {\n    if (this._lcpEntry) {\n      logger.log('[Measurements] Adding LCP Data');\n      // Capture Properties of the LCP element that contributes to the LCP.\n\n      if (this._lcpEntry.element) {\n        transaction.setTag('lcp.element', htmlTreeAsString(this._lcpEntry.element));\n      }\n\n      if (this._lcpEntry.id) {\n        transaction.setTag('lcp.id', this._lcpEntry.id);\n      }\n\n      if (this._lcpEntry.url) {\n        // Trim URL to the first 200 characters.\n        transaction.setTag('lcp.url', this._lcpEntry.url.trim().slice(0, 200));\n      }\n\n      transaction.setTag('lcp.size', this._lcpEntry.size);\n    }\n\n    if (this._clsEntry) {\n      logger.log('[Measurements] Adding CLS Data');\n      this._clsEntry.sources.map((source, index) =>\n        transaction.setTag(`cls.source.${index + 1}`, htmlTreeAsString(source.node)),\n      );\n    }\n  }\n\n  /** Starts tracking the Cumulative Layout Shift on the current page. */\n  private _trackCLS(): void {\n    getCLS(metric => {\n      const entry = metric.entries.pop();\n\n      if (!entry) {\n        return;\n      }\n\n      logger.log('[Measurements] Adding CLS');\n      this._measurements['cls'] = { value: metric.value };\n      this._clsEntry = entry as LayoutShift;\n    });\n  }\n\n  /**\n   * Capture the information of the user agent.\n   */\n  private _trackNavigator(transaction: Transaction): void {\n    const navigator = global.navigator as null | (Navigator & NavigatorNetworkInformation & NavigatorDeviceMemory);\n\n    if (!navigator) {\n      return;\n    }\n\n    // track network connectivity\n\n    const connection = navigator.connection;\n    if (connection) {\n      if (connection.effectiveType) {\n        transaction.setTag('effectiveConnectionType', connection.effectiveType);\n      }\n\n      if (connection.type) {\n        transaction.setTag('connectionType', connection.type);\n      }\n\n      if (isMeasurementValue(connection.rtt)) {\n        this._measurements['connection.rtt'] = { value: connection.rtt as number };\n      }\n\n      if (isMeasurementValue(connection.downlink)) {\n        this._measurements['connection.downlink'] = { value: connection.downlink as number };\n      }\n    }\n\n    if (isMeasurementValue(navigator.deviceMemory)) {\n      transaction.setTag('deviceMemory', String(navigator.deviceMemory));\n    }\n\n    if (isMeasurementValue(navigator.hardwareConcurrency)) {\n      transaction.setTag('hardwareConcurrency', String(navigator.hardwareConcurrency));\n    }\n  }\n\n  /** Starts tracking the Largest Contentful Paint on the current page. */\n  private _trackLCP(): void {\n    getLCP(metric => {\n      const entry = metric.entries.pop();\n\n      if (!entry) {\n        return;\n      }\n\n      const timeOrigin = msToSec(browserPerformanceTimeOrigin as number);\n      const startTime = msToSec(entry.startTime as number);\n      logger.log('[Measurements] Adding LCP');\n      this._measurements['lcp'] = { value: metric.value };\n      this._measurements['mark.lcp'] = { value: timeOrigin + startTime };\n      this._lcpEntry = entry as LargestContentfulPaint;\n    });\n  }\n\n  /** Starts tracking the First Input Delay on the current page. */\n  private _trackFID(): void {\n    getFID(metric => {\n      const entry = metric.entries.pop();\n\n      if (!entry) {\n        return;\n      }\n\n      const timeOrigin = msToSec(browserPerformanceTimeOrigin as number);\n      const startTime = msToSec(entry.startTime as number);\n      logger.log('[Measurements] Adding FID');\n      this._measurements['fid'] = { value: metric.value };\n      this._measurements['mark.fid'] = { value: timeOrigin + startTime };\n    });\n  }\n}\n\n/** Instrument navigation entries */\nfunction addNavigationSpans(transaction: Transaction, entry: Record<string, any>, timeOrigin: number): void {\n  addPerformanceNavigationTiming({ transaction, entry, event: 'unloadEvent', timeOrigin });\n  addPerformanceNavigationTiming({ transaction, entry, event: 'redirect', timeOrigin });\n  addPerformanceNavigationTiming({ transaction, entry, event: 'domContentLoadedEvent', timeOrigin });\n  addPerformanceNavigationTiming({ transaction, entry, event: 'loadEvent', timeOrigin });\n  addPerformanceNavigationTiming({ transaction, entry, event: 'connect', timeOrigin });\n  addPerformanceNavigationTiming({\n    transaction,\n    entry,\n    event: 'secureConnection',\n    timeOrigin,\n    eventEnd: 'connectEnd',\n    description: 'TLS/SSL',\n  });\n  addPerformanceNavigationTiming({\n    transaction,\n    entry,\n    event: 'fetch',\n    timeOrigin,\n    eventEnd: 'domainLookupStart',\n    description: 'cache',\n  });\n  addPerformanceNavigationTiming({ transaction, entry, event: 'domainLookup', timeOrigin, description: 'DNS' });\n  addRequest(transaction, entry, timeOrigin);\n}\n\n/** Create measure related spans */\nfunction addMeasureSpans(\n  transaction: Transaction,\n  entry: Record<string, any>,\n  startTime: number,\n  duration: number,\n  timeOrigin: number,\n): number {\n  const measureStartTimestamp = timeOrigin + startTime;\n  const measureEndTimestamp = measureStartTimestamp + duration;\n\n  _startChild(transaction, {\n    description: entry.name as string,\n    endTimestamp: measureEndTimestamp,\n    op: entry.entryType as string,\n    startTimestamp: measureStartTimestamp,\n  });\n\n  return measureStartTimestamp;\n}\n\nexport interface ResourceEntry extends Record<string, unknown> {\n  initiatorType?: string;\n  transferSize?: number;\n  encodedBodySize?: number;\n  decodedBodySize?: number;\n}\n\n/** Create resource-related spans */\nexport function addResourceSpans(\n  transaction: Transaction,\n  entry: ResourceEntry,\n  resourceName: string,\n  startTime: number,\n  duration: number,\n  timeOrigin: number,\n): number | undefined {\n  // we already instrument based on fetch and xhr, so we don't need to\n  // duplicate spans here.\n  if (entry.initiatorType === 'xmlhttprequest' || entry.initiatorType === 'fetch') {\n    return undefined;\n  }\n\n  const data: Record<string, any> = {};\n  if ('transferSize' in entry) {\n    data['Transfer Size'] = entry.transferSize;\n  }\n  if ('encodedBodySize' in entry) {\n    data['Encoded Body Size'] = entry.encodedBodySize;\n  }\n  if ('decodedBodySize' in entry) {\n    data['Decoded Body Size'] = entry.decodedBodySize;\n  }\n\n  const startTimestamp = timeOrigin + startTime;\n  const endTimestamp = startTimestamp + duration;\n\n  _startChild(transaction, {\n    description: resourceName,\n    endTimestamp,\n    op: entry.initiatorType ? `resource.${entry.initiatorType}` : 'resource',\n    startTimestamp,\n    data,\n  });\n\n  return endTimestamp;\n}\n\n/** Create performance navigation related spans */\nfunction addPerformanceNavigationTiming(props: {\n  transaction: Transaction;\n  entry: Record<string, any>;\n  event: string;\n  timeOrigin: number;\n  eventEnd?: string;\n  description?: string;\n}): void {\n  const { transaction, entry, event, timeOrigin, eventEnd, description } = props;\n\n  const end = eventEnd ? (entry[eventEnd] as number | undefined) : (entry[`${event}End`] as number | undefined);\n  const start = entry[`${event}Start`] as number | undefined;\n  if (!start || !end) {\n    return;\n  }\n  _startChild(transaction, {\n    op: 'browser',\n    description: description ?? event,\n    startTimestamp: timeOrigin + msToSec(start),\n    endTimestamp: timeOrigin + msToSec(end),\n  });\n}\n\n/** Create request and response related spans */\nfunction addRequest(transaction: Transaction, entry: Record<string, any>, timeOrigin: number): void {\n  _startChild(transaction, {\n    op: 'browser',\n    description: 'request',\n    startTimestamp: timeOrigin + msToSec(entry.requestStart as number),\n    endTimestamp: timeOrigin + msToSec(entry.responseEnd as number),\n  });\n\n  _startChild(transaction, {\n    op: 'browser',\n    description: 'response',\n    startTimestamp: timeOrigin + msToSec(entry.responseStart as number),\n    endTimestamp: timeOrigin + msToSec(entry.responseEnd as number),\n  });\n}\n\n/**\n * Helper function to start child on transactions. This function will make sure that the transaction will\n * use the start timestamp of the created child span if it is earlier than the transactions actual\n * start timestamp.\n */\nexport function _startChild(transaction: Transaction, { startTimestamp, ...ctx }: SpanContext): Span {\n  if (startTimestamp && transaction.startTimestamp > startTimestamp) {\n    transaction.startTimestamp = startTimestamp;\n  }\n\n  return transaction.startChild({\n    startTimestamp,\n    ...ctx,\n  });\n}\n\n/**\n * Checks if a given value is a valid measurement value.\n */\nfunction isMeasurementValue(value: any): boolean {\n  return typeof value === 'number' && isFinite(value);\n}\n", "import { addInstrumentationHandler, isInstanceOf, isMatchingPattern } from '@sentry/utils';\n\nimport { Span } from '../span';\nimport { SpanStatus } from '../spanstatus';\nimport { getActiveTransaction, hasTracingEnabled } from '../utils';\n\nexport const DEFAULT_TRACING_ORIGINS = ['localhost', /^\\//];\n\n/** Options for Request Instrumentation */\nexport interface RequestInstrumentationOptions {\n  /**\n   * List of strings / regex where the integration should create Spans out of. Additionally this will be used\n   * to define which outgoing requests the `sentry-trace` header will be attached to.\n   *\n   * Default: ['localhost', /^\\//] {@see DEFAULT_TRACING_ORIGINS}\n   */\n  tracingOrigins: Array<string | RegExp>;\n\n  /**\n   * Flag to disable patching all together for fetch requests.\n   *\n   * Default: true\n   */\n  traceFetch: boolean;\n\n  /**\n   * Flag to disable patching all together for xhr requests.\n   *\n   * Default: true\n   */\n  traceXHR: boolean;\n\n  /**\n   * This function will be called before creating a span for a request with the given url.\n   * Return false if you don't want a span for the given url.\n   *\n   * By default it uses the `tracingOrigins` options as a url match.\n   */\n  shouldCreateSpanForRequest?(url: string): boolean;\n}\n\n/** Data returned from fetch callback */\nexport interface FetchData {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  args: any[]; // the arguments passed to the fetch call itself\n  fetchData?: {\n    method: string;\n    url: string;\n    // span_id\n    __span?: string;\n  };\n\n  // TODO Should this be unknown instead? If we vendor types, make it a Response\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  response?: any;\n  error?: unknown;\n\n  startTimestamp: number;\n  endTimestamp?: number;\n}\n\n/** Data returned from XHR request */\nexport interface XHRData {\n  xhr?: {\n    __sentry_xhr__?: {\n      method: string;\n      url: string;\n      status_code: number;\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      data: Record<string, any>;\n    };\n    __sentry_xhr_span_id__?: string;\n    setRequestHeader?: (key: string, val: string) => void;\n    __sentry_own_request__?: boolean;\n  };\n  startTimestamp: number;\n  endTimestamp?: number;\n}\n\nexport const defaultRequestInstrumentationOptions: RequestInstrumentationOptions = {\n  traceFetch: true,\n  traceXHR: true,\n  tracingOrigins: DEFAULT_TRACING_ORIGINS,\n};\n\n/** Registers span creators for xhr and fetch requests  */\nexport function instrumentOutgoingRequests(_options?: Partial<RequestInstrumentationOptions>): void {\n  // eslint-disable-next-line @typescript-eslint/unbound-method\n  const { traceFetch, traceXHR, tracingOrigins, shouldCreateSpanForRequest } = {\n    ...defaultRequestInstrumentationOptions,\n    ..._options,\n  };\n\n  // We should cache url -> decision so that we don't have to compute\n  // regexp everytime we create a request.\n  const urlMap: Record<string, boolean> = {};\n\n  const defaultShouldCreateSpan = (url: string): boolean => {\n    if (urlMap[url]) {\n      return urlMap[url];\n    }\n    const origins = tracingOrigins;\n    urlMap[url] =\n      origins.some((origin: string | RegExp) => isMatchingPattern(url, origin)) &&\n      !isMatchingPattern(url, 'sentry_key');\n    return urlMap[url];\n  };\n\n  // We want that our users don't have to re-implement shouldCreateSpanForRequest themselves\n  // That's why we filter out already unwanted Spans from tracingOrigins\n  let shouldCreateSpan = defaultShouldCreateSpan;\n  if (typeof shouldCreateSpanForRequest === 'function') {\n    shouldCreateSpan = (url: string) => {\n      return defaultShouldCreateSpan(url) && shouldCreateSpanForRequest(url);\n    };\n  }\n\n  const spans: Record<string, Span> = {};\n\n  if (traceFetch) {\n    addInstrumentationHandler({\n      callback: (handlerData: FetchData) => {\n        fetchCallback(handlerData, shouldCreateSpan, spans);\n      },\n      type: 'fetch',\n    });\n  }\n\n  if (traceXHR) {\n    addInstrumentationHandler({\n      callback: (handlerData: XHRData) => {\n        xhrCallback(handlerData, shouldCreateSpan, spans);\n      },\n      type: 'xhr',\n    });\n  }\n}\n\n/**\n * Create and track fetch request spans\n */\nexport function fetchCallback(\n  handlerData: FetchData,\n  shouldCreateSpan: (url: string) => boolean,\n  spans: Record<string, Span>,\n): void {\n  if (!hasTracingEnabled() || !(handlerData.fetchData && shouldCreateSpan(handlerData.fetchData.url))) {\n    return;\n  }\n\n  if (handlerData.endTimestamp && handlerData.fetchData.__span) {\n    const span = spans[handlerData.fetchData.__span];\n    if (span) {\n      if (handlerData.response) {\n        // TODO (kmclb) remove this once types PR goes through\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        span.setHttpStatus(handlerData.response.status);\n      } else if (handlerData.error) {\n        span.setStatus(SpanStatus.InternalError);\n      }\n      span.finish();\n\n      // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n      delete spans[handlerData.fetchData.__span];\n    }\n    return;\n  }\n\n  const activeTransaction = getActiveTransaction();\n  if (activeTransaction) {\n    const span = activeTransaction.startChild({\n      data: {\n        ...handlerData.fetchData,\n        type: 'fetch',\n      },\n      description: `${handlerData.fetchData.method} ${handlerData.fetchData.url}`,\n      op: 'http',\n    });\n\n    handlerData.fetchData.__span = span.spanId;\n    spans[span.spanId] = span;\n\n    const request = (handlerData.args[0] = handlerData.args[0] as string | Request);\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const options = (handlerData.args[1] = (handlerData.args[1] as { [key: string]: any }) || {});\n    let headers = options.headers;\n    if (isInstanceOf(request, Request)) {\n      headers = (request as Request).headers;\n    }\n    if (headers) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      if (typeof headers.append === 'function') {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        headers.append('sentry-trace', span.toTraceparent());\n      } else if (Array.isArray(headers)) {\n        headers = [...headers, ['sentry-trace', span.toTraceparent()]];\n      } else {\n        headers = { ...headers, 'sentry-trace': span.toTraceparent() };\n      }\n    } else {\n      headers = { 'sentry-trace': span.toTraceparent() };\n    }\n    options.headers = headers;\n  }\n}\n\n/**\n * Create and track xhr request spans\n */\nexport function xhrCallback(\n  handlerData: XHRData,\n  shouldCreateSpan: (url: string) => boolean,\n  spans: Record<string, Span>,\n): void {\n  if (\n    !hasTracingEnabled() ||\n    handlerData.xhr?.__sentry_own_request__ ||\n    !(handlerData.xhr?.__sentry_xhr__ && shouldCreateSpan(handlerData.xhr.__sentry_xhr__.url))\n  ) {\n    return;\n  }\n\n  const xhr = handlerData.xhr.__sentry_xhr__;\n\n  // check first if the request has finished and is tracked by an existing span which should now end\n  if (handlerData.endTimestamp && handlerData.xhr.__sentry_xhr_span_id__) {\n    const span = spans[handlerData.xhr.__sentry_xhr_span_id__];\n    if (span) {\n      span.setHttpStatus(xhr.status_code);\n      span.finish();\n\n      // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n      delete spans[handlerData.xhr.__sentry_xhr_span_id__];\n    }\n    return;\n  }\n\n  // if not, create a new span to track it\n  const activeTransaction = getActiveTransaction();\n  if (activeTransaction) {\n    const span = activeTransaction.startChild({\n      data: {\n        ...xhr.data,\n        type: 'xhr',\n        method: xhr.method,\n        url: xhr.url,\n      },\n      description: `${xhr.method} ${xhr.url}`,\n      op: 'http',\n    });\n\n    handlerData.xhr.__sentry_xhr_span_id__ = span.spanId;\n    spans[handlerData.xhr.__sentry_xhr_span_id__] = span;\n\n    if (handlerData.xhr.setRequestHeader) {\n      try {\n        handlerData.xhr.setRequestHeader('sentry-trace', span.toTraceparent());\n      } catch (_) {\n        // Error: InvalidStateError: Failed to execute 'setRequestHeader' on 'XMLHttpRequest': The object's state must be OPENED.\n      }\n    }\n  }\n}\n", "import { Transaction, TransactionContext } from '@sentry/types';\nimport { addInstrumentationHandler, getGlobalObject, logger } from '@sentry/utils';\n\nconst global = getGlobalObject<Window>();\n\n/**\n * Default function implementing pageload and navigation transactions\n */\nexport function instrumentRoutingWithDefaults<T extends Transaction>(\n  customStartTransaction: (context: TransactionContext) => T | undefined,\n  startTransactionOnPageLoad: boolean = true,\n  startTransactionOnLocationChange: boolean = true,\n): void {\n  if (!global || !global.location) {\n    logger.warn('Could not initialize routing instrumentation due to invalid location');\n    return;\n  }\n\n  let startingUrl: string | undefined = global.location.href;\n\n  let activeTransaction: T | undefined;\n  if (startTransactionOnPageLoad) {\n    activeTransaction = customStartTransaction({ name: global.location.pathname, op: 'pageload' });\n  }\n\n  if (startTransactionOnLocationChange) {\n    addInstrumentationHandler({\n      callback: ({ to, from }: { to: string; from?: string }) => {\n        /**\n         * This early return is there to account for some cases where a navigation transaction starts right after\n         * long-running pageload. We make sure that if `from` is undefined and a valid `startingURL` exists, we don't\n         * create an uneccessary navigation transaction.\n         *\n         * This was hard to duplicate, but this behavior stopped as soon as this fix was applied. This issue might also\n         * only be caused in certain development environments where the usage of a hot module reloader is causing\n         * errors.\n         */\n        if (from === undefined && startingUrl && startingUrl.indexOf(to) !== -1) {\n          startingUrl = undefined;\n          return;\n        }\n\n        if (from !== to) {\n          startingUrl = undefined;\n          if (activeTransaction) {\n            logger.log(`[Tracing] Finishing current transaction with op: ${activeTransaction.op}`);\n            // If there's an open transaction on the scope, we need to finish it before creating an new one.\n            activeTransaction.finish();\n          }\n          activeTransaction = customStartTransaction({ name: global.location.pathname, op: 'navigation' });\n        }\n      },\n      type: 'history',\n    });\n  }\n}\n", "import { Hub } from '@sentry/hub';\nimport { EventProcessor, Integration, Transaction, TransactionContext } from '@sentry/types';\nimport { getGlobalObject, logger } from '@sentry/utils';\n\nimport { startIdleTransaction } from '../hubextensions';\nimport { DEFAULT_IDLE_TIMEOUT, IdleTransaction } from '../idletransaction';\nimport { SpanStatus } from '../spanstatus';\nimport { extractTraceparentData, secToMs } from '../utils';\nimport { registerBackgroundTabDetection } from './backgroundtab';\nimport { MetricsInstrumentation } from './metrics';\nimport {\n  defaultRequestInstrumentationOptions,\n  instrumentOutgoingRequests,\n  RequestInstrumentationOptions,\n} from './request';\nimport { instrumentRoutingWithDefaults } from './router';\n\nexport const DEFAULT_MAX_TRANSACTION_DURATION_SECONDS = 600;\n\n/** Options for Browser Tracing integration */\nexport interface BrowserTracingOptions extends RequestInstrumentationOptions {\n  /**\n   * The time to wait in ms until the transaction will be finished. The transaction will use the end timestamp of\n   * the last finished span as the endtime for the transaction.\n   * Time is in ms.\n   *\n   * Default: 1000\n   */\n  idleTimeout: number;\n\n  /**\n   * Flag to enable/disable creation of `navigation` transaction on history changes.\n   *\n   * Default: true\n   */\n  startTransactionOnLocationChange: boolean;\n\n  /**\n   * Flag to enable/disable creation of `pageload` transaction on first pageload.\n   *\n   * Default: true\n   */\n  startTransactionOnPageLoad: boolean;\n\n  /**\n   * The maximum duration of a transaction before it will be marked as \"deadline_exceeded\".\n   * If you never want to mark a transaction set it to 0.\n   * Time is in seconds.\n   *\n   * Default: 600\n   */\n  maxTransactionDuration: number;\n\n  /**\n   * Flag Transactions where tabs moved to background with \"cancelled\". Browser background tab timing is\n   * not suited towards doing precise measurements of operations. By default, we recommend that this option\n   * be enabled as background transactions can mess up your statistics in nondeterministic ways.\n   *\n   * Default: true\n   */\n  markBackgroundTransactions: boolean;\n\n  /**\n   * beforeNavigate is called before a pageload/navigation transaction is created and allows users to modify transaction\n   * context data, or drop the transaction entirely (by setting `sampled = false` in the context).\n   *\n   * Note: For legacy reasons, transactions can also be dropped by returning `undefined`.\n   *\n   * @param context: The context data which will be passed to `startTransaction` by default\n   *\n   * @returns A (potentially) modified context object, with `sampled = false` if the transaction should be dropped.\n   */\n  beforeNavigate?(context: TransactionContext): TransactionContext | undefined;\n\n  /**\n   * Instrumentation that creates routing change transactions. By default creates\n   * pageload and navigation transactions.\n   */\n  routingInstrumentation<T extends Transaction>(\n    customStartTransaction: (context: TransactionContext) => T | undefined,\n    startTransactionOnPageLoad?: boolean,\n    startTransactionOnLocationChange?: boolean,\n  ): void;\n}\n\nconst DEFAULT_BROWSER_TRACING_OPTIONS = {\n  idleTimeout: DEFAULT_IDLE_TIMEOUT,\n  markBackgroundTransactions: true,\n  maxTransactionDuration: DEFAULT_MAX_TRANSACTION_DURATION_SECONDS,\n  routingInstrumentation: instrumentRoutingWithDefaults,\n  startTransactionOnLocationChange: true,\n  startTransactionOnPageLoad: true,\n  ...defaultRequestInstrumentationOptions,\n};\n\n/**\n * The Browser Tracing integration automatically instruments browser pageload/navigation\n * actions as transactions, and captures requests, metrics and errors as spans.\n *\n * The integration can be configured with a variety of options, and can be extended to use\n * any routing library. This integration uses {@see IdleTransaction} to create transactions.\n */\nexport class BrowserTracing implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'BrowserTracing';\n\n  /** Browser Tracing integration options */\n  public options: BrowserTracingOptions;\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = BrowserTracing.id;\n\n  private _getCurrentHub?: () => Hub;\n\n  private readonly _metrics: MetricsInstrumentation = new MetricsInstrumentation();\n\n  private readonly _emitOptionsWarning: boolean = false;\n\n  public constructor(_options?: Partial<BrowserTracingOptions>) {\n    let tracingOrigins = defaultRequestInstrumentationOptions.tracingOrigins;\n    // NOTE: Logger doesn't work in constructors, as it's initialized after integrations instances\n    if (\n      _options &&\n      _options.tracingOrigins &&\n      Array.isArray(_options.tracingOrigins) &&\n      _options.tracingOrigins.length !== 0\n    ) {\n      tracingOrigins = _options.tracingOrigins;\n    } else {\n      this._emitOptionsWarning = true;\n    }\n\n    this.options = {\n      ...DEFAULT_BROWSER_TRACING_OPTIONS,\n      ..._options,\n      tracingOrigins,\n    };\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(_: (callback: EventProcessor) => void, getCurrentHub: () => Hub): void {\n    this._getCurrentHub = getCurrentHub;\n\n    if (this._emitOptionsWarning) {\n      logger.warn(\n        '[Tracing] You need to define `tracingOrigins` in the options. Set an array of urls or patterns to trace.',\n      );\n      logger.warn(\n        `[Tracing] We added a reasonable default for you: ${defaultRequestInstrumentationOptions.tracingOrigins}`,\n      );\n    }\n\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const {\n      routingInstrumentation: instrumentRouting,\n      startTransactionOnLocationChange,\n      startTransactionOnPageLoad,\n      markBackgroundTransactions,\n      traceFetch,\n      traceXHR,\n      tracingOrigins,\n      shouldCreateSpanForRequest,\n    } = this.options;\n\n    instrumentRouting(\n      (context: TransactionContext) => this._createRouteTransaction(context),\n      startTransactionOnPageLoad,\n      startTransactionOnLocationChange,\n    );\n\n    if (markBackgroundTransactions) {\n      registerBackgroundTabDetection();\n    }\n\n    instrumentOutgoingRequests({ traceFetch, traceXHR, tracingOrigins, shouldCreateSpanForRequest });\n  }\n\n  /** Create routing idle transaction. */\n  private _createRouteTransaction(context: TransactionContext): Transaction | undefined {\n    if (!this._getCurrentHub) {\n      logger.warn(`[Tracing] Did not create ${context.op} transaction because _getCurrentHub is invalid.`);\n      return undefined;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const { beforeNavigate, idleTimeout, maxTransactionDuration } = this.options;\n\n    const parentContextFromHeader = context.op === 'pageload' ? getHeaderContext() : undefined;\n\n    const expandedContext = {\n      ...context,\n      ...parentContextFromHeader,\n      trimEnd: true,\n    };\n    const modifiedContext = typeof beforeNavigate === 'function' ? beforeNavigate(expandedContext) : expandedContext;\n\n    // For backwards compatibility reasons, beforeNavigate can return undefined to \"drop\" the transaction (prevent it\n    // from being sent to Sentry).\n    const finalContext = modifiedContext === undefined ? { ...expandedContext, sampled: false } : modifiedContext;\n\n    if (finalContext.sampled === false) {\n      logger.log(`[Tracing] Will not send ${finalContext.op} transaction because of beforeNavigate.`);\n    }\n\n    logger.log(`[Tracing] Starting ${finalContext.op} transaction on scope`);\n\n    const hub = this._getCurrentHub();\n    const { location } = getGlobalObject() as WindowOrWorkerGlobalScope & { location: Location };\n\n    const idleTransaction = startIdleTransaction(\n      hub,\n      finalContext,\n      idleTimeout,\n      true,\n      { location }, // for use in the tracesSampler\n    );\n    idleTransaction.registerBeforeFinishCallback((transaction, endTimestamp) => {\n      this._metrics.addPerformanceEntries(transaction);\n      adjustTransactionDuration(secToMs(maxTransactionDuration), transaction, endTimestamp);\n    });\n\n    return idleTransaction as Transaction;\n  }\n}\n\n/**\n * Gets transaction context from a sentry-trace meta.\n *\n * @returns Transaction context data from the header or undefined if there's no header or the header is malformed\n */\nexport function getHeaderContext(): Partial<TransactionContext> | undefined {\n  const header = getMetaContent('sentry-trace');\n  if (header) {\n    return extractTraceparentData(header);\n  }\n\n  return undefined;\n}\n\n/** Returns the value of a meta tag */\nexport function getMetaContent(metaName: string): string | null {\n  const el = document.querySelector(`meta[name=${metaName}]`);\n  return el ? el.getAttribute('content') : null;\n}\n\n/** Adjusts transaction value based on max transaction duration */\nfunction adjustTransactionDuration(maxDuration: number, transaction: IdleTransaction, endTimestamp: number): void {\n  const diff = endTimestamp - transaction.startTimestamp;\n  const isOutdatedTransaction = endTimestamp && (diff > maxDuration || diff < 0);\n  if (isOutdatedTransaction) {\n    transaction.setStatus(SpanStatus.DeadlineExceeded);\n    transaction.setTag('maxTransactionDurationExceeded', 'true');\n  }\n}\n", "export { BrowserTracing } from './browsertracing';\nexport {\n  instrumentOutgoingRequests,\n  RequestInstrumentationOptions,\n  defaultRequestInstrumentationOptions,\n} from './request';\n", "import { Integration, Transaction } from '@sentry/types';\nimport { logger } from '@sentry/utils';\n\ntype Method =\n  | 'all'\n  | 'get'\n  | 'post'\n  | 'put'\n  | 'delete'\n  | 'patch'\n  | 'options'\n  | 'head'\n  | 'checkout'\n  | 'copy'\n  | 'lock'\n  | 'merge'\n  | 'mkactivity'\n  | 'mkcol'\n  | 'move'\n  | 'm-search'\n  | 'notify'\n  | 'purge'\n  | 'report'\n  | 'search'\n  | 'subscribe'\n  | 'trace'\n  | 'unlock'\n  | 'unsubscribe'\n  | 'use';\n\ntype Router = {\n  [method in Method]: (...args: any) => any; // eslint-disable-line @typescript-eslint/no-explicit-any\n};\n\ninterface ExpressResponse {\n  once(name: string, callback: () => void): void;\n}\n\n/**\n * Internal helper for `__sentry_transaction`\n * @hidden\n */\ninterface SentryTracingResponse {\n  __sentry_transaction?: Transaction;\n}\n\n/**\n * Express integration\n *\n * Provides an request and error handler for Express framework as well as tracing capabilities\n */\nexport class Express implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'Express';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = Express.id;\n\n  /**\n   * Express App instance\n   */\n  private readonly _router?: Router;\n  private readonly _methods?: Method[];\n\n  /**\n   * @inheritDoc\n   */\n  public constructor(options: { app?: Router; router?: Router; methods?: Method[] } = {}) {\n    this._router = options.router || options.app;\n    this._methods = (Array.isArray(options.methods) ? options.methods : []).concat('use');\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(): void {\n    if (!this._router) {\n      logger.error('ExpressIntegration is missing an Express instance');\n      return;\n    }\n    instrumentMiddlewares(this._router, this._methods);\n  }\n}\n\n/**\n * Wraps original middleware function in a tracing call, which stores the info about the call as a span,\n * and finishes it once the middleware is done invoking.\n *\n * Express middlewares have 3 various forms, thus we have to take care of all of them:\n * // sync\n * app.use(function (req, res) { ... })\n * // async\n * app.use(function (req, res, next) { ... })\n * // error handler\n * app.use(function (err, req, res, next) { ... })\n *\n * They all internally delegate to the `router[method]` of the given application instance.\n */\n// eslint-disable-next-line @typescript-eslint/ban-types, @typescript-eslint/no-explicit-any\nfunction wrap(fn: Function, method: Method): (...args: any[]) => void {\n  const arity = fn.length;\n\n  switch (arity) {\n    case 2: {\n      return function(this: NodeJS.Global, req: unknown, res: ExpressResponse & SentryTracingResponse): void {\n        const transaction = res.__sentry_transaction;\n        if (transaction) {\n          const span = transaction.startChild({\n            description: fn.name,\n            op: `middleware.${method}`,\n          });\n          res.once('finish', () => {\n            span.finish();\n          });\n        }\n        return fn.call(this, req, res);\n      };\n    }\n    case 3: {\n      return function(\n        this: NodeJS.Global,\n        req: unknown,\n        res: ExpressResponse & SentryTracingResponse,\n        next: () => void,\n      ): void {\n        const transaction = res.__sentry_transaction;\n        const span = transaction?.startChild({\n          description: fn.name,\n          op: `middleware.${method}`,\n        });\n        fn.call(this, req, res, function(this: NodeJS.Global, ...args: unknown[]): void {\n          span?.finish();\n          next.call(this, ...args);\n        });\n      };\n    }\n    case 4: {\n      return function(\n        this: NodeJS.Global,\n        err: Error,\n        req: Request,\n        res: Response & SentryTracingResponse,\n        next: () => void,\n      ): void {\n        const transaction = res.__sentry_transaction;\n        const span = transaction?.startChild({\n          description: fn.name,\n          op: `middleware.${method}`,\n        });\n        fn.call(this, err, req, res, function(this: NodeJS.Global, ...args: unknown[]): void {\n          span?.finish();\n          next.call(this, ...args);\n        });\n      };\n    }\n    default: {\n      throw new Error(`Express middleware takes 2-4 arguments. Got: ${arity}`);\n    }\n  }\n}\n\n/**\n * Takes all the function arguments passed to the original `app` or `router` method, eg. `app.use` or `router.use`\n * and wraps every function, as well as array of functions with a call to our `wrap` method.\n * We have to take care of the arrays as well as iterate over all of the arguments,\n * as `app.use` can accept middlewares in few various forms.\n *\n * app.use([<path>], <fn>)\n * app.use([<path>], <fn>, ...<fn>)\n * app.use([<path>], ...<fn>[])\n */\nfunction wrapMiddlewareArgs(args: unknown[], method: Method): unknown[] {\n  return args.map((arg: unknown) => {\n    if (typeof arg === 'function') {\n      return wrap(arg, method);\n    }\n\n    if (Array.isArray(arg)) {\n      return arg.map((a: unknown) => {\n        if (typeof a === 'function') {\n          return wrap(a, method);\n        }\n        return a;\n      });\n    }\n\n    return arg;\n  });\n}\n\n/**\n * Patches original router to utilize our tracing functionality\n */\nfunction patchMiddleware(router: Router, method: Method): Router {\n  const originalCallback = router[method];\n\n  router[method] = function(...args: unknown[]): void {\n    return originalCallback.call(this, ...wrapMiddlewareArgs(args, method));\n  };\n\n  return router;\n}\n\n/**\n * Patches original router methods\n */\nfunction instrumentMiddlewares(router: Router, methods: Method[] = []): void {\n  methods.forEach((method: Method) => patchMiddleware(router, method));\n}\n", "import { Hub } from '@sentry/hub';\nimport { EventProcessor, Integration } from '@sentry/types';\nimport { fill, isThenable, loadModule, logger } from '@sentry/utils';\n\ninterface PgClient {\n  prototype: {\n    query: () => void | Promise<unknown>;\n  };\n}\n\n/** Tracing integration for node-postgres package */\nexport class Postgres implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'Postgres';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = Postgres.id;\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(_: (callback: EventProcessor) => void, getCurrentHub: () => Hub): void {\n    const pkg = loadModule<{ Client: PgClient }>('pg');\n\n    if (!pkg) {\n      logger.error('Postgres Integration was unable to require `pg` package.');\n      return;\n    }\n\n    /**\n     * function (query, callback) => void\n     * function (query, params, callback) => void\n     * function (query) => Promise\n     * function (query, params) => Promise\n     * function (pg.Cursor) => pg.Cursor\n     */\n    fill(pkg.Client.prototype, 'query', function(orig: () => void | Promise<unknown>) {\n      return function(this: unknown, config: unknown, values: unknown, callback: unknown) {\n        const scope = getCurrentHub().getScope();\n        const parentSpan = scope?.getSpan();\n        const span = parentSpan?.startChild({\n          description: typeof config === 'string' ? config : (config as { text: string }).text,\n          op: `db`,\n        });\n\n        if (typeof callback === 'function') {\n          return orig.call(this, config, values, function(err: Error, result: unknown) {\n            span?.finish();\n            callback(err, result);\n          });\n        }\n\n        if (typeof values === 'function') {\n          return orig.call(this, config, function(err: Error, result: unknown) {\n            span?.finish();\n            values(err, result);\n          });\n        }\n\n        const rv = typeof values !== 'undefined' ? orig.call(this, config, values) : orig.call(this, config);\n\n        if (isThenable(rv)) {\n          return (rv as Promise<unknown>).then((res: unknown) => {\n            span?.finish();\n            return res;\n          });\n        }\n\n        span?.finish();\n        return rv;\n      };\n    });\n  }\n}\n", "import { Hub } from '@sentry/hub';\nimport { EventProcessor, Integration } from '@sentry/types';\nimport { fill, loadModule, logger } from '@sentry/utils';\n\ninterface MysqlConnection {\n  createQuery: () => void;\n}\n\n/** Tracing integration for node-mysql package */\nexport class Mysql implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'Mysql';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = Mysql.id;\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(_: (callback: EventProcessor) => void, getCurrentHub: () => Hub): void {\n    const pkg = loadModule<MysqlConnection>('mysql/lib/Connection.js');\n\n    if (!pkg) {\n      logger.error('Mysql Integration was unable to require `mysql` package.');\n      return;\n    }\n\n    // The original function will have one of these signatures:\n    //    function (callback) => void\n    //    function (options, callback) => void\n    //    function (options, values, callback) => void\n    fill(pkg, 'createQuery', function(orig: () => void) {\n      return function(this: unknown, options: unknown, values: unknown, callback: unknown) {\n        const scope = getCurrentHub().getScope();\n        const parentSpan = scope?.getSpan();\n        const span = parentSpan?.startChild({\n          description: typeof options === 'string' ? options : (options as { sql: string }).sql,\n          op: `db`,\n        });\n\n        if (typeof callback === 'function') {\n          return orig.call(this, options, values, function(err: Error, result: unknown, fields: unknown) {\n            span?.finish();\n            callback(err, result, fields);\n          });\n        }\n\n        if (typeof values === 'function') {\n          return orig.call(this, options, function(err: Error, result: unknown, fields: unknown) {\n            span?.finish();\n            values(err, result, fields);\n          });\n        }\n\n        return orig.call(this, options, values, callback);\n      };\n    });\n  }\n}\n", "import { Hub } from '@sentry/hub';\nimport { EventProcessor, Integration, SpanContext } from '@sentry/types';\nimport { fill, isThenable, loadModule, logger } from '@sentry/utils';\n\n// This allows us to use the same array for both defaults options and the type itself.\n// (note `as const` at the end to make it a union of string literal types (i.e. \"a\" | \"b\" | ... )\n// and not just a string[])\ntype Operation = typeof OPERATIONS[number];\nconst OPERATIONS = [\n  'aggregate', // aggregate(pipeline, options, callback)\n  'bulkWrite', // bulkWrite(operations, options, callback)\n  'countDocuments', // countDocuments(query, options, callback)\n  'createIndex', // createIndex(fieldOrSpec, options, callback)\n  'createIndexes', // createIndexes(indexSpecs, options, callback)\n  'deleteMany', // deleteMany(filter, options, callback)\n  'deleteOne', // deleteOne(filter, options, callback)\n  'distinct', // distinct(key, query, options, callback)\n  'drop', // drop(options, callback)\n  'dropIndex', // dropIndex(indexName, options, callback)\n  'dropIndexes', // dropIndexes(options, callback)\n  'estimatedDocumentCount', // estimatedDocumentCount(options, callback)\n  'find', // find(query, options, callback)\n  'findOne', // findOne(query, options, callback)\n  'findOneAndDelete', // findOneAndDelete(filter, options, callback)\n  'findOneAndReplace', // findOneAndReplace(filter, replacement, options, callback)\n  'findOneAndUpdate', // findOneAndUpdate(filter, update, options, callback)\n  'indexes', // indexes(options, callback)\n  'indexExists', // indexExists(indexes, options, callback)\n  'indexInformation', // indexInformation(options, callback)\n  'initializeOrderedBulkOp', // initializeOrderedBulkOp(options, callback)\n  'insertMany', // insertMany(docs, options, callback)\n  'insertOne', // insertOne(doc, options, callback)\n  'isCapped', // isCapped(options, callback)\n  'mapReduce', // mapReduce(map, reduce, options, callback)\n  'options', // options(options, callback)\n  'parallelCollectionScan', // parallelCollectionScan(options, callback)\n  'rename', // rename(newName, options, callback)\n  'replaceOne', // replaceOne(filter, doc, options, callback)\n  'stats', // stats(options, callback)\n  'updateMany', // updateMany(filter, update, options, callback)\n  'updateOne', // updateOne(filter, update, options, callback)\n] as const;\n\n// All of the operations above take `options` and `callback` as their final parameters, but some of them\n// take additional parameters as well. For those operations, this is a map of\n// { <operation name>:  [<names of additional parameters>] }, as a way to know what to call the operation's\n// positional arguments when we add them to the span's `data` object later\nconst OPERATION_SIGNATURES: {\n  [op in Operation]?: string[];\n} = {\n  // aggregate intentionally not included because `pipeline` arguments are too complex to serialize well\n  // see https://github.com/getsentry/sentry-javascript/pull/3102\n  bulkWrite: ['operations'],\n  countDocuments: ['query'],\n  createIndex: ['fieldOrSpec'],\n  createIndexes: ['indexSpecs'],\n  deleteMany: ['filter'],\n  deleteOne: ['filter'],\n  distinct: ['key', 'query'],\n  dropIndex: ['indexName'],\n  find: ['query'],\n  findOne: ['query'],\n  findOneAndDelete: ['filter'],\n  findOneAndReplace: ['filter', 'replacement'],\n  findOneAndUpdate: ['filter', 'update'],\n  indexExists: ['indexes'],\n  insertMany: ['docs'],\n  insertOne: ['doc'],\n  mapReduce: ['map', 'reduce'],\n  rename: ['newName'],\n  replaceOne: ['filter', 'doc'],\n  updateMany: ['filter', 'update'],\n  updateOne: ['filter', 'update'],\n};\n\ninterface MongoCollection {\n  collectionName: string;\n  dbName: string;\n  namespace: string;\n  prototype: {\n    [operation in Operation]: (...args: unknown[]) => unknown;\n  };\n}\n\ninterface MongoOptions {\n  operations?: Operation[];\n  describeOperations?: boolean | Operation[];\n  useMongoose?: boolean;\n}\n\n/** Tracing integration for mongo package */\nexport class Mongo implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'Mongo';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = Mongo.id;\n\n  private _operations: Operation[];\n  private _describeOperations?: boolean | Operation[];\n  private _useMongoose: boolean;\n\n  /**\n   * @inheritDoc\n   */\n  public constructor(options: MongoOptions = {}) {\n    this._operations = Array.isArray(options.operations)\n      ? options.operations\n      : ((OPERATIONS as unknown) as Operation[]);\n    this._describeOperations = 'describeOperations' in options ? options.describeOperations : true;\n    this._useMongoose = !!options.useMongoose;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(_: (callback: EventProcessor) => void, getCurrentHub: () => Hub): void {\n    const moduleName = this._useMongoose ? 'mongoose' : 'mongodb';\n    const pkg = loadModule<{ Collection: MongoCollection }>(moduleName);\n\n    if (!pkg) {\n      logger.error(`Mongo Integration was unable to require \\`${moduleName}\\` package.`);\n      return;\n    }\n\n    this._instrumentOperations(pkg.Collection, this._operations, getCurrentHub);\n  }\n\n  /**\n   * Patches original collection methods\n   */\n  private _instrumentOperations(collection: MongoCollection, operations: Operation[], getCurrentHub: () => Hub): void {\n    operations.forEach((operation: Operation) => this._patchOperation(collection, operation, getCurrentHub));\n  }\n\n  /**\n   * Patches original collection to utilize our tracing functionality\n   */\n  private _patchOperation(collection: MongoCollection, operation: Operation, getCurrentHub: () => Hub): void {\n    if (!(operation in collection.prototype)) return;\n\n    const getSpanContext = this._getSpanContextFromOperationArguments.bind(this);\n\n    fill(collection.prototype, operation, function(orig: () => void | Promise<unknown>) {\n      return function(this: unknown, ...args: unknown[]) {\n        const lastArg = args[args.length - 1];\n        const scope = getCurrentHub().getScope();\n        const parentSpan = scope?.getSpan();\n\n        // Check if the operation was passed a callback. (mapReduce requires a different check, as\n        // its (non-callback) arguments can also be functions.)\n        if (typeof lastArg !== 'function' || (operation === 'mapReduce' && args.length === 2)) {\n          const span = parentSpan?.startChild(getSpanContext(this, operation, args));\n          const maybePromise = orig.call(this, ...args) as Promise<unknown>;\n\n          if (isThenable(maybePromise)) {\n            return maybePromise.then((res: unknown) => {\n              span?.finish();\n              return res;\n            });\n          } else {\n            span?.finish();\n            return maybePromise;\n          }\n        }\n\n        const span = parentSpan?.startChild(getSpanContext(this, operation, args.slice(0, -1)));\n        return orig.call(this, ...args.slice(0, -1), function(err: Error, result: unknown) {\n          span?.finish();\n          lastArg(err, result);\n        });\n      };\n    });\n  }\n\n  /**\n   * Form a SpanContext based on the user input to a given operation.\n   */\n  private _getSpanContextFromOperationArguments(\n    collection: MongoCollection,\n    operation: Operation,\n    args: unknown[],\n  ): SpanContext {\n    const data: { [key: string]: string } = {\n      collectionName: collection.collectionName,\n      dbName: collection.dbName,\n      namespace: collection.namespace,\n    };\n    const spanContext: SpanContext = {\n      op: `db`,\n      description: operation,\n      data,\n    };\n\n    // If the operation takes no arguments besides `options` and `callback`, or if argument\n    // collection is disabled for this operation, just return early.\n    const signature = OPERATION_SIGNATURES[operation];\n    const shouldDescribe = Array.isArray(this._describeOperations)\n      ? this._describeOperations.includes(operation)\n      : this._describeOperations;\n\n    if (!signature || !shouldDescribe) {\n      return spanContext;\n    }\n\n    try {\n      // Special case for `mapReduce`, as the only one accepting functions as arguments.\n      if (operation === 'mapReduce') {\n        const [map, reduce] = args as { name?: string }[];\n        data[signature[0]] = typeof map === 'string' ? map : map.name || '<anonymous>';\n        data[signature[1]] = typeof reduce === 'string' ? reduce : reduce.name || '<anonymous>';\n      } else {\n        for (let i = 0; i < signature.length; i++) {\n          data[signature[i]] = JSON.stringify(args[i]);\n        }\n      }\n    } catch (_oO) {\n      // no-empty\n    }\n\n    return spanContext;\n  }\n}\n", "export { Express } from './express';\nexport { Postgres } from './postgres';\nexport { Mysql } from './mysql';\nexport { Mongo } from './mongo';\n", "import { BrowserTracing } from './browser';\nimport { addExtensionMethods } from './hubextensions';\nimport * as TracingIntegrations from './integrations';\n\nconst Integrations = { ...TracingIntegrations, BrowserTracing };\n\nexport { Integrations };\nexport { Span } from './span';\nexport { Transaction } from './transaction';\nexport {\n  // TODO deprecate old name in v7\n  instrumentOutgoingRequests as registerRequestInstrumentation,\n  RequestInstrumentationOptions,\n  defaultRequestInstrumentationOptions,\n} from './browser';\nexport { SpanStatus } from './spanstatus';\nexport { IdleTransaction } from './idletransaction';\nexport { startIdleTransaction } from './hubextensions';\n\n// We are patching the global object with our hub extension methods\naddExtensionMethods();\n\nexport { addExtensionMethods };\n\nexport {\n  extractTraceparentData,\n  getActiveTransaction,\n  hasTracingEnabled,\n  stripUrlQueryAndFragment,\n  TRACEPARENT_REGEXP,\n} from './utils';\n", "import { getCurrentHub } from '@sentry/node';\nimport { Integration, Span, Transaction } from '@sentry/types';\nimport { fill } from '@sentry/utils';\n// 'aws-sdk/global' import is expected to be type-only so it's erased in the final .js file.\n// When TypeScript compiler is upgraded, use `import type` syntax to explicitly assert that we don't want to load a module here.\nimport * as AWS from 'aws-sdk/global';\n\ntype GenericParams = { [key: string]: any }; // eslint-disable-line @typescript-eslint/no-explicit-any\ntype MakeRequestCallback<TResult> = (err: AWS.AWSError, data: TResult) => void;\n// This interace could be replaced with just type alias once the `strictBindCallApply` mode is enabled.\ninterface MakeRequestFunction<TParams, TResult> extends CallableFunction {\n  (operation: string, params?: TParams, callback?: MakeRequestCallback<TResult>): AWS.Request<TResult, AWS.AWSError>;\n}\ninterface AWSService {\n  serviceIdentifier: string;\n}\n\n/** AWS service requests tracking */\nexport class AWSServices implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'AWSServices';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = AWSServices.id;\n\n  private readonly _optional: boolean;\n\n  public constructor(options: { optional?: boolean } = {}) {\n    this._optional = options.optional || false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(): void {\n    try {\n      const awsModule = require('aws-sdk/global') as typeof AWS;\n      fill(awsModule.Service.prototype, 'makeRequest', wrapMakeRequest);\n    } catch (e) {\n      if (!this._optional) {\n        throw e;\n      }\n    }\n  }\n}\n\n/** */\nfunction wrapMakeRequest<TService extends AWSService, TResult>(\n  orig: MakeRequestFunction<GenericParams, TResult>,\n): MakeRequestFunction<GenericParams, TResult> {\n  return function(this: TService, operation: string, params?: GenericParams, callback?: MakeRequestCallback<TResult>) {\n    let transaction: Transaction | undefined;\n    let span: Span | undefined;\n    const scope = getCurrentHub().getScope();\n    if (scope) {\n      transaction = scope.getTransaction();\n    }\n    const req = orig.call(this, operation, params);\n    req.on('afterBuild', () => {\n      if (transaction) {\n        span = transaction.startChild({\n          description: describe(this, operation, params),\n          op: 'aws.request',\n        });\n      }\n    });\n    req.on('complete', () => {\n      if (span) {\n        span.finish();\n      }\n    });\n\n    if (callback) {\n      req.send(callback);\n    }\n    return req;\n  };\n}\n\n/** Describes an operation on generic AWS service */\nfunction describe<TService extends AWSService>(service: TService, operation: string, params?: GenericParams): string {\n  let ret = `aws.${service.serviceIdentifier}.${operation}`;\n  if (params === undefined) {\n    return ret;\n  }\n  switch (service.serviceIdentifier) {\n    case 's3':\n      ret += describeS3Operation(operation, params);\n      break;\n    case 'lambda':\n      ret += describeLambdaOperation(operation, params);\n      break;\n  }\n  return ret;\n}\n\n/** Describes an operation on AWS Lambda service */\nfunction describeLambdaOperation(_operation: string, params: GenericParams): string {\n  let ret = '';\n  if ('FunctionName' in params) {\n    ret += ` ${params.FunctionName}`;\n  }\n  return ret;\n}\n\n/** Describes an operation on AWS S3 service */\nfunction describeS3Operation(_operation: string, params: GenericParams): string {\n  let ret = '';\n  if ('Bucket' in params) {\n    ret += ` ${params.Bucket}`;\n  }\n  return ret;\n}\n", "import { Event } from '@sentry/node';\nimport { addExceptionMechanism } from '@sentry/utils';\nimport * as domain from 'domain';\n\n/**\n * Event processor that will override SDK details to point to the serverless SDK instead of Node,\n * as well as set correct mechanism type, which should be set to `handled: false`.\n * We do it like this, so that we don't introduce any side-effects in this module, which makes it tree-shakeable.\n * @param event Event\n * @param integration Name of the serverless integration ('AWSLambda', 'GCPFunction', etc)\n */\nexport function serverlessEventProcessor(event: Event): Event {\n  addExceptionMechanism(event, {\n    handled: false,\n  });\n\n  return event;\n}\n\n/**\n * @returns Current active domain with a correct type.\n */\nexport function getActiveDomain(): domain.Domain | null {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-member-access\n  return (domain as any).active as domain.Domain | null;\n}\n\n/**\n * @param fn function to run\n * @returns function which runs in the newly created domain or in the existing one\n */\nexport function domainify<A extends unknown[], R>(fn: (...args: A) => R): (...args: A) => R | void {\n  return (...args) => {\n    if (getActiveDomain()) {\n      return fn(...args);\n    }\n    const dom = domain.create();\n    return dom.run(() => fn(...args));\n  };\n}\n\n/**\n * @param source function to be wrapped\n * @param wrap wrapping function that takes source and returns a wrapper\n * @param overrides properties to override in the source\n * @returns wrapped function\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function proxyFunction<A extends any[], R, F extends (...args: A) => R>(\n  source: F,\n  wrap: (source: F) => F,\n  overrides?: Record<PropertyKey, unknown>,\n): F {\n  const wrapper = wrap(source);\n  const handler: ProxyHandler<F> = {\n    apply: <T>(_target: F, thisArg: T, args: A) => {\n      return wrapper.apply(thisArg, args);\n    },\n  };\n\n  if (overrides) {\n    handler.get = (target, prop) => {\n      // eslint-disable-next-line no-prototype-builtins\n      if (overrides.hasOwnProperty(prop)) {\n        return overrides[prop as string];\n      }\n      return (target as Record<PropertyKey, unknown>)[prop as string];\n    };\n  }\n\n  return new Proxy(source, handler);\n}\n", "import {\n  captureException,\n  captureMessage,\n  flush,\n  getCurrentHub,\n  Scope,\n  Severity,\n  startTransaction,\n  withScope,\n} from '@sentry/node';\nimport * as Sentry from '@sentry/node';\nimport { extractTraceparentData } from '@sentry/tracing';\nimport { Integration } from '@sentry/types';\nimport { isString, logger } from '@sentry/utils';\n// NOTE: I have no idea how to fix this right now, and don't want to waste more time, as it builds just fine \u2014 Kamil\n// eslint-disable-next-line import/no-unresolved\nimport { Context, Handler } from 'aws-lambda';\nimport { existsSync } from 'fs';\nimport { hostname } from 'os';\nimport { basename, resolve } from 'path';\nimport { performance } from 'perf_hooks';\nimport { types } from 'util';\n\nimport { AWSServices } from './awsservices';\nimport { serverlessEventProcessor } from './utils';\n\nexport * from '@sentry/node';\n\nconst { isPromise } = types;\n\n// https://www.npmjs.com/package/aws-lambda-consumer\ntype SyncHandler<T extends Handler> = (\n  event: Parameters<T>[0],\n  context: Parameters<T>[1],\n  callback: Parameters<T>[2],\n) => void;\n\nexport type AsyncHandler<T extends Handler> = (\n  event: Parameters<T>[0],\n  context: Parameters<T>[1],\n) => Promise<NonNullable<Parameters<Parameters<T>[2]>[1]>>;\n\nexport interface WrapperOptions {\n  flushTimeout: number;\n  rethrowAfterCapture: boolean;\n  callbackWaitsForEmptyEventLoop: boolean;\n  captureTimeoutWarning: boolean;\n  timeoutWarningLimit: number;\n}\n\nexport const defaultIntegrations: Integration[] = [...Sentry.defaultIntegrations, new AWSServices({ optional: true })];\n\n/**\n * @see {@link Sentry.init}\n */\nexport function init(options: Sentry.NodeOptions = {}): void {\n  if (options.defaultIntegrations === undefined) {\n    options.defaultIntegrations = defaultIntegrations;\n  }\n\n  options._metadata = options._metadata || {};\n  options._metadata.sdk = {\n    name: 'sentry.javascript.serverless',\n    integrations: ['AWSLambda'],\n    packages: [\n      {\n        name: 'npm:@sentry/serverless',\n        version: Sentry.SDK_VERSION,\n      },\n    ],\n    version: Sentry.SDK_VERSION,\n  };\n\n  Sentry.init(options);\n  Sentry.addGlobalEventProcessor(serverlessEventProcessor);\n}\n\n/** */\nfunction tryRequire<T>(taskRoot: string, subdir: string, mod: string): T {\n  const lambdaStylePath = resolve(taskRoot, subdir, mod);\n  if (existsSync(lambdaStylePath) || existsSync(`${lambdaStylePath}.js`)) {\n    // Lambda-style path\n    return require(lambdaStylePath);\n  }\n  // Node-style path\n  return require(require.resolve(mod, { paths: [taskRoot, subdir] }));\n}\n\n/** */\nexport function tryPatchHandler(taskRoot: string, handlerPath: string): void {\n  type HandlerBag = HandlerModule | Handler | null | undefined;\n  interface HandlerModule {\n    [key: string]: HandlerBag;\n  }\n\n  const handlerDesc = basename(handlerPath);\n  const match = handlerDesc.match(/^([^.]*)\\.(.*)$/);\n  if (!match) {\n    logger.error(`Bad handler ${handlerDesc}`);\n    return;\n  }\n\n  const [, handlerMod, handlerName] = match;\n\n  let obj: HandlerBag;\n  try {\n    const handlerDir = handlerPath.substring(0, handlerPath.indexOf(handlerDesc));\n    obj = tryRequire(taskRoot, handlerDir, handlerMod);\n  } catch (e) {\n    logger.error(`Cannot require ${handlerPath} in ${taskRoot}`, e);\n    return;\n  }\n\n  let mod: HandlerBag;\n  let functionName: string | undefined;\n  handlerName.split('.').forEach(name => {\n    mod = obj;\n    obj = obj && (obj as HandlerModule)[name];\n    functionName = name;\n  });\n  if (!obj) {\n    logger.error(`${handlerPath} is undefined or not exported`);\n    return;\n  }\n  if (typeof obj !== 'function') {\n    logger.error(`${handlerPath} is not a function`);\n    return;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  (mod as HandlerModule)[functionName!] = wrapHandler(obj as Handler);\n}\n\n/**\n * Tries to invoke context.getRemainingTimeInMillis if not available returns 0\n * Some environments use AWS lambda but don't support this function\n * @param context\n */\nfunction tryGetRemainingTimeInMillis(context: Context): number {\n  return typeof context.getRemainingTimeInMillis === 'function' ? context.getRemainingTimeInMillis() : 0;\n}\n\n/**\n * Adds additional information from the environment and AWS Context to the Sentry Scope.\n *\n * @param scope Scope that should be enhanced\n * @param context AWS Lambda context that will be used to extract some part of the data\n * @param startTime performance.now() when wrapHandler was invoked\n */\nfunction enhanceScopeWithEnvironmentData(scope: Scope, context: Context, startTime: number): void {\n  scope.setTransactionName(context.functionName);\n\n  scope.setTag('server_name', process.env._AWS_XRAY_DAEMON_ADDRESS || process.env.SENTRY_NAME || hostname());\n  scope.setTag('url', `awslambda:///${context.functionName}`);\n\n  scope.setContext('runtime', {\n    name: 'node',\n    version: global.process.version,\n  });\n\n  scope.setContext('aws.lambda', {\n    aws_request_id: context.awsRequestId,\n    function_name: context.functionName,\n    function_version: context.functionVersion,\n    invoked_function_arn: context.invokedFunctionArn,\n    execution_duration_in_millis: performance.now() - startTime,\n    remaining_time_in_millis: tryGetRemainingTimeInMillis(context),\n    'sys.argv': process.argv,\n  });\n\n  scope.setContext('aws.cloudwatch.logs', {\n    log_group: context.logGroupName,\n    log_stream: context.logStreamName,\n    url: `https://console.aws.amazon.com/cloudwatch/home?region=${\n      process.env.AWS_REGION\n    }#logsV2:log-groups/log-group/${encodeURIComponent(context.logGroupName)}/log-events/${encodeURIComponent(\n      context.logStreamName,\n    )}`,\n  });\n}\n\n/**\n * Wraps a lambda handler adding it error capture and tracing capabilities.\n *\n * @param handler Handler\n * @param options Options\n * @returns Handler\n */\nexport function wrapHandler<TEvent, TResult>(\n  handler: Handler<TEvent, TResult>,\n  wrapOptions: Partial<WrapperOptions> = {},\n): Handler<TEvent, TResult | undefined> {\n  const START_TIME = performance.now();\n  const options: WrapperOptions = {\n    flushTimeout: 2000,\n    rethrowAfterCapture: true,\n    callbackWaitsForEmptyEventLoop: false,\n    captureTimeoutWarning: true,\n    timeoutWarningLimit: 500,\n    ...wrapOptions,\n  };\n  let timeoutWarningTimer: NodeJS.Timeout;\n\n  // AWSLambda is like Express. It makes a distinction about handlers based on it's last argument\n  // async (event) => async handler\n  // async (event, context) => async handler\n  // (event, context, callback) => sync handler\n  // Nevertheless whatever option is chosen by user, we convert it to async handler.\n  const asyncHandler: AsyncHandler<typeof handler> =\n    handler.length > 2\n      ? (event, context) =>\n          new Promise((resolve, reject) => {\n            const rv = (handler as SyncHandler<typeof handler>)(event, context, (error, result) => {\n              if (error === null || error === undefined) {\n                resolve(result!); // eslint-disable-line @typescript-eslint/no-non-null-assertion\n              } else {\n                reject(error);\n              }\n            }) as unknown;\n\n            // This should never happen, but still can if someone writes a handler as\n            // `async (event, context, callback) => {}`\n            if (isPromise(rv)) {\n              void (rv as Promise<NonNullable<TResult>>).then(resolve, reject);\n            }\n          })\n      : (handler as AsyncHandler<typeof handler>);\n\n  return async (event, context) => {\n    context.callbackWaitsForEmptyEventLoop = options.callbackWaitsForEmptyEventLoop;\n\n    // In seconds. You cannot go any more granular than this in AWS Lambda.\n    const configuredTimeout = Math.ceil(tryGetRemainingTimeInMillis(context) / 1000);\n    const configuredTimeoutMinutes = Math.floor(configuredTimeout / 60);\n    const configuredTimeoutSeconds = configuredTimeout % 60;\n\n    const humanReadableTimeout =\n      configuredTimeoutMinutes > 0\n        ? `${configuredTimeoutMinutes}m${configuredTimeoutSeconds}s`\n        : `${configuredTimeoutSeconds}s`;\n\n    // When `callbackWaitsForEmptyEventLoop` is set to false, which it should when using `captureTimeoutWarning`,\n    // we don't have a guarantee that this message will be delivered. Because of that, we don't flush it.\n    if (options.captureTimeoutWarning) {\n      const timeoutWarningDelay = tryGetRemainingTimeInMillis(context) - options.timeoutWarningLimit;\n\n      timeoutWarningTimer = setTimeout(() => {\n        withScope(scope => {\n          scope.setTag('timeout', humanReadableTimeout);\n          captureMessage(`Possible function timeout: ${context.functionName}`, Severity.Warning);\n        });\n      }, timeoutWarningDelay);\n    }\n\n    // Applying `sentry-trace` to context\n    let traceparentData;\n    const eventWithHeaders = event as { headers?: { [key: string]: string } };\n    if (eventWithHeaders.headers && isString(eventWithHeaders.headers['sentry-trace'])) {\n      traceparentData = extractTraceparentData(eventWithHeaders.headers['sentry-trace'] as string);\n    }\n    const transaction = startTransaction({\n      name: context.functionName,\n      op: 'awslambda.handler',\n      ...traceparentData,\n    });\n\n    const hub = getCurrentHub();\n    const scope = hub.pushScope();\n    let rv: TResult | undefined;\n    try {\n      enhanceScopeWithEnvironmentData(scope, context, START_TIME);\n      // We put the transaction on the scope so users can attach children to it\n      scope.setSpan(transaction);\n      rv = await asyncHandler(event, context);\n    } catch (e) {\n      captureException(e);\n      if (options.rethrowAfterCapture) {\n        throw e;\n      }\n    } finally {\n      clearTimeout(timeoutWarningTimer);\n      transaction.finish();\n      hub.popScope();\n      await flush(options.flushTimeout);\n    }\n    return rv;\n  };\n}\n", "import { getCurrentHub } from '@sentry/node';\nimport { Integration, Span, Transaction } from '@sentry/types';\nimport { fill } from '@sentry/utils';\nimport { EventEmitter } from 'events';\n\ninterface GrpcFunction extends CallableFunction {\n  (...args: unknown[]): EventEmitter;\n}\n\ninterface GrpcFunctionObject extends GrpcFunction {\n  requestStream: boolean;\n  responseStream: boolean;\n  originalName: string;\n}\n\ninterface StubOptions {\n  servicePath?: string;\n}\n\ninterface CreateStubFunc extends CallableFunction {\n  (createStub: unknown, options: StubOptions): PromiseLike<Stub>;\n}\n\ninterface Stub {\n  [key: string]: GrpcFunctionObject;\n}\n\n/** Google Cloud Platform service requests tracking for GRPC APIs */\nexport class GoogleCloudGrpc implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'GoogleCloudGrpc';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = GoogleCloudGrpc.id;\n\n  private readonly _optional: boolean;\n\n  public constructor(options: { optional?: boolean } = {}) {\n    this._optional = options.optional || false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(): void {\n    try {\n      const gaxModule = require('google-gax');\n      fill(\n        gaxModule.GrpcClient.prototype, // eslint-disable-line @typescript-eslint/no-unsafe-member-access\n        'createStub',\n        wrapCreateStub,\n      );\n    } catch (e) {\n      if (!this._optional) {\n        throw e;\n      }\n    }\n  }\n}\n\n/** Returns a wrapped function that returns a stub with tracing enabled */\nfunction wrapCreateStub(origCreate: CreateStubFunc): CreateStubFunc {\n  return async function(this: unknown, ...args: Parameters<CreateStubFunc>) {\n    const servicePath = args[1]?.servicePath;\n    if (servicePath == null || servicePath == undefined) {\n      return origCreate.apply(this, args);\n    }\n    const serviceIdentifier = identifyService(servicePath);\n    const stub = await origCreate.apply(this, args);\n    for (const methodName of Object.keys(Object.getPrototypeOf(stub))) {\n      fillGrpcFunction(stub, serviceIdentifier, methodName);\n    }\n    return stub;\n  };\n}\n\n/** Patches the function in grpc stub to enable tracing */\nfunction fillGrpcFunction(stub: Stub, serviceIdentifier: string, methodName: string): void {\n  const funcObj = stub[methodName];\n  if (typeof funcObj !== 'function') {\n    return;\n  }\n  const callType =\n    !funcObj.requestStream && !funcObj.responseStream\n      ? 'unary call'\n      : funcObj.requestStream && !funcObj.responseStream\n      ? 'client stream'\n      : !funcObj.requestStream && funcObj.responseStream\n      ? 'server stream'\n      : 'bidi stream';\n  if (callType != 'unary call') {\n    return;\n  }\n  fill(\n    stub,\n    methodName,\n    (orig: GrpcFunction): GrpcFunction => (...args) => {\n      const ret = orig.apply(stub, args);\n      if (typeof ret?.on !== 'function') {\n        return ret;\n      }\n      let transaction: Transaction | undefined;\n      let span: Span | undefined;\n      const scope = getCurrentHub().getScope();\n      if (scope) {\n        transaction = scope.getTransaction();\n      }\n      if (transaction) {\n        span = transaction.startChild({\n          description: `${callType} ${methodName}`,\n          op: `gcloud.grpc.${serviceIdentifier}`,\n        });\n      }\n      ret.on('status', () => {\n        if (span) {\n          span.finish();\n        }\n      });\n      return ret;\n    },\n  );\n}\n\n/** Identifies service by its address */\nfunction identifyService(servicePath: string): string {\n  const match = servicePath.match(/^(\\w+)\\.googleapis.com$/);\n  return match ? match[1] : servicePath;\n}\n", "// '@google-cloud/common' import is expected to be type-only so it's erased in the final .js file.\n// When TypeScript compiler is upgraded, use `import type` syntax to explicitly assert that we don't want to load a module here.\nimport * as common from '@google-cloud/common';\nimport { getCurrentHub } from '@sentry/node';\nimport { Integration, Span, Transaction } from '@sentry/types';\nimport { fill } from '@sentry/utils';\n\ntype RequestOptions = common.DecorateRequestOptions;\ntype ResponseCallback = common.BodyResponseCallback;\n// This interace could be replaced with just type alias once the `strictBindCallApply` mode is enabled.\ninterface RequestFunction extends CallableFunction {\n  (reqOpts: RequestOptions, callback: ResponseCallback): void;\n}\n\n/** Google Cloud Platform service requests tracking for RESTful APIs */\nexport class GoogleCloudHttp implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'GoogleCloudHttp';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = GoogleCloudHttp.id;\n\n  private readonly _optional: boolean;\n\n  public constructor(options: { optional?: boolean } = {}) {\n    this._optional = options.optional || false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(): void {\n    try {\n      const commonModule = require('@google-cloud/common') as typeof common;\n      fill(commonModule.Service.prototype, 'request', wrapRequestFunction);\n    } catch (e) {\n      if (!this._optional) {\n        throw e;\n      }\n    }\n  }\n}\n\n/** Returns a wrapped function that makes a request with tracing enabled */\nfunction wrapRequestFunction(orig: RequestFunction): RequestFunction {\n  return function(this: common.Service, reqOpts: RequestOptions, callback: ResponseCallback): void {\n    let transaction: Transaction | undefined;\n    let span: Span | undefined;\n    const scope = getCurrentHub().getScope();\n    if (scope) {\n      transaction = scope.getTransaction();\n    }\n    if (transaction) {\n      const httpMethod = reqOpts.method || 'GET';\n      span = transaction.startChild({\n        description: `${httpMethod} ${reqOpts.uri}`,\n        op: `gcloud.http.${identifyService(this.apiEndpoint)}`,\n      });\n    }\n    orig.call(this, reqOpts, (...args: Parameters<ResponseCallback>) => {\n      if (span) {\n        span.finish();\n      }\n      callback(...args);\n    });\n  };\n}\n\n/** Identifies service by its base url */\nfunction identifyService(apiEndpoint: string): string {\n  const match = apiEndpoint.match(/^https:\\/\\/(\\w+)\\.googleapis.com$/);\n  return match ? match[1] : apiEndpoint.replace(/^(http|https)?:\\/\\//, '');\n}\n", "import { captureException, flush, getCurrentHub, Handlers, startTransaction } from '@sentry/node';\nimport { extractTraceparentData } from '@sentry/tracing';\nimport { isString, logger, stripUrlQueryAndFragment } from '@sentry/utils';\n\nimport { domainify, getActiveDomain, proxyFunction } from './../utils';\nimport { HttpFunction, WrapperOptions } from './general';\n\ntype ParseRequestOptions = Handlers.ParseRequestOptions;\n\nexport interface HttpFunctionWrapperOptions extends WrapperOptions {\n  parseRequestOptions: ParseRequestOptions;\n}\n\nconst { parseRequest } = Handlers;\n\n/**\n * Wraps an HTTP function handler adding it error capture and tracing capabilities.\n *\n * @param fn HTTP Handler\n * @param options Options\n * @returns HTTP handler\n */\nexport function wrapHttpFunction(\n  fn: HttpFunction,\n  wrapOptions: Partial<HttpFunctionWrapperOptions> = {},\n): HttpFunction {\n  const wrap = (f: HttpFunction): HttpFunction => domainify(_wrapHttpFunction(f, wrapOptions));\n\n  let overrides: Record<PropertyKey, unknown> | undefined;\n\n  // Functions emulator from firebase-tools has a hack-ish workaround that saves the actual function\n  // passed to `onRequest(...)` and in fact runs it so we need to wrap it too.\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-member-access\n  const emulatorFunc = (fn as any).__emulator_func as HttpFunction | undefined;\n  if (emulatorFunc) {\n    overrides = { __emulator_func: proxyFunction(emulatorFunc, wrap) };\n  }\n  return proxyFunction(fn, wrap, overrides);\n}\n\n/** */\nfunction _wrapHttpFunction(fn: HttpFunction, wrapOptions: Partial<HttpFunctionWrapperOptions> = {}): HttpFunction {\n  const options: HttpFunctionWrapperOptions = {\n    flushTimeout: 2000,\n    parseRequestOptions: {},\n    ...wrapOptions,\n  };\n  return (req, res) => {\n    const reqMethod = (req.method || '').toUpperCase();\n    const reqUrl = stripUrlQueryAndFragment(req.originalUrl || req.url || '');\n\n    // Applying `sentry-trace` to context\n    let traceparentData;\n    const reqWithHeaders = req as { headers?: { [key: string]: string } };\n    if (reqWithHeaders.headers && isString(reqWithHeaders.headers['sentry-trace'])) {\n      traceparentData = extractTraceparentData(reqWithHeaders.headers['sentry-trace'] as string);\n    }\n    const transaction = startTransaction({\n      name: `${reqMethod} ${reqUrl}`,\n      op: 'gcp.function.http',\n      ...traceparentData,\n    });\n\n    // getCurrentHub() is expected to use current active domain as a carrier\n    // since functions-framework creates a domain for each incoming request.\n    // So adding of event processors every time should not lead to memory bloat.\n    getCurrentHub().configureScope(scope => {\n      scope.addEventProcessor(event => parseRequest(event, req, options.parseRequestOptions));\n      // We put the transaction on the scope so users can attach children to it\n      scope.setSpan(transaction);\n    });\n\n    // We also set __sentry_transaction on the response so people can grab the transaction there to add\n    // spans to it later.\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-member-access\n    (res as any).__sentry_transaction = transaction;\n\n    // functions-framework creates a domain for each incoming request so we take advantage of this fact and add an error handler.\n    // BTW this is the only way to catch any exception occured during request lifecycle.\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    getActiveDomain()!.on('error', err => {\n      captureException(err);\n    });\n\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const _end = res.end;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    res.end = function(chunk?: any | (() => void), encoding?: string | (() => void), cb?: () => void): void {\n      transaction.setHttpStatus(res.statusCode);\n      transaction.finish();\n\n      void flush(options.flushTimeout)\n        .then(() => {\n          _end.call(this, chunk, encoding, cb);\n        })\n        .then(null, e => {\n          logger.error(e);\n        });\n    };\n\n    return fn(req, res);\n  };\n}\n", "import { Scope } from '@sentry/node';\nimport { Context as SentryContext } from '@sentry/types';\nimport { Request, Response } from 'express'; // eslint-disable-line import/no-extraneous-dependencies\nimport { hostname } from 'os';\n\nexport interface HttpFunction {\n  (req: Request, res: Response): any; // eslint-disable-line @typescript-eslint/no-explicit-any\n}\n\nexport interface EventFunction {\n  (data: Record<string, any>, context: Context): any; // eslint-disable-line @typescript-eslint/no-explicit-any\n}\n\nexport interface EventFunctionWithCallback {\n  (data: Record<string, any>, context: Context, callback: Function): any; // eslint-disable-line @typescript-eslint/no-explicit-any, @typescript-eslint/ban-types\n}\n\nexport interface CloudEventFunction {\n  (cloudevent: CloudEventsContext): any; // eslint-disable-line @typescript-eslint/no-explicit-any\n}\n\nexport interface CloudEventFunctionWithCallback {\n  (cloudevent: CloudEventsContext, callback: Function): any; // eslint-disable-line @typescript-eslint/no-explicit-any, @typescript-eslint/ban-types\n}\n\nexport interface CloudFunctionsContext {\n  eventId?: string;\n  timestamp?: string;\n  eventType?: string;\n  resource?: string;\n}\n\nexport interface CloudEventsContext {\n  [key: string]: any; // eslint-disable-line @typescript-eslint/no-explicit-any\n  type?: string;\n  specversion?: string;\n  source?: string;\n  id?: string;\n  time?: string;\n  schemaurl?: string;\n  contenttype?: string;\n}\n\nexport type Context = CloudFunctionsContext | CloudEventsContext;\n\nexport interface WrapperOptions {\n  flushTimeout: number;\n}\n\n/**\n * Enhances the scope with additional event information.\n *\n * @param scope scope\n * @param context event context\n */\nexport function configureScopeWithContext(scope: Scope, context: Context): void {\n  scope.setContext('runtime', {\n    name: 'node',\n    version: global.process.version,\n  });\n  scope.setTag('server_name', process.env.SENTRY_NAME || hostname());\n  scope.setContext('gcp.function.context', { ...context } as SentryContext);\n}\n\nexport { Request, Response };\n", "import { captureException, flush, getCurrentHub, startTransaction } from '@sentry/node';\nimport { logger } from '@sentry/utils';\n\nimport { domainify, getActiveDomain, proxyFunction } from '../utils';\nimport { configureScopeWithContext, EventFunction, EventFunctionWithCallback, WrapperOptions } from './general';\n\nexport type EventFunctionWrapperOptions = WrapperOptions;\n\n/**\n * Wraps an event function handler adding it error capture and tracing capabilities.\n *\n * @param fn Event handler\n * @param options Options\n * @returns Event handler\n */\nexport function wrapEventFunction(\n  fn: EventFunction | EventFunctionWithCallback,\n  wrapOptions: Partial<EventFunctionWrapperOptions> = {},\n): EventFunctionWithCallback {\n  return proxyFunction(fn, f => domainify(_wrapEventFunction(f, wrapOptions)));\n}\n\n/** */\nfunction _wrapEventFunction(\n  fn: EventFunction | EventFunctionWithCallback,\n  wrapOptions: Partial<EventFunctionWrapperOptions> = {},\n): EventFunctionWithCallback {\n  const options: EventFunctionWrapperOptions = {\n    flushTimeout: 2000,\n    ...wrapOptions,\n  };\n  return (data, context, callback) => {\n    const transaction = startTransaction({\n      name: context.eventType,\n      op: 'gcp.function.event',\n    });\n\n    // getCurrentHub() is expected to use current active domain as a carrier\n    // since functions-framework creates a domain for each incoming request.\n    // So adding of event processors every time should not lead to memory bloat.\n    getCurrentHub().configureScope(scope => {\n      configureScopeWithContext(scope, context);\n      // We put the transaction on the scope so users can attach children to it\n      scope.setSpan(transaction);\n    });\n\n    const activeDomain = getActiveDomain()!; // eslint-disable-line @typescript-eslint/no-non-null-assertion\n\n    activeDomain.on('error', captureException);\n\n    const newCallback = activeDomain.bind((...args: unknown[]) => {\n      if (args[0] !== null && args[0] !== undefined) {\n        captureException(args[0]);\n      }\n      transaction.finish();\n\n      void flush(options.flushTimeout)\n        .then(() => {\n          callback(...args);\n        })\n        .then(null, e => {\n          logger.error(e);\n        });\n    });\n\n    if (fn.length > 2) {\n      return (fn as EventFunctionWithCallback)(data, context, newCallback);\n    }\n\n    return Promise.resolve()\n      .then(() => (fn as EventFunction)(data, context))\n      .then(\n        result => newCallback(null, result),\n        err => newCallback(err, undefined),\n      );\n  };\n}\n", "import { captureException, flush, getCurrentHub, startTransaction } from '@sentry/node';\nimport { logger } from '@sentry/utils';\n\nimport { domainify, getActiveDomain, proxyFunction } from '../utils';\nimport {\n  CloudEventFunction,\n  CloudEventFunctionWithCallback,\n  configureScopeWithContext,\n  WrapperOptions,\n} from './general';\n\nexport type CloudEventFunctionWrapperOptions = WrapperOptions;\n\n/**\n * Wraps an event function handler adding it error capture and tracing capabilities.\n *\n * @param fn Event handler\n * @param options Options\n * @returns Event handler\n */\nexport function wrapCloudEventFunction(\n  fn: CloudEventFunction | CloudEventFunctionWithCallback,\n  wrapOptions: Partial<CloudEventFunctionWrapperOptions> = {},\n): CloudEventFunctionWithCallback {\n  return proxyFunction(fn, f => domainify(_wrapCloudEventFunction(f, wrapOptions)));\n}\n\n/** */\nfunction _wrapCloudEventFunction(\n  fn: CloudEventFunction | CloudEventFunctionWithCallback,\n  wrapOptions: Partial<CloudEventFunctionWrapperOptions> = {},\n): CloudEventFunctionWithCallback {\n  const options: CloudEventFunctionWrapperOptions = {\n    flushTimeout: 2000,\n    ...wrapOptions,\n  };\n  return (context, callback) => {\n    const transaction = startTransaction({\n      name: context.type || '<unknown>',\n      op: 'gcp.function.cloud_event',\n    });\n\n    // getCurrentHub() is expected to use current active domain as a carrier\n    // since functions-framework creates a domain for each incoming request.\n    // So adding of event processors every time should not lead to memory bloat.\n    getCurrentHub().configureScope(scope => {\n      configureScopeWithContext(scope, context);\n      // We put the transaction on the scope so users can attach children to it\n      scope.setSpan(transaction);\n    });\n\n    const activeDomain = getActiveDomain()!; // eslint-disable-line @typescript-eslint/no-non-null-assertion\n\n    activeDomain.on('error', captureException);\n\n    const newCallback = activeDomain.bind((...args: unknown[]) => {\n      if (args[0] !== null && args[0] !== undefined) {\n        captureException(args[0]);\n      }\n      transaction.finish();\n\n      void flush(options.flushTimeout)\n        .then(() => {\n          callback(...args);\n        })\n        .then(null, e => {\n          logger.error(e);\n        });\n    });\n\n    if (fn.length > 1) {\n      return (fn as CloudEventFunctionWithCallback)(context, newCallback);\n    }\n\n    return Promise.resolve()\n      .then(() => (fn as CloudEventFunction)(context))\n      .then(\n        result => newCallback(null, result),\n        err => newCallback(err, undefined),\n      );\n  };\n}\n", "import * as Sentry from '@sentry/node';\nimport { Integration } from '@sentry/types';\n\nimport { GoogleCloudGrpc } from '../google-cloud-grpc';\nimport { GoogleCloudHttp } from '../google-cloud-http';\nimport { serverlessEventProcessor } from '../utils';\n\nexport * from './http';\nexport * from './events';\nexport * from './cloud_events';\n\nexport const defaultIntegrations: Integration[] = [\n  ...Sentry.defaultIntegrations,\n  new GoogleCloudHttp({ optional: true }), // We mark this integration optional since '@google-cloud/common' module could be missing.\n  new GoogleCloudGrpc({ optional: true }), // We mark this integration optional since 'google-gax' module could be missing.\n];\n\n/**\n * @see {@link Sentry.init}\n */\nexport function init(options: Sentry.NodeOptions = {}): void {\n  if (options.defaultIntegrations === undefined) {\n    options.defaultIntegrations = defaultIntegrations;\n  }\n\n  options._metadata = options._metadata || {};\n  options._metadata.sdk = {\n    name: 'sentry.javascript.serverless',\n    integrations: ['GCPFunction'],\n    packages: [\n      {\n        name: 'npm:@sentry/serverless',\n        version: Sentry.SDK_VERSION,\n      },\n    ],\n    version: Sentry.SDK_VERSION,\n  };\n\n  Sentry.init(options);\n  Sentry.addGlobalEventProcessor(serverlessEventProcessor);\n}\n", "// https://medium.com/unsplash/named-namespace-imports-7345212bbffb\nimport * as AWSLambda from './awslambda';\nimport * as GCPFunction from './gcpfunction';\nexport { AWSLambda, GCPFunction };\n\nexport * from './awsservices';\nexport * from '@sentry/node';\n", "function printExpires(expires){\n    if(!expires) return false;\n    if(typeof expires == 'string') expires = new Date(expires);\n    if(typeof expires == 'number') expires = new Date(expires);\n    var n = ( expires.valueOf() - (new Date()).valueOf() ) / 1000;\n    return 'Expires='+expires.toGMTString()+';Max-Age='+Math.round( n );\n}\n\nvar cookie = {\n    stringify: function( obj ){\n        var value;\n        try{\n            value = encodeURIComponent(obj.value);\n        }catch(e){\n            value = obj.value;\n        }\n        return [\n\n            obj.name+'='+value,\n            ( typeof obj.expires != 'undefined' && obj.expires ? printExpires(obj.expires) : '' ),\n            ( typeof obj.path != 'undefined' ? (obj.path ? 'Path='+obj.path : '') : 'Path=/' ),\n            ( typeof obj.domain != 'undefined' && obj.domain ? 'Domain='+obj.domain : '' ),\n            ( typeof obj.secure != 'undefined' && obj.secure ? 'secure' : '' ),\n            ( typeof obj.httponly != 'undefined' && obj.httponly ? 'HttpOnly' : '' ),\n            ( typeof obj.samesite != 'undefined' && obj.samesite ? 'SameSite=' + obj.samesite : '')\n\n        ].join(';').replace(/;+/g,';').replace(/;$/,'').replace(/;/g,'; ');\n    },\n    parse: function( string, path, domain ){\n        var s = string.replace(/;\\s+/g,';').split(';')\n            .map(function(s){return s.replace(/\\s+\\s+/g,'=').split('=');});\n\n        var n = s.shift();\n\n        var obj = {};\n        obj.expires = false;\n        obj.httponly = false;\n        obj.secure = false;\n        obj.path = path || '/';\n        obj.domain = domain || '';\n        obj.samesite = '';\n\n        var I, f = {\n            httponly: function(){ obj.httponly = true; },\n            secure: function(){ obj.secure = true; },\n            expires: function(v){ obj.expires = new Date(v); },\n            'max-age': function(v){ if(obj.expires) return; obj.expires = new Date((new Date()).valueOf()+(v*1000)); },\n            path: function(v){ obj.path = v; },\n            domain: function(v){ obj.domain = v; },\n            samesite: function(v) { obj.samesite = v; }\n        };\n\n        for(var i in s) {\n            I = s[i][0].toLowerCase();\n            if( typeof f[I] != 'undefined' ) f[I]( s[i].length==2 ? s[i][1] : '' );\n        }\n\n        if( !obj.expires ) obj.expires = 0;\n        obj.name = n.shift();\n        n = n.map((s) => {\n            var f;\n            try{\n                f = decodeURIComponent(s)\n            }catch(e){ f = s }\n            return s\n        })\n        \n        obj.value = n.join('=');\n        return obj;\n    },\n    tokenize: function( array ){\n        return array.map(function(s){ return s.name+'='+s.value; }).join('; ');\n    }\n};\n\nmodule.exports = exports = cookie;\n", "function _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nmodule.exports = _interopRequireDefault;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;", "module.exports.KEYOBJECT = Symbol('KEYOBJECT')\nmodule.exports.PRIVATE_MEMBERS = Symbol('PRIVATE_MEMBERS')\nmodule.exports.PUBLIC_MEMBERS = Symbol('PUBLIC_MEMBERS')\nmodule.exports.THUMBPRINT_MATERIAL = Symbol('THUMBPRINT_MATERIAL')\nmodule.exports.JWK_MEMBERS = Symbol('JWK_MEMBERS')\nmodule.exports.KEY_MANAGEMENT_ENCRYPT = Symbol('KEY_MANAGEMENT_ENCRYPT')\nmodule.exports.KEY_MANAGEMENT_DECRYPT = Symbol('KEY_MANAGEMENT_DECRYPT')\n\nconst USES_MAPPING = {\n  sig: new Set(['sign', 'verify']),\n  enc: new Set(['encrypt', 'decrypt', 'wrapKey', 'unwrapKey', 'deriveKey'])\n}\nconst OPS = new Set([...USES_MAPPING.sig, ...USES_MAPPING.enc])\nconst USES = new Set(Object.keys(USES_MAPPING))\n\nmodule.exports.USES_MAPPING = USES_MAPPING\nmodule.exports.OPS = OPS\nmodule.exports.USES = USES\n", "const { deprecate } = require('util')\n\nconst deprecation = deprecate(() => {}, '\"P-256K\" EC curve name is deprecated')\n\nmodule.exports = {\n  name: 'secp256k1',\n  rename (value) {\n    if (value !== 'secp256k1') {\n      deprecation()\n    }\n    module.exports.name = value\n  }\n}\n", "const { getCurves } = require('crypto')\n\nconst { name: secp256k1 } = require('../jwk/key/secp256k1_crv')\n\nconst curves = new Set()\n\nif (getCurves().includes('prime256v1')) {\n  curves.add('P-256')\n}\n\nif (getCurves().includes('secp256k1')) {\n  curves.add(secp256k1)\n}\n\nif (getCurves().includes('secp384r1')) {\n  curves.add('P-384')\n}\n\nif (getCurves().includes('secp521r1')) {\n  curves.add('P-521')\n}\n\nmodule.exports = curves\n", "module.exports = new Map([\n  ['A128CBC-HS256', 128],\n  ['A128GCM', 96],\n  ['A128GCMKW', 96],\n  ['A192CBC-HS384', 128],\n  ['A192GCM', 96],\n  ['A192GCMKW', 96],\n  ['A256CBC-HS512', 128],\n  ['A256GCM', 96],\n  ['A256GCMKW', 96]\n])\n", "module.exports = {\n  sign: new Map(),\n  verify: new Map(),\n  keyManagementEncrypt: new Map(),\n  keyManagementDecrypt: new Map(),\n  encrypt: new Map(),\n  decrypt: new Map()\n}\n", "module.exports = {\n  oct: {\n    decrypt: {},\n    deriveKey: {},\n    encrypt: {},\n    sign: {},\n    unwrapKey: {},\n    verify: {},\n    wrapKey: {}\n  },\n  EC: {\n    decrypt: {},\n    deriveKey: {},\n    encrypt: {},\n    sign: {},\n    unwrapKey: {},\n    verify: {},\n    wrapKey: {}\n  },\n  RSA: {\n    decrypt: {},\n    deriveKey: {},\n    encrypt: {},\n    sign: {},\n    unwrapKey: {},\n    verify: {},\n    wrapKey: {}\n  },\n  OKP: {\n    decrypt: {},\n    deriveKey: {},\n    encrypt: {},\n    sign: {},\n    unwrapKey: {},\n    verify: {},\n    wrapKey: {}\n  }\n}\n", "module.exports = new Map([\n  ['A128CBC-HS256', 256],\n  ['A128GCM', 128],\n  ['A192CBC-HS384', 384],\n  ['A192GCM', 192],\n  ['A256CBC-HS512', 512],\n  ['A256GCM', 256]\n])\n", "const curves = new Set(['Ed25519'])\n\nif (!('electron' in process.versions)) {\n  curves.add('Ed448')\n  curves.add('X25519')\n  curves.add('X448')\n}\n\nmodule.exports = curves\n", "module.exports = new Map()\n", "const EC_CURVES = require('./ec_curves')\nconst IVLENGTHS = require('./iv_lengths')\nconst JWA = require('./jwa')\nconst JWK = require('./jwk')\nconst KEYLENGTHS = require('./key_lengths')\nconst OKP_CURVES = require('./okp_curves')\nconst ECDH_DERIVE_LENGTHS = require('./ecdh_derive_lengths')\n\nmodule.exports = {\n  EC_CURVES,\n  ECDH_DERIVE_LENGTHS,\n  IVLENGTHS,\n  JWA,\n  JWK,\n  KEYLENGTHS,\n  OKP_CURVES\n}\n", "const { randomBytes } = require('crypto')\n\nconst { IVLENGTHS } = require('../registry')\n\nmodule.exports = alg => randomBytes(IVLENGTHS.get(alg) / 8)\n", "/* global BigInt */\n\nconst fromBase64 = (base64) => {\n  return base64.replace(/=/g, '').replace(/\\+/g, '-').replace(/\\//g, '_')\n}\n\nconst encode = (input, encoding = 'utf8') => {\n  return fromBase64(Buffer.from(input, encoding).toString('base64'))\n}\n\nconst encodeBuffer = (buf) => {\n  return fromBase64(buf.toString('base64'))\n}\n\nconst decodeToBuffer = (input) => {\n  return Buffer.from(input, 'base64')\n}\n\nconst decode = (input, encoding = 'utf8') => {\n  return decodeToBuffer(input).toString(encoding)\n}\n\nconst b64uJSON = {\n  encode: (input) => {\n    return encode(JSON.stringify(input))\n  },\n  decode: (input, encoding = 'utf8') => {\n    return JSON.parse(decode(input, encoding))\n  }\n}\n\nb64uJSON.decode.try = (input, encoding = 'utf8') => {\n  try {\n    return b64uJSON.decode(input, encoding)\n  } catch (err) {\n    return decode(input, encoding)\n  }\n}\n\nconst bnToBuf = (bn) => {\n  let hex = BigInt(bn).toString(16)\n  if (hex.length % 2) {\n    hex = `0${hex}`\n  }\n\n  const len = hex.length / 2\n  const u8 = new Uint8Array(len)\n\n  let i = 0\n  let j = 0\n  while (i < len) {\n    u8[i] = parseInt(hex.slice(j, j + 2), 16)\n    i += 1\n    j += 2\n  }\n\n  return u8\n}\n\nconst encodeBigInt = (bn) => encodeBuffer(Buffer.from(bnToBuf(bn)))\n\nmodule.exports.decode = decode\nmodule.exports.decodeToBuffer = decodeToBuffer\nmodule.exports.encode = encode\nmodule.exports.encodeBuffer = encodeBuffer\nmodule.exports.JSON = b64uJSON\nmodule.exports.encodeBigInt = encodeBigInt\n", "const CODES = {\n  JOSEAlgNotWhitelisted: 'ERR_JOSE_ALG_NOT_WHITELISTED',\n  JOSECritNotUnderstood: 'ERR_JOSE_CRIT_NOT_UNDERSTOOD',\n  JOSEInvalidEncoding: 'ERR_JOSE_INVALID_ENCODING',\n  JOSEMultiError: 'ERR_JOSE_MULTIPLE_ERRORS',\n  JOSENotSupported: 'ERR_JOSE_NOT_SUPPORTED',\n  JWEDecryptionFailed: 'ERR_JWE_DECRYPTION_FAILED',\n  JWEInvalid: 'ERR_JWE_INVALID',\n  JWKImportFailed: 'ERR_JWK_IMPORT_FAILED',\n  JWKInvalid: 'ERR_JWK_INVALID',\n  JWKKeySupport: 'ERR_JWK_KEY_SUPPORT',\n  JWKSNoMatchingKey: 'ERR_JWKS_NO_MATCHING_KEY',\n  JWSInvalid: 'ERR_JWS_INVALID',\n  JWSVerificationFailed: 'ERR_JWS_VERIFICATION_FAILED',\n  JWTClaimInvalid: 'ERR_JWT_CLAIM_INVALID',\n  JWTExpired: 'ERR_JWT_EXPIRED',\n  JWTMalformed: 'ERR_JWT_MALFORMED'\n}\n\nconst DEFAULT_MESSAGES = {\n  JWEDecryptionFailed: 'decryption operation failed',\n  JWEInvalid: 'JWE invalid',\n  JWKSNoMatchingKey: 'no matching key found in the KeyStore',\n  JWSInvalid: 'JWS invalid',\n  JWSVerificationFailed: 'signature verification failed'\n}\n\nclass JOSEError extends Error {\n  constructor (message) {\n    super(message)\n    if (message === undefined) {\n      this.message = DEFAULT_MESSAGES[this.constructor.name]\n    }\n    this.name = this.constructor.name\n    this.code = CODES[this.constructor.name]\n    Error.captureStackTrace(this, this.constructor)\n  }\n}\n\nconst isMulti = e => e instanceof JOSEMultiError\nclass JOSEMultiError extends JOSEError {\n  constructor (errors) {\n    super()\n    let i\n    while ((i = errors.findIndex(isMulti)) && i !== -1) {\n      errors.splice(i, 1, ...errors[i])\n    }\n    Object.defineProperty(this, 'errors', { value: errors })\n  }\n\n  * [Symbol.iterator] () {\n    for (const error of this.errors) {\n      yield error\n    }\n  }\n}\nmodule.exports.JOSEError = JOSEError\n\nmodule.exports.JOSEAlgNotWhitelisted = class JOSEAlgNotWhitelisted extends JOSEError {}\nmodule.exports.JOSECritNotUnderstood = class JOSECritNotUnderstood extends JOSEError {}\nmodule.exports.JOSEInvalidEncoding = class JOSEInvalidEncoding extends JOSEError {}\nmodule.exports.JOSEMultiError = JOSEMultiError\nmodule.exports.JOSENotSupported = class JOSENotSupported extends JOSEError {}\n\nmodule.exports.JWEDecryptionFailed = class JWEDecryptionFailed extends JOSEError {}\nmodule.exports.JWEInvalid = class JWEInvalid extends JOSEError {}\n\nmodule.exports.JWKImportFailed = class JWKImportFailed extends JOSEError {}\nmodule.exports.JWKInvalid = class JWKInvalid extends JOSEError {}\nmodule.exports.JWKKeySupport = class JWKKeySupport extends JOSEError {}\n\nmodule.exports.JWKSNoMatchingKey = class JWKSNoMatchingKey extends JOSEError {}\n\nmodule.exports.JWSInvalid = class JWSInvalid extends JOSEError {}\nmodule.exports.JWSVerificationFailed = class JWSVerificationFailed extends JOSEError {}\n\nclass JWTClaimInvalid extends JOSEError {\n  constructor (message, claim = 'unspecified', reason = 'unspecified') {\n    super(message)\n    this.claim = claim\n    this.reason = reason\n  }\n}\nmodule.exports.JWTClaimInvalid = JWTClaimInvalid\nmodule.exports.JWTExpired = class JWTExpired extends JWTClaimInvalid {}\nmodule.exports.JWTMalformed = class JWTMalformed extends JOSEError {}\n", "const { diffieHellman, KeyObject, sign, verify } = require('crypto')\n\nconst [major, minor] = process.version.substr(1).split('.').map(x => parseInt(x, 10))\n\nmodule.exports = {\n  oaepHashSupported: major > 12 || (major === 12 && minor >= 9),\n  keyObjectSupported: !!KeyObject && major >= 12,\n  edDSASupported: !!sign && !!verify,\n  dsaEncodingSupported: major > 13 || (major === 13 && minor >= 2) || (major === 12 && minor >= 16),\n  improvedDH: !!diffieHellman\n}\n", "module.exports = a => !!a && a.constructor === Object\n", "const { inherits } = require('util')\n\nfunction Reporter (options) {\n  this._reporterState = {\n    obj: null,\n    path: [],\n    options: options || {},\n    errors: []\n  }\n}\n\nReporter.prototype.isError = function isError (obj) {\n  return obj instanceof ReporterError\n}\n\nReporter.prototype.save = function save () {\n  const state = this._reporterState\n\n  return { obj: state.obj, pathLen: state.path.length }\n}\n\nReporter.prototype.restore = function restore (data) {\n  const state = this._reporterState\n\n  state.obj = data.obj\n  state.path = state.path.slice(0, data.pathLen)\n}\n\nReporter.prototype.enterKey = function enterKey (key) {\n  return this._reporterState.path.push(key)\n}\n\nReporter.prototype.exitKey = function exitKey (index) {\n  const state = this._reporterState\n\n  state.path = state.path.slice(0, index - 1)\n}\n\nReporter.prototype.leaveKey = function leaveKey (index, key, value) {\n  const state = this._reporterState\n\n  this.exitKey(index)\n  if (state.obj !== null) { state.obj[key] = value }\n}\n\nReporter.prototype.path = function path () {\n  return this._reporterState.path.join('/')\n}\n\nReporter.prototype.enterObject = function enterObject () {\n  const state = this._reporterState\n\n  const prev = state.obj\n  state.obj = {}\n  return prev\n}\n\nReporter.prototype.leaveObject = function leaveObject (prev) {\n  const state = this._reporterState\n\n  const now = state.obj\n  state.obj = prev\n  return now\n}\n\nReporter.prototype.error = function error (msg) {\n  let err\n  const state = this._reporterState\n\n  const inherited = msg instanceof ReporterError\n  if (inherited) {\n    err = msg\n  } else {\n    err = new ReporterError(state.path.map(function (elem) {\n      return `[${JSON.stringify(elem)}]`\n    }).join(''), msg.message || msg, msg.stack)\n  }\n\n  if (!state.options.partial) { throw err }\n\n  if (!inherited) { state.errors.push(err) }\n\n  return err\n}\n\nReporter.prototype.wrapResult = function wrapResult (result) {\n  const state = this._reporterState\n  if (!state.options.partial) { return result }\n\n  return {\n    result: this.isError(result) ? null : result,\n    errors: state.errors\n  }\n}\n\nfunction ReporterError (path, msg) {\n  this.path = path\n  this.rethrow(msg)\n}\ninherits(ReporterError, Error)\n\nReporterError.prototype.rethrow = function rethrow (msg) {\n  this.message = `${msg} at: ${this.path || '(shallow)'}`\n  if (Error.captureStackTrace) { Error.captureStackTrace(this, ReporterError) }\n\n  if (!this.stack) {\n    try {\n      // IE only adds stack when thrown\n      throw new Error(this.message)\n    } catch (e) {\n      this.stack = e.stack\n    }\n  }\n  return this\n}\n\nexports.Reporter = Reporter\n", "const { inherits } = require('util')\n\nconst { Reporter } = require('../base/reporter')\n\nfunction DecoderBuffer (base, options) {\n  Reporter.call(this, options)\n  if (!Buffer.isBuffer(base)) {\n    this.error('Input not Buffer')\n    return\n  }\n\n  this.base = base\n  this.offset = 0\n  this.length = base.length\n}\ninherits(DecoderBuffer, Reporter)\n\nDecoderBuffer.isDecoderBuffer = function isDecoderBuffer (data) {\n  if (data instanceof DecoderBuffer) {\n    return true\n  }\n\n  // Or accept compatible API\n  const isCompatible = typeof data === 'object' &&\n    Buffer.isBuffer(data.base) &&\n    data.constructor.name === 'DecoderBuffer' &&\n    typeof data.offset === 'number' &&\n    typeof data.length === 'number' &&\n    typeof data.save === 'function' &&\n    typeof data.restore === 'function' &&\n    typeof data.isEmpty === 'function' &&\n    typeof data.readUInt8 === 'function' &&\n    typeof data.skip === 'function' &&\n    typeof data.raw === 'function'\n\n  return isCompatible\n}\n\nDecoderBuffer.prototype.save = function save () {\n  return { offset: this.offset, reporter: Reporter.prototype.save.call(this) }\n}\n\nDecoderBuffer.prototype.restore = function restore (save) {\n  // Return skipped data\n  const res = new DecoderBuffer(this.base)\n  res.offset = save.offset\n  res.length = this.offset\n\n  this.offset = save.offset\n  Reporter.prototype.restore.call(this, save.reporter)\n\n  return res\n}\n\nDecoderBuffer.prototype.isEmpty = function isEmpty () {\n  return this.offset === this.length\n}\n\nDecoderBuffer.prototype.readUInt8 = function readUInt8 (fail) {\n  if (this.offset + 1 <= this.length) { return this.base.readUInt8(this.offset++, true) } else { return this.error(fail || 'DecoderBuffer overrun') }\n}\n\nDecoderBuffer.prototype.skip = function skip (bytes, fail) {\n  if (!(this.offset + bytes <= this.length)) { return this.error(fail || 'DecoderBuffer overrun') }\n\n  const res = new DecoderBuffer(this.base)\n\n  // Share reporter state\n  res._reporterState = this._reporterState\n\n  res.offset = this.offset\n  res.length = this.offset + bytes\n  this.offset += bytes\n  return res\n}\n\nDecoderBuffer.prototype.raw = function raw (save) {\n  return this.base.slice(save ? save.offset : this.offset, this.length)\n}\n\nfunction EncoderBuffer (value, reporter) {\n  if (Array.isArray(value)) {\n    this.length = 0\n    this.value = value.map(function (item) {\n      if (!EncoderBuffer.isEncoderBuffer(item)) { item = new EncoderBuffer(item, reporter) }\n      this.length += item.length\n      return item\n    }, this)\n  } else if (typeof value === 'number') {\n    if (!(value >= 0 && value <= 0xff)) { return reporter.error('non-byte EncoderBuffer value') }\n    this.value = value\n    this.length = 1\n  } else if (typeof value === 'string') {\n    this.value = value\n    this.length = Buffer.byteLength(value)\n  } else if (Buffer.isBuffer(value)) {\n    this.value = value\n    this.length = value.length\n  } else {\n    return reporter.error(`Unsupported type: ${typeof value}`)\n  }\n}\n\nEncoderBuffer.isEncoderBuffer = function isEncoderBuffer (data) {\n  if (data instanceof EncoderBuffer) {\n    return true\n  }\n\n  // Or accept compatible API\n  const isCompatible = typeof data === 'object' &&\n    data.constructor.name === 'EncoderBuffer' &&\n    typeof data.length === 'number' &&\n    typeof data.join === 'function'\n\n  return isCompatible\n}\n\nEncoderBuffer.prototype.join = function join (out, offset) {\n  if (!out) { out = Buffer.alloc(this.length) }\n  if (!offset) { offset = 0 }\n\n  if (this.length === 0) { return out }\n\n  if (Array.isArray(this.value)) {\n    this.value.forEach(function (item) {\n      item.join(out, offset)\n      offset += item.length\n    })\n  } else {\n    if (typeof this.value === 'number') { out[offset] = this.value } else if (typeof this.value === 'string') { out.write(this.value, offset) } else if (Buffer.isBuffer(this.value)) { this.value.copy(out, offset) }\n    offset += this.length\n  }\n\n  return out\n}\n\nmodule.exports = {\n  DecoderBuffer,\n  EncoderBuffer\n}\n", "const { strict: assert } = require('assert')\n\nconst { Reporter } = require('../base/reporter')\nconst { DecoderBuffer, EncoderBuffer } = require('../base/buffer')\n\n// Supported tags\nconst tags = [\n  'seq', 'seqof', 'set', 'setof', 'objid', 'bool',\n  'gentime', 'utctime', 'null_', 'enum', 'int', 'objDesc',\n  'bitstr', 'bmpstr', 'charstr', 'genstr', 'graphstr', 'ia5str', 'iso646str',\n  'numstr', 'octstr', 'printstr', 't61str', 'unistr', 'utf8str', 'videostr'\n]\n\n// Public methods list\nconst methods = [\n  'key', 'obj', 'use', 'optional', 'explicit', 'implicit', 'def', 'choice',\n  'any', 'contains'\n].concat(tags)\n\n// Overrided methods list\nconst overrided = [\n  '_peekTag', '_decodeTag', '_use',\n  '_decodeStr', '_decodeObjid', '_decodeTime',\n  '_decodeNull', '_decodeInt', '_decodeBool', '_decodeList',\n\n  '_encodeComposite', '_encodeStr', '_encodeObjid', '_encodeTime',\n  '_encodeNull', '_encodeInt', '_encodeBool'\n]\n\nfunction Node (enc, parent, name) {\n  const state = {}\n  this._baseState = state\n\n  state.name = name\n  state.enc = enc\n\n  state.parent = parent || null\n  state.children = null\n\n  // State\n  state.tag = null\n  state.args = null\n  state.reverseArgs = null\n  state.choice = null\n  state.optional = false\n  state.any = false\n  state.obj = false\n  state.use = null\n  state.useDecoder = null\n  state.key = null\n  state.default = null\n  state.explicit = null\n  state.implicit = null\n  state.contains = null\n\n  // Should create new instance on each method\n  if (!state.parent) {\n    state.children = []\n    this._wrap()\n  }\n}\n\nconst stateProps = [\n  'enc', 'parent', 'children', 'tag', 'args', 'reverseArgs', 'choice',\n  'optional', 'any', 'obj', 'use', 'alteredUse', 'key', 'default', 'explicit',\n  'implicit', 'contains'\n]\n\nNode.prototype.clone = function clone () {\n  const state = this._baseState\n  const cstate = {}\n  stateProps.forEach(function (prop) {\n    cstate[prop] = state[prop]\n  })\n  const res = new this.constructor(cstate.parent)\n  res._baseState = cstate\n  return res\n}\n\nNode.prototype._wrap = function wrap () {\n  const state = this._baseState\n  methods.forEach(function (method) {\n    this[method] = function _wrappedMethod () {\n      const clone = new this.constructor(this)\n      state.children.push(clone)\n      return clone[method].apply(clone, arguments)\n    }\n  }, this)\n}\n\nNode.prototype._init = function init (body) {\n  const state = this._baseState\n\n  assert(state.parent === null)\n  body.call(this)\n\n  // Filter children\n  state.children = state.children.filter(function (child) {\n    return child._baseState.parent === this\n  }, this)\n  assert.equal(state.children.length, 1, 'Root node can have only one child')\n}\n\nNode.prototype._useArgs = function useArgs (args) {\n  const state = this._baseState\n\n  // Filter children and args\n  const children = args.filter(function (arg) {\n    return arg instanceof this.constructor\n  }, this)\n  args = args.filter(function (arg) {\n    return !(arg instanceof this.constructor)\n  }, this)\n\n  if (children.length !== 0) {\n    assert(state.children === null)\n    state.children = children\n\n    // Replace parent to maintain backward link\n    children.forEach(function (child) {\n      child._baseState.parent = this\n    }, this)\n  }\n  if (args.length !== 0) {\n    assert(state.args === null)\n    state.args = args\n    state.reverseArgs = args.map(function (arg) {\n      if (typeof arg !== 'object' || arg.constructor !== Object) { return arg }\n\n      const res = {}\n      Object.keys(arg).forEach(function (key) {\n        if (key == (key | 0)) { key |= 0 } // eslint-disable-line eqeqeq\n        const value = arg[key]\n        res[value] = key\n      })\n      return res\n    })\n  }\n}\n\n//\n// Overrided methods\n//\n\noverrided.forEach(function (method) {\n  Node.prototype[method] = function _overrided () {\n    const state = this._baseState\n    throw new Error(`${method} not implemented for encoding: ${state.enc}`)\n  }\n})\n\n//\n// Public methods\n//\n\ntags.forEach(function (tag) {\n  Node.prototype[tag] = function _tagMethod () {\n    const state = this._baseState\n    const args = Array.prototype.slice.call(arguments)\n\n    assert(state.tag === null)\n    state.tag = tag\n\n    this._useArgs(args)\n\n    return this\n  }\n})\n\nNode.prototype.use = function use (item) {\n  assert(item)\n  const state = this._baseState\n\n  assert(state.use === null)\n  state.use = item\n\n  return this\n}\n\nNode.prototype.optional = function optional () {\n  const state = this._baseState\n\n  state.optional = true\n\n  return this\n}\n\nNode.prototype.def = function def (val) {\n  const state = this._baseState\n\n  assert(state.default === null)\n  state.default = val\n  state.optional = true\n\n  return this\n}\n\nNode.prototype.explicit = function explicit (num) {\n  const state = this._baseState\n\n  assert(state.explicit === null && state.implicit === null)\n  state.explicit = num\n\n  return this\n}\n\nNode.prototype.implicit = function implicit (num) {\n  const state = this._baseState\n\n  assert(state.explicit === null && state.implicit === null)\n  state.implicit = num\n\n  return this\n}\n\nNode.prototype.obj = function obj () {\n  const state = this._baseState\n  const args = Array.prototype.slice.call(arguments)\n\n  state.obj = true\n\n  if (args.length !== 0) { this._useArgs(args) }\n\n  return this\n}\n\nNode.prototype.key = function key (newKey) {\n  const state = this._baseState\n\n  assert(state.key === null)\n  state.key = newKey\n\n  return this\n}\n\nNode.prototype.any = function any () {\n  const state = this._baseState\n\n  state.any = true\n\n  return this\n}\n\nNode.prototype.choice = function choice (obj) {\n  const state = this._baseState\n\n  assert(state.choice === null)\n  state.choice = obj\n  this._useArgs(Object.keys(obj).map(function (key) {\n    return obj[key]\n  }))\n\n  return this\n}\n\nNode.prototype.contains = function contains (item) {\n  const state = this._baseState\n\n  assert(state.use === null)\n  state.contains = item\n\n  return this\n}\n\n//\n// Decoding\n//\n\nNode.prototype._decode = function decode (input, options) {\n  const state = this._baseState\n\n  // Decode root node\n  if (state.parent === null) { return input.wrapResult(state.children[0]._decode(input, options)) }\n\n  let result = state.default\n  let present = true\n\n  let prevKey = null\n  if (state.key !== null) { prevKey = input.enterKey(state.key) }\n\n  // Check if tag is there\n  if (state.optional) {\n    let tag = null\n    if (state.explicit !== null) { tag = state.explicit } else if (state.implicit !== null) { tag = state.implicit } else if (state.tag !== null) { tag = state.tag }\n\n    if (tag === null && !state.any) {\n      // Trial and Error\n      const save = input.save()\n      try {\n        if (state.choice === null) { this._decodeGeneric(state.tag, input, options) } else { this._decodeChoice(input, options) }\n        present = true\n      } catch (e) {\n        present = false\n      }\n      input.restore(save)\n    } else {\n      present = this._peekTag(input, tag, state.any)\n\n      if (input.isError(present)) { return present }\n    }\n  }\n\n  // Push object on stack\n  let prevObj\n  if (state.obj && present) { prevObj = input.enterObject() }\n\n  if (present) {\n    // Unwrap explicit values\n    if (state.explicit !== null) {\n      const explicit = this._decodeTag(input, state.explicit)\n      if (input.isError(explicit)) { return explicit }\n      input = explicit\n    }\n\n    const start = input.offset\n\n    // Unwrap implicit and normal values\n    if (state.use === null && state.choice === null) {\n      let save\n      if (state.any) { save = input.save() }\n      const body = this._decodeTag(\n        input,\n        state.implicit !== null ? state.implicit : state.tag,\n        state.any\n      )\n      if (input.isError(body)) { return body }\n\n      if (state.any) { result = input.raw(save) } else { input = body }\n    }\n\n    if (options && options.track && state.tag !== null) { options.track(input.path(), start, input.length, 'tagged') }\n\n    if (options && options.track && state.tag !== null) { options.track(input.path(), input.offset, input.length, 'content') }\n\n    // Select proper method for tag\n    if (state.any) {\n      // no-op\n    } else if (state.choice === null) {\n      result = this._decodeGeneric(state.tag, input, options)\n    } else {\n      result = this._decodeChoice(input, options)\n    }\n\n    if (input.isError(result)) { return result }\n\n    // Decode children\n    if (!state.any && state.choice === null && state.children !== null) {\n      state.children.forEach(function decodeChildren (child) {\n        // NOTE: We are ignoring errors here, to let parser continue with other\n        // parts of encoded data\n        child._decode(input, options)\n      })\n    }\n\n    // Decode contained/encoded by schema, only in bit or octet strings\n    if (state.contains && (state.tag === 'octstr' || state.tag === 'bitstr')) {\n      const data = new DecoderBuffer(result)\n      result = this._getUse(state.contains, input._reporterState.obj)\n        ._decode(data, options)\n    }\n  }\n\n  // Pop object\n  if (state.obj && present) { result = input.leaveObject(prevObj) }\n\n  // Set key\n  if (state.key !== null && (result !== null || present === true)) { input.leaveKey(prevKey, state.key, result) } else if (prevKey !== null) { input.exitKey(prevKey) }\n\n  return result\n}\n\nNode.prototype._decodeGeneric = function decodeGeneric (tag, input, options) {\n  const state = this._baseState\n\n  if (tag === 'seq' || tag === 'set') { return null }\n  if (tag === 'seqof' || tag === 'setof') { return this._decodeList(input, tag, state.args[0], options) } else if (/str$/.test(tag)) { return this._decodeStr(input, tag, options) } else if (tag === 'objid' && state.args) { return this._decodeObjid(input, state.args[0], state.args[1], options) } else if (tag === 'objid') { return this._decodeObjid(input, null, null, options) } else if (tag === 'gentime' || tag === 'utctime') { return this._decodeTime(input, tag, options) } else if (tag === 'null_') { return this._decodeNull(input, options) } else if (tag === 'bool') { return this._decodeBool(input, options) } else if (tag === 'objDesc') { return this._decodeStr(input, tag, options) } else if (tag === 'int' || tag === 'enum') { return this._decodeInt(input, state.args && state.args[0], options) }\n\n  if (state.use !== null) {\n    return this._getUse(state.use, input._reporterState.obj)\n      ._decode(input, options)\n  } else {\n    return input.error(`unknown tag: ${tag}`)\n  }\n}\n\nNode.prototype._getUse = function _getUse (entity, obj) {\n  const state = this._baseState\n  // Create altered use decoder if implicit is set\n  state.useDecoder = this._use(entity, obj)\n  assert(state.useDecoder._baseState.parent === null)\n  state.useDecoder = state.useDecoder._baseState.children[0]\n  if (state.implicit !== state.useDecoder._baseState.implicit) {\n    state.useDecoder = state.useDecoder.clone()\n    state.useDecoder._baseState.implicit = state.implicit\n  }\n  return state.useDecoder\n}\n\nNode.prototype._decodeChoice = function decodeChoice (input, options) {\n  const state = this._baseState\n  let result = null\n  let match = false\n\n  Object.keys(state.choice).some(function (key) {\n    const save = input.save()\n    const node = state.choice[key]\n    try {\n      const value = node._decode(input, options)\n      if (input.isError(value)) { return false }\n\n      result = { type: key, value: value }\n      match = true\n    } catch (e) {\n      input.restore(save)\n      return false\n    }\n    return true\n  }, this)\n\n  if (!match) { return input.error('Choice not matched') }\n\n  return result\n}\n\n//\n// Encoding\n//\n\nNode.prototype._createEncoderBuffer = function createEncoderBuffer (data) {\n  return new EncoderBuffer(data, this.reporter)\n}\n\nNode.prototype._encode = function encode (data, reporter, parent) {\n  const state = this._baseState\n  if (state.default !== null && state.default === data) { return }\n\n  const result = this._encodeValue(data, reporter, parent)\n  if (result === undefined) { return }\n\n  if (this._skipDefault(result, reporter, parent)) { return }\n\n  return result\n}\n\nNode.prototype._encodeValue = function encode (data, reporter, parent) {\n  const state = this._baseState\n\n  // Decode root node\n  if (state.parent === null) { return state.children[0]._encode(data, reporter || new Reporter()) }\n\n  let result = null\n\n  // Set reporter to share it with a child class\n  this.reporter = reporter\n\n  // Check if data is there\n  if (state.optional && data === undefined) {\n    if (state.default !== null) { data = state.default } else { return }\n  }\n\n  // Encode children first\n  let content = null\n  let primitive = false\n  if (state.any) {\n    // Anything that was given is translated to buffer\n    result = this._createEncoderBuffer(data)\n  } else if (state.choice) {\n    result = this._encodeChoice(data, reporter)\n  } else if (state.contains) {\n    content = this._getUse(state.contains, parent)._encode(data, reporter)\n    primitive = true\n  } else if (state.children) {\n    content = state.children.map(function (child) {\n      if (child._baseState.tag === 'null_') { return child._encode(null, reporter, data) }\n\n      if (child._baseState.key === null) { return reporter.error('Child should have a key') }\n      const prevKey = reporter.enterKey(child._baseState.key)\n\n      if (typeof data !== 'object') { return reporter.error('Child expected, but input is not object') }\n\n      const res = child._encode(data[child._baseState.key], reporter, data)\n      reporter.leaveKey(prevKey)\n\n      return res\n    }, this).filter(function (child) {\n      return child\n    })\n    content = this._createEncoderBuffer(content)\n  } else {\n    if (state.tag === 'seqof' || state.tag === 'setof') {\n      if (!(state.args && state.args.length === 1)) { return reporter.error(`Too many args for: ${state.tag}`) }\n\n      if (!Array.isArray(data)) { return reporter.error('seqof/setof, but data is not Array') }\n\n      const child = this.clone()\n      child._baseState.implicit = null\n      content = this._createEncoderBuffer(data.map(function (item) {\n        const state = this._baseState\n\n        return this._getUse(state.args[0], data)._encode(item, reporter)\n      }, child))\n    } else if (state.use !== null) {\n      result = this._getUse(state.use, parent)._encode(data, reporter)\n    } else {\n      content = this._encodePrimitive(state.tag, data)\n      primitive = true\n    }\n  }\n\n  // Encode data itself\n  if (!state.any && state.choice === null) {\n    const tag = state.implicit !== null ? state.implicit : state.tag\n    const cls = state.implicit === null ? 'universal' : 'context'\n\n    if (tag === null) {\n      if (state.use === null) { reporter.error('Tag could be omitted only for .use()') }\n    } else {\n      if (state.use === null) { result = this._encodeComposite(tag, primitive, cls, content) }\n    }\n  }\n\n  // Wrap in explicit\n  if (state.explicit !== null) { result = this._encodeComposite(state.explicit, false, 'context', result) }\n\n  return result\n}\n\nNode.prototype._encodeChoice = function encodeChoice (data, reporter) {\n  const state = this._baseState\n\n  const node = state.choice[data.type]\n  if (!node) {\n    assert(\n      false,\n      `${data.type} not found in ${JSON.stringify(Object.keys(state.choice))}`\n    )\n  }\n  return node._encode(data.value, reporter)\n}\n\nNode.prototype._encodePrimitive = function encodePrimitive (tag, data) {\n  const state = this._baseState\n\n  if (/str$/.test(tag)) { return this._encodeStr(data, tag) } else if (tag === 'objid' && state.args) { return this._encodeObjid(data, state.reverseArgs[0], state.args[1]) } else if (tag === 'objid') { return this._encodeObjid(data, null, null) } else if (tag === 'gentime' || tag === 'utctime') { return this._encodeTime(data, tag) } else if (tag === 'null_') { return this._encodeNull() } else if (tag === 'int' || tag === 'enum') { return this._encodeInt(data, state.args && state.reverseArgs[0]) } else if (tag === 'bool') { return this._encodeBool(data) } else if (tag === 'objDesc') { return this._encodeStr(data, tag) } else { throw new Error(`Unsupported tag: ${tag}`) }\n}\n\nNode.prototype._isNumstr = function isNumstr (str) {\n  return /^[0-9 ]*$/.test(str)\n}\n\nNode.prototype._isPrintstr = function isPrintstr (str) {\n  return /^[A-Za-z0-9 '()+,-./:=?]*$/.test(str)\n}\n\nmodule.exports = Node\n", "// Helper\nfunction reverse (map) {\n  const res = {}\n\n  Object.keys(map).forEach(function (key) {\n    // Convert key to integer if it is stringified\n    if ((key | 0) == key) { key = key | 0 } // eslint-disable-line eqeqeq\n\n    const value = map[key]\n    res[value] = key\n  })\n\n  return res\n}\n\nexports.tagClass = {\n  0: 'universal',\n  1: 'application',\n  2: 'context',\n  3: 'private'\n}\nexports.tagClassByName = reverse(exports.tagClass)\n\nexports.tag = {\n  0x00: 'end',\n  0x01: 'bool',\n  0x02: 'int',\n  0x03: 'bitstr',\n  0x04: 'octstr',\n  0x05: 'null_',\n  0x06: 'objid',\n  0x07: 'objDesc',\n  0x08: 'external',\n  0x09: 'real',\n  0x0a: 'enum',\n  0x0b: 'embed',\n  0x0c: 'utf8str',\n  0x0d: 'relativeOid',\n  0x10: 'seq',\n  0x11: 'set',\n  0x12: 'numstr',\n  0x13: 'printstr',\n  0x14: 't61str',\n  0x15: 'videostr',\n  0x16: 'ia5str',\n  0x17: 'utctime',\n  0x18: 'gentime',\n  0x19: 'graphstr',\n  0x1a: 'iso646str',\n  0x1b: 'genstr',\n  0x1c: 'unistr',\n  0x1d: 'charstr',\n  0x1e: 'bmpstr'\n}\nexports.tagByName = reverse(exports.tag)\n", "/* global BigInt */\nconst { inherits } = require('util')\n\nconst Node = require('../base/node')\nconst der = require('../constants/der')\n\nfunction DEREncoder (entity) {\n  this.enc = 'der'\n  this.name = entity.name\n  this.entity = entity\n\n  // Construct base tree\n  this.tree = new DERNode()\n  this.tree._init(entity.body)\n}\n\nDEREncoder.prototype.encode = function encode (data, reporter) {\n  return this.tree._encode(data, reporter).join()\n}\n\n// Tree methods\n\nfunction DERNode (parent) {\n  Node.call(this, 'der', parent)\n}\ninherits(DERNode, Node)\n\nDERNode.prototype._encodeComposite = function encodeComposite (tag,\n  primitive,\n  cls,\n  content) {\n  const encodedTag = encodeTag(tag, primitive, cls, this.reporter)\n\n  // Short form\n  if (content.length < 0x80) {\n    const header = Buffer.alloc(2)\n    header[0] = encodedTag\n    header[1] = content.length\n    return this._createEncoderBuffer([header, content])\n  }\n\n  // Long form\n  // Count octets required to store length\n  let lenOctets = 1\n  for (let i = content.length; i >= 0x100; i >>= 8) { lenOctets++ }\n\n  const header = Buffer.alloc(1 + 1 + lenOctets)\n  header[0] = encodedTag\n  header[1] = 0x80 | lenOctets\n\n  for (let i = 1 + lenOctets, j = content.length; j > 0; i--, j >>= 8) { header[i] = j & 0xff }\n\n  return this._createEncoderBuffer([header, content])\n}\n\nDERNode.prototype._encodeStr = function encodeStr (str, tag) {\n  if (tag === 'bitstr') {\n    return this._createEncoderBuffer([str.unused | 0, str.data])\n  } else if (tag === 'bmpstr') {\n    const buf = Buffer.alloc(str.length * 2)\n    for (let i = 0; i < str.length; i++) {\n      buf.writeUInt16BE(str.charCodeAt(i), i * 2)\n    }\n    return this._createEncoderBuffer(buf)\n  } else if (tag === 'numstr') {\n    if (!this._isNumstr(str)) {\n      return this.reporter.error('Encoding of string type: numstr supports only digits and space')\n    }\n    return this._createEncoderBuffer(str)\n  } else if (tag === 'printstr') {\n    if (!this._isPrintstr(str)) {\n      return this.reporter.error('Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark')\n    }\n    return this._createEncoderBuffer(str)\n  } else if (/str$/.test(tag)) {\n    return this._createEncoderBuffer(str)\n  } else if (tag === 'objDesc') {\n    return this._createEncoderBuffer(str)\n  } else {\n    return this.reporter.error(`Encoding of string type: ${tag} unsupported`)\n  }\n}\n\nDERNode.prototype._encodeObjid = function encodeObjid (id, values, relative) {\n  if (typeof id === 'string') {\n    if (!values) { return this.reporter.error('string objid given, but no values map found') }\n    if (!Object.prototype.hasOwnProperty.call(values, id)) { return this.reporter.error('objid not found in values map') }\n    id = values[id].split(/[\\s.]+/g)\n    for (let i = 0; i < id.length; i++) { id[i] |= 0 }\n  } else if (Array.isArray(id)) {\n    id = id.slice()\n    for (let i = 0; i < id.length; i++) { id[i] |= 0 }\n  }\n\n  if (!Array.isArray(id)) {\n    return this.reporter.error(`objid() should be either array or string, got: ${JSON.stringify(id)}`)\n  }\n\n  if (!relative) {\n    if (id[1] >= 40) { return this.reporter.error('Second objid identifier OOB') }\n    id.splice(0, 2, id[0] * 40 + id[1])\n  }\n\n  // Count number of octets\n  let size = 0\n  for (let i = 0; i < id.length; i++) {\n    let ident = id[i]\n    for (size++; ident >= 0x80; ident >>= 7) { size++ }\n  }\n\n  const objid = Buffer.alloc(size)\n  let offset = objid.length - 1\n  for (let i = id.length - 1; i >= 0; i--) {\n    let ident = id[i]\n    objid[offset--] = ident & 0x7f\n    while ((ident >>= 7) > 0) { objid[offset--] = 0x80 | (ident & 0x7f) }\n  }\n\n  return this._createEncoderBuffer(objid)\n}\n\nfunction two (num) {\n  if (num < 10) { return `0${num}` } else { return num }\n}\n\nDERNode.prototype._encodeTime = function encodeTime (time, tag) {\n  let str\n  const date = new Date(time)\n\n  if (tag === 'gentime') {\n    str = [\n      two(date.getUTCFullYear()),\n      two(date.getUTCMonth() + 1),\n      two(date.getUTCDate()),\n      two(date.getUTCHours()),\n      two(date.getUTCMinutes()),\n      two(date.getUTCSeconds()),\n      'Z'\n    ].join('')\n  } else if (tag === 'utctime') {\n    str = [\n      two(date.getUTCFullYear() % 100),\n      two(date.getUTCMonth() + 1),\n      two(date.getUTCDate()),\n      two(date.getUTCHours()),\n      two(date.getUTCMinutes()),\n      two(date.getUTCSeconds()),\n      'Z'\n    ].join('')\n  } else {\n    this.reporter.error(`Encoding ${tag} time is not supported yet`)\n  }\n\n  return this._encodeStr(str, 'octstr')\n}\n\nDERNode.prototype._encodeNull = function encodeNull () {\n  return this._createEncoderBuffer('')\n}\n\nfunction bnToBuf (bn) {\n  var hex = BigInt(bn).toString(16)\n  if (hex.length % 2) { hex = '0' + hex }\n\n  var len = hex.length / 2\n  var u8 = new Uint8Array(len)\n\n  var i = 0\n  var j = 0\n  while (i < len) {\n    u8[i] = parseInt(hex.slice(j, j + 2), 16)\n    i += 1\n    j += 2\n  }\n\n  return u8\n}\n\nDERNode.prototype._encodeInt = function encodeInt (num, values) {\n  if (typeof num === 'string') {\n    if (!values) { return this.reporter.error('String int or enum given, but no values map') }\n    if (!Object.prototype.hasOwnProperty.call(values, num)) {\n      return this.reporter.error(`Values map doesn't contain: ${JSON.stringify(num)}`)\n    }\n    num = values[num]\n  }\n\n  if (typeof num === 'bigint') {\n    const numArray = [...bnToBuf(num)]\n    if (numArray[0] & 0x80) {\n      numArray.unshift(0)\n    }\n    num = Buffer.from(numArray)\n  }\n\n  if (Buffer.isBuffer(num)) {\n    let size = num.length\n    if (num.length === 0) { size++ }\n\n    const out = Buffer.alloc(size)\n    num.copy(out)\n    if (num.length === 0) { out[0] = 0 }\n    return this._createEncoderBuffer(out)\n  }\n\n  if (num < 0x80) { return this._createEncoderBuffer(num) }\n\n  if (num < 0x100) { return this._createEncoderBuffer([0, num]) }\n\n  let size = 1\n  for (let i = num; i >= 0x100; i >>= 8) { size++ }\n\n  const out = new Array(size)\n  for (let i = out.length - 1; i >= 0; i--) {\n    out[i] = num & 0xff\n    num >>= 8\n  }\n  if (out[0] & 0x80) {\n    out.unshift(0)\n  }\n\n  return this._createEncoderBuffer(Buffer.from(out))\n}\n\nDERNode.prototype._encodeBool = function encodeBool (value) {\n  return this._createEncoderBuffer(value ? 0xff : 0)\n}\n\nDERNode.prototype._use = function use (entity, obj) {\n  if (typeof entity === 'function') { entity = entity(obj) }\n  return entity._getEncoder('der').tree\n}\n\nDERNode.prototype._skipDefault = function skipDefault (dataBuffer, reporter, parent) {\n  const state = this._baseState\n  let i\n  if (state.default === null) { return false }\n\n  const data = dataBuffer.join()\n  if (state.defaultBuffer === undefined) { state.defaultBuffer = this._encodeValue(state.default, reporter, parent).join() }\n\n  if (data.length !== state.defaultBuffer.length) { return false }\n\n  for (i = 0; i < data.length; i++) {\n    if (data[i] !== state.defaultBuffer[i]) { return false }\n  }\n\n  return true\n}\n\n// Utility methods\n\nfunction encodeTag (tag, primitive, cls, reporter) {\n  let res\n\n  if (tag === 'seqof') { tag = 'seq' } else if (tag === 'setof') { tag = 'set' }\n\n  if (Object.prototype.hasOwnProperty.call(der.tagByName, tag)) { res = der.tagByName[tag] } else if (typeof tag === 'number' && (tag | 0) === tag) { res = tag } else { return reporter.error(`Unknown tag: ${tag}`) }\n\n  if (res >= 0x1f) { return reporter.error('Multi-octet tag encoding unsupported') }\n\n  if (!primitive) { res |= 0x20 }\n\n  res |= (der.tagClassByName[cls || 'universal'] << 6)\n\n  return res\n}\n\nmodule.exports = DEREncoder\n", "const { inherits } = require('util')\n\nconst DEREncoder = require('./der')\n\nfunction PEMEncoder (entity) {\n  DEREncoder.call(this, entity)\n  this.enc = 'pem'\n}\ninherits(PEMEncoder, DEREncoder)\n\nPEMEncoder.prototype.encode = function encode (data, options) {\n  const buf = DEREncoder.prototype.encode.call(this, data)\n\n  const p = buf.toString('base64')\n  const out = [`-----BEGIN ${options.label}-----`]\n  for (let i = 0; i < p.length; i += 64) { out.push(p.slice(i, i + 64)) }\n  out.push(`-----END ${options.label}-----`)\n  return out.join('\\n')\n}\n\nmodule.exports = PEMEncoder\n", "module.exports = {\n  der: require('./der'),\n  pem: require('./pem')\n}\n", "/* global BigInt */\nconst { inherits } = require('util')\n\nconst { DecoderBuffer } = require('../base/buffer')\nconst Node = require('../base/node')\n\n// Import DER constants\nconst der = require('../constants/der')\n\nfunction DERDecoder (entity) {\n  this.enc = 'der'\n  this.name = entity.name\n  this.entity = entity\n\n  // Construct base tree\n  this.tree = new DERNode()\n  this.tree._init(entity.body)\n}\n\nDERDecoder.prototype.decode = function decode (data, options) {\n  if (!DecoderBuffer.isDecoderBuffer(data)) {\n    data = new DecoderBuffer(data, options)\n  }\n\n  return this.tree._decode(data, options)\n}\n\n// Tree methods\n\nfunction DERNode (parent) {\n  Node.call(this, 'der', parent)\n}\ninherits(DERNode, Node)\n\nDERNode.prototype._peekTag = function peekTag (buffer, tag, any) {\n  if (buffer.isEmpty()) { return false }\n\n  const state = buffer.save()\n  const decodedTag = derDecodeTag(buffer, `Failed to peek tag: \"${tag}\"`)\n  if (buffer.isError(decodedTag)) { return decodedTag }\n\n  buffer.restore(state)\n\n  return decodedTag.tag === tag || decodedTag.tagStr === tag || (decodedTag.tagStr + 'of') === tag || any\n}\n\nDERNode.prototype._decodeTag = function decodeTag (buffer, tag, any) {\n  const decodedTag = derDecodeTag(buffer,\n    `Failed to decode tag of \"${tag}\"`)\n  if (buffer.isError(decodedTag)) { return decodedTag }\n\n  let len = derDecodeLen(buffer,\n    decodedTag.primitive,\n    `Failed to get length of \"${tag}\"`)\n\n  // Failure\n  if (buffer.isError(len)) { return len }\n\n  if (!any &&\n      decodedTag.tag !== tag &&\n      decodedTag.tagStr !== tag &&\n      decodedTag.tagStr + 'of' !== tag) {\n    return buffer.error(`Failed to match tag: \"${tag}\"`)\n  }\n\n  if (decodedTag.primitive || len !== null) { return buffer.skip(len, `Failed to match body of: \"${tag}\"`) }\n\n  // Indefinite length... find END tag\n  const state = buffer.save()\n  const res = this._skipUntilEnd(\n    buffer,\n    `Failed to skip indefinite length body: \"${this.tag}\"`)\n  if (buffer.isError(res)) { return res }\n\n  len = buffer.offset - state.offset\n  buffer.restore(state)\n  return buffer.skip(len, `Failed to match body of: \"${tag}\"`)\n}\n\nDERNode.prototype._skipUntilEnd = function skipUntilEnd (buffer, fail) {\n  for (;;) {\n    const tag = derDecodeTag(buffer, fail)\n    if (buffer.isError(tag)) { return tag }\n    const len = derDecodeLen(buffer, tag.primitive, fail)\n    if (buffer.isError(len)) { return len }\n\n    let res\n    if (tag.primitive || len !== null) { res = buffer.skip(len) } else { res = this._skipUntilEnd(buffer, fail) }\n\n    // Failure\n    if (buffer.isError(res)) { return res }\n\n    if (tag.tagStr === 'end') { break }\n  }\n}\n\nDERNode.prototype._decodeList = function decodeList (buffer, tag, decoder,\n  options) {\n  const result = []\n  while (!buffer.isEmpty()) {\n    const possibleEnd = this._peekTag(buffer, 'end')\n    if (buffer.isError(possibleEnd)) { return possibleEnd }\n\n    const res = decoder.decode(buffer, 'der', options)\n    if (buffer.isError(res) && possibleEnd) { break }\n    result.push(res)\n  }\n  return result\n}\n\nDERNode.prototype._decodeStr = function decodeStr (buffer, tag) {\n  if (tag === 'bitstr') {\n    const unused = buffer.readUInt8()\n    if (buffer.isError(unused)) { return unused }\n    return { unused: unused, data: buffer.raw() }\n  } else if (tag === 'bmpstr') {\n    const raw = buffer.raw()\n    if (raw.length % 2 === 1) { return buffer.error('Decoding of string type: bmpstr length mismatch') }\n\n    let str = ''\n    for (let i = 0; i < raw.length / 2; i++) {\n      str += String.fromCharCode(raw.readUInt16BE(i * 2))\n    }\n    return str\n  } else if (tag === 'numstr') {\n    const numstr = buffer.raw().toString('ascii')\n    if (!this._isNumstr(numstr)) {\n      return buffer.error('Decoding of string type: numstr unsupported characters')\n    }\n    return numstr\n  } else if (tag === 'octstr') {\n    return buffer.raw()\n  } else if (tag === 'objDesc') {\n    return buffer.raw()\n  } else if (tag === 'printstr') {\n    const printstr = buffer.raw().toString('ascii')\n    if (!this._isPrintstr(printstr)) {\n      return buffer.error('Decoding of string type: printstr unsupported characters')\n    }\n    return printstr\n  } else if (/str$/.test(tag)) {\n    return buffer.raw().toString()\n  } else {\n    return buffer.error(`Decoding of string type: ${tag} unsupported`)\n  }\n}\n\nDERNode.prototype._decodeObjid = function decodeObjid (buffer, values, relative) {\n  let result\n  const identifiers = []\n  let ident = 0\n  let subident = 0\n  while (!buffer.isEmpty()) {\n    subident = buffer.readUInt8()\n    ident <<= 7\n    ident |= subident & 0x7f\n    if ((subident & 0x80) === 0) {\n      identifiers.push(ident)\n      ident = 0\n    }\n  }\n  if (subident & 0x80) { identifiers.push(ident) }\n\n  const first = (identifiers[0] / 40) | 0\n  const second = identifiers[0] % 40\n\n  if (relative) { result = identifiers } else { result = [first, second].concat(identifiers.slice(1)) }\n\n  if (values) {\n    let tmp = values[result.join(' ')]\n    if (tmp === undefined) { tmp = values[result.join('.')] }\n    if (tmp !== undefined) { result = tmp }\n  }\n\n  return result\n}\n\nDERNode.prototype._decodeTime = function decodeTime (buffer, tag) {\n  const str = buffer.raw().toString()\n\n  let year\n  let mon\n  let day\n  let hour\n  let min\n  let sec\n  if (tag === 'gentime') {\n    year = str.slice(0, 4) | 0\n    mon = str.slice(4, 6) | 0\n    day = str.slice(6, 8) | 0\n    hour = str.slice(8, 10) | 0\n    min = str.slice(10, 12) | 0\n    sec = str.slice(12, 14) | 0\n  } else if (tag === 'utctime') {\n    year = str.slice(0, 2) | 0\n    mon = str.slice(2, 4) | 0\n    day = str.slice(4, 6) | 0\n    hour = str.slice(6, 8) | 0\n    min = str.slice(8, 10) | 0\n    sec = str.slice(10, 12) | 0\n    if (year < 70) { year = 2000 + year } else { year = 1900 + year }\n  } else {\n    return buffer.error(`Decoding ${tag} time is not supported yet`)\n  }\n\n  return Date.UTC(year, mon - 1, day, hour, min, sec, 0)\n}\n\nDERNode.prototype._decodeNull = function decodeNull () {\n  return null\n}\n\nDERNode.prototype._decodeBool = function decodeBool (buffer) {\n  const res = buffer.readUInt8()\n  if (buffer.isError(res)) { return res } else { return res !== 0 }\n}\n\nDERNode.prototype._decodeInt = function decodeInt (buffer, values) {\n  // Bigint, return as it is (assume big endian)\n  const raw = buffer.raw()\n  let res = BigInt(`0x${raw.toString('hex')}`)\n\n  if (values) {\n    res = values[res.toString(10)] || res\n  }\n\n  return res\n}\n\nDERNode.prototype._use = function use (entity, obj) {\n  if (typeof entity === 'function') { entity = entity(obj) }\n  return entity._getDecoder('der').tree\n}\n\n// Utility methods\n\nfunction derDecodeTag (buf, fail) {\n  let tag = buf.readUInt8(fail)\n  if (buf.isError(tag)) { return tag }\n\n  const cls = der.tagClass[tag >> 6]\n  const primitive = (tag & 0x20) === 0\n\n  // Multi-octet tag - load\n  if ((tag & 0x1f) === 0x1f) {\n    let oct = tag\n    tag = 0\n    while ((oct & 0x80) === 0x80) {\n      oct = buf.readUInt8(fail)\n      if (buf.isError(oct)) { return oct }\n\n      tag <<= 7\n      tag |= oct & 0x7f\n    }\n  } else {\n    tag &= 0x1f\n  }\n  const tagStr = der.tag[tag]\n\n  return {\n    cls: cls,\n    primitive: primitive,\n    tag: tag,\n    tagStr: tagStr\n  }\n}\n\nfunction derDecodeLen (buf, primitive, fail) {\n  let len = buf.readUInt8(fail)\n  if (buf.isError(len)) { return len }\n\n  // Indefinite form\n  if (!primitive && len === 0x80) { return null }\n\n  // Definite form\n  if ((len & 0x80) === 0) {\n    // Short form\n    return len\n  }\n\n  // Long form\n  const num = len & 0x7f\n  if (num > 4) { return buf.error('length octect is too long') }\n\n  len = 0\n  for (let i = 0; i < num; i++) {\n    len <<= 8\n    const j = buf.readUInt8(fail)\n    if (buf.isError(j)) { return j }\n    len |= j\n  }\n\n  return len\n}\n\nmodule.exports = DERDecoder\n", "const { inherits } = require('util')\n\nconst DERDecoder = require('./der')\n\nfunction PEMDecoder (entity) {\n  DERDecoder.call(this, entity)\n  this.enc = 'pem'\n}\ninherits(PEMDecoder, DERDecoder)\n\nPEMDecoder.prototype.decode = function decode (data, options) {\n  const lines = data.toString().split(/[\\r\\n]+/g)\n\n  const label = options.label.toUpperCase()\n\n  const re = /^-----(BEGIN|END) ([^-]+)-----$/\n  let start = -1\n  let end = -1\n  for (let i = 0; i < lines.length; i++) {\n    const match = lines[i].match(re)\n    if (match === null) { continue }\n\n    if (match[2] !== label) { continue }\n\n    if (start === -1) {\n      if (match[1] !== 'BEGIN') { break }\n      start = i\n    } else {\n      if (match[1] !== 'END') { break }\n      end = i\n      break\n    }\n  }\n  if (start === -1 || end === -1) { throw new Error(`PEM section not found for: ${label}`) }\n\n  const base64 = lines.slice(start + 1, end).join('')\n  // Remove excessive symbols\n  base64.replace(/[^a-z0-9+/=]+/gi, '')\n\n  const input = Buffer.from(base64, 'base64')\n  return DERDecoder.prototype.decode.call(this, input, options)\n}\n\nmodule.exports = PEMDecoder\n", "module.exports = {\n  der: require('./der'),\n  pem: require('./pem')\n}\n", "const { inherits } = require('util')\nconst encoders = require('./encoders')\nconst decoders = require('./decoders')\n\nmodule.exports.define = function define (name, body) {\n  return new Entity(name, body)\n}\n\nfunction Entity (name, body) {\n  this.name = name\n  this.body = body\n\n  this.decoders = {}\n  this.encoders = {}\n}\n\nEntity.prototype._createNamed = function createNamed (Base) {\n  const name = this.name\n\n  function Generated (entity) {\n    this._initNamed(entity, name)\n  }\n  inherits(Generated, Base)\n  Generated.prototype._initNamed = function _initNamed (entity, name) {\n    Base.call(this, entity, name)\n  }\n\n  return new Generated(this)\n}\n\nEntity.prototype._getDecoder = function _getDecoder (enc) {\n  enc = enc || 'der'\n  // Lazily create decoder\n  if (!Object.prototype.hasOwnProperty.call(this.decoders, enc)) { this.decoders[enc] = this._createNamed(decoders[enc]) }\n  return this.decoders[enc]\n}\n\nEntity.prototype.decode = function decode (data, enc, options) {\n  return this._getDecoder(enc).decode(data, options)\n}\n\nEntity.prototype._getEncoder = function _getEncoder (enc) {\n  enc = enc || 'der'\n  // Lazily create encoder\n  if (!Object.prototype.hasOwnProperty.call(this.encoders, enc)) { this.encoders[enc] = this._createNamed(encoders[enc]) }\n  return this.encoders[enc]\n}\n\nEntity.prototype.encode = function encode (data, enc, /* internal */ reporter) {\n  return this._getEncoder(enc).encode(data, reporter)\n}\n", "const { Reporter } = require('./reporter')\nconst { DecoderBuffer, EncoderBuffer } = require('./buffer')\nconst Node = require('./node')\n\nmodule.exports = {\n  DecoderBuffer,\n  EncoderBuffer,\n  Node,\n  Reporter\n}\n", "module.exports = {\n  der: require('./der')\n}\n", "const { define } = require('./asn1/api')\nconst base = require('./asn1/base')\nconst constants = require('./asn1/constants')\nconst decoders = require('./asn1/decoders')\nconst encoders = require('./asn1/encoders')\n\nmodule.exports = {\n  base,\n  constants,\n  decoders,\n  define,\n  encoders\n}\n", "const { name: secp256k1 } = require('../../jwk/key/secp256k1_crv')\n\nconst oids = {\n  '1 2 840 10045 3 1 7': 'P-256',\n  '1 3 132 0 10': secp256k1,\n  '1 3 132 0 34': 'P-384',\n  '1 3 132 0 35': 'P-521',\n  '1 2 840 10045 2 1': 'ecPublicKey',\n  '1 2 840 113549 1 1 1': 'rsaEncryption',\n  '1 3 101 110': 'X25519',\n  '1 3 101 111': 'X448',\n  '1 3 101 112': 'Ed25519',\n  '1 3 101 113': 'Ed448'\n}\n\nmodule.exports = oids\n", "const oids = require('./oids')\n\nmodule.exports = function () {\n  this.seq().obj(\n    this.key('algorithm').objid(oids),\n    this.key('parameters').optional().choice({ namedCurve: this.objid(oids), null: this.null_() })\n  )\n}\n", "const oids = require('./oids')\n\nmodule.exports = function () {\n  this.seq().obj(\n    this.key('version').int(),\n    this.key('privateKey').octstr(),\n    this.key('parameters').explicit(0).optional().choice({ namedCurve: this.objid(oids) }),\n    this.key('publicKey').explicit(1).optional().bitstr()\n  )\n}\n", "module.exports = (AlgorithmIdentifier) => function () {\n  this.seq().obj(\n    this.key('version').int(),\n    this.key('algorithm').use(AlgorithmIdentifier),\n    this.key('privateKey').octstr()\n  )\n}\n", "module.exports = AlgorithmIdentifier => function () {\n  this.seq().obj(\n    this.key('algorithm').use(AlgorithmIdentifier),\n    this.key('publicKey').bitstr()\n  )\n}\n", "module.exports = function () {\n  this.octstr().contains().obj(\n    this.key('privateKey').octstr()\n  )\n}\n", "module.exports = (AlgorithmIdentifier, PrivateKey) => function () {\n  this.seq().obj(\n    this.key('version').int(),\n    this.key('algorithm').use(AlgorithmIdentifier),\n    this.key('privateKey').use(PrivateKey)\n  )\n}\n", "module.exports = function () {\n  this.seq().obj(\n    this.key('version').int({ 0: 'two-prime', 1: 'multi' }),\n    this.key('n').int(),\n    this.key('e').int(),\n    this.key('d').int(),\n    this.key('p').int(),\n    this.key('q').int(),\n    this.key('dp').int(),\n    this.key('dq').int(),\n    this.key('qi').int()\n  )\n}\n", "module.exports = function () {\n  this.seq().obj(\n    this.key('n').int(),\n    this.key('e').int()\n  )\n}\n", "const asn1 = require('@panva/asn1.js')\n\nconst types = new Map()\n\nconst AlgorithmIdentifier = asn1.define('AlgorithmIdentifier', require('./algorithm_identifier'))\ntypes.set('AlgorithmIdentifier', AlgorithmIdentifier)\n\nconst ECPrivateKey = asn1.define('ECPrivateKey', require('./ec_private_key'))\ntypes.set('ECPrivateKey', ECPrivateKey)\n\nconst PrivateKeyInfo = asn1.define('PrivateKeyInfo', require('./private_key_info')(AlgorithmIdentifier))\ntypes.set('PrivateKeyInfo', PrivateKeyInfo)\n\nconst PublicKeyInfo = asn1.define('PublicKeyInfo', require('./public_key_info')(AlgorithmIdentifier))\ntypes.set('PublicKeyInfo', PublicKeyInfo)\n\nconst PrivateKey = asn1.define('PrivateKey', require('./private_key'))\ntypes.set('PrivateKey', PrivateKey)\n\nconst OneAsymmetricKey = asn1.define('OneAsymmetricKey', require('./one_asymmetric_key')(AlgorithmIdentifier, PrivateKey))\ntypes.set('OneAsymmetricKey', OneAsymmetricKey)\n\nconst RSAPrivateKey = asn1.define('RSAPrivateKey', require('./rsa_private_key'))\ntypes.set('RSAPrivateKey', RSAPrivateKey)\n\nconst RSAPublicKey = asn1.define('RSAPublicKey', require('./rsa_public_key'))\ntypes.set('RSAPublicKey', RSAPublicKey)\n\nmodule.exports = types\n", "/* global BigInt */\n\nconst { keyObjectSupported } = require('./runtime_support')\n\nlet createPublicKey\nlet createPrivateKey\nlet createSecretKey\nlet KeyObject\nlet asInput\n\nif (keyObjectSupported) {\n  ({ createPublicKey, createPrivateKey, createSecretKey, KeyObject } = require('crypto'))\n  asInput = (input) => input\n} else {\n  const { EOL } = require('os')\n\n  const errors = require('../errors')\n  const isObject = require('./is_object')\n  const asn1 = require('./asn1')\n  const toInput = Symbol('toInput')\n\n  const namedCurve = Symbol('namedCurve')\n\n  asInput = (keyObject, needsPublic) => {\n    if (keyObject instanceof KeyObject) {\n      return keyObject[toInput](needsPublic)\n    }\n\n    return createSecretKey(keyObject)[toInput](needsPublic)\n  }\n\n  const pemToDer = pem => Buffer.from(pem.replace(/(?:-----(?:BEGIN|END)(?: (?:RSA|EC))? (?:PRIVATE|PUBLIC) KEY-----|\\s)/g, ''), 'base64')\n  const derToPem = (der, label) => `-----BEGIN ${label}-----${EOL}${(der.toString('base64').match(/.{1,64}/g) || []).join(EOL)}${EOL}-----END ${label}-----`\n  const unsupported = (input) => {\n    const label = typeof input === 'string' ? input : `OID ${input.join('.')}`\n    throw new errors.JOSENotSupported(`${label} is not supported in your Node.js runtime version`)\n  }\n\n  KeyObject = class KeyObject {\n    export ({ cipher, passphrase, type, format } = {}) {\n      if (this._type === 'secret') {\n        return this._buffer\n      }\n\n      if (this._type === 'public') {\n        if (this.asymmetricKeyType === 'rsa') {\n          switch (type) {\n            case 'pkcs1':\n              if (format === 'pem') {\n                return this._pem\n              }\n\n              return pemToDer(this._pem)\n            case 'spki': {\n              const PublicKeyInfo = asn1.get('PublicKeyInfo')\n              const pem = PublicKeyInfo.encode({\n                algorithm: {\n                  algorithm: 'rsaEncryption',\n                  parameters: { type: 'null' }\n                },\n                publicKey: {\n                  unused: 0,\n                  data: pemToDer(this._pem)\n                }\n              }, 'pem', { label: 'PUBLIC KEY' })\n\n              return format === 'pem' ? pem : pemToDer(pem)\n            }\n            default:\n              throw new TypeError(`The value ${type} is invalid for option \"type\"`)\n          }\n        }\n\n        if (this.asymmetricKeyType === 'ec') {\n          if (type !== 'spki') {\n            throw new TypeError(`The value ${type} is invalid for option \"type\"`)\n          }\n\n          if (format === 'pem') {\n            return this._pem\n          }\n\n          return pemToDer(this._pem)\n        }\n      }\n\n      if (this._type === 'private') {\n        if (passphrase !== undefined || cipher !== undefined) {\n          throw new errors.JOSENotSupported('encrypted private keys are not supported in your Node.js runtime version')\n        }\n\n        if (type === 'pkcs8') {\n          if (this._pkcs8) {\n            if (format === 'der' && typeof this._pkcs8 === 'string') {\n              return pemToDer(this._pkcs8)\n            }\n\n            if (format === 'pem' && Buffer.isBuffer(this._pkcs8)) {\n              return derToPem(this._pkcs8, 'PRIVATE KEY')\n            }\n\n            return this._pkcs8\n          }\n\n          if (this.asymmetricKeyType === 'rsa') {\n            const parsed = this._asn1\n            const RSAPrivateKey = asn1.get('RSAPrivateKey')\n            const privateKey = RSAPrivateKey.encode(parsed)\n            const PrivateKeyInfo = asn1.get('PrivateKeyInfo')\n            const pkcs8 = PrivateKeyInfo.encode({\n              version: 0,\n              privateKey,\n              algorithm: {\n                algorithm: 'rsaEncryption',\n                parameters: { type: 'null' }\n              }\n            })\n\n            this._pkcs8 = pkcs8\n\n            return this.export({ type, format })\n          }\n\n          if (this.asymmetricKeyType === 'ec') {\n            const parsed = this._asn1\n            const ECPrivateKey = asn1.get('ECPrivateKey')\n            const privateKey = ECPrivateKey.encode({\n              version: parsed.version,\n              privateKey: parsed.privateKey,\n              publicKey: parsed.publicKey\n            })\n            const PrivateKeyInfo = asn1.get('PrivateKeyInfo')\n            const pkcs8 = PrivateKeyInfo.encode({\n              version: 0,\n              privateKey,\n              algorithm: {\n                algorithm: 'ecPublicKey',\n                parameters: this._asn1.parameters\n              }\n            })\n\n            this._pkcs8 = pkcs8\n\n            return this.export({ type, format })\n          }\n        }\n\n        if (this.asymmetricKeyType === 'rsa' && type === 'pkcs1') {\n          if (format === 'pem') {\n            return this._pem\n          }\n\n          return pemToDer(this._pem)\n        } else if (this.asymmetricKeyType === 'ec' && type === 'sec1') {\n          if (format === 'pem') {\n            return this._pem\n          }\n\n          return pemToDer(this._pem)\n        } else {\n          throw new TypeError(`The value ${type} is invalid for option \"type\"`)\n        }\n      }\n    }\n\n    get type () {\n      return this._type\n    }\n\n    get asymmetricKeyType () {\n      return this._asymmetricKeyType\n    }\n\n    get symmetricKeySize () {\n      return this._symmetricKeySize\n    }\n\n    [toInput] (needsPublic) {\n      switch (this._type) {\n        case 'secret':\n          return this._buffer\n        case 'public':\n          return this._pem\n        default:\n          if (needsPublic) {\n            if (!('_pub' in this)) {\n              this._pub = createPublicKey(this)\n            }\n\n            return this._pub[toInput](false)\n          }\n\n          return this._pem\n      }\n    }\n  }\n\n  createSecretKey = (buffer) => {\n    if (!Buffer.isBuffer(buffer) || !buffer.length) {\n      throw new TypeError('input must be a non-empty Buffer instance')\n    }\n\n    const keyObject = new KeyObject()\n    keyObject._buffer = Buffer.from(buffer)\n    keyObject._symmetricKeySize = buffer.length\n    keyObject._type = 'secret'\n\n    return keyObject\n  }\n\n  createPublicKey = (input) => {\n    if (input instanceof KeyObject) {\n      if (input.type !== 'private') {\n        throw new TypeError(`Invalid key object type ${input.type}, expected private.`)\n      }\n\n      switch (input.asymmetricKeyType) {\n        case 'ec': {\n          const PublicKeyInfo = asn1.get('PublicKeyInfo')\n          const key = PublicKeyInfo.encode({\n            algorithm: {\n              algorithm: 'ecPublicKey',\n              parameters: input._asn1.parameters\n            },\n            publicKey: input._asn1.publicKey\n          })\n\n          return createPublicKey({ key, format: 'der', type: 'spki' })\n        }\n        case 'rsa': {\n          const RSAPublicKey = asn1.get('RSAPublicKey')\n          const key = RSAPublicKey.encode(input._asn1)\n          return createPublicKey({ key, format: 'der', type: 'pkcs1' })\n        }\n      }\n    }\n\n    if (typeof input === 'string' || Buffer.isBuffer(input)) {\n      input = { key: input, format: 'pem' }\n    }\n\n    if (!isObject(input)) {\n      throw new TypeError('input must be a string, Buffer or an object')\n    }\n\n    const { format, passphrase } = input\n    let { key, type } = input\n\n    if (typeof key !== 'string' && !Buffer.isBuffer(key)) {\n      throw new TypeError('key must be a string or Buffer')\n    }\n\n    if (format !== 'pem' && format !== 'der') {\n      throw new TypeError('format must be one of \"pem\" or \"der\"')\n    }\n\n    let label\n    if (format === 'pem') {\n      key = key.toString()\n      switch (key.split(/\\r?\\n/g)[0].toString()) {\n        case '-----BEGIN PUBLIC KEY-----':\n          type = 'spki'\n          label = 'PUBLIC KEY'\n          break\n        case '-----BEGIN RSA PUBLIC KEY-----':\n          type = 'pkcs1'\n          label = 'RSA PUBLIC KEY'\n          break\n        case '-----BEGIN CERTIFICATE-----':\n          throw new errors.JOSENotSupported('X.509 certificates are not supported in your Node.js runtime version')\n        case '-----BEGIN PRIVATE KEY-----':\n        case '-----BEGIN EC PRIVATE KEY-----':\n        case '-----BEGIN RSA PRIVATE KEY-----':\n          return createPublicKey(createPrivateKey(key))\n        default:\n          throw new TypeError('unknown/unsupported PEM type')\n      }\n    }\n\n    switch (type) {\n      case 'spki': {\n        const PublicKeyInfo = asn1.get('PublicKeyInfo')\n        const parsed = PublicKeyInfo.decode(key, format, { label })\n\n        let type, keyObject\n        switch (parsed.algorithm.algorithm) {\n          case 'ecPublicKey': {\n            keyObject = new KeyObject()\n            keyObject._asn1 = parsed\n            keyObject._asymmetricKeyType = 'ec'\n            keyObject._type = 'public'\n            keyObject._pem = PublicKeyInfo.encode(parsed, 'pem', { label: 'PUBLIC KEY' })\n\n            break\n          }\n          case 'rsaEncryption': {\n            type = 'pkcs1'\n            keyObject = createPublicKey({ type, key: parsed.publicKey.data, format: 'der' })\n            break\n          }\n          default:\n            unsupported(parsed.algorithm.algorithm)\n        }\n\n        return keyObject\n      }\n      case 'pkcs1': {\n        const RSAPublicKey = asn1.get('RSAPublicKey')\n        const parsed = RSAPublicKey.decode(key, format, { label })\n\n        // special case when private pkcs1 PEM / DER is used with createPublicKey\n        if (parsed.n === BigInt(0)) {\n          return createPublicKey(createPrivateKey({ key, format, type, passphrase }))\n        }\n\n        const keyObject = new KeyObject()\n        keyObject._asn1 = parsed\n        keyObject._asymmetricKeyType = 'rsa'\n        keyObject._type = 'public'\n        keyObject._pem = RSAPublicKey.encode(parsed, 'pem', { label: 'RSA PUBLIC KEY' })\n\n        return keyObject\n      }\n      case 'pkcs8':\n      case 'sec1':\n        return createPublicKey(createPrivateKey({ format, key, type, passphrase }))\n      default:\n        throw new TypeError(`The value ${type} is invalid for option \"type\"`)\n    }\n  }\n\n  createPrivateKey = (input, hints) => {\n    if (typeof input === 'string' || Buffer.isBuffer(input)) {\n      input = { key: input, format: 'pem' }\n    }\n\n    if (!isObject(input)) {\n      throw new TypeError('input must be a string, Buffer or an object')\n    }\n\n    const { format, passphrase } = input\n    let { key, type } = input\n\n    if (typeof key !== 'string' && !Buffer.isBuffer(key)) {\n      throw new TypeError('key must be a string or Buffer')\n    }\n\n    if (passphrase !== undefined) {\n      throw new errors.JOSENotSupported('encrypted private keys are not supported in your Node.js runtime version')\n    }\n\n    if (format !== 'pem' && format !== 'der') {\n      throw new TypeError('format must be one of \"pem\" or \"der\"')\n    }\n\n    let label\n    if (format === 'pem') {\n      key = key.toString()\n      switch (key.split(/\\r?\\n/g)[0].toString()) {\n        case '-----BEGIN PRIVATE KEY-----':\n          type = 'pkcs8'\n          label = 'PRIVATE KEY'\n          break\n        case '-----BEGIN EC PRIVATE KEY-----':\n          type = 'sec1'\n          label = 'EC PRIVATE KEY'\n          break\n        case '-----BEGIN RSA PRIVATE KEY-----':\n          type = 'pkcs1'\n          label = 'RSA PRIVATE KEY'\n          break\n        default:\n          throw new TypeError('unknown/unsupported PEM type')\n      }\n    }\n\n    switch (type) {\n      case 'pkcs8': {\n        const PrivateKeyInfo = asn1.get('PrivateKeyInfo')\n        const parsed = PrivateKeyInfo.decode(key, format, { label })\n\n        let type, keyObject\n        switch (parsed.algorithm.algorithm) {\n          case 'ecPublicKey': {\n            type = 'sec1'\n            keyObject = createPrivateKey({ type, key: parsed.privateKey, format: 'der' }, { [namedCurve]: parsed.algorithm.parameters.value })\n            break\n          }\n          case 'rsaEncryption': {\n            type = 'pkcs1'\n            keyObject = createPrivateKey({ type, key: parsed.privateKey, format: 'der' })\n            break\n          }\n          default:\n            unsupported(parsed.algorithm.algorithm)\n        }\n\n        keyObject._pkcs8 = key\n        return keyObject\n      }\n      case 'pkcs1': {\n        const RSAPrivateKey = asn1.get('RSAPrivateKey')\n        const parsed = RSAPrivateKey.decode(key, format, { label })\n\n        const keyObject = new KeyObject()\n        keyObject._asn1 = parsed\n        keyObject._asymmetricKeyType = 'rsa'\n        keyObject._type = 'private'\n        keyObject._pem = RSAPrivateKey.encode(parsed, 'pem', { label: 'RSA PRIVATE KEY' })\n\n        return keyObject\n      }\n      case 'sec1': {\n        const ECPrivateKey = asn1.get('ECPrivateKey')\n        let parsed = ECPrivateKey.decode(key, format, { label })\n\n        if (!('parameters' in parsed) && !hints[namedCurve]) {\n          throw new Error('invalid sec1')\n        } else if (!('parameters' in parsed)) {\n          parsed = { ...parsed, parameters: { type: 'namedCurve', value: hints[namedCurve] } }\n        }\n\n        const keyObject = new KeyObject()\n        keyObject._asn1 = parsed\n        keyObject._asymmetricKeyType = 'ec'\n        keyObject._type = 'private'\n        keyObject._pem = ECPrivateKey.encode(parsed, 'pem', { label: 'EC PRIVATE KEY' })\n\n        return keyObject\n      }\n      default:\n        throw new TypeError(`The value ${type} is invalid for option \"type\"`)\n    }\n  }\n}\n\nmodule.exports = { createPublicKey, createPrivateKey, createSecretKey, KeyObject, asInput }\n", "/* global BigInt */\n\nconst { randomBytes } = require('crypto')\n\nconst base64url = require('./base64url')\nconst errors = require('../errors')\n\nconst ZERO = BigInt(0)\nconst ONE = BigInt(1)\nconst TWO = BigInt(2)\n\nconst toJWKParameter = (n) => {\n  const hex = n.toString(16)\n  return base64url.encodeBuffer(Buffer.from(hex.length % 2 ? `0${hex}` : hex, 'hex'))\n}\nconst fromBuffer = buf => BigInt(`0x${buf.toString('hex')}`)\nconst bitLength = n => n.toString(2).length\n\nconst eGcdX = (a, b) => {\n  let x = ZERO\n  let y = ONE\n  let u = ONE\n  let v = ZERO\n\n  while (a !== ZERO) {\n    const q = b / a\n    const r = b % a\n    const m = x - (u * q)\n    const n = y - (v * q)\n    b = a\n    a = r\n    x = u\n    y = v\n    u = m\n    v = n\n  }\n  return x\n}\n\nconst gcd = (a, b) => {\n  let shift = ZERO\n  while (!((a | b) & ONE)) {\n    a >>= ONE\n    b >>= ONE\n    shift++\n  }\n  while (!(a & ONE)) {\n    a >>= ONE\n  }\n  do {\n    while (!(b & ONE)) {\n      b >>= ONE\n    }\n    if (a > b) {\n      const x = a\n      a = b\n      b = x\n    }\n    b -= a\n  } while (b)\n\n  return a << shift\n}\n\nconst modPow = (a, b, n) => {\n  a = toZn(a, n)\n  let result = ONE\n  let x = a\n  while (b > 0) {\n    var leastSignificantBit = b % TWO\n    b = b / TWO\n    if (leastSignificantBit === ONE) {\n      result = result * x\n      result = result % n\n    }\n    x = x * x\n    x = x % n\n  }\n  return result\n}\n\nconst randBetween = (min, max) => {\n  const interval = max - min\n  const bitLen = bitLength(interval)\n  let rnd\n  do {\n    rnd = fromBuffer(randBits(bitLen))\n  } while (rnd > interval)\n  return rnd + min\n}\n\nconst randBits = (bitLength) => {\n  const byteLength = Math.ceil(bitLength / 8)\n  const rndBytes = randomBytes(byteLength)\n  // Fill with 0's the extra bits\n  rndBytes[0] = rndBytes[0] & (2 ** (bitLength % 8) - 1)\n  return rndBytes\n}\n\nconst toZn = (a, n) => {\n  a = a % n\n  return (a < 0) ? a + n : a\n}\n\nconst odd = (n) => {\n  let r = n\n  while (r % TWO === ZERO) {\n    r = r / TWO\n  }\n  return r\n}\n\n// not sold on these values\nconst maxCountWhileNoY = 30\nconst maxCountWhileInot0 = 22\n\nconst getPrimeFactors = (e, d, n) => {\n  const r = odd(e * d - ONE)\n\n  let countWhileNoY = 0\n  let y\n  do {\n    countWhileNoY++\n    if (countWhileNoY === maxCountWhileNoY) {\n      throw new errors.JWKImportFailed('failed to calculate missing primes')\n    }\n\n    let countWhileInot0 = 0\n    let i = modPow(randBetween(TWO, n), r, n)\n    let o = ZERO\n    while (i !== ONE) {\n      countWhileInot0++\n      if (countWhileInot0 === maxCountWhileInot0) {\n        throw new errors.JWKImportFailed('failed to calculate missing primes')\n      }\n      o = i\n      i = (i * i) % n\n    }\n    if (o !== (n - ONE)) {\n      y = o\n    }\n  } while (!y)\n\n  const p = gcd(y - ONE, n)\n  const q = n / p\n\n  return p > q ? { p, q } : { p: q, q: p }\n}\n\nmodule.exports = (jwk) => {\n  const e = fromBuffer(base64url.decodeToBuffer(jwk.e))\n  const d = fromBuffer(base64url.decodeToBuffer(jwk.d))\n  const n = fromBuffer(base64url.decodeToBuffer(jwk.n))\n\n  if (d >= n) {\n    throw new errors.JWKInvalid('invalid RSA private exponent')\n  }\n\n  const { p, q } = getPrimeFactors(e, d, n)\n  const dp = d % (p - ONE)\n  const dq = d % (q - ONE)\n  const qi = toZn(eGcdX(toZn(q, p), p), p)\n\n  return {\n    ...jwk,\n    p: toJWKParameter(p),\n    q: toJWKParameter(q),\n    dp: toJWKParameter(dp),\n    dq: toJWKParameter(dq),\n    qi: toJWKParameter(qi)\n  }\n}\n", "/* global BigInt */\n\nconst { EOL } = require('os')\n\nconst errors = require('../errors')\n\nconst { keyObjectSupported } = require('./runtime_support')\nconst { createPublicKey } = require('./key_object')\nconst base64url = require('./base64url')\nconst asn1 = require('./asn1')\nconst computePrimes = require('./rsa_primes')\nconst { OKP_CURVES, EC_CURVES } = require('../registry')\n\nconst formatPem = (base64pem, descriptor) => `-----BEGIN ${descriptor} KEY-----${EOL}${(base64pem.match(/.{1,64}/g) || []).join(EOL)}${EOL}-----END ${descriptor} KEY-----`\n\nconst okpToJWK = {\n  private (crv, keyObject) {\n    const der = keyObject.export({ type: 'pkcs8', format: 'der' })\n    const OneAsymmetricKey = asn1.get('OneAsymmetricKey')\n    const { privateKey: { privateKey: d } } = OneAsymmetricKey.decode(der)\n\n    return {\n      ...okpToJWK.public(crv, createPublicKey(keyObject)),\n      d: base64url.encodeBuffer(d)\n    }\n  },\n  public (crv, keyObject) {\n    const der = keyObject.export({ type: 'spki', format: 'der' })\n\n    const PublicKeyInfo = asn1.get('PublicKeyInfo')\n\n    const { publicKey: { data: x } } = PublicKeyInfo.decode(der)\n\n    return {\n      kty: 'OKP',\n      crv,\n      x: base64url.encodeBuffer(x)\n    }\n  }\n}\n\nconst keyObjectToJWK = {\n  rsa: {\n    private (keyObject) {\n      const der = keyObject.export({ type: 'pkcs8', format: 'der' })\n\n      const PrivateKeyInfo = asn1.get('PrivateKeyInfo')\n      const RSAPrivateKey = asn1.get('RSAPrivateKey')\n\n      const { privateKey } = PrivateKeyInfo.decode(der)\n      const { version, n, e, d, p, q, dp, dq, qi } = RSAPrivateKey.decode(privateKey)\n\n      if (version !== 'two-prime') {\n        throw new errors.JOSENotSupported('Private RSA keys with more than two primes are not supported')\n      }\n\n      return {\n        kty: 'RSA',\n        n: base64url.encodeBigInt(n),\n        e: base64url.encodeBigInt(e),\n        d: base64url.encodeBigInt(d),\n        p: base64url.encodeBigInt(p),\n        q: base64url.encodeBigInt(q),\n        dp: base64url.encodeBigInt(dp),\n        dq: base64url.encodeBigInt(dq),\n        qi: base64url.encodeBigInt(qi)\n      }\n    },\n    public (keyObject) {\n      const der = keyObject.export({ type: 'spki', format: 'der' })\n\n      const PublicKeyInfo = asn1.get('PublicKeyInfo')\n      const RSAPublicKey = asn1.get('RSAPublicKey')\n\n      const { publicKey: { data: publicKey } } = PublicKeyInfo.decode(der)\n      const { n, e } = RSAPublicKey.decode(publicKey)\n\n      return {\n        kty: 'RSA',\n        n: base64url.encodeBigInt(n),\n        e: base64url.encodeBigInt(e)\n      }\n    }\n  },\n  ec: {\n    private (keyObject) {\n      const der = keyObject.export({ type: 'pkcs8', format: 'der' })\n\n      const PrivateKeyInfo = asn1.get('PrivateKeyInfo')\n      const ECPrivateKey = asn1.get('ECPrivateKey')\n\n      const { privateKey, algorithm: { parameters: { value: crv } } } = PrivateKeyInfo.decode(der)\n      const { privateKey: d, publicKey } = ECPrivateKey.decode(privateKey)\n\n      if (typeof publicKey === 'undefined') {\n        if (keyObjectSupported) {\n          return {\n            ...keyObjectToJWK.ec.public(createPublicKey(keyObject)),\n            d: base64url.encodeBuffer(d)\n          }\n        }\n\n        throw new errors.JOSENotSupported('Private EC keys without the public key embedded are not supported in your Node.js runtime version')\n      }\n\n      const x = publicKey.data.slice(1, ((publicKey.data.length - 1) / 2) + 1)\n      const y = publicKey.data.slice(((publicKey.data.length - 1) / 2) + 1)\n\n      return {\n        kty: 'EC',\n        crv,\n        d: base64url.encodeBuffer(d),\n        x: base64url.encodeBuffer(x),\n        y: base64url.encodeBuffer(y)\n      }\n    },\n    public (keyObject) {\n      const der = keyObject.export({ type: 'spki', format: 'der' })\n\n      const PublicKeyInfo = asn1.get('PublicKeyInfo')\n\n      const { publicKey: { data: publicKey }, algorithm: { parameters: { value: crv } } } = PublicKeyInfo.decode(der)\n\n      const x = publicKey.slice(1, ((publicKey.length - 1) / 2) + 1)\n      const y = publicKey.slice(((publicKey.length - 1) / 2) + 1)\n\n      return {\n        kty: 'EC',\n        crv,\n        x: base64url.encodeBuffer(x),\n        y: base64url.encodeBuffer(y)\n      }\n    }\n  },\n  ed25519: {\n    private (keyObject) {\n      return okpToJWK.private('Ed25519', keyObject)\n    },\n    public (keyObject) {\n      return okpToJWK.public('Ed25519', keyObject)\n    }\n  },\n  ed448: {\n    private (keyObject) {\n      return okpToJWK.private('Ed448', keyObject)\n    },\n    public (keyObject) {\n      return okpToJWK.public('Ed448', keyObject)\n    }\n  },\n  x25519: {\n    private (keyObject) {\n      return okpToJWK.private('X25519', keyObject)\n    },\n    public (keyObject) {\n      return okpToJWK.public('X25519', keyObject)\n    }\n  },\n  x448: {\n    private (keyObject) {\n      return okpToJWK.private('X448', keyObject)\n    },\n    public (keyObject) {\n      return okpToJWK.public('X448', keyObject)\n    }\n  }\n}\n\nmodule.exports.keyObjectToJWK = (keyObject) => {\n  if (keyObject.type === 'private') {\n    return keyObjectToJWK[keyObject.asymmetricKeyType].private(keyObject)\n  }\n\n  return keyObjectToJWK[keyObject.asymmetricKeyType].public(keyObject)\n}\n\nconst concatEcPublicKey = (x, y) => ({\n  unused: 0,\n  data: Buffer.concat([\n    Buffer.alloc(1, 4),\n    base64url.decodeToBuffer(x),\n    base64url.decodeToBuffer(y)\n  ])\n})\n\nconst jwkToPem = {\n  RSA: {\n    private (jwk, { calculateMissingRSAPrimes }) {\n      const RSAPrivateKey = asn1.get('RSAPrivateKey')\n\n      if ('oth' in jwk) {\n        throw new errors.JOSENotSupported('Private RSA keys with more than two primes are not supported')\n      }\n\n      if (jwk.p || jwk.q || jwk.dp || jwk.dq || jwk.qi) {\n        if (!(jwk.p && jwk.q && jwk.dp && jwk.dq && jwk.qi)) {\n          throw new errors.JWKInvalid('all other private key parameters must be present when any one of them is present')\n        }\n      } else if (calculateMissingRSAPrimes) {\n        jwk = computePrimes(jwk)\n      } else if (!calculateMissingRSAPrimes) {\n        throw new errors.JOSENotSupported('importing private RSA keys without all other private key parameters is not enabled, see documentation and its advisory on how and when its ok to enable it')\n      }\n\n      return RSAPrivateKey.encode({\n        version: 0,\n        n: BigInt(`0x${base64url.decodeToBuffer(jwk.n).toString('hex')}`),\n        e: BigInt(`0x${base64url.decodeToBuffer(jwk.e).toString('hex')}`),\n        d: BigInt(`0x${base64url.decodeToBuffer(jwk.d).toString('hex')}`),\n        p: BigInt(`0x${base64url.decodeToBuffer(jwk.p).toString('hex')}`),\n        q: BigInt(`0x${base64url.decodeToBuffer(jwk.q).toString('hex')}`),\n        dp: BigInt(`0x${base64url.decodeToBuffer(jwk.dp).toString('hex')}`),\n        dq: BigInt(`0x${base64url.decodeToBuffer(jwk.dq).toString('hex')}`),\n        qi: BigInt(`0x${base64url.decodeToBuffer(jwk.qi).toString('hex')}`)\n      }, 'pem', { label: 'RSA PRIVATE KEY' })\n    },\n    public (jwk) {\n      const RSAPublicKey = asn1.get('RSAPublicKey')\n\n      return RSAPublicKey.encode({\n        version: 0,\n        n: BigInt(`0x${base64url.decodeToBuffer(jwk.n).toString('hex')}`),\n        e: BigInt(`0x${base64url.decodeToBuffer(jwk.e).toString('hex')}`)\n      }, 'pem', { label: 'RSA PUBLIC KEY' })\n    }\n  },\n  EC: {\n    private (jwk) {\n      const ECPrivateKey = asn1.get('ECPrivateKey')\n\n      return ECPrivateKey.encode({\n        version: 1,\n        privateKey: base64url.decodeToBuffer(jwk.d),\n        parameters: { type: 'namedCurve', value: jwk.crv },\n        publicKey: concatEcPublicKey(jwk.x, jwk.y)\n      }, 'pem', { label: 'EC PRIVATE KEY' })\n    },\n    public (jwk) {\n      const PublicKeyInfo = asn1.get('PublicKeyInfo')\n\n      return PublicKeyInfo.encode({\n        algorithm: {\n          algorithm: 'ecPublicKey',\n          parameters: { type: 'namedCurve', value: jwk.crv }\n        },\n        publicKey: concatEcPublicKey(jwk.x, jwk.y)\n      }, 'pem', { label: 'PUBLIC KEY' })\n    }\n  },\n  OKP: {\n    private (jwk) {\n      const OneAsymmetricKey = asn1.get('OneAsymmetricKey')\n\n      const b64 = OneAsymmetricKey.encode({\n        version: 0,\n        privateKey: { privateKey: base64url.decodeToBuffer(jwk.d) },\n        algorithm: { algorithm: jwk.crv }\n      }, 'der')\n\n      // TODO: WHYYY? https://github.com/indutny/asn1.js/issues/110\n      b64.write('04', 12, 1, 'hex')\n\n      return formatPem(b64.toString('base64'), 'PRIVATE')\n    },\n    public (jwk) {\n      const PublicKeyInfo = asn1.get('PublicKeyInfo')\n\n      return PublicKeyInfo.encode({\n        algorithm: { algorithm: jwk.crv },\n        publicKey: {\n          unused: 0,\n          data: base64url.decodeToBuffer(jwk.x)\n        }\n      }, 'pem', { label: 'PUBLIC KEY' })\n    }\n  }\n}\n\nmodule.exports.jwkToPem = (jwk, { calculateMissingRSAPrimes = false } = {}) => {\n  switch (jwk.kty) {\n    case 'EC':\n      if (!EC_CURVES.has(jwk.crv)) {\n        throw new errors.JOSENotSupported(`unsupported EC key curve: ${jwk.crv}`)\n      }\n      break\n    case 'OKP':\n      if (!OKP_CURVES.has(jwk.crv)) {\n        throw new errors.JOSENotSupported(`unsupported OKP key curve: ${jwk.crv}`)\n      }\n      break\n    case 'RSA':\n      break\n    default:\n      throw new errors.JOSENotSupported(`unsupported key type: ${jwk.kty}`)\n  }\n\n  if (jwk.d) {\n    return jwkToPem[jwk.kty].private(jwk, { calculateMissingRSAPrimes })\n  }\n\n  return jwkToPem[jwk.kty].public(jwk)\n}\n", "const { createHash } = require('crypto')\n\nconst base64url = require('../help/base64url')\n\nconst x5t = (hash, cert) => base64url.encodeBuffer(createHash(hash).update(Buffer.from(cert, 'base64')).digest())\n\nmodule.exports.kid = components => base64url.encodeBuffer(createHash('sha256').update(JSON.stringify(components)).digest())\nmodule.exports.x5t = x5t.bind(undefined, 'sha1')\nmodule.exports['x5t#S256'] = x5t.bind(undefined, 'sha256')\n", "const { strict: assert } = require('assert')\nconst { inspect } = require('util')\nconst { EOL } = require('os')\n\nconst { keyObjectSupported } = require('../../help/runtime_support')\nconst { createPublicKey } = require('../../help/key_object')\nconst { keyObjectToJWK } = require('../../help/key_utils')\nconst {\n  THUMBPRINT_MATERIAL, PUBLIC_MEMBERS, PRIVATE_MEMBERS, JWK_MEMBERS, KEYOBJECT,\n  USES_MAPPING, OPS, USES\n} = require('../../help/consts')\nconst isObject = require('../../help/is_object')\nconst thumbprint = require('../thumbprint')\nconst errors = require('../../errors')\n\nconst privateApi = Symbol('privateApi')\nconst { JWK } = require('../../registry')\n\nclass Key {\n  constructor (keyObject, { alg, use, kid, key_ops: ops, x5c, x5t, 'x5t#S256': x5t256 } = {}) {\n    if (use !== undefined) {\n      if (typeof use !== 'string' || !USES.has(use)) {\n        throw new TypeError('`use` must be either \"sig\" or \"enc\" string when provided')\n      }\n    }\n\n    if (alg !== undefined) {\n      if (typeof alg !== 'string' || !alg) {\n        throw new TypeError('`alg` must be a non-empty string when provided')\n      }\n    }\n\n    if (kid !== undefined) {\n      if (typeof kid !== 'string' || !kid) {\n        throw new TypeError('`kid` must be a non-empty string when provided')\n      }\n    }\n\n    if (ops !== undefined) {\n      if (!Array.isArray(ops) || !ops.length || ops.some(o => typeof o !== 'string')) {\n        throw new TypeError('`key_ops` must be a non-empty array of strings when provided')\n      }\n      ops = Array.from(new Set(ops)).filter(x => OPS.has(x))\n    }\n\n    if (ops && use) {\n      if (\n        (use === 'enc' && ops.some(x => USES_MAPPING.sig.has(x))) ||\n        (use === 'sig' && ops.some(x => USES_MAPPING.enc.has(x)))\n      ) {\n        throw new errors.JWKInvalid('inconsistent JWK \"use\" and \"key_ops\"')\n      }\n    }\n\n    if (keyObjectSupported && x5c !== undefined) {\n      if (!Array.isArray(x5c) || !x5c.length || x5c.some(c => typeof c !== 'string')) {\n        throw new TypeError('`x5c` must be an array of one or more PKIX certificates when provided')\n      }\n\n      x5c.forEach((cert, i) => {\n        let publicKey\n        try {\n          publicKey = createPublicKey({\n            key: `-----BEGIN CERTIFICATE-----${EOL}${(cert.match(/.{1,64}/g) || []).join(EOL)}${EOL}-----END CERTIFICATE-----`, format: 'pem'\n          })\n        } catch (err) {\n          throw new errors.JWKInvalid(`\\`x5c\\` member at index ${i} is not a valid base64-encoded DER PKIX certificate`)\n        }\n        if (i === 0) {\n          try {\n            assert.deepEqual(\n              publicKey.export({ type: 'spki', format: 'der' }),\n              (keyObject.type === 'public' ? keyObject : createPublicKey(keyObject)).export({ type: 'spki', format: 'der' })\n            )\n          } catch (err) {\n            throw new errors.JWKInvalid('The key in the first `x5c` certificate MUST match the public key represented by the JWK')\n          }\n        }\n      })\n    }\n\n    Object.defineProperties(this, {\n      [KEYOBJECT]: { value: isObject(keyObject) ? undefined : keyObject },\n      keyObject: {\n        get () {\n          if (!keyObjectSupported) {\n            throw new errors.JOSENotSupported('KeyObject class is not supported in your Node.js runtime version')\n          }\n\n          return this[KEYOBJECT]\n        }\n      },\n      type: { value: keyObject.type },\n      private: { value: keyObject.type === 'private' },\n      public: { value: keyObject.type === 'public' },\n      secret: { value: keyObject.type === 'secret' },\n      alg: { value: alg, enumerable: alg !== undefined },\n      use: { value: use, enumerable: use !== undefined },\n      x5c: {\n        enumerable: x5c !== undefined,\n        ...(x5c ? { get () { return [...x5c] } } : { value: undefined })\n      },\n      key_ops: {\n        enumerable: ops !== undefined,\n        ...(ops ? { get () { return [...ops] } } : { value: undefined })\n      },\n      kid: {\n        enumerable: true,\n        ...(kid ? { value: kid } : {\n          get () {\n            Object.defineProperty(this, 'kid', { value: this.thumbprint, configurable: false })\n            return this.kid\n          },\n          configurable: true\n        })\n      },\n      ...(x5c ? {\n        x5t: {\n          enumerable: true,\n          ...(x5t ? { value: x5t } : {\n            get () {\n              Object.defineProperty(this, 'x5t', { value: thumbprint.x5t(this.x5c[0]), configurable: false })\n              return this.x5t\n            },\n            configurable: true\n          })\n        }\n      } : undefined),\n      ...(x5c ? {\n        'x5t#S256': {\n          enumerable: true,\n          ...(x5t256 ? { value: x5t256 } : {\n            get () {\n              Object.defineProperty(this, 'x5t#S256', { value: thumbprint['x5t#S256'](this.x5c[0]), configurable: false })\n              return this['x5t#S256']\n            },\n            configurable: true\n          })\n        }\n      } : undefined),\n      thumbprint: {\n        get () {\n          Object.defineProperty(this, 'thumbprint', { value: thumbprint.kid(this[THUMBPRINT_MATERIAL]()), configurable: false })\n          return this.thumbprint\n        },\n        configurable: true\n      }\n    })\n  }\n\n  toPEM (priv = false, encoding = {}) {\n    if (this.secret) {\n      throw new TypeError('symmetric keys cannot be exported as PEM')\n    }\n\n    if (priv && this.public === true) {\n      throw new TypeError('public key cannot be exported as private')\n    }\n\n    const { type = priv ? 'pkcs8' : 'spki', cipher, passphrase } = encoding\n\n    let keyObject = this[KEYOBJECT]\n\n    if (!priv) {\n      if (this.private) {\n        keyObject = createPublicKey(keyObject)\n      }\n      if (cipher || passphrase) {\n        throw new TypeError('cipher and passphrase can only be applied when exporting private keys')\n      }\n    }\n\n    if (priv) {\n      return keyObject.export({ format: 'pem', type, cipher, passphrase })\n    }\n\n    return keyObject.export({ format: 'pem', type })\n  }\n\n  toJWK (priv = false) {\n    if (priv && this.public === true) {\n      throw new TypeError('public key cannot be exported as private')\n    }\n\n    const components = [...this.constructor[priv ? PRIVATE_MEMBERS : PUBLIC_MEMBERS]]\n      .map(k => [k, this[k]])\n\n    const result = {}\n\n    Object.keys(components).forEach((key) => {\n      const [k, v] = components[key]\n\n      result[k] = v\n    })\n\n    result.kty = this.kty\n    result.kid = this.kid\n\n    if (this.alg) {\n      result.alg = this.alg\n    }\n\n    if (this.key_ops && this.key_ops.length) {\n      result.key_ops = this.key_ops\n    }\n\n    if (this.use) {\n      result.use = this.use\n    }\n\n    if (this.x5c) {\n      result.x5c = this.x5c\n    }\n\n    if (this.x5t) {\n      result.x5t = this.x5t\n    }\n\n    if (this['x5t#S256']) {\n      result['x5t#S256'] = this['x5t#S256']\n    }\n\n    return result\n  }\n\n  [JWK_MEMBERS] () {\n    const props = this[KEYOBJECT].type === 'private' ? this.constructor[PRIVATE_MEMBERS] : this.constructor[PUBLIC_MEMBERS]\n    Object.defineProperties(this, [...props].reduce((acc, component) => {\n      acc[component] = {\n        get () {\n          const jwk = keyObjectToJWK(this[KEYOBJECT])\n          Object.defineProperties(\n            this,\n            Object.entries(jwk)\n              .filter(([key]) => props.has(key))\n              .reduce((acc, [key, value]) => {\n                acc[key] = { value, enumerable: this.constructor[PUBLIC_MEMBERS].has(key), configurable: false }\n                return acc\n              }, {})\n          )\n\n          return this[component]\n        },\n        enumerable: this.constructor[PUBLIC_MEMBERS].has(component),\n        configurable: true\n      }\n      return acc\n    }, {}))\n  }\n\n  /* c8 ignore next 8 */\n  [inspect.custom] () {\n    return `${this.constructor.name} ${inspect(this.toJWK(false), {\n      depth: Infinity,\n      colors: process.stdout.isTTY,\n      compact: false,\n      sorted: true\n    })}`\n  }\n\n  /* c8 ignore next 3 */\n  [THUMBPRINT_MATERIAL] () {\n    throw new Error(`\"[THUMBPRINT_MATERIAL]()\" is not implemented on ${this.constructor.name}`)\n  }\n\n  algorithms (operation, /* the rest is private API */ int, opts) {\n    const { use = this.use, alg = this.alg, key_ops: ops = this.key_ops } = int === privateApi ? opts : {}\n    if (alg) {\n      return new Set(this.algorithms(operation, privateApi, { alg: null, use, key_ops: ops }).has(alg) ? [alg] : undefined)\n    }\n\n    if (typeof operation === 'symbol') {\n      try {\n        return this[operation]()\n      } catch (err) {\n        return new Set()\n      }\n    }\n\n    if (operation && ops && !ops.includes(operation)) {\n      return new Set()\n    }\n\n    switch (operation) {\n      case 'decrypt':\n      case 'deriveKey':\n      case 'encrypt':\n      case 'sign':\n      case 'unwrapKey':\n      case 'verify':\n      case 'wrapKey':\n        return new Set(Object.entries(JWK[this.kty][operation]).map(([alg, fn]) => fn(this) ? alg : undefined).filter(Boolean))\n      case undefined:\n        return new Set([\n          ...this.algorithms('sign'),\n          ...this.algorithms('verify'),\n          ...this.algorithms('decrypt'),\n          ...this.algorithms('encrypt'),\n          ...this.algorithms('unwrapKey'),\n          ...this.algorithms('wrapKey'),\n          ...this.algorithms('deriveKey')\n        ])\n      default:\n        throw new TypeError('invalid key operation')\n    }\n  }\n\n  /* c8 ignore next 3 */\n  static async generate () {\n    throw new Error(`\"static async generate()\" is not implemented on ${this.name}`)\n  }\n\n  /* c8 ignore next 3 */\n  static generateSync () {\n    throw new Error(`\"static generateSync()\" is not implemented on ${this.name}`)\n  }\n\n  /* c8 ignore next 3 */\n  static get [PUBLIC_MEMBERS] () {\n    throw new Error(`\"static get [PUBLIC_MEMBERS]()\" is not implemented on ${this.name}`)\n  }\n\n  /* c8 ignore next 3 */\n  static get [PRIVATE_MEMBERS] () {\n    throw new Error(`\"static get [PRIVATE_MEMBERS]()\" is not implemented on ${this.name}`)\n  }\n}\n\nmodule.exports = Key\n", "const { generateKeyPairSync, generateKeyPair: async } = require('crypto')\nconst { promisify } = require('util')\n\nconst {\n  THUMBPRINT_MATERIAL, JWK_MEMBERS, PUBLIC_MEMBERS,\n  PRIVATE_MEMBERS, KEY_MANAGEMENT_DECRYPT, KEY_MANAGEMENT_ENCRYPT\n} = require('../../help/consts')\nconst { keyObjectSupported } = require('../../help/runtime_support')\nconst { createPublicKey, createPrivateKey } = require('../../help/key_object')\n\nconst Key = require('./base')\n\nconst generateKeyPair = promisify(async)\n\nconst RSA_PUBLIC = new Set(['e', 'n'])\nObject.freeze(RSA_PUBLIC)\nconst RSA_PRIVATE = new Set([...RSA_PUBLIC, 'd', 'p', 'q', 'dp', 'dq', 'qi'])\nObject.freeze(RSA_PRIVATE)\n\n// RSA Key Type\nclass RSAKey extends Key {\n  constructor (...args) {\n    super(...args)\n    this[JWK_MEMBERS]()\n    Object.defineProperties(this, {\n      kty: {\n        value: 'RSA',\n        enumerable: true\n      },\n      length: {\n        get () {\n          Object.defineProperty(this, 'length', {\n            value: Buffer.byteLength(this.n, 'base64') * 8,\n            configurable: false\n          })\n\n          return this.length\n        },\n        configurable: true\n      }\n    })\n  }\n\n  static get [PUBLIC_MEMBERS] () {\n    return RSA_PUBLIC\n  }\n\n  static get [PRIVATE_MEMBERS] () {\n    return RSA_PRIVATE\n  }\n\n  // https://tc39.github.io/ecma262/#sec-ordinaryownpropertykeys no need for any special\n  // JSON.stringify handling in V8\n  [THUMBPRINT_MATERIAL] () {\n    return { e: this.e, kty: 'RSA', n: this.n }\n  }\n\n  [KEY_MANAGEMENT_ENCRYPT] () {\n    return this.algorithms('wrapKey')\n  }\n\n  [KEY_MANAGEMENT_DECRYPT] () {\n    return this.algorithms('unwrapKey')\n  }\n\n  static async generate (len = 2048, privat = true) {\n    if (!Number.isSafeInteger(len) || len < 512 || len % 8 !== 0 || (('electron' in process.versions) && len % 128 !== 0)) {\n      throw new TypeError('invalid bit length')\n    }\n\n    let privateKey, publicKey\n\n    if (keyObjectSupported) {\n      ({ privateKey, publicKey } = await generateKeyPair('rsa', { modulusLength: len }))\n      return privat ? privateKey : publicKey\n    }\n\n    ({ privateKey, publicKey } = await generateKeyPair('rsa', {\n      modulusLength: len,\n      publicKeyEncoding: { type: 'spki', format: 'pem' },\n      privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n    }))\n\n    if (privat) {\n      return createPrivateKey(privateKey)\n    } else {\n      return createPublicKey(publicKey)\n    }\n  }\n\n  static generateSync (len = 2048, privat = true) {\n    if (!Number.isSafeInteger(len) || len < 512 || len % 8 !== 0 || (('electron' in process.versions) && len % 128 !== 0)) {\n      throw new TypeError('invalid bit length')\n    }\n\n    let privateKey, publicKey\n\n    if (keyObjectSupported) {\n      ({ privateKey, publicKey } = generateKeyPairSync('rsa', { modulusLength: len }))\n      return privat ? privateKey : publicKey\n    }\n\n    ({ privateKey, publicKey } = generateKeyPairSync('rsa', {\n      modulusLength: len,\n      publicKeyEncoding: { type: 'spki', format: 'pem' },\n      privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n    }))\n\n    if (privat) {\n      return createPrivateKey(privateKey)\n    } else {\n      return createPublicKey(publicKey)\n    }\n  }\n}\n\nmodule.exports = RSAKey\n", "const { generateKeyPairSync, generateKeyPair: async } = require('crypto')\nconst { promisify } = require('util')\n\nconst {\n  THUMBPRINT_MATERIAL, JWK_MEMBERS, PUBLIC_MEMBERS,\n  PRIVATE_MEMBERS, KEY_MANAGEMENT_DECRYPT, KEY_MANAGEMENT_ENCRYPT\n} = require('../../help/consts')\nconst { EC_CURVES } = require('../../registry')\nconst { keyObjectSupported } = require('../../help/runtime_support')\nconst { createPublicKey, createPrivateKey } = require('../../help/key_object')\n\nconst errors = require('../../errors')\nconst { name: secp256k1 } = require('./secp256k1_crv')\n\nconst Key = require('./base')\n\nconst generateKeyPair = promisify(async)\n\nconst EC_PUBLIC = new Set(['crv', 'x', 'y'])\nObject.freeze(EC_PUBLIC)\nconst EC_PRIVATE = new Set([...EC_PUBLIC, 'd'])\nObject.freeze(EC_PRIVATE)\n\n// Elliptic Curve Key Type\nclass ECKey extends Key {\n  constructor (...args) {\n    super(...args)\n    this[JWK_MEMBERS]()\n    Object.defineProperty(this, 'kty', { value: 'EC', enumerable: true })\n    if (!EC_CURVES.has(this.crv)) {\n      throw new errors.JOSENotSupported('unsupported EC key curve')\n    }\n  }\n\n  static get [PUBLIC_MEMBERS] () {\n    return EC_PUBLIC\n  }\n\n  static get [PRIVATE_MEMBERS] () {\n    return EC_PRIVATE\n  }\n\n  // https://tc39.github.io/ecma262/#sec-ordinaryownpropertykeys no need for any special\n  // JSON.stringify handling in V8\n  [THUMBPRINT_MATERIAL] () {\n    return { crv: this.crv, kty: 'EC', x: this.x, y: this.y }\n  }\n\n  [KEY_MANAGEMENT_ENCRYPT] () {\n    return this.algorithms('deriveKey')\n  }\n\n  [KEY_MANAGEMENT_DECRYPT] () {\n    if (this.public) {\n      return new Set()\n    }\n    return this.algorithms('deriveKey')\n  }\n\n  static async generate (crv = 'P-256', privat = true) {\n    if (!EC_CURVES.has(crv)) {\n      throw new errors.JOSENotSupported(`unsupported EC key curve: ${crv}`)\n    }\n\n    if (crv === secp256k1 && crv !== 'secp256k1') {\n      crv = 'secp256k1'\n    }\n\n    let privateKey, publicKey\n\n    if (keyObjectSupported) {\n      ({ privateKey, publicKey } = await generateKeyPair('ec', { namedCurve: crv }))\n      return privat ? privateKey : publicKey\n    }\n\n    ({ privateKey, publicKey } = await generateKeyPair('ec', {\n      namedCurve: crv,\n      publicKeyEncoding: { type: 'spki', format: 'pem' },\n      privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n    }))\n\n    if (privat) {\n      return createPrivateKey(privateKey)\n    } else {\n      return createPublicKey(publicKey)\n    }\n  }\n\n  static generateSync (crv = 'P-256', privat = true) {\n    if (!EC_CURVES.has(crv)) {\n      throw new errors.JOSENotSupported(`unsupported EC key curve: ${crv}`)\n    }\n\n    if (crv === secp256k1 && crv !== 'secp256k1') {\n      crv = 'secp256k1'\n    }\n\n    let privateKey, publicKey\n\n    if (keyObjectSupported) {\n      ({ privateKey, publicKey } = generateKeyPairSync('ec', { namedCurve: crv }))\n      return privat ? privateKey : publicKey\n    }\n\n    ({ privateKey, publicKey } = generateKeyPairSync('ec', {\n      namedCurve: crv,\n      publicKeyEncoding: { type: 'spki', format: 'pem' },\n      privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n    }))\n\n    if (privat) {\n      return createPrivateKey(privateKey)\n    } else {\n      return createPublicKey(publicKey)\n    }\n  }\n}\n\nmodule.exports = ECKey\n", "const { generateKeyPairSync, generateKeyPair: async } = require('crypto')\nconst { promisify } = require('util')\n\nconst {\n  THUMBPRINT_MATERIAL, JWK_MEMBERS, PUBLIC_MEMBERS,\n  PRIVATE_MEMBERS, KEY_MANAGEMENT_DECRYPT, KEY_MANAGEMENT_ENCRYPT\n} = require('../../help/consts')\nconst { OKP_CURVES } = require('../../registry')\nconst { edDSASupported } = require('../../help/runtime_support')\nconst errors = require('../../errors')\n\nconst Key = require('./base')\n\nconst generateKeyPair = promisify(async)\n\nconst OKP_PUBLIC = new Set(['crv', 'x'])\nObject.freeze(OKP_PUBLIC)\nconst OKP_PRIVATE = new Set([...OKP_PUBLIC, 'd'])\nObject.freeze(OKP_PRIVATE)\n\n// Octet string key pairs Key Type\nclass OKPKey extends Key {\n  constructor (...args) {\n    super(...args)\n    this[JWK_MEMBERS]()\n    Object.defineProperty(this, 'kty', { value: 'OKP', enumerable: true })\n    if (!OKP_CURVES.has(this.crv)) {\n      throw new errors.JOSENotSupported('unsupported OKP key curve')\n    }\n  }\n\n  static get [PUBLIC_MEMBERS] () {\n    return OKP_PUBLIC\n  }\n\n  static get [PRIVATE_MEMBERS] () {\n    return OKP_PRIVATE\n  }\n\n  // https://tc39.github.io/ecma262/#sec-ordinaryownpropertykeys no need for any special\n  // JSON.stringify handling in V8\n  [THUMBPRINT_MATERIAL] () {\n    return { crv: this.crv, kty: 'OKP', x: this.x }\n  }\n\n  [KEY_MANAGEMENT_ENCRYPT] () {\n    return this.algorithms('deriveKey')\n  }\n\n  [KEY_MANAGEMENT_DECRYPT] () {\n    if (this.public) {\n      return new Set()\n    }\n    return this.algorithms('deriveKey')\n  }\n\n  static async generate (crv = 'Ed25519', privat = true) {\n    if (!edDSASupported) {\n      throw new errors.JOSENotSupported('OKP keys are not supported in your Node.js runtime version')\n    }\n\n    if (!OKP_CURVES.has(crv)) {\n      throw new errors.JOSENotSupported(`unsupported OKP key curve: ${crv}`)\n    }\n\n    const { privateKey, publicKey } = await generateKeyPair(crv.toLowerCase())\n\n    return privat ? privateKey : publicKey\n  }\n\n  static generateSync (crv = 'Ed25519', privat = true) {\n    if (!edDSASupported) {\n      throw new errors.JOSENotSupported('OKP keys are not supported in your Node.js runtime version')\n    }\n\n    if (!OKP_CURVES.has(crv)) {\n      throw new errors.JOSENotSupported(`unsupported OKP key curve: ${crv}`)\n    }\n\n    const { privateKey, publicKey } = generateKeyPairSync(crv.toLowerCase())\n\n    return privat ? privateKey : publicKey\n  }\n}\n\nmodule.exports = OKPKey\n", "const { randomBytes } = require('crypto')\n\nconst { createSecretKey } = require('../../help/key_object')\nconst base64url = require('../../help/base64url')\nconst {\n  THUMBPRINT_MATERIAL, PUBLIC_MEMBERS, PRIVATE_MEMBERS,\n  KEY_MANAGEMENT_DECRYPT, KEY_MANAGEMENT_ENCRYPT, KEYOBJECT\n} = require('../../help/consts')\n\nconst Key = require('./base')\n\nconst OCT_PUBLIC = new Set()\nObject.freeze(OCT_PUBLIC)\nconst OCT_PRIVATE = new Set(['k'])\nObject.freeze(OCT_PRIVATE)\n\n// Octet sequence Key Type\nclass OctKey extends Key {\n  constructor (...args) {\n    super(...args)\n    Object.defineProperties(this, {\n      kty: {\n        value: 'oct',\n        enumerable: true\n      },\n      length: {\n        value: this[KEYOBJECT] ? this[KEYOBJECT].symmetricKeySize * 8 : undefined\n      },\n      k: {\n        enumerable: false,\n        get () {\n          if (this[KEYOBJECT]) {\n            Object.defineProperty(this, 'k', {\n              value: base64url.encodeBuffer(this[KEYOBJECT].export()),\n              configurable: false\n            })\n          } else {\n            Object.defineProperty(this, 'k', {\n              value: undefined,\n              configurable: false\n            })\n          }\n\n          return this.k\n        },\n        configurable: true\n      }\n    })\n  }\n\n  static get [PUBLIC_MEMBERS] () {\n    return OCT_PUBLIC\n  }\n\n  static get [PRIVATE_MEMBERS] () {\n    return OCT_PRIVATE\n  }\n\n  // https://tc39.github.io/ecma262/#sec-ordinaryownpropertykeys no need for any special\n  // JSON.stringify handling in V8\n  [THUMBPRINT_MATERIAL] () {\n    if (!this[KEYOBJECT]) {\n      throw new TypeError('reference \"oct\" keys without \"k\" cannot have their thumbprint calculated')\n    }\n    return { k: this.k, kty: 'oct' }\n  }\n\n  [KEY_MANAGEMENT_ENCRYPT] () {\n    return new Set([\n      ...this.algorithms('wrapKey'),\n      ...this.algorithms('deriveKey')\n    ])\n  }\n\n  [KEY_MANAGEMENT_DECRYPT] () {\n    return this[KEY_MANAGEMENT_ENCRYPT]()\n  }\n\n  algorithms (...args) {\n    if (!this[KEYOBJECT]) {\n      return new Set()\n    }\n\n    return Key.prototype.algorithms.call(this, ...args)\n  }\n\n  static async generate (...args) {\n    return this.generateSync(...args)\n  }\n\n  static generateSync (len = 256, privat = true) {\n    if (!privat) {\n      throw new TypeError('\"oct\" keys cannot be generated as public')\n    }\n    if (!Number.isSafeInteger(len) || !len || len % 8 !== 0) {\n      throw new TypeError('invalid bit length')\n    }\n\n    return createSecretKey(randomBytes(len / 8))\n  }\n}\n\nmodule.exports = OctKey\n", "const { deprecate } = require('util')\n\nconst { createPublicKey, createPrivateKey, createSecretKey, KeyObject } = require('../help/key_object')\nconst base64url = require('../help/base64url')\nconst isObject = require('../help/is_object')\nconst { jwkToPem } = require('../help/key_utils')\nconst errors = require('../errors')\n\nconst RSAKey = require('./key/rsa')\nconst ECKey = require('./key/ec')\nconst OKPKey = require('./key/okp')\nconst OctKey = require('./key/oct')\n\nconst importable = new Set(['string', 'buffer', 'object'])\n\nconst mergedParameters = (target = {}, source = {}) => {\n  return {\n    alg: source.alg,\n    key_ops: source.key_ops,\n    kid: source.kid,\n    use: source.use,\n    x5c: source.x5c,\n    x5t: source.x5t,\n    'x5t#S256': source['x5t#S256'],\n    ...target\n  }\n}\n\nconst openSSHpublicKey = /^[a-zA-Z0-9-]+ AAAA(?:[0-9A-Za-z+/])+(?:==|=)?(?: .*)?$/\n\nconst asKey = (key, parameters, { calculateMissingRSAPrimes = false } = {}) => {\n  let privateKey, publicKey, secret\n\n  if (!importable.has(typeof key)) {\n    throw new TypeError('key argument must be a string, buffer or an object')\n  }\n\n  if (parameters !== undefined && !isObject(parameters)) {\n    throw new TypeError('parameters argument must be a plain object when provided')\n  }\n\n  if (key instanceof KeyObject) {\n    switch (key.type) {\n      case 'private':\n        privateKey = key\n        break\n      case 'public':\n        publicKey = key\n        break\n      case 'secret':\n        secret = key\n        break\n    }\n  } else if (typeof key === 'object' && key && 'kty' in key && key.kty === 'oct') { // symmetric key <Object>\n    try {\n      secret = createSecretKey(base64url.decodeToBuffer(key.k))\n    } catch (err) {\n      if (!('k' in key)) {\n        secret = { type: 'secret' }\n      }\n    }\n    parameters = mergedParameters(parameters, key)\n  } else if (typeof key === 'object' && key && 'kty' in key) { // assume JWK formatted asymmetric key <Object>\n    ({ calculateMissingRSAPrimes = false } = parameters || { calculateMissingRSAPrimes })\n    let pem\n\n    try {\n      pem = jwkToPem(key, { calculateMissingRSAPrimes })\n    } catch (err) {\n      if (err instanceof errors.JOSEError) {\n        throw err\n      }\n    }\n\n    if (pem && key.d) {\n      privateKey = createPrivateKey(pem)\n    } else if (pem) {\n      publicKey = createPublicKey(pem)\n    }\n\n    parameters = mergedParameters({}, key)\n  } else if (key && (typeof key === 'object' || typeof key === 'string')) { // <Object> | <string> | <Buffer> passed to crypto.createPrivateKey or crypto.createPublicKey or <Buffer> passed to crypto.createSecretKey\n    try {\n      privateKey = createPrivateKey(key)\n    } catch (err) {\n      if (err instanceof errors.JOSEError) {\n        throw err\n      }\n    }\n\n    try {\n      publicKey = createPublicKey(key)\n      if (key.startsWith('-----BEGIN CERTIFICATE-----') && (!parameters || !('x5c' in parameters))) {\n        parameters = mergedParameters(parameters, {\n          x5c: [key.replace(/(?:-----(?:BEGIN|END) CERTIFICATE-----|\\s)/g, '')]\n        })\n      }\n    } catch (err) {\n      if (err instanceof errors.JOSEError) {\n        throw err\n      }\n    }\n\n    try {\n      // this is to filter out invalid PEM keys and certs, i'll rather have them fail import then\n      // have them imported as symmetric \"oct\" keys\n      if (!key.includes('-----BEGIN') && !openSSHpublicKey.test(key.toString('ascii').replace(/[\\r\\n]/g, ''))) {\n        secret = createSecretKey(Buffer.isBuffer(key) ? key : Buffer.from(key))\n      }\n    } catch (err) {}\n  }\n\n  const keyObject = privateKey || publicKey || secret\n\n  if (privateKey || publicKey) {\n    switch (keyObject.asymmetricKeyType) {\n      case 'rsa':\n        return new RSAKey(keyObject, parameters)\n      case 'ec':\n        return new ECKey(keyObject, parameters)\n      case 'ed25519':\n      case 'ed448':\n      case 'x25519':\n      case 'x448':\n        return new OKPKey(keyObject, parameters)\n      default:\n        throw new errors.JOSENotSupported('only RSA, EC and OKP asymmetric keys are supported')\n    }\n  } else if (secret) {\n    return new OctKey(keyObject, parameters)\n  }\n\n  throw new errors.JWKImportFailed('key import failed')\n}\n\nmodule.exports = asKey\nObject.defineProperty(asKey, 'deprecated', {\n  value: deprecate((key, parameters) => { return asKey(key, parameters, { calculateMissingRSAPrimes: true }) }, 'JWK.importKey() is deprecated, use JWK.asKey() instead'),\n  enumerable: false\n})\n", "const errors = require('../errors')\n\nconst importKey = require('./import')\n\nconst RSAKey = require('./key/rsa')\nconst ECKey = require('./key/ec')\nconst OKPKey = require('./key/okp')\nconst OctKey = require('./key/oct')\n\nconst generate = async (kty, crvOrSize, params, generatePrivate = true) => {\n  switch (kty) {\n    case 'RSA':\n      return importKey(\n        await RSAKey.generate(crvOrSize, generatePrivate),\n        params\n      )\n    case 'EC':\n      return importKey(\n        await ECKey.generate(crvOrSize, generatePrivate),\n        params\n      )\n    case 'OKP':\n      return importKey(\n        await OKPKey.generate(crvOrSize, generatePrivate),\n        params\n      )\n    case 'oct':\n      return importKey(\n        await OctKey.generate(crvOrSize, generatePrivate),\n        params\n      )\n    default:\n      throw new errors.JOSENotSupported(`unsupported key type: ${kty}`)\n  }\n}\n\nconst generateSync = (kty, crvOrSize, params, generatePrivate = true) => {\n  switch (kty) {\n    case 'RSA':\n      return importKey(RSAKey.generateSync(crvOrSize, generatePrivate), params)\n    case 'EC':\n      return importKey(ECKey.generateSync(crvOrSize, generatePrivate), params)\n    case 'OKP':\n      return importKey(OKPKey.generateSync(crvOrSize, generatePrivate), params)\n    case 'oct':\n      return importKey(OctKey.generateSync(crvOrSize, generatePrivate), params)\n    default:\n      throw new errors.JOSENotSupported(`unsupported key type: ${kty}`)\n  }\n}\n\nmodule.exports.generate = generate\nmodule.exports.generateSync = generateSync\n", "const { inspect } = require('util')\n\nconst Key = require('./base')\n\nclass NoneKey extends Key {\n  constructor () {\n    super({ type: 'unsecured' }, { alg: 'none' })\n    Object.defineProperties(this, {\n      kid: { value: undefined },\n      kty: { value: undefined },\n      thumbprint: { value: undefined },\n      toJWK: { value: undefined },\n      toPEM: { value: undefined }\n    })\n  }\n\n  /* c8 ignore next 3 */\n  [inspect.custom] () {\n    return 'None {}'\n  }\n\n  algorithms (operation) {\n    switch (operation) {\n      case 'sign':\n      case 'verify':\n      case undefined:\n        return new Set(['none'])\n      default:\n        return new Set()\n    }\n  }\n}\n\nmodule.exports = new NoneKey()\n", "const { inspect } = require('util')\n\nconst Key = require('./base')\n\nclass EmbeddedJWK extends Key {\n  constructor () {\n    super({ type: 'embedded' })\n    Object.defineProperties(this, {\n      kid: { value: undefined },\n      kty: { value: undefined },\n      thumbprint: { value: undefined },\n      toJWK: { value: undefined },\n      toPEM: { value: undefined }\n    })\n  }\n\n  /* c8 ignore next 3 */\n  [inspect.custom] () {\n    return 'Embedded.JWK {}'\n  }\n\n  algorithms () {\n    return new Set()\n  }\n}\n\nmodule.exports = new EmbeddedJWK()\n", "const { inspect } = require('util')\n\nconst Key = require('./base')\n\nclass EmbeddedX5C extends Key {\n  constructor () {\n    super({ type: 'embedded' })\n    Object.defineProperties(this, {\n      kid: { value: undefined },\n      kty: { value: undefined },\n      thumbprint: { value: undefined },\n      toJWK: { value: undefined },\n      toPEM: { value: undefined }\n    })\n  }\n\n  /* c8 ignore next 3 */\n  [inspect.custom] () {\n    return 'Embedded.X5C {}'\n  }\n\n  algorithms () {\n    return new Set()\n  }\n}\n\nmodule.exports = new EmbeddedX5C()\n", "const Key = require('./key/base')\nconst None = require('./key/none')\nconst EmbeddedJWK = require('./key/embedded.jwk')\nconst EmbeddedX5C = require('./key/embedded.x5c')\nconst importKey = require('./import')\nconst generate = require('./generate')\n\nmodule.exports = {\n  ...generate,\n  asKey: importKey,\n  isKey: input => input instanceof Key,\n  None,\n  EmbeddedJWK,\n  EmbeddedX5C\n}\n\n/* deprecated */\nObject.defineProperty(module.exports, 'importKey', {\n  value: importKey.deprecated,\n  enumerable: false\n})\n", "const { deprecate, inspect } = require('util')\n\nconst isObject = require('../help/is_object')\nconst { generate, generateSync } = require('../jwk/generate')\nconst { USES_MAPPING } = require('../help/consts')\nconst { isKey, asKey: importKey } = require('../jwk')\n\nconst keyscore = (key, { alg, use, ops }) => {\n  let score = 0\n\n  if (alg && key.alg) {\n    score++\n  }\n\n  if (use && key.use) {\n    score++\n  }\n\n  if (ops && key.key_ops) {\n    score++\n  }\n\n  return score\n}\n\nclass KeyStore {\n  constructor (...keys) {\n    while (keys.some(Array.isArray)) {\n      keys = keys.flat ? keys.flat() : keys.reduce((acc, val) => {\n        if (Array.isArray(val)) {\n          return [...acc, ...val]\n        }\n\n        acc.push(val)\n        return acc\n      }, [])\n    }\n    if (keys.some(k => !isKey(k) || !k.kty)) {\n      throw new TypeError('all keys must be instances of a key instantiated by JWK.asKey')\n    }\n\n    this._keys = new Set(keys)\n  }\n\n  all ({ alg, kid, thumbprint, use, kty, key_ops: ops, x5t, 'x5t#S256': x5t256, crv } = {}) {\n    if (ops !== undefined && (!Array.isArray(ops) || !ops.length || ops.some(x => typeof x !== 'string'))) {\n      throw new TypeError('`key_ops` must be a non-empty array of strings')\n    }\n\n    const search = { alg, use, ops }\n    return [...this._keys]\n      .filter((key) => {\n        let candidate = true\n\n        if (candidate && kid !== undefined && key.kid !== kid) {\n          candidate = false\n        }\n\n        if (candidate && thumbprint !== undefined && key.thumbprint !== thumbprint) {\n          candidate = false\n        }\n\n        if (candidate && x5t !== undefined && key.x5t !== x5t) {\n          candidate = false\n        }\n\n        if (candidate && x5t256 !== undefined && key['x5t#S256'] !== x5t256) {\n          candidate = false\n        }\n\n        if (candidate && kty !== undefined && key.kty !== kty) {\n          candidate = false\n        }\n\n        if (candidate && crv !== undefined && (key.crv !== crv)) {\n          candidate = false\n        }\n\n        if (alg !== undefined && !key.algorithms().has(alg)) {\n          candidate = false\n        }\n\n        if (candidate && use !== undefined && (key.use !== undefined && key.use !== use)) {\n          candidate = false\n        }\n\n        // TODO:\n        if (candidate && ops !== undefined && (key.key_ops !== undefined || key.use !== undefined)) {\n          let keyOps\n          if (key.key_ops) {\n            keyOps = new Set(key.key_ops)\n          } else {\n            keyOps = USES_MAPPING[key.use]\n          }\n          if (ops.some(x => !keyOps.has(x))) {\n            candidate = false\n          }\n        }\n\n        return candidate\n      })\n      .sort((first, second) => keyscore(second, search) - keyscore(first, search))\n  }\n\n  get (...args) {\n    return this.all(...args)[0]\n  }\n\n  add (key) {\n    if (!isKey(key) || !key.kty) {\n      throw new TypeError('key must be an instance of a key instantiated by JWK.asKey')\n    }\n\n    this._keys.add(key)\n  }\n\n  remove (key) {\n    if (!isKey(key)) {\n      throw new TypeError('key must be an instance of a key instantiated by JWK.asKey')\n    }\n\n    this._keys.delete(key)\n  }\n\n  toJWKS (priv = false) {\n    return {\n      keys: [...this._keys.values()].map(\n        key => key.toJWK(priv && (key.private || (key.secret && key.k)))\n      )\n    }\n  }\n\n  async generate (...args) {\n    this._keys.add(await generate(...args))\n  }\n\n  generateSync (...args) {\n    this._keys.add(generateSync(...args))\n  }\n\n  get size () {\n    return this._keys.size\n  }\n\n  /* c8 ignore next 8 */\n  [inspect.custom] () {\n    return `${this.constructor.name} ${inspect(this.toJWKS(false), {\n      depth: Infinity,\n      colors: process.stdout.isTTY,\n      compact: false,\n      sorted: true\n    })}`\n  }\n\n  * [Symbol.iterator] () {\n    for (const key of this._keys) {\n      yield key\n    }\n  }\n}\n\nfunction asKeyStore (jwks, { ignoreErrors = false, calculateMissingRSAPrimes = false } = {}) {\n  if (!isObject(jwks) || !Array.isArray(jwks.keys) || jwks.keys.some(k => !isObject(k) || !('kty' in k))) {\n    throw new TypeError('jwks must be a JSON Web Key Set formatted object')\n  }\n\n  const keys = jwks.keys.map((jwk) => {\n    try {\n      return importKey(jwk, { calculateMissingRSAPrimes })\n    } catch (err) {\n      if (!ignoreErrors) {\n        throw err\n      }\n    }\n  }).filter(Boolean)\n\n  return new KeyStore(...keys)\n}\n\nObject.defineProperty(KeyStore, 'fromJWKS', {\n  value: deprecate(jwks => asKeyStore(jwks, { calculateMissingRSAPrimes: true }), 'JWKS.KeyStore.fromJWKS() is deprecated, use JWKS.asKeyStore() instead'),\n  enumerable: false\n})\n\nmodule.exports = { KeyStore, asKeyStore }\n", "const errors = require('../errors')\nconst Key = require('../jwk/key/base')\nconst importKey = require('../jwk/import')\nconst { KeyStore } = require('../jwks/keystore')\n\nmodule.exports = (input, keyStoreAllowed = false) => {\n  if (input instanceof Key) {\n    return input\n  }\n\n  if (input instanceof KeyStore) {\n    if (!keyStoreAllowed) {\n      throw new TypeError('key argument for this operation must not be a JWKS.KeyStore instance')\n    }\n\n    return input\n  }\n\n  try {\n    return importKey(input)\n  } catch (err) {\n    if (err instanceof errors.JOSEError && !(err instanceof errors.JWKImportFailed)) {\n      throw err\n    }\n\n    let msg\n    if (keyStoreAllowed) {\n      msg = 'key must be an instance of a key instantiated by JWK.asKey, a valid JWK.asKey input, or a JWKS.KeyStore instance'\n    } else {\n      msg = 'key must be an instance of a key instantiated by JWK.asKey, or a valid JWK.asKey input'\n    }\n\n    throw new TypeError(msg)\n  }\n}\n", "module.exports = obj => JSON.parse(JSON.stringify(obj))\n", "const { timingSafeEqual: TSE } = require('crypto')\n\nconst paddedBuffer = (input, length) => {\n  if (input.length === length) {\n    return input\n  }\n\n  const buffer = Buffer.alloc(length)\n  input.copy(buffer)\n  return buffer\n}\n\nconst timingSafeEqual = (a, b) => {\n  const length = Math.max(a.length, b.length)\n  return TSE(paddedBuffer(a, length), paddedBuffer(b, length))\n}\n\nmodule.exports = timingSafeEqual\n", "module.exports = alg => `sha${alg.substr(2, 3)}`\n", "const { createHmac } = require('crypto')\n\nconst { KEYOBJECT } = require('../help/consts')\nconst timingSafeEqual = require('../help/timing_safe_equal')\nconst resolveNodeAlg = require('../help/node_alg')\nconst { asInput } = require('../help/key_object')\n\nconst sign = (jwaAlg, hmacAlg, { [KEYOBJECT]: keyObject }, payload) => {\n  const hmac = createHmac(hmacAlg, asInput(keyObject, false))\n  hmac.update(payload)\n  return hmac.digest()\n}\n\nconst verify = (jwaAlg, hmacAlg, key, payload, signature) => {\n  const expected = sign(jwaAlg, hmacAlg, key, payload)\n  const actual = signature\n\n  return timingSafeEqual(actual, expected)\n}\n\nmodule.exports = (JWA, JWK) => {\n  ['HS256', 'HS384', 'HS512'].forEach((jwaAlg) => {\n    const hmacAlg = resolveNodeAlg(jwaAlg)\n    JWA.sign.set(jwaAlg, sign.bind(undefined, jwaAlg, hmacAlg))\n    JWA.verify.set(jwaAlg, verify.bind(undefined, jwaAlg, hmacAlg))\n    JWK.oct.sign[jwaAlg] = JWK.oct.verify[jwaAlg] = key => key.use === 'sig' || key.use === undefined\n  })\n}\n", "const MAX_OCTET = 0x80\nconst CLASS_UNIVERSAL = 0\nconst PRIMITIVE_BIT = 0x20\nconst TAG_SEQ = 0x10\nconst TAG_INT = 0x02\nconst ENCODED_TAG_SEQ = (TAG_SEQ | PRIMITIVE_BIT) | (CLASS_UNIVERSAL << 6)\nconst ENCODED_TAG_INT = TAG_INT | (CLASS_UNIVERSAL << 6)\n\nconst getParamSize = keySize => ((keySize / 8) | 0) + (keySize % 8 === 0 ? 0 : 1)\n\nconst paramBytesForAlg = {\n  ES256: getParamSize(256),\n  ES256K: getParamSize(256),\n  ES384: getParamSize(384),\n  ES512: getParamSize(521)\n}\n\nconst countPadding = (buf, start, stop) => {\n  let padding = 0\n  while (start + padding < stop && buf[start + padding] === 0) {\n    ++padding\n  }\n\n  const needsSign = buf[start + padding] >= MAX_OCTET\n  if (needsSign) {\n    --padding\n  }\n\n  return padding\n}\n\nmodule.exports.derToJose = (signature, alg) => {\n  if (!Buffer.isBuffer(signature)) {\n    throw new TypeError('ECDSA signature must be a Buffer')\n  }\n\n  if (!paramBytesForAlg[alg]) {\n    throw new Error(`Unknown algorithm \"${alg}\"`)\n  }\n\n  const paramBytes = paramBytesForAlg[alg]\n\n  // the DER encoded param should at most be the param size, plus a padding\n  // zero, since due to being a signed integer\n  const maxEncodedParamLength = paramBytes + 1\n\n  const inputLength = signature.length\n\n  let offset = 0\n  if (signature[offset++] !== ENCODED_TAG_SEQ) {\n    throw new Error('Could not find expected \"seq\"')\n  }\n\n  let seqLength = signature[offset++]\n  if (seqLength === (MAX_OCTET | 1)) {\n    seqLength = signature[offset++]\n  }\n\n  if (inputLength - offset < seqLength) {\n    throw new Error(`\"seq\" specified length of ${seqLength}\", only ${inputLength - offset}\" remaining`)\n  }\n\n  if (signature[offset++] !== ENCODED_TAG_INT) {\n    throw new Error('Could not find expected \"int\" for \"r\"')\n  }\n\n  const rLength = signature[offset++]\n\n  if (inputLength - offset - 2 < rLength) {\n    throw new Error(`\"r\" specified length of \"${rLength}\", only \"${inputLength - offset - 2}\" available`)\n  }\n\n  if (maxEncodedParamLength < rLength) {\n    throw new Error(`\"r\" specified length of \"${rLength}\", max of \"${maxEncodedParamLength}\" is acceptable`)\n  }\n\n  const rOffset = offset\n  offset += rLength\n\n  if (signature[offset++] !== ENCODED_TAG_INT) {\n    throw new Error('Could not find expected \"int\" for \"s\"')\n  }\n\n  const sLength = signature[offset++]\n\n  if (inputLength - offset !== sLength) {\n    throw new Error(`\"s\" specified length of \"${sLength}\", expected \"${inputLength - offset}\"`)\n  }\n\n  if (maxEncodedParamLength < sLength) {\n    throw new Error(`\"s\" specified length of \"${sLength}\", max of \"${maxEncodedParamLength}\" is acceptable`)\n  }\n\n  const sOffset = offset\n  offset += sLength\n\n  if (offset !== inputLength) {\n    throw new Error(`Expected to consume entire buffer, but \"${inputLength - offset}\" bytes remain`)\n  }\n\n  const rPadding = paramBytes - rLength\n\n  const sPadding = paramBytes - sLength\n\n  const dst = Buffer.allocUnsafe(rPadding + rLength + sPadding + sLength)\n\n  for (offset = 0; offset < rPadding; ++offset) {\n    dst[offset] = 0\n  }\n  signature.copy(dst, offset, rOffset + Math.max(-rPadding, 0), rOffset + rLength)\n\n  offset = paramBytes\n\n  for (const o = offset; offset < o + sPadding; ++offset) {\n    dst[offset] = 0\n  }\n  signature.copy(dst, offset, sOffset + Math.max(-sPadding, 0), sOffset + sLength)\n\n  return dst\n}\n\nmodule.exports.joseToDer = (signature, alg) => {\n  if (!Buffer.isBuffer(signature)) {\n    throw new TypeError('ECDSA signature must be a Buffer')\n  }\n\n  if (!paramBytesForAlg[alg]) {\n    throw new TypeError(`Unknown algorithm \"${alg}\"`)\n  }\n\n  const paramBytes = paramBytesForAlg[alg]\n\n  const signatureBytes = signature.length\n  if (signatureBytes !== paramBytes * 2) {\n    throw new Error(`\"${alg}\" signatures must be \"${paramBytes * 2}\" bytes, saw \"${signatureBytes}\"`)\n  }\n\n  const rPadding = countPadding(signature, 0, paramBytes)\n  const sPadding = countPadding(signature, paramBytes, signature.length)\n  const rLength = paramBytes - rPadding\n  const sLength = paramBytes - sPadding\n\n  const rsBytes = 1 + 1 + rLength + 1 + 1 + sLength\n\n  const shortLength = rsBytes < MAX_OCTET\n\n  const dst = Buffer.allocUnsafe((shortLength ? 2 : 3) + rsBytes)\n\n  let offset = 0\n  dst[offset++] = ENCODED_TAG_SEQ\n  if (shortLength) {\n    // Bit 8 has value \"0\"\n    // bits 7-1 give the length.\n    dst[offset++] = rsBytes\n  } else {\n    // Bit 8 of first octet has value \"1\"\n    // bits 7-1 give the number of additional length octets.\n    dst[offset++] = MAX_OCTET\t| 1 // eslint-disable-line no-tabs\n    // length, base 256\n    dst[offset++] = rsBytes & 0xff\n  }\n  dst[offset++] = ENCODED_TAG_INT\n  dst[offset++] = rLength\n  if (rPadding < 0) {\n    dst[offset++] = 0\n    offset += signature.copy(dst, offset, 0, paramBytes)\n  } else {\n    offset += signature.copy(dst, offset, rPadding, paramBytes)\n  }\n  dst[offset++] = ENCODED_TAG_INT\n  dst[offset++] = sLength\n  if (sPadding < 0) {\n    dst[offset++] = 0\n    signature.copy(dst, offset, paramBytes)\n  } else {\n    signature.copy(dst, offset, paramBytes + sPadding)\n  }\n\n  return dst\n}\n", "const { sign: signOneShot, verify: verifyOneShot, createSign, createVerify, getCurves } = require('crypto')\n\nconst { derToJose, joseToDer } = require('../help/ecdsa_signatures')\nconst { KEYOBJECT } = require('../help/consts')\nconst resolveNodeAlg = require('../help/node_alg')\nconst { asInput } = require('../help/key_object')\nconst { dsaEncodingSupported } = require('../help/runtime_support')\nconst { name: secp256k1 } = require('../jwk/key/secp256k1_crv')\n\nlet sign, verify\n\nif (dsaEncodingSupported) {\n  sign = (jwaAlg, nodeAlg, { [KEYOBJECT]: keyObject }, payload) => {\n    if (typeof payload === 'string') {\n      payload = Buffer.from(payload)\n    }\n    return signOneShot(nodeAlg, payload, { key: asInput(keyObject, false), dsaEncoding: 'ieee-p1363' })\n  }\n  verify = (jwaAlg, nodeAlg, { [KEYOBJECT]: keyObject }, payload, signature) => {\n    try {\n      return verifyOneShot(nodeAlg, payload, { key: asInput(keyObject, true), dsaEncoding: 'ieee-p1363' }, signature)\n    } catch (err) {\n      return false\n    }\n  }\n} else {\n  sign = (jwaAlg, nodeAlg, { [KEYOBJECT]: keyObject }, payload) => {\n    return derToJose(createSign(nodeAlg).update(payload).sign(asInput(keyObject, false)), jwaAlg)\n  }\n  verify = (jwaAlg, nodeAlg, { [KEYOBJECT]: keyObject }, payload, signature) => {\n    try {\n      return createVerify(nodeAlg).update(payload).verify(asInput(keyObject, true), joseToDer(signature, jwaAlg))\n    } catch (err) {\n      return false\n    }\n  }\n}\n\nconst crvToAlg = (crv) => {\n  switch (crv) {\n    case 'P-256':\n      return 'ES256'\n    case secp256k1:\n      return 'ES256K'\n    case 'P-384':\n      return 'ES384'\n    case 'P-521':\n      return 'ES512'\n  }\n}\n\nmodule.exports = (JWA, JWK) => {\n  const algs = []\n\n  if (getCurves().includes('prime256v1')) {\n    algs.push('ES256')\n  }\n\n  if (getCurves().includes('secp256k1')) {\n    algs.push('ES256K')\n  }\n\n  if (getCurves().includes('secp384r1')) {\n    algs.push('ES384')\n  }\n\n  if (getCurves().includes('secp521r1')) {\n    algs.push('ES512')\n  }\n\n  algs.forEach((jwaAlg) => {\n    const nodeAlg = resolveNodeAlg(jwaAlg)\n    JWA.sign.set(jwaAlg, sign.bind(undefined, jwaAlg, nodeAlg))\n    JWA.verify.set(jwaAlg, verify.bind(undefined, jwaAlg, nodeAlg))\n    JWK.EC.sign[jwaAlg] = key => key.private && JWK.EC.verify[jwaAlg](key)\n    JWK.EC.verify[jwaAlg] = key => (key.use === 'sig' || key.use === undefined) && crvToAlg(key.crv) === jwaAlg\n  })\n}\n", "const { sign: signOneShot, verify: verifyOneShot } = require('crypto')\n\nconst { KEYOBJECT } = require('../help/consts')\nconst { edDSASupported } = require('../help/runtime_support')\n\nconst sign = ({ [KEYOBJECT]: keyObject }, payload) => {\n  if (typeof payload === 'string') {\n    payload = Buffer.from(payload)\n  }\n  return signOneShot(undefined, payload, keyObject)\n}\n\nconst verify = ({ [KEYOBJECT]: keyObject }, payload, signature) => {\n  return verifyOneShot(undefined, payload, keyObject, signature)\n}\n\nmodule.exports = (JWA, JWK) => {\n  if (edDSASupported) {\n    JWA.sign.set('EdDSA', sign)\n    JWA.verify.set('EdDSA', verify)\n    JWK.OKP.sign.EdDSA = key => key.private && JWK.OKP.verify.EdDSA(key)\n    JWK.OKP.verify.EdDSA = key => (key.use === 'sig' || key.use === undefined) && key.keyObject.asymmetricKeyType.startsWith('ed')\n  }\n}\n", "const {\n  createSign,\n  createVerify,\n  constants\n} = require('crypto')\n\nconst { KEYOBJECT } = require('../help/consts')\nconst resolveNodeAlg = require('../help/node_alg')\nconst { asInput } = require('../help/key_object')\n\nconst sign = (nodeAlg, { [KEYOBJECT]: keyObject }, payload) => {\n  const key = asInput(keyObject, false)\n  return createSign(nodeAlg).update(payload).sign({\n    key,\n    padding: constants.RSA_PKCS1_PSS_PADDING,\n    saltLength: constants.RSA_PSS_SALTLEN_DIGEST\n  })\n}\n\nconst verify = (nodeAlg, { [KEYOBJECT]: keyObject }, payload, signature) => {\n  const key = asInput(keyObject, true)\n  return createVerify(nodeAlg).update(payload).verify({\n    key,\n    padding: constants.RSA_PKCS1_PSS_PADDING,\n    saltLength: constants.RSA_PSS_SALTLEN_DIGEST\n  }, signature)\n}\n\nconst LENGTHS = {\n  PS256: 528,\n  PS384: 784,\n  PS512: 1040\n}\n\nmodule.exports = (JWA, JWK) => {\n  ['PS256', 'PS384', 'PS512'].forEach((jwaAlg) => {\n    const nodeAlg = resolveNodeAlg(jwaAlg)\n    JWA.sign.set(jwaAlg, sign.bind(undefined, nodeAlg))\n    JWA.verify.set(jwaAlg, verify.bind(undefined, nodeAlg))\n    JWK.RSA.sign[jwaAlg] = key => key.private && JWK.RSA.verify[jwaAlg](key)\n    JWK.RSA.verify[jwaAlg] = key => (key.use === 'sig' || key.use === undefined) && key.length >= LENGTHS[jwaAlg]\n  })\n}\n", "const { createSign, createVerify } = require('crypto')\n\nconst { KEYOBJECT } = require('../help/consts')\nconst resolveNodeAlg = require('../help/node_alg')\nconst { asInput } = require('../help/key_object')\n\nconst sign = (nodeAlg, { [KEYOBJECT]: keyObject }, payload) => {\n  return createSign(nodeAlg).update(payload).sign(asInput(keyObject, false))\n}\n\nconst verify = (nodeAlg, { [KEYOBJECT]: keyObject }, payload, signature) => {\n  return createVerify(nodeAlg).update(payload).verify(asInput(keyObject, true), signature)\n}\n\nconst LENGTHS = {\n  RS256: 0,\n  RS384: 624,\n  RS512: 752\n}\n\nmodule.exports = (JWA, JWK) => {\n  ['RS256', 'RS384', 'RS512'].forEach((jwaAlg) => {\n    const nodeAlg = resolveNodeAlg(jwaAlg)\n    JWA.sign.set(jwaAlg, sign.bind(undefined, nodeAlg))\n    JWA.verify.set(jwaAlg, verify.bind(undefined, nodeAlg))\n    JWK.RSA.sign[jwaAlg] = key => key.private && JWK.RSA.verify[jwaAlg](key)\n    JWK.RSA.verify[jwaAlg] = key => (key.use === 'sig' || key.use === undefined) && key.length >= LENGTHS[jwaAlg]\n  })\n}\n", "const sign = () => Buffer.from('')\nconst verify = (key, payload, signature) => !signature.length\n\nmodule.exports = (JWA, JWK) => {\n  JWA.sign.set('none', sign)\n  JWA.verify.set('none', verify)\n}\n", "const MAX_INT32 = Math.pow(2, 32)\n\nmodule.exports = (value, buf = Buffer.allocUnsafe(8)) => {\n  const high = Math.floor(value / MAX_INT32)\n  const low = value % MAX_INT32\n\n  buf.writeUInt32BE(high, 0)\n  buf.writeUInt32BE(low, 4)\n  return buf\n}\n", "const { createCipheriv, createDecipheriv, getCiphers } = require('crypto')\n\nconst uint64be = require('../help/uint64be')\nconst timingSafeEqual = require('../help/timing_safe_equal')\nconst { KEYOBJECT } = require('../help/consts')\nconst { JWEInvalid, JWEDecryptionFailed } = require('../errors')\n\nconst checkInput = function (size, iv, tag) {\n  if (iv.length !== 16) {\n    throw new JWEInvalid('invalid iv')\n  }\n  if (arguments.length === 3) {\n    if (tag.length !== size / 8) {\n      throw new JWEInvalid('invalid tag')\n    }\n  }\n}\n\nconst encrypt = (size, sign, { [KEYOBJECT]: keyObject }, cleartext, { iv, aad = Buffer.alloc(0) }) => {\n  const key = keyObject.export()\n  checkInput(size, iv)\n\n  const keySize = size / 8\n  const encKey = key.slice(keySize)\n  const cipher = createCipheriv(`aes-${size}-cbc`, encKey, iv)\n  const ciphertext = Buffer.concat([cipher.update(cleartext), cipher.final()])\n  const macData = Buffer.concat([aad, iv, ciphertext, uint64be(aad.length * 8)])\n\n  const macKey = key.slice(0, keySize)\n  const tag = sign({ [KEYOBJECT]: macKey }, macData).slice(0, keySize)\n\n  return { ciphertext, tag }\n}\n\nconst decrypt = (size, sign, { [KEYOBJECT]: keyObject }, ciphertext, { iv, tag = Buffer.alloc(0), aad = Buffer.alloc(0) }) => {\n  checkInput(size, iv, tag)\n\n  const keySize = size / 8\n  const key = keyObject.export()\n  const encKey = key.slice(keySize)\n  const macKey = key.slice(0, keySize)\n\n  const macData = Buffer.concat([aad, iv, ciphertext, uint64be(aad.length * 8)])\n  const expectedTag = sign({ [KEYOBJECT]: macKey }, macData, tag).slice(0, keySize)\n  const macCheckPassed = timingSafeEqual(tag, expectedTag)\n\n  if (!macCheckPassed) {\n    throw new JWEDecryptionFailed()\n  }\n\n  let cleartext\n  try {\n    const cipher = createDecipheriv(`aes-${size}-cbc`, encKey, iv)\n    cleartext = Buffer.concat([cipher.update(ciphertext), cipher.final()])\n  } catch (err) {}\n\n  if (!cleartext) {\n    throw new JWEDecryptionFailed()\n  }\n\n  return cleartext\n}\n\nmodule.exports = (JWA, JWK) => {\n  ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512'].forEach((jwaAlg) => {\n    const size = parseInt(jwaAlg.substr(1, 3), 10)\n    const sign = JWA.sign.get(`HS${size * 2}`)\n    if (getCiphers().includes(`aes-${size}-cbc`)) {\n      JWA.encrypt.set(jwaAlg, encrypt.bind(undefined, size, sign))\n      JWA.decrypt.set(jwaAlg, decrypt.bind(undefined, size, sign))\n      JWK.oct.encrypt[jwaAlg] = JWK.oct.decrypt[jwaAlg] = key => (key.use === 'enc' || key.use === undefined) && key.length / 2 === size\n    }\n  })\n}\n", "const { createCipheriv, createDecipheriv, getCiphers } = require('crypto')\n\nconst { KEYOBJECT } = require('../help/consts')\nconst { JWEInvalid, JWEDecryptionFailed } = require('../errors')\nconst { asInput } = require('../help/key_object')\n\nconst checkInput = function (size, iv, tag) {\n  if (iv.length !== 12) {\n    throw new JWEInvalid('invalid iv')\n  }\n  if (arguments.length === 3) {\n    if (tag.length !== 16) {\n      throw new JWEInvalid('invalid tag')\n    }\n  }\n}\n\nconst encrypt = (size, { [KEYOBJECT]: keyObject }, cleartext, { iv, aad = Buffer.alloc(0) }) => {\n  const key = asInput(keyObject, false)\n  checkInput(size, iv)\n\n  const cipher = createCipheriv(`aes-${size}-gcm`, key, iv, { authTagLength: 16 })\n  cipher.setAAD(aad)\n\n  const ciphertext = Buffer.concat([cipher.update(cleartext), cipher.final()])\n  const tag = cipher.getAuthTag()\n\n  return { ciphertext, tag }\n}\n\nconst decrypt = (size, { [KEYOBJECT]: keyObject }, ciphertext, { iv, tag = Buffer.alloc(0), aad = Buffer.alloc(0) }) => {\n  const key = asInput(keyObject, false)\n  checkInput(size, iv, tag)\n\n  try {\n    const cipher = createDecipheriv(`aes-${size}-gcm`, key, iv, { authTagLength: 16 })\n    cipher.setAuthTag(tag)\n    cipher.setAAD(aad)\n\n    return Buffer.concat([cipher.update(ciphertext), cipher.final()])\n  } catch (err) {\n    throw new JWEDecryptionFailed()\n  }\n}\n\nmodule.exports = (JWA, JWK) => {\n  ['A128GCM', 'A192GCM', 'A256GCM'].forEach((jwaAlg) => {\n    const size = parseInt(jwaAlg.substr(1, 3), 10)\n    if (getCiphers().includes(`aes-${size}-gcm`)) {\n      JWA.encrypt.set(jwaAlg, encrypt.bind(undefined, size))\n      JWA.decrypt.set(jwaAlg, decrypt.bind(undefined, size))\n      JWK.oct.encrypt[jwaAlg] = JWK.oct.decrypt[jwaAlg] = key => (key.use === 'enc' || key.use === undefined) && key.length === size\n    }\n  })\n}\n", "const { publicEncrypt, privateDecrypt, constants } = require('crypto')\n\nconst { oaepHashSupported } = require('../help/runtime_support')\nconst { KEYOBJECT } = require('../help/consts')\nconst { asInput } = require('../help/key_object')\n\nconst resolvePadding = (alg) => {\n  switch (alg) {\n    case 'RSA-OAEP':\n    case 'RSA-OAEP-256':\n    case 'RSA-OAEP-384':\n    case 'RSA-OAEP-512':\n      return constants.RSA_PKCS1_OAEP_PADDING\n    case 'RSA1_5':\n      return constants.RSA_PKCS1_PADDING\n  }\n}\n\nconst resolveOaepHash = (alg) => {\n  switch (alg) {\n    case 'RSA-OAEP':\n      return 'sha1'\n    case 'RSA-OAEP-256':\n      return 'sha256'\n    case 'RSA-OAEP-384':\n      return 'sha384'\n    case 'RSA-OAEP-512':\n      return 'sha512'\n    default:\n      return undefined\n  }\n}\n\nconst wrapKey = (padding, oaepHash, { [KEYOBJECT]: keyObject }, payload) => {\n  const key = asInput(keyObject, true)\n  return { wrapped: publicEncrypt({ key, oaepHash, padding }, payload) }\n}\n\nconst unwrapKey = (padding, oaepHash, { [KEYOBJECT]: keyObject }, payload) => {\n  const key = asInput(keyObject, false)\n  return privateDecrypt({ key, oaepHash, padding }, payload)\n}\n\nconst LENGTHS = {\n  RSA1_5: 0,\n  'RSA-OAEP': 592,\n  'RSA-OAEP-256': 784,\n  'RSA-OAEP-384': 1040,\n  'RSA-OAEP-512': 1296\n}\n\nmodule.exports = (JWA, JWK) => {\n  const algs = ['RSA-OAEP', 'RSA1_5']\n\n  if (oaepHashSupported) {\n    algs.splice(1, 0, 'RSA-OAEP-256', 'RSA-OAEP-384', 'RSA-OAEP-512')\n  }\n\n  algs.forEach((jwaAlg) => {\n    const padding = resolvePadding(jwaAlg)\n    const oaepHash = resolveOaepHash(jwaAlg)\n    JWA.keyManagementEncrypt.set(jwaAlg, wrapKey.bind(undefined, padding, oaepHash))\n    JWA.keyManagementDecrypt.set(jwaAlg, unwrapKey.bind(undefined, padding, oaepHash))\n    JWK.RSA.wrapKey[jwaAlg] = key => (key.use === 'enc' || key.use === undefined) && key.length >= LENGTHS[jwaAlg]\n    JWK.RSA.unwrapKey[jwaAlg] = key => key.private && (key.use === 'enc' || key.use === undefined) && key.length >= LENGTHS[jwaAlg]\n  })\n}\n", "const { createCipheriv, createDecipheriv, getCiphers } = require('crypto')\n\nconst { KEYOBJECT } = require('../help/consts')\nconst { asInput } = require('../help/key_object')\n\nconst checkInput = (data) => {\n  if (data !== undefined && data.length % 8 !== 0) {\n    throw new Error('invalid data length')\n  }\n}\n\nconst wrapKey = (alg, { [KEYOBJECT]: keyObject }, payload) => {\n  const key = asInput(keyObject, false)\n  const cipher = createCipheriv(alg, key, Buffer.alloc(8, 'a6', 'hex'))\n\n  return { wrapped: Buffer.concat([cipher.update(payload), cipher.final()]) }\n}\n\nconst unwrapKey = (alg, { [KEYOBJECT]: keyObject }, payload) => {\n  const key = asInput(keyObject, false)\n  checkInput(payload)\n  const cipher = createDecipheriv(alg, key, Buffer.alloc(8, 'a6', 'hex'))\n\n  return Buffer.concat([cipher.update(payload), cipher.final()])\n}\n\nmodule.exports = (JWA, JWK) => {\n  ['A128KW', 'A192KW', 'A256KW'].forEach((jwaAlg) => {\n    const size = parseInt(jwaAlg.substr(1, 3), 10)\n    const alg = `aes${size}-wrap`\n    if (getCiphers().includes(alg)) {\n      JWA.keyManagementEncrypt.set(jwaAlg, wrapKey.bind(undefined, alg))\n      JWA.keyManagementDecrypt.set(jwaAlg, unwrapKey.bind(undefined, alg))\n      JWK.oct.wrapKey[jwaAlg] = JWK.oct.unwrapKey[jwaAlg] = key => (key.use === 'enc' || key.use === undefined) && key.length === size\n    }\n  })\n}\n", "const generateIV = require('../help/generate_iv')\nconst base64url = require('../help/base64url')\n\nmodule.exports = (JWA, JWK) => {\n  ['A128GCMKW', 'A192GCMKW', 'A256GCMKW'].forEach((jwaAlg) => {\n    const encAlg = jwaAlg.substr(0, 7)\n    const size = parseInt(jwaAlg.substr(1, 3), 10)\n    const encrypt = JWA.encrypt.get(encAlg)\n    const decrypt = JWA.decrypt.get(encAlg)\n\n    if (encrypt && decrypt) {\n      JWA.keyManagementEncrypt.set(jwaAlg, (key, payload) => {\n        const iv = generateIV(jwaAlg)\n        const { ciphertext, tag } = encrypt(key, payload, { iv })\n        return {\n          wrapped: ciphertext,\n          header: { tag: base64url.encodeBuffer(tag), iv: base64url.encodeBuffer(iv) }\n        }\n      })\n      JWA.keyManagementDecrypt.set(jwaAlg, decrypt)\n      JWK.oct.wrapKey[jwaAlg] = JWK.oct.unwrapKey[jwaAlg] = key => (key.use === 'enc' || key.use === undefined) && key.length === size\n    }\n  })\n}\n", "const { pbkdf2Sync: pbkdf2, randomBytes } = require('crypto')\n\nconst { KEYOBJECT } = require('../help/consts')\nconst base64url = require('../help/base64url')\n\nconst SALT_LENGTH = 16\nconst NULL_BUFFER = Buffer.alloc(1, 0)\n\nconst concatSalt = (alg, p2s) => {\n  return Buffer.concat([\n    Buffer.from(alg, 'utf8'),\n    NULL_BUFFER,\n    p2s\n  ])\n}\n\nconst wrapKey = (keylen, sha, concat, wrap, { [KEYOBJECT]: keyObject }, payload) => {\n  // Note that if password-based encryption is used for multiple\n  // recipients, it is expected that each recipient use different values\n  // for the PBES2 parameters \"p2s\" and \"p2c\".\n  // here we generate p2c between 2048 and 4096 and random p2s\n  const p2c = Math.floor((Math.random() * 2049) + 2048)\n  const p2s = randomBytes(SALT_LENGTH)\n  const salt = concat(p2s)\n\n  const derivedKey = pbkdf2(keyObject.export(), salt, p2c, keylen, sha)\n\n  const result = wrap({ [KEYOBJECT]: derivedKey }, payload)\n  result.header = result.header || {}\n  Object.assign(result.header, { p2c, p2s: base64url.encodeBuffer(p2s) })\n\n  return result\n}\n\nconst unwrapKey = (keylen, sha, concat, unwrap, { [KEYOBJECT]: keyObject }, payload, header) => {\n  const { p2s, p2c } = header\n  const salt = concat(p2s)\n  const derivedKey = pbkdf2(keyObject.export(), salt, p2c, keylen, sha)\n  return unwrap({ [KEYOBJECT]: derivedKey }, payload, header)\n}\n\nmodule.exports = (JWA, JWK) => {\n  ['PBES2-HS256+A128KW', 'PBES2-HS384+A192KW', 'PBES2-HS512+A256KW'].forEach((jwaAlg) => {\n    const kw = jwaAlg.substr(-6)\n    const kwWrap = JWA.keyManagementEncrypt.get(kw)\n    const kwUnwrap = JWA.keyManagementDecrypt.get(kw)\n    const keylen = parseInt(jwaAlg.substr(13, 3), 10) / 8\n    const sha = `sha${jwaAlg.substr(8, 3)}`\n\n    if (kwWrap && kwUnwrap) {\n      JWA.keyManagementEncrypt.set(jwaAlg, wrapKey.bind(undefined, keylen, sha, concatSalt.bind(undefined, jwaAlg), kwWrap))\n      JWA.keyManagementDecrypt.set(jwaAlg, unwrapKey.bind(undefined, keylen, sha, concatSalt.bind(undefined, jwaAlg), kwUnwrap))\n      JWK.oct.deriveKey[jwaAlg] = key => key.use === 'enc' || key.use === undefined\n    }\n  })\n}\n", "const { improvedDH } = require('../../help/runtime_support')\n\nif (improvedDH) {\n  const { diffieHellman } = require('crypto')\n\n  const { KeyObject } = require('../../help/key_object')\n  const importKey = require('../../jwk/import')\n\n  module.exports = ({ keyObject: privateKey }, publicKey) => {\n    if (!(publicKey instanceof KeyObject)) {\n      ({ keyObject: publicKey } = importKey(publicKey))\n    }\n\n    return diffieHellman({ privateKey, publicKey })\n  }\n} else {\n  const { createECDH, constants: { POINT_CONVERSION_UNCOMPRESSED } } = require('crypto')\n\n  const base64url = require('../../help/base64url')\n\n  const crvToCurve = (crv) => {\n    switch (crv) {\n      case 'P-256':\n        return 'prime256v1'\n      case 'P-384':\n        return 'secp384r1'\n      case 'P-521':\n        return 'secp521r1'\n    }\n  }\n\n  const UNCOMPRESSED = Buffer.alloc(1, POINT_CONVERSION_UNCOMPRESSED)\n  const pubToBuffer = (x, y) => Buffer.concat([UNCOMPRESSED, base64url.decodeToBuffer(x), base64url.decodeToBuffer(y)])\n\n  module.exports = ({ crv, d }, { x, y }) => {\n    const curve = crvToCurve(crv)\n    const exchange = createECDH(curve)\n\n    exchange.setPrivateKey(base64url.decodeToBuffer(d))\n\n    return exchange.computeSecret(pubToBuffer(x, y))\n  }\n}\n", "const { createHash } = require('crypto')\nconst ecdhComputeSecret = require('./compute_secret')\n\nconst concat = (key, length, value) => {\n  const iterations = Math.ceil(length / 32)\n  let res\n\n  for (let iter = 1; iter <= iterations; iter++) {\n    const buf = Buffer.allocUnsafe(4 + key.length + value.length)\n    buf.writeUInt32BE(iter, 0)\n    key.copy(buf, 4)\n    value.copy(buf, 4 + key.length)\n    if (!res) {\n      res = createHash('sha256').update(buf).digest()\n    } else {\n      res = Buffer.concat([res, createHash('sha256').update(buf).digest()])\n    }\n  }\n\n  return res.slice(0, length)\n}\n\nconst uint32be = (value, buf = Buffer.allocUnsafe(4)) => {\n  buf.writeUInt32BE(value)\n  return buf\n}\n\nconst lengthAndInput = input => Buffer.concat([uint32be(input.length), input])\n\nmodule.exports = (alg, keyLen, privKey, pubKey, { apu = Buffer.alloc(0), apv = Buffer.alloc(0) } = {}, computeSecret = ecdhComputeSecret) => {\n  const value = Buffer.concat([\n    lengthAndInput(Buffer.from(alg)),\n    lengthAndInput(apu),\n    lengthAndInput(apv),\n    uint32be(keyLen)\n  ])\n\n  const sharedSecret = computeSecret(privKey, pubKey)\n  return concat(sharedSecret, keyLen / 8, value)\n}\n", "const { improvedDH } = require('../../help/runtime_support')\nconst { KEYLENGTHS } = require('../../registry')\nconst { generateSync } = require('../../jwk/generate')\nconst { name: secp256k1 } = require('../../jwk/key/secp256k1_crv')\n\nconst derive = require('./derive')\n\nconst wrapKey = (key, payload, { enc }) => {\n  const epk = generateSync(key.kty, key.crv)\n\n  const derivedKey = derive(enc, KEYLENGTHS.get(enc), epk, key)\n\n  return {\n    wrapped: derivedKey,\n    header: { epk: { kty: key.kty, crv: key.crv, x: epk.x, y: epk.y } }\n  }\n}\n\nconst unwrapKey = (key, payload, header) => {\n  const { enc, epk } = header\n  return derive(enc, KEYLENGTHS.get(enc), key, epk, header)\n}\n\nmodule.exports = (JWA, JWK) => {\n  JWA.keyManagementEncrypt.set('ECDH-ES', wrapKey)\n  JWA.keyManagementDecrypt.set('ECDH-ES', unwrapKey)\n  JWK.EC.deriveKey['ECDH-ES'] = key => (key.use === 'enc' || key.use === undefined) && key.crv !== secp256k1\n\n  if (improvedDH) {\n    JWK.OKP.deriveKey['ECDH-ES'] = key => (key.use === 'enc' || key.use === undefined) && key.keyObject.asymmetricKeyType.startsWith('x')\n  }\n}\n", "const { improvedDH } = require('../../help/runtime_support')\nconst { KEYOBJECT } = require('../../help/consts')\nconst { generateSync } = require('../../jwk/generate')\nconst { name: secp256k1 } = require('../../jwk/key/secp256k1_crv')\nconst { ECDH_DERIVE_LENGTHS } = require('../../registry')\n\nconst derive = require('./derive')\n\nconst wrapKey = (wrap, derive, key, payload) => {\n  const epk = generateSync(key.kty, key.crv)\n\n  const derivedKey = derive(epk, key, payload)\n\n  const result = wrap({ [KEYOBJECT]: derivedKey }, payload)\n  result.header = result.header || {}\n  Object.assign(result.header, { epk: { kty: key.kty, crv: key.crv, x: epk.x, y: epk.y } })\n\n  return result\n}\n\nconst unwrapKey = (unwrap, derive, key, payload, header) => {\n  const { epk } = header\n  const derivedKey = derive(key, epk, header)\n\n  return unwrap({ [KEYOBJECT]: derivedKey }, payload, header)\n}\n\nmodule.exports = (JWA, JWK) => {\n  ['ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'].forEach((jwaAlg) => {\n    const kw = jwaAlg.substr(-6)\n    const kwWrap = JWA.keyManagementEncrypt.get(kw)\n    const kwUnwrap = JWA.keyManagementDecrypt.get(kw)\n    const keylen = parseInt(jwaAlg.substr(9, 3), 10)\n    ECDH_DERIVE_LENGTHS.set(jwaAlg, keylen)\n\n    if (kwWrap && kwUnwrap) {\n      JWA.keyManagementEncrypt.set(jwaAlg, wrapKey.bind(undefined, kwWrap, derive.bind(undefined, jwaAlg, keylen)))\n      JWA.keyManagementDecrypt.set(jwaAlg, unwrapKey.bind(undefined, kwUnwrap, derive.bind(undefined, jwaAlg, keylen)))\n      JWK.EC.deriveKey[jwaAlg] = key => (key.use === 'enc' || key.use === undefined) && key.crv !== secp256k1\n\n      if (improvedDH) {\n        JWK.OKP.deriveKey[jwaAlg] = key => (key.use === 'enc' || key.use === undefined) && key.keyObject.asymmetricKeyType.startsWith('x')\n      }\n    }\n  })\n}\nmodule.exports.wrapKey = wrapKey\nmodule.exports.unwrapKey = unwrapKey\n", "const { JWKKeySupport, JOSENotSupported } = require('../errors')\nconst { KEY_MANAGEMENT_ENCRYPT, KEY_MANAGEMENT_DECRYPT } = require('../help/consts')\n\nconst { JWA, JWK } = require('../registry')\n\n// sign, verify\nrequire('./hmac')(JWA, JWK)\nrequire('./ecdsa')(JWA, JWK)\nrequire('./eddsa')(JWA, JWK)\nrequire('./rsassa_pss')(JWA, JWK)\nrequire('./rsassa')(JWA, JWK)\nrequire('./none')(JWA)\n\n// encrypt, decrypt\nrequire('./aes_cbc_hmac_sha2')(JWA, JWK)\nrequire('./aes_gcm')(JWA, JWK)\n\n// wrapKey, unwrapKey\nrequire('./rsaes')(JWA, JWK)\nrequire('./aes_kw')(JWA, JWK)\nrequire('./aes_gcm_kw')(JWA, JWK)\n\n// deriveKey\nrequire('./pbes2')(JWA, JWK)\nrequire('./ecdh/dir')(JWA, JWK)\nrequire('./ecdh/kw')(JWA, JWK)\n\nconst check = (key, op, alg) => {\n  const cache = `_${op}_${alg}`\n\n  let label\n  let keyOp\n  if (op === 'keyManagementEncrypt') {\n    label = 'key management (encryption)'\n    keyOp = KEY_MANAGEMENT_ENCRYPT\n  } else if (op === 'keyManagementDecrypt') {\n    label = 'key management (decryption)'\n    keyOp = KEY_MANAGEMENT_DECRYPT\n  }\n\n  if (cache in key) {\n    if (key[cache]) {\n      return\n    }\n    throw new JWKKeySupport(`the key does not support ${alg} ${label || op} algorithm`)\n  }\n\n  let value = true\n  if (!JWA[op].has(alg)) {\n    throw new JOSENotSupported(`unsupported ${label || op} alg: ${alg}`)\n  } else if (!key.algorithms(keyOp).has(alg)) {\n    value = false\n  }\n\n  Object.defineProperty(key, cache, { value, enumerable: false })\n\n  if (!value) {\n    return check(key, op, alg)\n  }\n}\n\nmodule.exports = {\n  check,\n  sign: (alg, key, payload) => {\n    check(key, 'sign', alg)\n    return JWA.sign.get(alg)(key, payload)\n  },\n  verify: (alg, key, payload, signature) => {\n    check(key, 'verify', alg)\n    return JWA.verify.get(alg)(key, payload, signature)\n  },\n  keyManagementEncrypt: (alg, key, payload, opts) => {\n    check(key, 'keyManagementEncrypt', alg)\n    return JWA.keyManagementEncrypt.get(alg)(key, payload, opts)\n  },\n  keyManagementDecrypt: (alg, key, payload, opts) => {\n    check(key, 'keyManagementDecrypt', alg)\n    return JWA.keyManagementDecrypt.get(alg)(key, payload, opts)\n  },\n  encrypt: (alg, key, cleartext, opts) => {\n    check(key, 'encrypt', alg)\n    return JWA.encrypt.get(alg)(key, cleartext, opts)\n  },\n  decrypt: (alg, key, ciphertext, opts) => {\n    check(key, 'decrypt', alg)\n    return JWA.decrypt.get(alg)(key, ciphertext, opts)\n  }\n}\n", "const { JOSECritNotUnderstood, JWSInvalid } = require('../errors')\n\nconst DEFINED = new Set([\n  'alg', 'jku', 'jwk', 'kid', 'x5u', 'x5c', 'x5t', 'x5t#S256', 'typ', 'cty',\n  'crit', 'enc', 'zip', 'epk', 'apu', 'apv', 'iv', 'tag', 'p2s', 'p2c'\n])\n\nmodule.exports = function validateCrit (Err, protectedHeader, unprotectedHeader, understood) {\n  if (protectedHeader && 'crit' in protectedHeader) {\n    if (\n      !Array.isArray(protectedHeader.crit) ||\n      protectedHeader.crit.length === 0 ||\n      protectedHeader.crit.some(s => typeof s !== 'string' || !s)\n    ) {\n      throw new Err('\"crit\" Header Parameter MUST be an array of non-empty strings when present')\n    }\n    const whitelisted = new Set(understood)\n    const combined = { ...protectedHeader, ...unprotectedHeader }\n    protectedHeader.crit.forEach((parameter) => {\n      if (DEFINED.has(parameter)) {\n        throw new Err(`The critical list contains a non-extension Header Parameter ${parameter}`)\n      }\n      if (!whitelisted.has(parameter)) {\n        throw new JOSECritNotUnderstood(`critical \"${parameter}\" is not understood`)\n      }\n      if (parameter === 'b64') {\n        if (!('b64' in protectedHeader)) {\n          throw new JWSInvalid('\"b64\" critical parameter must be integrity protected')\n        }\n        if (typeof protectedHeader.b64 !== 'boolean') {\n          throw new JWSInvalid('\"b64\" critical parameter must be a boolean')\n        }\n      } else if (!(parameter in combined)) {\n        throw new Err(`critical parameter \"${parameter}\" is missing`)\n      }\n    })\n  }\n  if (unprotectedHeader && 'crit' in unprotectedHeader) {\n    throw new Err('\"crit\" Header Parameter MUST be integrity protected when present')\n  }\n}\n", "const isObject = require('../help/is_object')\nlet validateCrit = require('../help/validate_crit')\n\nconst { JWEInvalid } = require('../errors')\n\nvalidateCrit = validateCrit.bind(undefined, JWEInvalid)\n\nconst compactSerializer = (final, [recipient]) => {\n  return `${final.protected}.${recipient.encrypted_key}.${final.iv}.${final.ciphertext}.${final.tag}`\n}\ncompactSerializer.validate = (protectedHeader, unprotectedHeader, aad, { 0: { header }, length }) => {\n  if (length !== 1 || aad || unprotectedHeader || header) {\n    throw new JWEInvalid('JWE Compact Serialization doesn\\'t support multiple recipients, JWE unprotected headers or AAD')\n  }\n  validateCrit(protectedHeader, unprotectedHeader, protectedHeader ? protectedHeader.crit : undefined)\n}\n\nconst flattenedSerializer = (final, [recipient]) => {\n  const { header, encrypted_key: encryptedKey } = recipient\n\n  return {\n    ...(final.protected ? { protected: final.protected } : undefined),\n    ...(final.unprotected ? { unprotected: final.unprotected } : undefined),\n    ...(header ? { header } : undefined),\n    ...(encryptedKey ? { encrypted_key: encryptedKey } : undefined),\n    ...(final.aad ? { aad: final.aad } : undefined),\n    iv: final.iv,\n    ciphertext: final.ciphertext,\n    tag: final.tag\n  }\n}\nflattenedSerializer.validate = (protectedHeader, unprotectedHeader, aad, { 0: { header }, length }) => {\n  if (length !== 1) {\n    throw new JWEInvalid('Flattened JWE JSON Serialization doesn\\'t support multiple recipients')\n  }\n  validateCrit(protectedHeader, { ...unprotectedHeader, ...header }, protectedHeader ? protectedHeader.crit : undefined)\n}\n\nconst generalSerializer = (final, recipients) => {\n  const result = {\n    ...(final.protected ? { protected: final.protected } : undefined),\n    ...(final.unprotected ? { unprotected: final.unprotected } : undefined),\n    recipients: recipients.map(({ header, encrypted_key: encryptedKey, generatedHeader }) => {\n      if (!header && !encryptedKey && !generatedHeader) {\n        return false\n      }\n\n      return {\n        ...(header || generatedHeader ? { header: { ...header, ...generatedHeader } } : undefined),\n        ...(encryptedKey ? { encrypted_key: encryptedKey } : undefined)\n      }\n    }).filter(Boolean),\n    ...(final.aad ? { aad: final.aad } : undefined),\n    iv: final.iv,\n    ciphertext: final.ciphertext,\n    tag: final.tag\n  }\n\n  if (!result.recipients.length) {\n    delete result.recipients\n  }\n\n  return result\n}\ngeneralSerializer.validate = (protectedHeader, unprotectedHeader, aad, recipients) => {\n  recipients.forEach(({ header }) => {\n    validateCrit(protectedHeader, { ...header, ...unprotectedHeader }, protectedHeader ? protectedHeader.crit : undefined)\n  })\n}\n\nconst isJSON = (input) => {\n  return isObject(input) &&\n    typeof input.ciphertext === 'string' &&\n    typeof input.iv === 'string' &&\n    typeof input.tag === 'string' &&\n    (input.unprotected === undefined || isObject(input.unprotected)) &&\n    (input.protected === undefined || typeof input.protected === 'string') &&\n    (input.aad === undefined || typeof input.aad === 'string')\n}\n\nconst isSingleRecipient = (input) => {\n  return (input.encrypted_key === undefined || typeof input.encrypted_key === 'string') &&\n    (input.header === undefined || isObject(input.header))\n}\n\nconst isValidRecipient = (recipient) => {\n  return isObject(recipient) && typeof recipient.encrypted_key === 'string' && (recipient.header === undefined || isObject(recipient.header))\n}\n\nconst isMultiRecipient = (input) => {\n  if (Array.isArray(input.recipients) && input.recipients.every(isValidRecipient)) {\n    return true\n  }\n\n  return false\n}\n\nconst detect = (input) => {\n  if (typeof input === 'string' && input.split('.').length === 5) {\n    return 'compact'\n  }\n\n  if (isJSON(input)) {\n    if (isMultiRecipient(input)) {\n      return 'general'\n    }\n\n    if (isSingleRecipient(input)) {\n      return 'flattened'\n    }\n  }\n\n  throw new JWEInvalid('JWE malformed or invalid serialization')\n}\n\nmodule.exports = {\n  compact: compactSerializer,\n  flattened: flattenedSerializer,\n  general: generalSerializer,\n  detect\n}\n", "const { randomBytes } = require('crypto')\n\nconst { createSecretKey } = require('../help/key_object')\nconst { KEYLENGTHS } = require('../registry')\nconst Key = require('../jwk/key/oct')\n\nmodule.exports = (alg) => {\n  const keyLength = KEYLENGTHS.get(alg)\n\n  if (!keyLength) {\n    return new Key({ type: 'secret' })\n  }\n\n  return new Key(createSecretKey(randomBytes(keyLength / 8)), { use: 'enc', alg })\n}\n", "module.exports = (a = {}, b = {}) => {\n  const keysA = Object.keys(a)\n  const keysB = new Set(Object.keys(b))\n  return !keysA.some((ka) => keysB.has(ka))\n}\n", "const isDisjoint = require('../help/is_disjoint')\nconst base64url = require('../help/base64url')\nlet validateCrit = require('../help/validate_crit')\nconst { JWEInvalid, JOSENotSupported } = require('../errors')\n\nvalidateCrit = validateCrit.bind(undefined, JWEInvalid)\n\nmodule.exports = (prot, unprotected, recipients, checkAlgorithms, crit) => {\n  if (typeof prot === 'string') {\n    try {\n      prot = base64url.JSON.decode(prot)\n    } catch (err) {\n      throw new JWEInvalid('could not parse JWE protected header')\n    }\n  }\n\n  let alg = []\n  const enc = new Set()\n  if (!isDisjoint(prot, unprotected) || !recipients.every(({ header }) => {\n    if (typeof header === 'object') {\n      alg.push(header.alg)\n      enc.add(header.enc)\n    }\n    const combined = { ...unprotected, ...header }\n    validateCrit(prot, combined, crit)\n    if ('zip' in combined) {\n      throw new JWEInvalid('\"zip\" Header Parameter MUST be integrity protected')\n    } else if (prot && 'zip' in prot && prot.zip !== 'DEF') {\n      throw new JOSENotSupported('only \"DEF\" compression algorithm is supported')\n    }\n    return isDisjoint(header, prot) && isDisjoint(header, unprotected)\n  })) {\n    throw new JWEInvalid('JWE Shared Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint')\n  }\n\n  if (typeof prot === 'object') {\n    alg.push(prot.alg)\n    enc.add(prot.enc)\n  }\n  if (typeof unprotected === 'object') {\n    alg.push(unprotected.alg)\n    enc.add(unprotected.enc)\n  }\n\n  alg = alg.filter(Boolean)\n  enc.delete(undefined)\n\n  if (recipients.length !== 1) {\n    if (alg.includes('dir') || alg.includes('ECDH-ES')) {\n      throw new JWEInvalid('dir and ECDH-ES alg may only be used with a single recipient')\n    }\n  }\n\n  if (checkAlgorithms) {\n    if (alg.length !== recipients.length) {\n      throw new JWEInvalid('missing Key Management algorithm')\n    }\n    if (enc.size === 0) {\n      throw new JWEInvalid('missing Content Encryption algorithm')\n    } else if (enc.size !== 1) {\n      throw new JWEInvalid('there must only be one Content Encryption algorithm')\n    }\n  } else {\n    if (enc.size > 1) {\n      throw new JWEInvalid('there must only be one Content Encryption algorithm')\n    }\n  }\n\n  return [...enc][0]\n}\n", "const { deflateRawSync } = require('zlib')\n\nconst { KEYOBJECT } = require('../help/consts')\nconst generateIV = require('../help/generate_iv')\nconst base64url = require('../help/base64url')\nconst getKey = require('../help/get_key')\nconst isObject = require('../help/is_object')\nconst { createSecretKey } = require('../help/key_object')\nconst deepClone = require('../help/deep_clone')\nconst importKey = require('../jwk/import')\nconst { JWEInvalid } = require('../errors')\nconst { check, keyManagementEncrypt, encrypt } = require('../jwa')\n\nconst serializers = require('./serializers')\nconst generateCEK = require('./generate_cek')\nconst validateHeaders = require('./validate_headers')\n\nconst PROCESS_RECIPIENT = Symbol('PROCESS_RECIPIENT')\n\nclass Encrypt {\n  // TODO: in v2.x swap unprotectedHeader and aad\n  constructor (cleartext, protectedHeader, unprotectedHeader, aad) {\n    if (!Buffer.isBuffer(cleartext) && typeof cleartext !== 'string') {\n      throw new TypeError('cleartext argument must be a Buffer or a string')\n    }\n    cleartext = Buffer.from(cleartext)\n\n    if (aad !== undefined && !Buffer.isBuffer(aad) && typeof aad !== 'string') {\n      throw new TypeError('aad argument must be a Buffer or a string when provided')\n    }\n    aad = aad ? Buffer.from(aad) : undefined\n\n    if (protectedHeader !== undefined && !isObject(protectedHeader)) {\n      throw new TypeError('protectedHeader argument must be a plain object when provided')\n    }\n\n    if (unprotectedHeader !== undefined && !isObject(unprotectedHeader)) {\n      throw new TypeError('unprotectedHeader argument must be a plain object when provided')\n    }\n\n    this._recipients = []\n    this._cleartext = cleartext\n    this._aad = aad\n    this._unprotected = unprotectedHeader ? deepClone(unprotectedHeader) : undefined\n    this._protected = protectedHeader ? deepClone(protectedHeader) : undefined\n  }\n\n  /*\n   * @public\n   */\n  recipient (key, header) {\n    key = getKey(key)\n\n    if (header !== undefined && !isObject(header)) {\n      throw new TypeError('header argument must be a plain object when provided')\n    }\n\n    this._recipients.push({\n      key,\n      header: header ? deepClone(header) : undefined\n    })\n\n    return this\n  }\n\n  /*\n   * @private\n   */\n  [PROCESS_RECIPIENT] (recipient) {\n    const unprotectedHeader = this._unprotected\n    const protectedHeader = this._protected\n    const { length: recipientCount } = this._recipients\n\n    const jweHeader = {\n      ...protectedHeader,\n      ...unprotectedHeader,\n      ...recipient.header\n    }\n    const { key } = recipient\n\n    const enc = jweHeader.enc\n    let alg = jweHeader.alg\n\n    if (key.use === 'sig') {\n      throw new TypeError('a key with \"use\":\"sig\" is not usable for encryption')\n    }\n\n    if (alg === 'dir') {\n      check(key, 'encrypt', enc)\n    } else if (alg) {\n      check(key, 'keyManagementEncrypt', alg)\n    } else {\n      alg = key.alg || [...key.algorithms('wrapKey')][0] || [...key.algorithms('deriveKey')][0]\n\n      if (alg === 'ECDH-ES' && recipientCount !== 1) {\n        alg = [...key.algorithms('deriveKey')][1]\n      }\n\n      if (!alg) {\n        throw new JWEInvalid('could not resolve a usable \"alg\" for a recipient')\n      }\n\n      if (recipientCount === 1) {\n        if (protectedHeader) {\n          protectedHeader.alg = alg\n        } else {\n          this._protected = { alg }\n        }\n      } else {\n        if (recipient.header) {\n          recipient.header.alg = alg\n        } else {\n          recipient.header = { alg }\n        }\n      }\n    }\n\n    let wrapped\n    let generatedHeader\n\n    if (key.kty === 'oct' && alg === 'dir') {\n      this._cek = importKey(key[KEYOBJECT], { use: 'enc', alg: enc })\n    } else {\n      check(this._cek, 'encrypt', enc)\n      ;({ wrapped, header: generatedHeader } = keyManagementEncrypt(alg, key, this._cek[KEYOBJECT].export(), { enc, alg }))\n      if (alg === 'ECDH-ES') {\n        this._cek = importKey(createSecretKey(wrapped), { use: 'enc', alg: enc })\n      }\n    }\n\n    if (alg === 'dir' || alg === 'ECDH-ES') {\n      recipient.encrypted_key = ''\n    } else {\n      recipient.encrypted_key = base64url.encodeBuffer(wrapped)\n    }\n\n    if (generatedHeader) {\n      recipient.generatedHeader = generatedHeader\n    }\n  }\n\n  /*\n   * @public\n   */\n  encrypt (serialization) {\n    const serializer = serializers[serialization]\n    if (!serializer) {\n      throw new TypeError('serialization must be one of \"compact\", \"flattened\", \"general\"')\n    }\n\n    if (!this._recipients.length) {\n      throw new JWEInvalid('missing recipients')\n    }\n\n    serializer.validate(this._protected, this._unprotected, this._aad, this._recipients)\n\n    let enc = validateHeaders(this._protected, this._unprotected, this._recipients, false, this._protected ? this._protected.crit : undefined)\n    if (!enc) {\n      enc = 'A128CBC-HS256'\n      if (this._protected) {\n        this._protected.enc = enc\n      } else {\n        this._protected = { enc }\n      }\n    }\n    const final = {}\n    this._cek = generateCEK(enc)\n\n    for (const recipient of this._recipients) {\n      this[PROCESS_RECIPIENT](recipient)\n    }\n\n    const iv = generateIV(enc)\n    final.iv = base64url.encodeBuffer(iv)\n\n    if (this._recipients.length === 1 && this._recipients[0].generatedHeader) {\n      const [{ generatedHeader }] = this._recipients\n      delete this._recipients[0].generatedHeader\n      this._protected = {\n        ...this._protected,\n        ...generatedHeader\n      }\n    }\n\n    if (this._protected) {\n      final.protected = base64url.JSON.encode(this._protected)\n    }\n    final.unprotected = this._unprotected\n\n    let aad\n    if (this._aad) {\n      final.aad = base64url.encode(this._aad)\n      aad = Buffer.concat([\n        Buffer.from(final.protected || ''),\n        Buffer.from('.'),\n        Buffer.from(final.aad)\n      ])\n    } else {\n      aad = Buffer.from(final.protected || '')\n    }\n\n    let cleartext = this._cleartext\n    if (this._protected && 'zip' in this._protected) {\n      cleartext = deflateRawSync(cleartext)\n    }\n\n    const { ciphertext, tag } = encrypt(enc, this._cek, cleartext, { iv, aad })\n    final.tag = base64url.encodeBuffer(tag)\n    final.ciphertext = base64url.encodeBuffer(ciphertext)\n\n    return serializer(final, this._recipients)\n  }\n}\n\nmodule.exports = Encrypt\n", "const KeyStore = require('./keystore')\n\nmodule.exports = KeyStore\n", "const { inflateRawSync } = require('zlib')\n\nconst base64url = require('../help/base64url')\nconst getKey = require('../help/get_key')\nconst { KeyStore } = require('../jwks')\nconst errors = require('../errors')\nconst { check, decrypt, keyManagementDecrypt } = require('../jwa')\nconst JWK = require('../jwk')\n\nconst { createSecretKey } = require('../help/key_object')\nconst generateCEK = require('./generate_cek')\nconst validateHeaders = require('./validate_headers')\nconst { detect: resolveSerialization } = require('./serializers')\n\nconst SINGLE_RECIPIENT = new Set(['compact', 'flattened'])\n\nconst combineHeader = (prot = {}, unprotected = {}, header = {}) => {\n  if (typeof prot === 'string') {\n    prot = base64url.JSON.decode(prot)\n  }\n\n  const p2s = prot.p2s || unprotected.p2s || header.p2s\n  const apu = prot.apu || unprotected.apu || header.apu\n  const apv = prot.apv || unprotected.apv || header.apv\n  const iv = prot.iv || unprotected.iv || header.iv\n  const tag = prot.tag || unprotected.tag || header.tag\n\n  return {\n    ...prot,\n    ...unprotected,\n    ...header,\n    ...(typeof p2s === 'string' ? { p2s: base64url.decodeToBuffer(p2s) } : undefined),\n    ...(typeof apu === 'string' ? { apu: base64url.decodeToBuffer(apu) } : undefined),\n    ...(typeof apv === 'string' ? { apv: base64url.decodeToBuffer(apv) } : undefined),\n    ...(typeof iv === 'string' ? { iv: base64url.decodeToBuffer(iv) } : undefined),\n    ...(typeof tag === 'string' ? { tag: base64url.decodeToBuffer(tag) } : undefined)\n  }\n}\n\n/*\n * @public\n */\nconst jweDecrypt = (skipValidateHeaders, serialization, jwe, key, { crit = [], complete = false, algorithms } = {}) => {\n  key = getKey(key, true)\n\n  if (algorithms !== undefined && (!Array.isArray(algorithms) || algorithms.some(s => typeof s !== 'string' || !s))) {\n    throw new TypeError('\"algorithms\" option must be an array of non-empty strings')\n  } else if (algorithms) {\n    algorithms = new Set(algorithms)\n  }\n\n  if (!Array.isArray(crit) || crit.some(s => typeof s !== 'string' || !s)) {\n    throw new TypeError('\"crit\" option must be an array of non-empty strings')\n  }\n\n  if (!serialization) {\n    serialization = resolveSerialization(jwe)\n  }\n\n  let alg, ciphertext, enc, encryptedKey, iv, opts, prot, tag, unprotected, cek, aad, header\n\n  // treat general format with one recipient as flattened\n  // skips iteration and avoids multi errors in this case\n  if (serialization === 'general' && jwe.recipients.length === 1) {\n    serialization = 'flattened'\n    const { recipients, ...root } = jwe\n    jwe = { ...root, ...recipients[0] }\n  }\n\n  if (SINGLE_RECIPIENT.has(serialization)) {\n    if (serialization === 'compact') { // compact serialization format\n      ([prot, encryptedKey, iv, ciphertext, tag] = jwe.split('.'))\n    } else { // flattened serialization format\n      ({ protected: prot, encrypted_key: encryptedKey, iv, ciphertext, tag, unprotected, aad, header } = jwe)\n    }\n\n    if (!skipValidateHeaders) {\n      validateHeaders(prot, unprotected, [{ header }], true, crit)\n    }\n\n    opts = combineHeader(prot, unprotected, header)\n\n    ;({ alg, enc } = opts)\n\n    if (algorithms && !algorithms.has(alg === 'dir' ? enc : alg)) {\n      throw new errors.JOSEAlgNotWhitelisted('alg not whitelisted')\n    }\n\n    if (key instanceof KeyStore) {\n      const keystore = key\n      let keys\n      if (opts.alg === 'dir') {\n        keys = keystore.all({ kid: opts.kid, alg: opts.enc, key_ops: ['decrypt'] })\n      } else {\n        keys = keystore.all({ kid: opts.kid, alg: opts.alg, key_ops: ['unwrapKey'] })\n      }\n      switch (keys.length) {\n        case 0:\n          throw new errors.JWKSNoMatchingKey()\n        case 1:\n          // treat the call as if a Key instance was passed in\n          // skips iteration and avoids multi errors in this case\n          key = keys[0]\n          break\n        default: {\n          const errs = []\n          for (const key of keys) {\n            try {\n              return jweDecrypt(true, serialization, jwe, key, { crit, complete, algorithms: algorithms ? [...algorithms] : undefined })\n            } catch (err) {\n              errs.push(err)\n              continue\n            }\n          }\n\n          const multi = new errors.JOSEMultiError(errs)\n          if ([...multi].some(e => e instanceof errors.JWEDecryptionFailed)) {\n            throw new errors.JWEDecryptionFailed()\n          }\n          throw multi\n        }\n      }\n    }\n\n    check(key, ...(alg === 'dir' ? ['decrypt', enc] : ['keyManagementDecrypt', alg]))\n\n    try {\n      if (alg === 'dir') {\n        cek = JWK.asKey(key, { alg: enc, use: 'enc' })\n      } else if (alg === 'ECDH-ES') {\n        const unwrapped = keyManagementDecrypt(alg, key, undefined, opts)\n        cek = JWK.asKey(createSecretKey(unwrapped), { alg: enc, use: 'enc' })\n      } else {\n        const unwrapped = keyManagementDecrypt(alg, key, base64url.decodeToBuffer(encryptedKey), opts)\n        cek = JWK.asKey(createSecretKey(unwrapped), { alg: enc, use: 'enc' })\n      }\n    } catch (err) {\n      // To mitigate the attacks described in RFC 3218, the\n      // recipient MUST NOT distinguish between format, padding, and length\n      // errors of encrypted keys.  It is strongly recommended, in the event\n      // of receiving an improperly formatted key, that the recipient\n      // substitute a randomly generated CEK and proceed to the next step, to\n      // mitigate timing attacks.\n      cek = generateCEK(enc)\n    }\n\n    let adata\n    if (aad) {\n      adata = Buffer.concat([\n        Buffer.from(prot || ''),\n        Buffer.from('.'),\n        Buffer.from(aad)\n      ])\n    } else {\n      adata = Buffer.from(prot || '')\n    }\n\n    try {\n      iv = base64url.decodeToBuffer(iv)\n    } catch (err) {}\n    try {\n      tag = base64url.decodeToBuffer(tag)\n    } catch (err) {}\n\n    let cleartext = decrypt(enc, cek, base64url.decodeToBuffer(ciphertext), { iv, tag, aad: adata })\n\n    if (opts.zip) {\n      cleartext = inflateRawSync(cleartext)\n    }\n\n    if (complete) {\n      const result = { cleartext, key, cek }\n      if (aad) result.aad = aad\n      if (header) result.header = header\n      if (unprotected) result.unprotected = unprotected\n      if (prot) result.protected = base64url.JSON.decode(prot)\n      return result\n    }\n\n    return cleartext\n  }\n\n  validateHeaders(jwe.protected, jwe.unprotected, jwe.recipients.map(({ header }) => ({ header })), true, crit)\n\n  // general serialization format\n  const { recipients, ...root } = jwe\n  const errs = []\n  for (const recipient of recipients) {\n    try {\n      return jweDecrypt(true, 'flattened', { ...root, ...recipient }, key, { crit, complete, algorithms: algorithms ? [...algorithms] : undefined })\n    } catch (err) {\n      errs.push(err)\n      continue\n    }\n  }\n\n  const multi = new errors.JOSEMultiError(errs)\n  if ([...multi].some(e => e instanceof errors.JWEDecryptionFailed)) {\n    throw new errors.JWEDecryptionFailed()\n  } else if ([...multi].every(e => e instanceof errors.JWKSNoMatchingKey)) {\n    throw new errors.JWKSNoMatchingKey()\n  }\n  throw multi\n}\n\nmodule.exports = jweDecrypt.bind(undefined, false, undefined)\n", "const Encrypt = require('./encrypt')\nconst decrypt = require('./decrypt')\n\n// TODO: in v2.x swap unprotectedHeader and aad\nconst single = (serialization, cleartext, key, protectedHeader, unprotectedHeader, aad) => {\n  return new Encrypt(cleartext, protectedHeader, unprotectedHeader, aad)\n    .recipient(key)\n    .encrypt(serialization)\n}\n\nmodule.exports.Encrypt = Encrypt\nmodule.exports.encrypt = single.bind(undefined, 'compact')\nmodule.exports.encrypt.flattened = single.bind(undefined, 'flattened')\nmodule.exports.encrypt.general = single.bind(undefined, 'general')\n\nmodule.exports.decrypt = decrypt\n", "const isObject = require('../help/is_object')\nlet validateCrit = require('../help/validate_crit')\nconst { JWSInvalid } = require('../errors')\n\nvalidateCrit = validateCrit.bind(undefined, JWSInvalid)\n\nconst compactSerializer = (payload, [recipient]) => {\n  return `${recipient.protected}.${payload}.${recipient.signature}`\n}\ncompactSerializer.validate = (jws, { 0: { unprotectedHeader, protectedHeader }, length }) => {\n  if (length !== 1 || unprotectedHeader) {\n    throw new JWSInvalid('JWS Compact Serialization doesn\\'t support multiple recipients or JWS unprotected headers')\n  }\n  validateCrit(protectedHeader, unprotectedHeader, protectedHeader ? protectedHeader.crit : undefined)\n}\n\nconst flattenedSerializer = (payload, [recipient]) => {\n  const { header, signature, protected: prot } = recipient\n\n  return {\n    payload,\n    ...prot ? { protected: prot } : undefined,\n    ...header ? { header } : undefined,\n    signature\n  }\n}\nflattenedSerializer.validate = (jws, { 0: { unprotectedHeader, protectedHeader }, length }) => {\n  if (length !== 1) {\n    throw new JWSInvalid('Flattened JWS JSON Serialization doesn\\'t support multiple recipients')\n  }\n  validateCrit(protectedHeader, unprotectedHeader, protectedHeader ? protectedHeader.crit : undefined)\n}\n\nconst generalSerializer = (payload, recipients) => {\n  return {\n    payload,\n    signatures: recipients.map(({ header, signature, protected: prot }) => {\n      return {\n        ...prot ? { protected: prot } : undefined,\n        ...header ? { header } : undefined,\n        signature\n      }\n    })\n  }\n}\ngeneralSerializer.validate = (jws, recipients) => {\n  let validateB64 = false\n  recipients.forEach(({ protectedHeader, unprotectedHeader }) => {\n    if (protectedHeader && !validateB64 && 'b64' in protectedHeader) {\n      validateB64 = true\n    }\n    validateCrit(protectedHeader, unprotectedHeader, protectedHeader ? protectedHeader.crit : undefined)\n  })\n\n  if (validateB64) {\n    const values = recipients.map(({ protectedHeader }) => protectedHeader && protectedHeader.b64)\n    if (!values.every((actual, i, [expected]) => actual === expected)) {\n      throw new JWSInvalid('the \"b64\" Header Parameter value MUST be the same for all recipients')\n    }\n  }\n}\n\nconst isJSON = (input) => {\n  return isObject(input) && (typeof input.payload === 'string' || Buffer.isBuffer(input.payload))\n}\n\nconst isValidRecipient = (recipient) => {\n  return isObject(recipient) && typeof recipient.signature === 'string' &&\n    (recipient.header === undefined || isObject(recipient.header)) &&\n    (recipient.protected === undefined || typeof recipient.protected === 'string')\n}\n\nconst isMultiRecipient = (input) => {\n  if (Array.isArray(input.signatures) && input.signatures.every(isValidRecipient)) {\n    return true\n  }\n\n  return false\n}\n\nconst detect = (input) => {\n  if (typeof input === 'string' && input.split('.').length === 3) {\n    return 'compact'\n  }\n\n  if (isJSON(input)) {\n    if (isMultiRecipient(input)) {\n      return 'general'\n    }\n\n    if (isValidRecipient(input)) {\n      return 'flattened'\n    }\n  }\n\n  throw new JWSInvalid('JWS malformed or invalid serialization')\n}\n\nmodule.exports = {\n  compact: compactSerializer,\n  flattened: flattenedSerializer,\n  general: generalSerializer,\n  detect\n}\n", "const base64url = require('../help/base64url')\nconst isDisjoint = require('../help/is_disjoint')\nconst isObject = require('../help/is_object')\nconst deepClone = require('../help/deep_clone')\nconst { JWSInvalid } = require('../errors')\nconst { sign } = require('../jwa')\nconst getKey = require('../help/get_key')\n\nconst serializers = require('./serializers')\n\nconst PROCESS_RECIPIENT = Symbol('PROCESS_RECIPIENT')\n\nclass Sign {\n  constructor (payload) {\n    if (typeof payload === 'string') {\n      payload = base64url.encode(payload)\n    } else if (Buffer.isBuffer(payload)) {\n      payload = base64url.encodeBuffer(payload)\n      this._binary = true\n    } else if (isObject(payload)) {\n      payload = base64url.JSON.encode(payload)\n    } else {\n      throw new TypeError('payload argument must be a Buffer, string or an object')\n    }\n\n    this._payload = payload\n    this._recipients = []\n  }\n\n  /*\n   * @public\n   */\n  recipient (key, protectedHeader, unprotectedHeader) {\n    key = getKey(key)\n\n    if (protectedHeader !== undefined && !isObject(protectedHeader)) {\n      throw new TypeError('protectedHeader argument must be a plain object when provided')\n    }\n\n    if (unprotectedHeader !== undefined && !isObject(unprotectedHeader)) {\n      throw new TypeError('unprotectedHeader argument must be a plain object when provided')\n    }\n\n    if (!isDisjoint(protectedHeader, unprotectedHeader)) {\n      throw new JWSInvalid('JWS Protected and JWS Unprotected Header Parameter names must be disjoint')\n    }\n\n    this._recipients.push({\n      key,\n      protectedHeader: protectedHeader ? deepClone(protectedHeader) : undefined,\n      unprotectedHeader: unprotectedHeader ? deepClone(unprotectedHeader) : undefined\n    })\n\n    return this\n  }\n\n  /*\n   * @private\n   */\n  [PROCESS_RECIPIENT] (recipient, first) {\n    const { key, protectedHeader, unprotectedHeader } = recipient\n\n    if (key.use === 'enc') {\n      throw new TypeError('a key with \"use\":\"enc\" is not usable for signing')\n    }\n\n    const joseHeader = {\n      protected: protectedHeader || {},\n      unprotected: unprotectedHeader || {}\n    }\n\n    let alg = joseHeader.protected.alg || joseHeader.unprotected.alg\n\n    if (!alg) {\n      alg = key.alg || [...key.algorithms('sign')][0]\n      if (recipient.protectedHeader) {\n        joseHeader.protected.alg = recipient.protectedHeader.alg = alg\n      } else {\n        joseHeader.protected = recipient.protectedHeader = { alg }\n      }\n    }\n\n    if (!alg) {\n      throw new JWSInvalid('could not resolve a usable \"alg\" for a recipient')\n    }\n\n    recipient.header = unprotectedHeader\n    recipient.protected = Object.keys(joseHeader.protected).length ? base64url.JSON.encode(joseHeader.protected) : ''\n\n    if (first && joseHeader.protected.crit && joseHeader.protected.crit.includes('b64') && joseHeader.protected.b64 === false) {\n      if (this._binary) {\n        this._payload = base64url.decodeToBuffer(this._payload)\n      } else {\n        this._payload = base64url.decode(this._payload)\n      }\n    }\n\n    const data = Buffer.concat([\n      Buffer.from(recipient.protected || ''),\n      Buffer.from('.'),\n      Buffer.from(this._payload)\n    ])\n\n    recipient.signature = base64url.encodeBuffer(sign(alg, key, data))\n  }\n\n  /*\n   * @public\n   */\n  sign (serialization) {\n    const serializer = serializers[serialization]\n    if (!serializer) {\n      throw new TypeError('serialization must be one of \"compact\", \"flattened\", \"general\"')\n    }\n\n    if (!this._recipients.length) {\n      throw new JWSInvalid('missing recipients')\n    }\n\n    serializer.validate(this, this._recipients)\n\n    this._recipients.forEach((recipient, i) => {\n      this[PROCESS_RECIPIENT](recipient, i === 0)\n    })\n\n    return serializer(this._payload, this._recipients)\n  }\n}\n\nmodule.exports = Sign\n", "const { EOL } = require('os')\n\nconst base64url = require('../help/base64url')\nconst isDisjoint = require('../help/is_disjoint')\nconst isObject = require('../help/is_object')\nlet validateCrit = require('../help/validate_crit')\nconst getKey = require('../help/get_key')\nconst { KeyStore } = require('../jwks')\nconst errors = require('../errors')\nconst { check, verify } = require('../jwa')\nconst JWK = require('../jwk')\n\nconst { detect: resolveSerialization } = require('./serializers')\n\nvalidateCrit = validateCrit.bind(undefined, errors.JWSInvalid)\nconst SINGLE_RECIPIENT = new Set(['compact', 'flattened', 'preparsed'])\n\n/*\n * @public\n */\nconst jwsVerify = (skipDisjointCheck, serialization, jws, key, { crit = [], complete = false, algorithms, parse = true, encoding = 'utf8' } = {}) => {\n  key = getKey(key, true)\n\n  if (algorithms !== undefined && (!Array.isArray(algorithms) || algorithms.some(s => typeof s !== 'string' || !s))) {\n    throw new TypeError('\"algorithms\" option must be an array of non-empty strings')\n  } else if (algorithms) {\n    algorithms = new Set(algorithms)\n  }\n\n  if (!Array.isArray(crit) || crit.some(s => typeof s !== 'string' || !s)) {\n    throw new TypeError('\"crit\" option must be an array of non-empty strings')\n  }\n\n  if (!serialization) {\n    serialization = resolveSerialization(jws)\n  }\n\n  let prot // protected header\n  let header // unprotected header\n  let payload\n  let signature\n  let alg\n\n  // treat general format with one recipient as flattened\n  // skips iteration and avoids multi errors in this case\n  if (serialization === 'general' && jws.signatures.length === 1) {\n    serialization = 'flattened'\n    const { signatures, ...root } = jws\n    jws = { ...root, ...signatures[0] }\n  }\n\n  let decoded\n\n  if (SINGLE_RECIPIENT.has(serialization)) {\n    let parsedProt = {}\n\n    switch (serialization) {\n      case 'compact': // compact serialization format\n        ([prot, payload, signature] = jws.split('.'))\n        break\n      case 'flattened': // flattened serialization format\n        ({ protected: prot, payload, signature, header } = jws)\n        break\n      case 'preparsed': { // from the JWT module\n        ({ decoded } = jws);\n        ([prot, payload, signature] = jws.token.split('.'))\n        break\n      }\n    }\n\n    if (!header) {\n      skipDisjointCheck = true\n    }\n\n    if (decoded) {\n      parsedProt = decoded.header\n    } else if (prot) {\n      try {\n        parsedProt = base64url.JSON.decode(prot)\n      } catch (err) {\n        throw new errors.JWSInvalid('could not parse JWS protected header')\n      }\n    } else {\n      skipDisjointCheck = skipDisjointCheck || true\n    }\n\n    if (!skipDisjointCheck && !isDisjoint(parsedProt, header)) {\n      throw new errors.JWSInvalid('JWS Protected and JWS Unprotected Header Parameter names must be disjoint')\n    }\n\n    const combinedHeader = { ...parsedProt, ...header }\n    validateCrit(parsedProt, header, crit)\n\n    alg = parsedProt.alg || (header && header.alg)\n    if (!alg) {\n      throw new errors.JWSInvalid('missing JWS signature algorithm')\n    } else if (algorithms && !algorithms.has(alg)) {\n      throw new errors.JOSEAlgNotWhitelisted('alg not whitelisted')\n    }\n\n    if (key instanceof KeyStore) {\n      const keystore = key\n      const keys = keystore.all({ kid: combinedHeader.kid, alg: combinedHeader.alg, key_ops: ['verify'] })\n      switch (keys.length) {\n        case 0:\n          throw new errors.JWKSNoMatchingKey()\n        case 1:\n          // treat the call as if a Key instance was passed in\n          // skips iteration and avoids multi errors in this case\n          key = keys[0]\n          break\n        default: {\n          const errs = []\n          for (const key of keys) {\n            try {\n              return jwsVerify(true, serialization, jws, key, { crit, complete, encoding, parse, algorithms: algorithms ? [...algorithms] : undefined })\n            } catch (err) {\n              errs.push(err)\n              continue\n            }\n          }\n\n          const multi = new errors.JOSEMultiError(errs)\n          if ([...multi].some(e => e instanceof errors.JWSVerificationFailed)) {\n            throw new errors.JWSVerificationFailed()\n          }\n          throw multi\n        }\n      }\n    }\n\n    if (key === JWK.EmbeddedJWK) {\n      if (!isObject(combinedHeader.jwk)) {\n        throw new errors.JWSInvalid('JWS Header Parameter \"jwk\" must be a JSON object')\n      }\n      key = JWK.asKey(combinedHeader.jwk)\n      if (key.type !== 'public') {\n        throw new errors.JWSInvalid('JWS Header Parameter \"jwk\" must be a public key')\n      }\n    } else if (key === JWK.EmbeddedX5C) {\n      if (!Array.isArray(combinedHeader.x5c) || !combinedHeader.x5c.length || combinedHeader.x5c.some(c => typeof c !== 'string' || !c)) {\n        throw new errors.JWSInvalid('JWS Header Parameter \"x5c\" must be a JSON array of certificate value strings')\n      }\n      key = JWK.asKey(\n        `-----BEGIN CERTIFICATE-----${EOL}${(combinedHeader.x5c[0].match(/.{1,64}/g) || []).join(EOL)}${EOL}-----END CERTIFICATE-----`,\n        { x5c: combinedHeader.x5c }\n      )\n    }\n\n    check(key, 'verify', alg)\n\n    const toBeVerified = Buffer.concat([\n      Buffer.from(prot || ''),\n      Buffer.from('.'),\n      Buffer.isBuffer(payload) ? payload : Buffer.from(payload)\n    ])\n\n    if (!verify(alg, key, toBeVerified, base64url.decodeToBuffer(signature))) {\n      throw new errors.JWSVerificationFailed()\n    }\n\n    if (!combinedHeader.crit || !combinedHeader.crit.includes('b64') || combinedHeader.b64) {\n      if (parse) {\n        payload = decoded ? decoded.payload : base64url.JSON.decode.try(payload, encoding)\n      } else {\n        payload = base64url.decodeToBuffer(payload)\n      }\n    }\n\n    if (complete) {\n      const result = { payload, key }\n      if (prot) result.protected = parsedProt\n      if (header) result.header = header\n      return result\n    }\n\n    return payload\n  }\n\n  // general serialization format\n  const { signatures, ...root } = jws\n  const errs = []\n  for (const recipient of signatures) {\n    try {\n      return jwsVerify(false, 'flattened', { ...root, ...recipient }, key, { crit, complete, encoding, parse, algorithms: algorithms ? [...algorithms] : undefined })\n    } catch (err) {\n      errs.push(err)\n      continue\n    }\n  }\n\n  const multi = new errors.JOSEMultiError(errs)\n  if ([...multi].some(e => e instanceof errors.JWSVerificationFailed)) {\n    throw new errors.JWSVerificationFailed()\n  } else if ([...multi].every(e => e instanceof errors.JWKSNoMatchingKey)) {\n    throw new errors.JWKSNoMatchingKey()\n  }\n  throw multi\n}\n\nmodule.exports = {\n  bare: jwsVerify,\n  verify: jwsVerify.bind(undefined, false, undefined)\n}\n", "const Sign = require('./sign')\nconst { verify } = require('./verify')\n\nconst single = (serialization, payload, key, protectedHeader, unprotectedHeader) => {\n  return new Sign(payload)\n    .recipient(key, protectedHeader, unprotectedHeader)\n    .sign(serialization)\n}\n\nmodule.exports.Sign = Sign\nmodule.exports.sign = single.bind(undefined, 'compact')\nmodule.exports.sign.flattened = single.bind(undefined, 'flattened')\nmodule.exports.sign.general = single.bind(undefined, 'general')\n\nmodule.exports.verify = verify\n", "const base64url = require('../help/base64url')\nconst errors = require('../errors')\n\nmodule.exports = (token, { complete = false } = {}) => {\n  if (typeof token !== 'string' || !token) {\n    throw new TypeError('JWT must be a string')\n  }\n\n  const { 0: header, 1: payload, 2: signature, length } = token.split('.')\n\n  if (length === 5) {\n    throw new TypeError('JWTs must be decrypted first')\n  }\n\n  if (length !== 3) {\n    throw new errors.JWTMalformed('JWTs must have three components')\n  }\n\n  try {\n    const result = {\n      header: base64url.JSON.decode(header),\n      payload: base64url.JSON.decode(payload),\n      signature\n    }\n\n    return complete ? result : result.payload\n  } catch (err) {\n    throw new errors.JWTMalformed('JWT is malformed')\n  }\n}\n", "const minute = 60\nconst hour = minute * 60\nconst day = hour * 24\nconst week = day * 7\nconst year = day * 365.25\n\nconst REGEX = /^(\\d+|\\d+\\.\\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i\n\nmodule.exports = (str) => {\n  const matched = REGEX.exec(str)\n\n  if (!matched) {\n    throw new TypeError(`invalid time period format (\"${str}\")`)\n  }\n\n  const value = parseFloat(matched[1])\n  const unit = matched[2].toLowerCase()\n\n  switch (unit) {\n    case 'sec':\n    case 'secs':\n    case 'second':\n    case 'seconds':\n    case 's':\n      return Math.round(value)\n    case 'minute':\n    case 'minutes':\n    case 'min':\n    case 'mins':\n    case 'm':\n      return Math.round(value * minute)\n    case 'hour':\n    case 'hours':\n    case 'hr':\n    case 'hrs':\n    case 'h':\n      return Math.round(value * hour)\n    case 'day':\n    case 'days':\n    case 'd':\n      return Math.round(value * day)\n    case 'week':\n    case 'weeks':\n    case 'w':\n      return Math.round(value * week)\n    case 'year':\n    case 'years':\n    case 'yr':\n    case 'yrs':\n    case 'y':\n      return Math.round(value * year)\n  }\n}\n", "module.exports = (date) => Math.floor(date.getTime() / 1000)\n", "const isNotString = val => typeof val !== 'string' || val.length === 0\n\nmodule.exports.isNotString = isNotString\nmodule.exports.isString = function isString (Err, value, label, claim, required = false) {\n  if (required && value === undefined) {\n    throw new Err(`${label} is missing`, claim, 'missing')\n  }\n\n  if (value !== undefined && isNotString(value)) {\n    throw new Err(`${label} must be a string`, claim, 'invalid')\n  }\n}\n", "const isObject = require('../help/is_object')\nconst secs = require('../help/secs')\nconst epoch = require('../help/epoch')\nconst getKey = require('../help/get_key')\nconst JWS = require('../jws')\n\nconst isString = require('./shared_validations').isString.bind(undefined, TypeError)\n\nconst validateOptions = (options) => {\n  if (typeof options.iat !== 'boolean') {\n    throw new TypeError('options.iat must be a boolean')\n  }\n\n  if (typeof options.kid !== 'boolean') {\n    throw new TypeError('options.kid must be a boolean')\n  }\n\n  isString(options.subject, 'options.subject')\n  isString(options.issuer, 'options.issuer')\n\n  if (\n    options.audience !== undefined &&\n    (\n      (typeof options.audience !== 'string' || !options.audience) &&\n      (!Array.isArray(options.audience) || options.audience.length === 0 || options.audience.some(a => !a || typeof a !== 'string'))\n    )\n  ) {\n    throw new TypeError('options.audience must be a string or an array of strings')\n  }\n\n  if (!isObject(options.header)) {\n    throw new TypeError('options.header must be an object')\n  }\n\n  isString(options.algorithm, 'options.algorithm')\n  isString(options.expiresIn, 'options.expiresIn')\n  isString(options.notBefore, 'options.notBefore')\n  isString(options.jti, 'options.jti')\n  isString(options.nonce, 'options.nonce')\n\n  if (options.now !== undefined && (!(options.now instanceof Date) || !options.now.getTime())) {\n    throw new TypeError('options.now must be a valid Date object')\n  }\n}\n\nmodule.exports = (payload, key, options = {}) => {\n  if (!isObject(options)) {\n    throw new TypeError('options must be an object')\n  }\n\n  const {\n    algorithm, audience, expiresIn, header = {}, iat = true,\n    issuer, jti, kid = true, nonce, notBefore, subject, now\n  } = options\n\n  validateOptions({\n    algorithm, audience, expiresIn, header, iat, issuer, jti, kid, nonce, notBefore, now, subject\n  })\n\n  if (!isObject(payload)) {\n    throw new TypeError('payload must be an object')\n  }\n\n  let unix\n  if (expiresIn || notBefore || iat) {\n    unix = epoch(now || new Date())\n  }\n\n  payload = {\n    ...payload,\n    sub: subject || payload.sub,\n    aud: audience || payload.aud,\n    iss: issuer || payload.iss,\n    jti: jti || payload.jti,\n    iat: iat ? unix : payload.iat,\n    nonce: nonce || payload.nonce,\n    exp: expiresIn ? unix + secs(expiresIn) : payload.exp,\n    nbf: notBefore ? unix + secs(notBefore) : payload.nbf\n  }\n\n  key = getKey(key)\n\n  let includeKid\n\n  if (typeof options.kid === 'boolean') {\n    includeKid = kid\n  } else {\n    includeKid = !key.secret\n  }\n\n  return JWS.sign(JSON.stringify(payload), key, {\n    ...header,\n    alg: algorithm || header.alg,\n    kid: includeKid ? key.kid : header.kid\n  })\n}\n", "const isObject = require('../help/is_object')\nconst epoch = require('../help/epoch')\nconst secs = require('../help/secs')\nconst getKey = require('../help/get_key')\nconst { bare: verify } = require('../jws/verify')\nconst { JWTClaimInvalid, JWTExpired } = require('../errors')\n\nconst { isString, isNotString } = require('./shared_validations')\nconst decode = require('./decode')\n\nconst isPayloadString = isString.bind(undefined, JWTClaimInvalid)\nconst isOptionString = isString.bind(undefined, TypeError)\n\nconst IDTOKEN = 'id_token'\nconst LOGOUTTOKEN = 'logout_token'\nconst ATJWT = 'at+JWT'\n\nconst isTimestamp = (value, label, required = false) => {\n  if (required && value === undefined) {\n    throw new JWTClaimInvalid(`\"${label}\" claim is missing`, label, 'missing')\n  }\n\n  if (value !== undefined && (typeof value !== 'number')) {\n    throw new JWTClaimInvalid(`\"${label}\" claim must be a JSON numeric value`, label, 'invalid')\n  }\n}\n\nconst isStringOrArrayOfStrings = (value, label, required = false) => {\n  if (required && value === undefined) {\n    throw new JWTClaimInvalid(`\"${label}\" claim is missing`, label, 'missing')\n  }\n\n  if (value !== undefined && (isNotString(value) && isNotArrayOfStrings(value))) {\n    throw new JWTClaimInvalid(`\"${label}\" claim must be a string or array of strings`, label, 'invalid')\n  }\n}\n\nconst isNotArrayOfStrings = val => !Array.isArray(val) || val.length === 0 || val.some(isNotString)\nconst normalizeTyp = (value) => value.toLowerCase().replace(/^application\\//, '')\n\nconst validateOptions = ({\n  algorithms, audience, clockTolerance, complete = false, crit, ignoreExp = false,\n  ignoreIat = false, ignoreNbf = false, issuer, jti, maxAuthAge, maxTokenAge, nonce, now = new Date(),\n  profile, subject, typ\n}) => {\n  isOptionString(profile, 'options.profile')\n\n  if (typeof complete !== 'boolean') {\n    throw new TypeError('options.complete must be a boolean')\n  }\n\n  if (typeof ignoreExp !== 'boolean') {\n    throw new TypeError('options.ignoreExp must be a boolean')\n  }\n\n  if (typeof ignoreNbf !== 'boolean') {\n    throw new TypeError('options.ignoreNbf must be a boolean')\n  }\n\n  if (typeof ignoreIat !== 'boolean') {\n    throw new TypeError('options.ignoreIat must be a boolean')\n  }\n\n  isOptionString(maxTokenAge, 'options.maxTokenAge')\n  isOptionString(subject, 'options.subject')\n  isOptionString(maxAuthAge, 'options.maxAuthAge')\n  isOptionString(jti, 'options.jti')\n  isOptionString(clockTolerance, 'options.clockTolerance')\n  isOptionString(typ, 'options.typ')\n\n  if (issuer !== undefined && (isNotString(issuer) && isNotArrayOfStrings(issuer))) {\n    throw new TypeError('options.issuer must be a string or an array of strings')\n  }\n\n  if (audience !== undefined && (isNotString(audience) && isNotArrayOfStrings(audience))) {\n    throw new TypeError('options.audience must be a string or an array of strings')\n  }\n\n  if (algorithms !== undefined && isNotArrayOfStrings(algorithms)) {\n    throw new TypeError('options.algorithms must be an array of strings')\n  }\n\n  isOptionString(nonce, 'options.nonce')\n\n  if (!(now instanceof Date) || !now.getTime()) {\n    throw new TypeError('options.now must be a valid Date object')\n  }\n\n  if (ignoreIat && maxTokenAge !== undefined) {\n    throw new TypeError('options.ignoreIat and options.maxTokenAge cannot used together')\n  }\n\n  if (crit !== undefined && isNotArrayOfStrings(crit)) {\n    throw new TypeError('options.crit must be an array of strings')\n  }\n\n  switch (profile) {\n    case IDTOKEN:\n      if (!issuer) {\n        throw new TypeError('\"issuer\" option is required to validate an ID Token')\n      }\n\n      if (!audience) {\n        throw new TypeError('\"audience\" option is required to validate an ID Token')\n      }\n\n      break\n    case ATJWT:\n      if (!issuer) {\n        throw new TypeError('\"issuer\" option is required to validate a JWT Access Token')\n      }\n\n      if (!audience) {\n        throw new TypeError('\"audience\" option is required to validate a JWT Access Token')\n      }\n\n      typ = ATJWT\n\n      break\n    case LOGOUTTOKEN:\n      if (!issuer) {\n        throw new TypeError('\"issuer\" option is required to validate a Logout Token')\n      }\n\n      if (!audience) {\n        throw new TypeError('\"audience\" option is required to validate a Logout Token')\n      }\n\n      break\n    case undefined:\n      break\n    default:\n      throw new TypeError(`unsupported options.profile value \"${profile}\"`)\n  }\n\n  return {\n    algorithms,\n    audience,\n    clockTolerance,\n    complete,\n    crit,\n    ignoreExp,\n    ignoreIat,\n    ignoreNbf,\n    issuer,\n    jti,\n    maxAuthAge,\n    maxTokenAge,\n    nonce,\n    now,\n    profile,\n    subject,\n    typ\n  }\n}\n\nconst validateTypes = ({ header, payload }, profile, options) => {\n  isPayloadString(header.alg, '\"alg\" header parameter', 'alg', true)\n\n  isTimestamp(payload.iat, 'iat', profile === IDTOKEN || profile === LOGOUTTOKEN || profile === ATJWT || !!options.maxTokenAge)\n  isTimestamp(payload.exp, 'exp', profile === IDTOKEN || profile === ATJWT)\n  isTimestamp(payload.auth_time, 'auth_time', !!options.maxAuthAge)\n  isTimestamp(payload.nbf, 'nbf')\n  isPayloadString(payload.jti, '\"jti\" claim', 'jti', profile === LOGOUTTOKEN || profile === ATJWT || !!options.jti)\n  isPayloadString(payload.acr, '\"acr\" claim', 'acr')\n  isPayloadString(payload.nonce, '\"nonce\" claim', 'nonce', !!options.nonce)\n  isStringOrArrayOfStrings(payload.iss, 'iss', !!options.issuer)\n  isPayloadString(payload.sub, '\"sub\" claim', 'sub', profile === IDTOKEN || profile === ATJWT || !!options.subject)\n  isStringOrArrayOfStrings(payload.aud, 'aud', !!options.audience)\n  isPayloadString(payload.azp, '\"azp\" claim', 'azp', profile === IDTOKEN && Array.isArray(payload.aud) && payload.aud.length > 1)\n  isStringOrArrayOfStrings(payload.amr, 'amr')\n  isPayloadString(header.typ, '\"typ\" header parameter', 'typ', !!options.typ)\n\n  if (profile === ATJWT) {\n    isPayloadString(payload.client_id, '\"client_id\" claim', 'client_id', true)\n  }\n\n  if (profile === LOGOUTTOKEN) {\n    isPayloadString(payload.sid, '\"sid\" claim', 'sid')\n\n    if (!('sid' in payload) && !('sub' in payload)) {\n      throw new JWTClaimInvalid('either \"sid\" or \"sub\" (or both) claims must be present')\n    }\n\n    if ('nonce' in payload) {\n      throw new JWTClaimInvalid('\"nonce\" claim is prohibited', 'nonce', 'prohibited')\n    }\n\n    if (!('events' in payload)) {\n      throw new JWTClaimInvalid('\"events\" claim is missing', 'events', 'missing')\n    }\n\n    if (!isObject(payload.events)) {\n      throw new JWTClaimInvalid('\"events\" claim must be an object', 'events', 'invalid')\n    }\n\n    if (!('http://schemas.openid.net/event/backchannel-logout' in payload.events)) {\n      throw new JWTClaimInvalid('\"http://schemas.openid.net/event/backchannel-logout\" member is missing in the \"events\" claim', 'events', 'invalid')\n    }\n\n    if (!isObject(payload.events['http://schemas.openid.net/event/backchannel-logout'])) {\n      throw new JWTClaimInvalid('\"http://schemas.openid.net/event/backchannel-logout\" member in the \"events\" claim must be an object', 'events', 'invalid')\n    }\n  }\n}\n\nconst checkAudiencePresence = (audPayload, audOption, profile) => {\n  if (typeof audPayload === 'string') {\n    return audOption.includes(audPayload)\n  }\n\n  // Each principal intended to process the JWT MUST\n  // identify itself with a value in the audience claim\n  audPayload = new Set(audPayload)\n  return audOption.some(Set.prototype.has.bind(audPayload))\n}\n\nmodule.exports = (token, key, options = {}) => {\n  if (!isObject(options)) {\n    throw new TypeError('options must be an object')\n  }\n\n  const {\n    algorithms, audience, clockTolerance, complete, crit, ignoreExp, ignoreIat, ignoreNbf, issuer,\n    jti, maxAuthAge, maxTokenAge, nonce, now, profile, subject, typ\n  } = options = validateOptions(options)\n\n  const decoded = decode(token, { complete: true })\n  key = getKey(key, true)\n\n  if (complete) {\n    ({ key } = verify(true, 'preparsed', { decoded, token }, key, { crit, algorithms, complete: true }))\n    decoded.key = key\n  } else {\n    verify(true, 'preparsed', { decoded, token }, key, { crit, algorithms })\n  }\n\n  const unix = epoch(now)\n  validateTypes(decoded, profile, options)\n\n  if (issuer && (typeof decoded.payload.iss !== 'string' || !(typeof issuer === 'string' ? [issuer] : issuer).includes(decoded.payload.iss))) {\n    throw new JWTClaimInvalid('unexpected \"iss\" claim value', 'iss', 'check_failed')\n  }\n\n  if (nonce && decoded.payload.nonce !== nonce) {\n    throw new JWTClaimInvalid('unexpected \"nonce\" claim value', 'nonce', 'check_failed')\n  }\n\n  if (subject && decoded.payload.sub !== subject) {\n    throw new JWTClaimInvalid('unexpected \"sub\" claim value', 'sub', 'check_failed')\n  }\n\n  if (jti && decoded.payload.jti !== jti) {\n    throw new JWTClaimInvalid('unexpected \"jti\" claim value', 'jti', 'check_failed')\n  }\n\n  if (audience && !checkAudiencePresence(decoded.payload.aud, typeof audience === 'string' ? [audience] : audience, profile)) {\n    throw new JWTClaimInvalid('unexpected \"aud\" claim value', 'aud', 'check_failed')\n  }\n\n  if (typ && normalizeTyp(decoded.header.typ) !== normalizeTyp(typ)) {\n    throw new JWTClaimInvalid('unexpected \"typ\" JWT header value', 'typ', 'check_failed')\n  }\n\n  const tolerance = clockTolerance ? secs(clockTolerance) : 0\n\n  if (maxAuthAge) {\n    const maxAuthAgeSeconds = secs(maxAuthAge)\n    if (decoded.payload.auth_time + maxAuthAgeSeconds < unix - tolerance) {\n      throw new JWTClaimInvalid('\"auth_time\" claim timestamp check failed (too much time has elapsed since the last End-User authentication)', 'auth_time', 'check_failed')\n    }\n  }\n\n  if (!ignoreIat && !('exp' in decoded.payload) && 'iat' in decoded.payload && decoded.payload.iat > unix + tolerance) {\n    throw new JWTClaimInvalid('\"iat\" claim timestamp check failed (it should be in the past)', 'iat', 'check_failed')\n  }\n\n  if (!ignoreNbf && 'nbf' in decoded.payload && decoded.payload.nbf > unix + tolerance) {\n    throw new JWTClaimInvalid('\"nbf\" claim timestamp check failed', 'nbf', 'check_failed')\n  }\n\n  if (!ignoreExp && 'exp' in decoded.payload && decoded.payload.exp <= unix - tolerance) {\n    throw new JWTExpired('\"exp\" claim timestamp check failed', 'exp', 'check_failed')\n  }\n\n  if (maxTokenAge) {\n    const age = unix - decoded.payload.iat\n    const max = secs(maxTokenAge)\n\n    if (age - tolerance > max) {\n      throw new JWTExpired('\"iat\" claim timestamp check failed (too far in the past)', 'iat', 'check_failed')\n    }\n\n    if (age < 0 - tolerance) {\n      throw new JWTClaimInvalid('\"iat\" claim timestamp check failed (it should be in the past)', 'iat', 'check_failed')\n    }\n  }\n\n  if (profile === IDTOKEN && Array.isArray(decoded.payload.aud) && decoded.payload.aud.length > 1 && decoded.payload.azp !== audience) {\n    throw new JWTClaimInvalid('unexpected \"azp\" claim value', 'azp', 'check_failed')\n  }\n\n  return complete ? decoded : decoded.payload\n}\n", "const verify = require('./verify')\n\nmodule.exports = {\n  IdToken: { verify: (token, key, options) => verify(token, key, { ...options, profile: 'id_token' }) },\n  LogoutToken: { verify: (token, key, options) => verify(token, key, { ...options, profile: 'logout_token' }) },\n  AccessToken: { verify: (token, key, options) => verify(token, key, { ...options, profile: 'at+JWT' }) }\n}\n", "const decode = require('./decode')\nconst sign = require('./sign')\nconst verify = require('./verify')\nconst profiles = require('./profiles')\n\nmodule.exports = {\n  decode,\n  sign,\n  verify,\n  ...profiles\n}\n", "module.exports = {\n  JWE: require('./jwe'),\n  JWK: require('./jwk'),\n  JWKS: require('./jwks'),\n  JWS: require('./jws'),\n  JWT: require('./jwt'),\n  errors: require('./errors')\n}\n", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.setLogger = setLogger;\nexports.proxyLogger = proxyLogger;\nexports.default = void 0;\nconst _logger = {\n  error(code, ...message) {\n    console.error(`[next-auth][error][${code.toLowerCase()}]`, `\\nhttps://next-auth.js.org/errors#${code.toLowerCase()}`, ...message);\n  },\n\n  warn(code, ...message) {\n    console.warn(`[next-auth][warn][${code.toLowerCase()}]`, `\\nhttps://next-auth.js.org/warnings#${code.toLowerCase()}`, ...message);\n  },\n\n  debug(code, ...message) {\n    var _process, _process$env;\n\n    if (!((_process = process) !== null && _process !== void 0 && (_process$env = _process.env) !== null && _process$env !== void 0 && _process$env._NEXTAUTH_DEBUG)) return;\n    console.log(`[next-auth][debug][${code.toLowerCase()}]`, ...message);\n  }\n\n};\n\nfunction setLogger(newLogger = {}) {\n  if (newLogger.error) _logger.error = newLogger.error;\n  if (newLogger.warn) _logger.warn = newLogger.warn;\n  if (newLogger.debug) _logger.debug = newLogger.debug;\n}\n\nvar _default = _logger;\nexports.default = _default;\n\nfunction proxyLogger(logger = _logger, basePath) {\n  try {\n    if (typeof window === \"undefined\") {\n      return logger;\n    }\n\n    const clientLogger = {};\n\n    for (const level in logger) {\n      clientLogger[level] = (code, ...message) => {\n        _logger[level](code, ...message);\n\n        const url = `${basePath}/_log`;\n        const body = new URLSearchParams({\n          level,\n          code,\n          message: JSON.stringify(message.map(m => {\n            if (m instanceof Error) {\n              return {\n                name: m.name,\n                message: m.message,\n                stack: m.stack\n              };\n            }\n\n            return m;\n          }))\n        });\n\n        if (navigator.sendBeacon) {\n          return navigator.sendBeacon(url, body);\n        }\n\n        return fetch(url, {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body\n        });\n      };\n    }\n\n    return clientLogger;\n  } catch (_unused) {\n    return _logger;\n  }\n}", "'use strict';\n\n/**\n * @file\n *\n * Copyright 2018 FutoIn Project (https://futoin.org)\n * Copyright 2018 Andrey Galkin <andrey@futoin.org>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst { createHash, createHmac } = require( 'crypto' );\n\nconst g_digestLenCache = {};\n\n/**\n * Get expected hash length.\n *\n * @func\n * @alias hkdf.hash_length\n * @param {string} hash - Hash algorithm (as in underlying Node.js crypto library)\n * @returns {integer} hash digest byte length\n *\n * @note Values are hardcoded with fallback for unknown algorithms.\n */\nconst hash_length = ( hash ) => {\n    switch ( hash ) {\n    case 'sha256': return 32;\n    case 'sha512': return 64;\n    case 'sha224': return 28;\n    case 'sha384': return 48;\n    case 'sha3-256': return 32;\n    case 'sha3-512': return 64;\n    case 'sha3-224': return 28;\n    case 'sha3-384': return 48;\n    case 'blake2s256': return 32;\n    case 'blake2b512': return 64;\n    case 'sha1': return 20;\n    case 'md5': return 16;\n    default: {\n        let len = g_digestLenCache[hash];\n\n        if ( len === undefined ) {\n            len = createHash( hash ).digest().length;\n            g_digestLenCache[hash] = len;\n        }\n\n        return len;\n    }\n    }\n};\n\n/**\n * HKDF extract action.\n *\n * @func\n * @alias hkdf.extract\n * @param {string} hash - Hash algorithm (as in underlying Node.js crypto library)\n * @param {integer} hash_len - Hash digest length\n * @param {Buffer|string} ikm - Initial Keying Material\n * @param {Buffer|string} salt - Optional salt (recommended)\n * @returns {Buffer} A buffer with pseudorandom key\n *\n * @note Values are hardcoded with fallback for unknown algorithms.\n */\nconst hkdf_extract = ( hash, hash_len, ikm, salt ) => {\n    const b_ikm = Buffer.isBuffer( ikm ) ? ikm : Buffer.from( ikm );\n    const b_salt = ( salt && salt.length ) ? Buffer.from( salt ) : Buffer.alloc( hash_len, 0 );\n\n    return createHmac( hash, b_salt ).update( b_ikm ).digest();\n};\n\n/**\n * HKDF expand action.\n *\n * @func\n * @alias hkdf.expand\n * @param {string} hash - Hash algorithm (as in underlying Node.js crypto library)\n * @param {integer} hash_len - Hash digest length\n * @param {Buffer|string} prk - A buffer with pseudorandom key\n * @param {integer} length - length of output keying material in octets\n * @param {Buffer|string} info - Optional context (safe to skip)\n * @returns {Buffer} A buffer with output keying material\n *\n * @note Values are hardcoded with fallback for unknown algorithms.\n */\nconst hkdf_expand = ( hash, hash_len, prk, length, info ) => {\n    const b_info = Buffer.from( info || '' );\n    const info_len = b_info.length;\n\n    const steps = Math.ceil( length / hash_len );\n\n    if ( steps > 0xFF ) {\n        throw new Error( `OKM length ${length} is too long for ${hash} hash` );\n    }\n\n    // use single buffer with unnecessary create/copy/move operations\n    const t = Buffer.alloc( hash_len * steps + info_len + 1 );\n\n    for ( let c = 1, start = 0, end = 0; c <= steps; ++c ) {\n        // add info\n        b_info.copy( t, end );\n        // add counter\n        t[ end + info_len ] = c;\n\n        createHmac( hash, prk )\n            // use view: T(C) = T(C-1) | info | C\n            .update( t.slice( start, end + info_len + 1 ) )\n            .digest()\n            // put back to the same buffer\n            .copy( t, end );\n\n        start = end; // used for T(C-1) start\n        end += hash_len; // used for T(C-1) end & overall end\n    }\n\n    return t.slice( 0, length );\n};\n\n/**\n * HMAC-based Extract-and-Expand Key Derivation Function (HKDF)\n *\n * @param {Buffer|string} ikm - Initial Keying Material\n * @param {integer} length - Required byte length of output\n * @param {Buffer|string} salt='' - Optional salt (recommended)\n * @param {Buffer|string} info='' - Optional context (safe to skip)\n * @param {string} hash='SHA-256' - HMAC hash function to use\n * @returns {Buffer} Raw buffer with derived key of @p length bytes\n */\nfunction hkdf( ikm, length, { salt='', info='', hash='SHA-256' } = {} ) {\n    hash = hash.toLowerCase().replace( '-', '' );\n\n    // 0. Hash length\n    const hash_len = hash_length( hash );\n\n    // 1. extract\n    const prk = hkdf_extract( hash, hash_len, ikm, salt );\n\n    // 2. expand\n    return hkdf_expand( hash, hash_len, prk, length, info );\n}\n\nObject.defineProperties( hkdf, {\n    hash_length : {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: hash_length,\n    },\n    extract : {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: hkdf_extract,\n    },\n    expand : {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: hkdf_expand,\n    },\n} );\n\nmodule.exports = hkdf;\n", "\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.encode = encode;\nexports.decode = decode;\nexports.getToken = getToken;\nexports.default = void 0;\n\nvar _crypto = _interopRequireDefault(require(\"crypto\"));\n\nvar _jose = _interopRequireDefault(require(\"jose\"));\n\nvar _logger = _interopRequireDefault(require(\"./logger\"));\n\nconst DEFAULT_SIGNATURE_ALGORITHM = \"HS512\";\nconst DEFAULT_ENCRYPTION_ALGORITHM = \"A256GCM\";\nconst DEFAULT_ENCRYPTION_ENABLED = false;\nconst DEFAULT_MAX_AGE = 30 * 24 * 60 * 60;\n\nasync function encode({\n  token = {},\n  maxAge = DEFAULT_MAX_AGE,\n  secret,\n  signingKey,\n  signingOptions = {\n    expiresIn: `${maxAge}s`\n  },\n  encryptionKey,\n  encryptionOptions = {\n    alg: \"dir\",\n    enc: DEFAULT_ENCRYPTION_ALGORITHM,\n    zip: \"DEF\"\n  },\n  encryption = DEFAULT_ENCRYPTION_ENABLED\n} = {}) {\n  const _signingKey = signingKey ? _jose.default.JWK.asKey(JSON.parse(signingKey)) : getDerivedSigningKey(secret);\n\n  const signedToken = _jose.default.JWT.sign(token, _signingKey, signingOptions);\n\n  if (encryption) {\n    const _encryptionKey = encryptionKey ? _jose.default.JWK.asKey(JSON.parse(encryptionKey)) : getDerivedEncryptionKey(secret);\n\n    return _jose.default.JWE.encrypt(signedToken, _encryptionKey, encryptionOptions);\n  }\n\n  return signedToken;\n}\n\nasync function decode({\n  secret,\n  token,\n  maxAge = DEFAULT_MAX_AGE,\n  signingKey,\n  verificationKey = signingKey,\n  verificationOptions = {\n    maxTokenAge: `${maxAge}s`,\n    algorithms: [DEFAULT_SIGNATURE_ALGORITHM]\n  },\n  encryptionKey,\n  decryptionKey = encryptionKey,\n  decryptionOptions = {\n    algorithms: [DEFAULT_ENCRYPTION_ALGORITHM]\n  },\n  encryption = DEFAULT_ENCRYPTION_ENABLED\n} = {}) {\n  if (!token) return null;\n  let tokenToVerify = token;\n\n  if (encryption) {\n    const _encryptionKey = decryptionKey ? _jose.default.JWK.asKey(JSON.parse(decryptionKey)) : getDerivedEncryptionKey(secret);\n\n    const decryptedToken = _jose.default.JWE.decrypt(token, _encryptionKey, decryptionOptions);\n\n    tokenToVerify = decryptedToken.toString(\"utf8\");\n  }\n\n  const _signingKey = verificationKey ? _jose.default.JWK.asKey(JSON.parse(verificationKey)) : getDerivedSigningKey(secret);\n\n  return _jose.default.JWT.verify(tokenToVerify, _signingKey, verificationOptions);\n}\n\nasync function getToken(params) {\n  var _req$headers$authoriz;\n\n  const {\n    req,\n    secureCookie = !(!process.env.NEXTAUTH_URL || process.env.NEXTAUTH_URL.startsWith(\"http://\")),\n    cookieName = secureCookie ? \"__Secure-next-auth.session-token\" : \"next-auth.session-token\",\n    raw = false,\n    decode: _decode = decode\n  } = params;\n  if (!req) throw new Error(\"Must pass `req` to JWT getToken()\");\n  let token = req.cookies[cookieName];\n\n  if (!token && ((_req$headers$authoriz = req.headers.authorization) === null || _req$headers$authoriz === void 0 ? void 0 : _req$headers$authoriz.split(\" \")[0]) === \"Bearer\") {\n    const urlEncodedToken = req.headers.authorization.split(\" \")[1];\n    token = decodeURIComponent(urlEncodedToken);\n  }\n\n  if (raw) {\n    return token;\n  }\n\n  try {\n    return _decode({\n      token,\n      ...params\n    });\n  } catch (_unused) {\n    return null;\n  }\n}\n\nlet DERIVED_SIGNING_KEY_WARNING = false;\nlet DERIVED_ENCRYPTION_KEY_WARNING = false;\n\nfunction hkdf(secret, {\n  byteLength,\n  encryptionInfo,\n  digest = \"sha256\"\n}) {\n  if (_crypto.default.hkdfSync) {\n    return Buffer.from(_crypto.default.hkdfSync(digest, secret, Buffer.alloc(0), encryptionInfo, byteLength));\n  }\n\n  return require(\"futoin-hkdf\")(secret, byteLength, {\n    info: encryptionInfo,\n    hash: digest\n  });\n}\n\nfunction getDerivedSigningKey(secret) {\n  if (!DERIVED_SIGNING_KEY_WARNING) {\n    _logger.default.warn(\"JWT_AUTO_GENERATED_SIGNING_KEY\");\n\n    DERIVED_SIGNING_KEY_WARNING = true;\n  }\n\n  const buffer = hkdf(secret, {\n    byteLength: 64,\n    encryptionInfo: \"NextAuth.js Generated Signing Key\"\n  });\n\n  const key = _jose.default.JWK.asKey(buffer, {\n    alg: DEFAULT_SIGNATURE_ALGORITHM,\n    use: \"sig\",\n    kid: \"nextauth-auto-generated-signing-key\"\n  });\n\n  return key;\n}\n\nfunction getDerivedEncryptionKey(secret) {\n  if (!DERIVED_ENCRYPTION_KEY_WARNING) {\n    _logger.default.warn(\"JWT_AUTO_GENERATED_ENCRYPTION_KEY\");\n\n    DERIVED_ENCRYPTION_KEY_WARNING = true;\n  }\n\n  const buffer = hkdf(secret, {\n    byteLength: 32,\n    encryptionInfo: \"NextAuth.js Generated Encryption Key\"\n  });\n\n  const key = _jose.default.JWK.asKey(buffer, {\n    alg: DEFAULT_ENCRYPTION_ALGORITHM,\n    use: \"enc\",\n    kid: \"nextauth-auto-generated-encryption-key\"\n  });\n\n  return key;\n}\n\nvar _default = {\n  encode,\n  decode,\n  getToken\n};\nexports.default = _default;", "// Takes a client cookie string and finds the last _idx key/value\nmodule.exports = function getIdx (cookie = '') {\n  let cookies = cookie\n    .split(';')\n    .map(c => c.trim())\n    .filter(Boolean)\n  let session = cookies.reverse().find(c => c.startsWith('_idx='))\n  return session || ''\n}\n", "/*!\n * cookie\n * Copyright(c) 2012-2014 Roman Shtylman\n * Copyright(c) 2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module exports.\n * @public\n */\n\nexports.parse = parse;\nexports.serialize = serialize;\n\n/**\n * Module variables.\n * @private\n */\n\nvar decode = decodeURIComponent;\nvar encode = encodeURIComponent;\nvar pairSplitRegExp = /; */;\n\n/**\n * RegExp to match field-content in RFC 7230 sec 3.2\n *\n * field-content = field-vchar [ 1*( SP / HTAB ) field-vchar ]\n * field-vchar   = VCHAR / obs-text\n * obs-text      = %x80-FF\n */\n\nvar fieldContentRegExp = /^[\\u0009\\u0020-\\u007e\\u0080-\\u00ff]+$/;\n\n/**\n * Parse a cookie header.\n *\n * Parse the given cookie header string into an object\n * The object has the various cookies as keys(names) => values\n *\n * @param {string} str\n * @param {object} [options]\n * @return {object}\n * @public\n */\n\nfunction parse(str, options) {\n  if (typeof str !== 'string') {\n    throw new TypeError('argument str must be a string');\n  }\n\n  var obj = {}\n  var opt = options || {};\n  var pairs = str.split(pairSplitRegExp);\n  var dec = opt.decode || decode;\n\n  for (var i = 0; i < pairs.length; i++) {\n    var pair = pairs[i];\n    var eq_idx = pair.indexOf('=');\n\n    // skip things that don't look like key=value\n    if (eq_idx < 0) {\n      continue;\n    }\n\n    var key = pair.substr(0, eq_idx).trim()\n    var val = pair.substr(++eq_idx, pair.length).trim();\n\n    // quoted values\n    if ('\"' == val[0]) {\n      val = val.slice(1, -1);\n    }\n\n    // only assign once\n    if (undefined == obj[key]) {\n      obj[key] = tryDecode(val, dec);\n    }\n  }\n\n  return obj;\n}\n\n/**\n * Serialize data into a cookie header.\n *\n * Serialize the a name value pair into a cookie string suitable for\n * http headers. An optional options object specified cookie parameters.\n *\n * serialize('foo', 'bar', { httpOnly: true })\n *   => \"foo=bar; httpOnly\"\n *\n * @param {string} name\n * @param {string} val\n * @param {object} [options]\n * @return {string}\n * @public\n */\n\nfunction serialize(name, val, options) {\n  var opt = options || {};\n  var enc = opt.encode || encode;\n\n  if (typeof enc !== 'function') {\n    throw new TypeError('option encode is invalid');\n  }\n\n  if (!fieldContentRegExp.test(name)) {\n    throw new TypeError('argument name is invalid');\n  }\n\n  var value = enc(val);\n\n  if (value && !fieldContentRegExp.test(value)) {\n    throw new TypeError('argument val is invalid');\n  }\n\n  var str = name + '=' + value;\n\n  if (null != opt.maxAge) {\n    var maxAge = opt.maxAge - 0;\n\n    if (isNaN(maxAge) || !isFinite(maxAge)) {\n      throw new TypeError('option maxAge is invalid')\n    }\n\n    str += '; Max-Age=' + Math.floor(maxAge);\n  }\n\n  if (opt.domain) {\n    if (!fieldContentRegExp.test(opt.domain)) {\n      throw new TypeError('option domain is invalid');\n    }\n\n    str += '; Domain=' + opt.domain;\n  }\n\n  if (opt.path) {\n    if (!fieldContentRegExp.test(opt.path)) {\n      throw new TypeError('option path is invalid');\n    }\n\n    str += '; Path=' + opt.path;\n  }\n\n  if (opt.expires) {\n    if (typeof opt.expires.toUTCString !== 'function') {\n      throw new TypeError('option expires is invalid');\n    }\n\n    str += '; Expires=' + opt.expires.toUTCString();\n  }\n\n  if (opt.httpOnly) {\n    str += '; HttpOnly';\n  }\n\n  if (opt.secure) {\n    str += '; Secure';\n  }\n\n  if (opt.sameSite) {\n    var sameSite = typeof opt.sameSite === 'string'\n      ? opt.sameSite.toLowerCase() : opt.sameSite;\n\n    switch (sameSite) {\n      case true:\n        str += '; SameSite=Strict';\n        break;\n      case 'lax':\n        str += '; SameSite=Lax';\n        break;\n      case 'strict':\n        str += '; SameSite=Strict';\n        break;\n      case 'none':\n        str += '; SameSite=None';\n        break;\n      default:\n        throw new TypeError('option sameSite is invalid');\n    }\n  }\n\n  return str;\n}\n\n/**\n * Try decoding a string using a decoding function.\n *\n * @param {string} str\n * @param {function} decode\n * @private\n */\n\nfunction tryDecode(str, decode) {\n  try {\n    return decode(str);\n  } catch (e) {\n    return str;\n  }\n}\n", "const ERR_MSG = 'Could not extract parameters from DER signature';\r\n\r\nexports.derToConcat = (signature, size) => {\r\n  let offset = 0;\r\n  if (signature[offset++] !== 0x30) throw new Error(ERR_MSG);\r\n  let seqLength = signature[offset++];\r\n  if (seqLength === 0x81) seqLength = signature[offset++];\r\n  if (seqLength > signature.length - offset || signature[offset++] !== 0x02) {\r\n    throw new Error(ERR_MSG);\r\n  }\r\n  let rLength = signature[offset++];\r\n  if (rLength > signature.length - offset - 2 || rLength > size + 1) {\r\n    throw new Error(ERR_MSG);\r\n  }\r\n  let rOffset = offset;\r\n  offset += rLength;\r\n  if (signature[offset++] !== 0x02) throw new Error(ERR_MSG);\r\n  let sLength = signature[offset++];\r\n  if (sLength !== signature.length - offset || sLength > size + 1) {\r\n    throw new Error(ERR_MSG);\r\n  }\r\n  let sOffset = offset;\r\n  offset += sLength;\r\n  if (offset !== signature.length) throw new Error(ERR_MSG);\r\n  let rPadding = size - rLength;\r\n  let sPadding = size - sLength;\r\n  let dst = Buffer.allocUnsafe(rPadding + rLength + sPadding + sLength);\r\n  for (offset = 0; offset < rPadding; offset++) dst[offset] = 0;\r\n  let rPad = Math.max(-rPadding, 0);\r\n  signature.copy(dst, offset, rOffset + rPad, rOffset + rLength);\r\n  offset = size;\r\n  for (let o = offset; offset < o + sPadding; offset++) dst[offset] = 0;\r\n  let sPad = Math.max(-sPadding, 0);\r\n  signature.copy(dst, offset, sOffset + sPad, sOffset + sLength);\r\n  return dst;\r\n}\r\n\r\nexports.concatToDer = (signature, size) => {\r\n  let rPadding = countPadding(signature, 0, size);\r\n  let sPadding = countPadding(signature, size, signature.length);\r\n  let rLength = size - rPadding;\r\n  let sLength = size - sPadding;\r\n  let rsBytes = rLength + sLength + 4;\r\n  let shortLength = rsBytes < 0x80;\r\n  let dst = Buffer.allocUnsafe((shortLength ? 2 : 3) + rsBytes);\r\n  let offset = 0;\r\n  dst[offset++] = 0x30;\r\n  if (shortLength) {\r\n    dst[offset++] = rsBytes;\r\n  } else {\r\n    dst[offset++] = 0x81;\r\n    dst[offset++] = rsBytes & 0xFF;\r\n  }\r\n  dst[offset++] = 0x02;\r\n  dst[offset++] = rLength;\r\n  if (rPadding < 0) {\r\n    dst[offset++] = 0;\r\n    offset += signature.copy(dst, offset, 0, size);\r\n  } else {\r\n    offset += signature.copy(dst, offset, rPadding, size);\r\n  }\r\n  dst[offset++] = 0x02;\r\n  dst[offset++] = sLength;\r\n  if (sPadding < 0) {\r\n    dst[offset++] = 0;\r\n    signature.copy(dst, offset, size);\r\n  } else {\r\n    signature.copy(dst, offset, size + sPadding);\r\n  }\r\n  return dst;\r\n}\r\n\r\nfunction countPadding(buf, start, stop) {\r\n  let padding = 0;\r\n  while (start + padding < stop && buf[start + padding] === 0) padding++;\r\n  let needsSign = buf[start + padding] >= 0x80;\r\n  return needsSign ? --padding : padding;\r\n}\r\n", "exports.buf2b64url = (data) => {\n  return data.toString('base64')\n             .replace(/\\+/g, '-')\n             .replace(/\\//g, '_')\n             .replace(/=/g, '');\n}\n\nfunction responder(error, result, callback) {\n  if (callback) {\n    callback(error, result);\n  } else if (error) {\n    throw error;\n  } else {\n    return result;\n  }\n}\n\nexports.responder = responder;\n\nexports.payloadVerifications = (parsed, cb) => {\n  if (parsed.audList) {\n    if (parsed.payload.aud === undefined) {\n      parsed.error = { message: 'Missing aud claim in payload' };\n      return responder(null, parsed, cb);\n    } else if (!parsed.audList.includes(parsed.payload.aud)) {\n      parsed.error = { message: 'Mismatching aud claim in payload' };\n      return responder(null, parsed, cb);\n    }\n  }\n  if (parsed.issList) {\n    if (parsed.payload.iss === undefined) {\n      parsed.error = { message: 'Missing iss claim in payload' };\n      return responder(null, parsed, cb);\n    } else if (!parsed.issList.includes(parsed.payload.iss)) {\n      parsed.error = { message: 'Mismatching iss claim in payload' };\n      return responder(null, parsed, cb);\n    }\n  }\n  let iat = Number(parsed.payload.iat);\n  if (!iat) {\n    parsed.error = { message: 'Missing or invalid iat claim in payload' };\n    return responder(null, parsed, cb);\n  }\n  let expiration = Number(parsed.payload.exp);\n  if (parsed.lifetime) {\n    let iatExp = iat + parsed.lifetime;\n    if (!expiration || iatExp < expiration) expiration = iatExp;\n  }\n  if (expiration && Date.now() > expiration * 1000) {\n    parsed.expired = expiration;\n    return responder(null, parsed, cb);\n  }\n  parsed.valid = true;\n  return responder(null, parsed, cb);\n}\n", "const crypto = require('crypto');\r\nconst ecdsa = require('./ecdsa.js');\r\nconst { responder, buf2b64url, payloadVerifications } = require('./common.js');\r\n\r\nconst ALG_RE = /^(HS|RS|ES)(256|384|512)$/;\r\n\r\n// ===== JWS GENERATION =======================================================\r\n\r\nexports.generate = (alg, payload, ...rest) => {\r\n  // alg, payload, key[, cb] or alg, payload, keystore, kid[, cb]\r\n  let key;\r\n  let cb;\r\n  let header = { alg: alg };\r\n  if (rest[0].constructor !== Object) {\r\n    key = rest[0];\r\n    cb = typeof rest[1] === 'function' ? rest[1] : undefined;\r\n  } else {\r\n    header.kid = rest[1];\r\n    key = rest[0][rest[1]];\r\n    cb = typeof rest[2] === 'function' ? rest[2] : undefined;\r\n    if (!key) {\r\n      return responder(new TypeError('Invalid key identifier'), null, cb);\r\n    }\r\n  }\r\n  let match = typeof alg === 'string' ? alg.match(ALG_RE) : null;\r\n  if (!match) {\r\n    return responder(new TypeError('Unrecognized algorithm'), null, cb);\r\n  }\r\n  let generateJws;\r\n  if (match[1] === 'HS') {\r\n    generateJws = generateHsJws;\r\n  } else if (match[1] === 'RS') {\r\n    generateJws = generateRsJws;\r\n  } else {\r\n    generateJws = generateEsJws;\r\n  }\r\n  payload.iat = Math.floor(Date.now() / 1000);\r\n  let h = buf2b64url(Buffer.from(JSON.stringify(header)));\r\n  let p = buf2b64url(Buffer.from(JSON.stringify(payload)));\r\n  let token;\r\n  try {\r\n    token = generateJws(`${h}.${p}`, +match[2], key);\r\n  } catch (error) {\r\n    return responder(error, null, cb);\r\n  }\r\n  return responder(null, token, cb);\r\n}\n\n// ===== JWS VERIFICATION =====================================================\n\r\nexports.verify = (parsed, key, cb) => {\r\n  if (parsed.error) return responder(null, parsed, cb);\r\n  if (typeof parsed.header.alg !== 'string') {\r\n    parsed.error = { message: 'Missing or invalid alg claim in header' };\r\n    return responder(null, parsed, cb);\r\n  }\r\n  let match = parsed.header.alg.match(ALG_RE);\r\n  if (!match) {\r\n    parsed.error = { message: `Unrecognized algorithm ${parsed.header.alg}` };\r\n    return responder(null, parsed, cb);\r\n  }\r\n  if (parsed.algList && !parsed.algList.includes(parsed.header.alg)) {\r\n    parsed.error = { message: `Unwanted algorithm ${parsed.header.alg}` };\r\n    return responder(null, parsed, cb);\r\n  }\r\n  let protect = `${parsed.parts[0]}.${parsed.parts[1]}`;\r\n  let verifyJws;\r\n  if (match[1] === 'HS') {\r\n    verifyJws = verifyHsJws;\r\n  } else if (match[1] === 'RS') {\r\n    verifyJws = verifyRsJws;\r\n  } else {\r\n    verifyJws = verifyEsJws;\r\n  }\r\n  let integrity;\r\n  try {\r\n    integrity = verifyJws(protect, parsed.parts[2], +match[2], key);\r\n  } catch (error) {\r\n    parsed.error = { message: `Could not verify integrity. ${error.message}` };\r\n    return responder(null, parsed, cb);\r\n  }\r\n  if (!integrity) {\r\n    parsed.error = { message: 'Integrity check failed' };\r\n    return responder(null, parsed, cb);\r\n  }\r\n  return payloadVerifications(parsed, cb);\r\n}\r\n\r\n// ===== HS256, HS384, HS512 ==================================================\r\n\r\nfunction generateHsJws(protect, bits, key) {\r\n  if (typeof key === 'string') {\r\n    key = Buffer.from(key, 'base64');\r\n  } else if (!(key instanceof Buffer)) {\r\n    throw new TypeError('Key must be a buffer or a base64 string');\r\n  }\r\n  let bytes = bits >> 3;\r\n  if (key.length < bytes) {\r\n    throw new TypeError(`Key length must be at least ${bytes} bytes`);\r\n  }\r\n  let hmac = crypto.createHmac(`SHA${bits}`, key);\r\n  let mac = buf2b64url(hmac.update(protect).digest());\r\n  return `${protect}.${mac}`;\r\n}\r\n\r\nfunction verifyHsJws(protect, mac, bits, key) {\r\n  if (typeof key === 'string') {\r\n    key = Buffer.from(key, 'base64');\r\n  } else if (!(key instanceof Buffer)) {\r\n    throw new TypeError('Key must be a buffer or a base64 string');\r\n  }\r\n  let bytes = bits >> 3;\r\n  if (key.length < bytes) {\r\n    throw new TypeError(`Key length must be at least ${bytes} bytes`);\r\n  }\r\n  let hmac = crypto.createHmac(`SHA${bits}`, key);\r\n  hmac.update(protect);\r\n  return crypto.timingSafeEqual(hmac.digest(), Buffer.from(mac, 'base64'));\r\n}\r\n\r\n// ===== RS256, RS384, RS512 ==================================================\r\n\r\nfunction generateRsJws(protect, bits, key) {\r\n  if (key instanceof Buffer) {\r\n    key = key.toString();\r\n  } else if (typeof key !== 'string') {\r\n    throw new TypeError('Key must be a buffer or a UTF-8 string');\r\n  }\r\n  if (!key.includes('-----BEGIN') || !key.includes('KEY-----')) {\r\n    throw new TypeError('Key must be a PEM formatted RSA private key');\r\n  }\r\n  let signer = crypto.createSign(`SHA${bits}`);\r\n  let signature = buf2b64url(signer.update(protect).sign(key));\r\n  return `${protect}.${signature}`;\r\n}\r\n\r\nfunction verifyRsJws(protect, signature, bits, key) {\r\n  if (key instanceof Buffer) {\r\n    key = key.toString();\r\n  } else if (typeof key !== 'string') {\r\n    throw new TypeError('Key must be a buffer or a UTF-8 string');\r\n  }\r\n  if (!key.includes('-----BEGIN') ||\r\n      !(key.includes('KEY-----') || key.includes('CERTIFICATE-----'))) {\r\n    throw new TypeError('Key must be a PEM formatted RSA public key');\r\n  }\r\n  let verifier = crypto.createVerify(`SHA${bits}`);\r\n  verifier.update(protect);\r\n  return verifier.verify(key, signature, 'base64');\r\n}\r\n\r\n// ===== ES256, ES384, ES512 ==================================================\r\n\r\nfunction generateEsJws(protect, bits, key) {\r\n  if (key instanceof Buffer) {\r\n    key = key.toString();\r\n  } else if (typeof key !== 'string') {\r\n    throw new TypeError('Key must be a buffer or a UTF-8 string');\r\n  }\r\n  if (!key.includes('-----BEGIN') || !key.includes('KEY-----')) {\r\n    throw new TypeError('Key must be a PEM formatted EC private key');\r\n  }\r\n  let signer = crypto.createSign(`SHA${bits}`);\r\n  signer.update(protect);\r\n  let size = 32;\r\n  if (bits === 384) {\r\n    size = 48;\r\n  } else if (bits === 512) {\r\n    size = 66;\r\n  }\r\n  let signature = buf2b64url(ecdsa.derToConcat(signer.sign(key), size));\r\n  return `${protect}.${signature}`;\r\n}\r\n\r\nfunction verifyEsJws(protect, signature, bits, key) {\r\n  if (key instanceof Buffer) {\r\n    key = key.toString();\r\n  } else if (typeof key !== 'string') {\r\n    throw new TypeError('Key must be a buffer or a UTF-8 string');\r\n  }\r\n  if (!key.includes('-----BEGIN') ||\r\n      !(key.includes('KEY-----') || key.includes('CERTIFICATE-----'))) {\r\n    throw new TypeError('Key must be a PEM formatted EC public key');\r\n  }\r\n  signature = Buffer.from(signature, 'base64');\r\n  let size = 32;\r\n  if (bits === 384) {\r\n    size = 48;\r\n  } else if (bits === 512) {\r\n    size = 66;\r\n  }\r\n  if (signature.length !== size << 1) {\r\n    return false;\r\n  }\r\n  let verifier = crypto.createVerify(`SHA${bits}`);\r\n  verifier.update(protect);\r\n  return verifier.verify(key, ecdsa.concatToDer(signature, size));\r\n}\r\n", "const crypto = require('crypto');\r\nconst { responder, buf2b64url, payloadVerifications } = require('./common.js');\r\n\r\nconst ALG_RE = /^(PBES2-HS(256|384|512)\\053)?(RSA-OAEP|dir|A(128|192|256)KW)$/;\r\nconst ENC_RE = /^A(128|192|256)(GCM|CBC-HS(256|384|512))$/;\r\n\r\n// ===== JWE GENERATION =======================================================\r\n\r\nexports.generate = (alg, enc, payload, ...rest) => {\r\n  // alg, enc, payload, key[, cb] or alg, enc, payload, keystore, kid[, cb]\r\n  let key;\r\n  let cb;\r\n  let header = { alg: alg, enc: enc };\r\n  if (rest[0].constructor !== Object) {\r\n    key = rest[0];\r\n    cb = typeof rest[1] === 'function' ? rest[1] : undefined;\r\n  } else {\r\n    header.kid = rest[1];\r\n    key = rest[0][rest[1]];\r\n    cb = typeof rest[2] === 'function' ? rest[2] : undefined;\r\n    if (!key) {\r\n      return responder(new TypeError('Invalid key identifier'), null, cb);\r\n    }\r\n  }\r\n  let aMatch = typeof alg === 'string' ? alg.match(ALG_RE) : null;\r\n  if (!aMatch || (aMatch[2] && +aMatch[2] !== aMatch[4] * 2)) {\r\n    let error = new TypeError('Unrecognized key management algorithm');\r\n    return responder(error, null, cb);\r\n  }\r\n  let eMatch = typeof enc === 'string' ? enc.match(ENC_RE) : null;\r\n  if (!eMatch || (eMatch[3] && +eMatch[3] !== eMatch[1] * 2)) {\r\n    let error = new TypeError('Unrecognized content encryption algorithm');\r\n    return responder(error, null, cb);\r\n  }\r\n  let salt;\r\n  if (aMatch[2]) {\r\n    let p2s = crypto.randomBytes(16);\r\n    header.p2c = 1024;\r\n    header.p2s = buf2b64url(p2s);\r\n    salt = Buffer.concat([Buffer.from(alg), Buffer.from([0]), p2s]);\r\n    if (!cb) {\r\n      let bits = Number(aMatch[2]);\r\n      key = crypto.pbkdf2Sync(key, salt, header.p2c, bits >> 4, `sha${bits}`);\r\n    }\r\n  }\r\n  let aad = buf2b64url(Buffer.from(JSON.stringify(header)));\r\n  if (!aMatch[2] || !cb) {\r\n    return generateJwe(aMatch, eMatch, aad, payload, key, cb);\r\n  }\r\n  let bits = Number(aMatch[2]);\r\n  crypto.pbkdf2(key, salt, header.p2c, bits >> 4, `sha${bits}`, (err, key) => {\r\n    if (err) return cb(err);\r\n    generateJwe(aMatch, eMatch, aad, payload, key, cb);\r\n  });\r\n}\r\n\r\nfunction generateJwe(aMatch, eMatch, aad, payload, key, cb) {\r\n  let cekLen = eMatch[3] ? +eMatch[1] >> 2 : +eMatch[1] >> 3;\r\n  let contEncr = eMatch[3] ? contentEncryptCbc : contentEncryptGcm;\r\n  let cek;\r\n  let cekEnc;\r\n  if (aMatch[0] !== 'dir') {\r\n    cek = crypto.randomBytes(cekLen);\r\n    let keyEncr = aMatch[4] ? aesKeyWrap : rsaOaepEncrypt;\r\n    try {\r\n      cekEnc = keyEncr(cek, key, +aMatch[4]);\r\n    } catch (error) {\r\n      return responder(error, null, cb);\r\n    }\r\n  } else {\r\n    // Key must be directly used for content encryption\r\n    if (typeof key === 'string') {\r\n      key = Buffer.from(key, 'base64');\r\n    } else if (!(key instanceof Buffer)) {\r\n      let error = new TypeError('Key must be a buffer or a base64 string');\r\n      return responder(error, null, cb);\r\n    }\r\n    if (key.length < cekLen) {\r\n      let error = new TypeError(`Key must be at least ${cekLen} bytes`);\r\n      return responder(error, null, cb);\r\n    }\r\n    cek = key.slice(0, cekLen);\r\n    cekEnc = '';\r\n  }\r\n  payload.iat = Math.floor(Date.now() / 1000);\r\n  let token = contEncr(aad, cek, cekEnc, JSON.stringify(payload), +eMatch[1]);\r\n  return responder(null, token, cb);\r\n}\r\n\r\n// ===== JWE VERIFICATION =====================================================\r\n\r\nexports.verify = (parsed, key, cb) => {\r\n  if (parsed.error) return responder(null, parsed, cb);\r\n  if (typeof parsed.header.alg !== 'string') {\r\n    parsed.error = { message: 'Missing or invalid alg claim in header' };\r\n    return responder(null, parsed, cb);\r\n  }\r\n  if (typeof parsed.header.enc !== 'string') {\r\n    parsed.error = { message: 'Missing or invalid enc claim in header' };\r\n    return responder(null, parsed, cb);\r\n  }\r\n  let aMatch = parsed.header.alg.match(ALG_RE);\r\n  if (!aMatch || (aMatch[2] && +aMatch[2] !== aMatch[4] * 2)) {\r\n    parsed.error = {\r\n      message: `Unrecognized key management algorithm ${parsed.header.alg}`\r\n    };\r\n    return responder(null, parsed, cb);\r\n  }\r\n  if (parsed.algList && !parsed.algList.includes(parsed.header.alg)) {\r\n    parsed.error = {\r\n      message: `Unwanted key management algorithm ${parsed.header.alg}`\r\n    };\r\n    return responder(null, parsed, cb);\r\n  }\r\n  let eMatch = parsed.header.enc.match(ENC_RE);\r\n  if (!eMatch || (eMatch[3] && +eMatch[3] !== eMatch[1] * 2)) {\r\n    parsed.error = {\r\n      message: `Unrecognized content encryption algorithm ${parsed.header.enc}`\r\n    };\r\n    return responder(null, parsed, cb);\r\n  }\r\n  if (parsed.encList && !parsed.encList.includes(parsed.header.enc)) {\r\n    parsed.error = {\r\n      message: `Unwanted content encryption algorithm ${parsed.header.enc}`\r\n    };\r\n    return responder(null, parsed, cb);\r\n  }\r\n  let salt;\r\n  let iter;\r\n  if (aMatch[2]) {\r\n    iter = parsed.header.p2c;\r\n    if (!Number.isInteger(iter) || iter < 1 || iter > 16384) {\r\n      parsed.error = { message: 'Missing or invalid p2c claim in header' };\r\n      return responder(null, parsed, cb);\r\n    } else if (!cb && iter > 1024) {\r\n      parsed.error = { message: 'p2c value too large for synchronous mode' };\r\n      return responder(null, parsed, cb);\r\n    }\r\n    if (typeof parsed.header.p2s !== 'string') {\r\n      parsed.error = { message: 'Missing or invalid p2s claim in header' };\r\n      return responder(null, parsed, cb);\r\n    }\r\n    let p2s = Buffer.from(parsed.header.p2s, 'base64');\r\n    let alg = parsed.header.alg;\r\n    salt = Buffer.concat([Buffer.from(alg), Buffer.from([0]), p2s]);\r\n    if (!cb) {\r\n      let bits = Number(aMatch[2]);\r\n      key = crypto.pbkdf2Sync(key, salt, iter, bits >> 4, `sha${bits}`);\r\n    }\r\n  }\r\n  if (!aMatch[2] || !cb) {\r\n    return decryptJwe(parsed, aMatch, eMatch, key, cb);\r\n  }\r\n  let bits = Number(aMatch[2]);\r\n  crypto.pbkdf2(key, salt, iter, bits >> 4, `sha${bits}`, (error, key) => {\r\n    if (error) return cb(error);\r\n    decryptJwe(parsed, aMatch, eMatch, key, cb);\r\n  });\r\n}\r\n\r\nfunction decryptJwe(parsed, aMatch, eMatch, key, cb) {\r\n  let aad = Buffer.from(parsed.parts[0]);\r\n  let cekEnc = Buffer.from(parsed.parts[1], 'base64');\r\n  let iv = Buffer.from(parsed.parts[2], 'base64');\r\n  let content = Buffer.from(parsed.parts[3], 'base64');\r\n  let tag = Buffer.from(parsed.parts[4], 'base64');\r\n  let cekLen = eMatch[3] ? +eMatch[1] >> 2 : +eMatch[1] >> 3;\r\n  let contDecr = eMatch[3] ? contentDecryptCbc : contentDecryptGcm;\r\n  let cek;\r\n  if (aMatch[0] !== 'dir') {\r\n    let keyDecr = aMatch[4] ? aesKeyUnwrap : rsaOaepDecrypt;\r\n    try {\r\n      cek = keyDecr(cekEnc, key, +aMatch[4]);\r\n    } catch (error) {\r\n      parsed.error = { message: `Could not decrypt token. ${error.message}` };\r\n      return responder(null, parsed, cb);\r\n    }\r\n  } else {\r\n    // Key must be directly used for content decryption\r\n    if (typeof key === 'string') {\r\n      key = Buffer.from(key, 'base64');\r\n    } else if (!(key instanceof Buffer)) {\r\n      parsed.error = { message: 'Invalid key' };\r\n      return responder(null, parsed, cb);\r\n    }\r\n    if (key.length < cekLen) {\r\n      parsed.error = {\r\n        message: `Invalid key length. Must be at least ${cekLen} bytes`\r\n      };\r\n      return responder(null, parsed, cb);\r\n    }\r\n    cek = key.slice(0, cekLen);\r\n  }\r\n  let plain;\r\n  try {\r\n    plain = contDecr(content, aad, tag, cek, iv, +eMatch[1]);\r\n  } catch (error) {\r\n    parsed.error = { message: `Could not decrypt token. ${error.message}` };\r\n    return responder(null, parsed, cb);\r\n  }\r\n  try {\r\n    parsed.payload = JSON.parse(plain);\r\n  } catch (error) {\r\n    parsed.error = { message: `Non parsable payload. ${error.message}` };\r\n    return responder(null, parsed, cb);\r\n  }\r\n  return payloadVerifications(parsed, cb);\r\n}\r\n\r\n// ===== A128GCM, A192GCM, A256GCM ============================================\r\n\r\nfunction contentEncryptGcm(aad, cek, cekEnc, plain, bits) {\r\n  let iv = crypto.randomBytes(12);\r\n  let cipher = crypto.createCipheriv(`id-aes${bits}-GCM`, cek, iv);\r\n  cipher.setAutoPadding(false);\r\n  cipher.setAAD(Buffer.from(aad));\r\n  let enc = buf2b64url(Buffer.concat([cipher.update(plain), cipher.final()]));\r\n  let tag = buf2b64url(cipher.getAuthTag());\r\n  return `${aad}.${cekEnc}.${buf2b64url(iv)}.${enc}.${tag}`;\r\n}\r\n\r\nfunction contentDecryptGcm(content, aad, tag, cek, iv, bits) {\r\n  let decipher = crypto.createDecipheriv(`id-aes${bits}-GCM`, cek, iv);\r\n  decipher.setAutoPadding(false);\r\n  decipher.setAAD(aad);\r\n  decipher.setAuthTag(tag);\r\n  return Buffer.concat([decipher.update(content), decipher.final()]);\r\n}\r\n\r\n// ===== A128CBC-HS256, A192CBC-HS384, A256CBC-HS512 ==========================\r\n\r\nfunction contentEncryptCbc(aad, cek, cekEnc, plain, bits) {\r\n  let iv = crypto.randomBytes(16);\r\n  let bytes = bits >> 3;\r\n  let cipher = crypto.createCipheriv(`AES-${bits}-CBC`, cek.slice(bytes), iv);\r\n  let enc = Buffer.concat([cipher.update(plain), cipher.final()]);\r\n  let len = aad.length << 3;\r\n  let al = Buffer.from(`000000000000000${len.toString(16)}`.slice(-16), 'hex');\r\n  let hmac = crypto.createHmac(`SHA${bits << 1}`, cek.slice(0, bytes));\r\n  hmac.update(Buffer.from(aad)).update(iv).update(enc).update(al);\r\n  let tag = buf2b64url(hmac.digest().slice(0, bytes));\r\n  return `${aad}.${cekEnc}.${buf2b64url(iv)}.${buf2b64url(enc)}.${tag}`;\r\n}\r\n\r\nfunction contentDecryptCbc(content, aad, tag, cek, iv, bits) {\r\n  let bytes = bits >> 3;\r\n  let len = aad.length << 3;\r\n  let al = Buffer.from(`000000000000000${len.toString(16)}`.slice(-16), 'hex');\r\n  let hmac = crypto.createHmac(`SHA${bits << 1}`, cek.slice(0, bytes));\r\n  hmac.update(aad).update(iv).update(content).update(al);\r\n  if (!crypto.timingSafeEqual(hmac.digest().slice(0, bytes), tag)) {\r\n    throw new Error('Authentication of encrypted data failed');\r\n  }\r\n  let encKey = cek.slice(bytes);\r\n  let decipher = crypto.createDecipheriv(`AES-${bits}-CBC`, encKey, iv);\r\n  return Buffer.concat([decipher.update(content), decipher.final()]);\r\n}\r\n\r\n// ===== RSA-OAEP =============================================================\r\n\r\nfunction rsaOaepEncrypt(cek, key) {\r\n  if (key instanceof Buffer) {\r\n    key = key.toString();\r\n  } else if (typeof key !== 'string') {\r\n    throw new TypeError('Key must be a buffer or a string');\r\n  }\r\n  if (!key.includes('-----BEGIN') ||\r\n      !(key.includes('KEY-----') || key.includes('CERTIFICATE-----'))) {\r\n    throw new TypeError('Key must be a PEM formatted RSA public key');\r\n  }\r\n  let options = {key: key, padding: crypto.constants.RSA_PKCS1_OAEP_PADDING};\r\n  return buf2b64url(crypto.publicEncrypt(options, cek));\r\n}\r\n\r\nfunction rsaOaepDecrypt(cekEnc, key) {\r\n  if (key instanceof Buffer) {\r\n    key = key.toString();\r\n  }\r\n  if (typeof key !== 'string' ||\r\n      !key.includes('-----BEGIN') || !key.includes('KEY-----')) {\r\n    throw new TypeError('Key must be a PEM formatted RSA private key');\r\n  }\r\n  let options = {key: key, padding: crypto.constants.RSA_PKCS1_OAEP_PADDING};\r\n  return crypto.privateDecrypt(options, cekEnc);\r\n}\r\n\r\n// ===== A128KW, A192KW, A256KW ===============================================\r\n\r\nfunction aesKeyWrap(cek, key, bits) {\r\n  let bytes = bits >> 3;\r\n  if (typeof key === 'string') {\r\n    key = Buffer.from(key, 'base64');\r\n  } else if (!(key instanceof Buffer)) {\r\n    throw new TypeError('Key must be a buffer or a base64-encoded string');\r\n  }\r\n  if (key.length < bytes) {\r\n    throw new TypeError(`Key length must be at least ${bytes} bytes`);\r\n  }\r\n  key = key.slice(0, bytes);\r\n  let r = [];\r\n  for (let i = 0; i < cek.length; i += 8) {\r\n    r.push(cek.slice(i, i + 8));\r\n  }\r\n  let iv = Buffer.alloc(16);\r\n  let a = Buffer.from('A6A6A6A6A6A6A6A6', 'hex');\r\n  let count = 1;\r\n  for (let j = 0; j < 6; j++) {\r\n    for (let i = 0; i < r.length; i++) {\r\n      let cipher = crypto.createCipheriv(`AES${bits}`, key, iv);\r\n      let c = `000000000000000${count.toString(16)}`.slice(-16);\r\n      let b = cipher.update(Buffer.concat([a, r[i]]));\r\n      a = Buffer.from(c, 'hex');\r\n      for (let n = 0; n < 8; n++) {\r\n        a[n] ^= b[n];\r\n      }\r\n      r[i] = b.slice(8, 16);\r\n      count++;\r\n    }\r\n  }\r\n  return buf2b64url(Buffer.concat([a].concat(r)));\r\n}\r\n\r\nfunction aesKeyUnwrap(cekEnc, key, bits) {\r\n  let bytes = bits >> 3;\r\n  if (typeof key === 'string') {\r\n    key = Buffer.from(key, 'base64');\r\n  } else if (!(key instanceof Buffer)) {\r\n    throw new TypeError('Key must be a buffer or a base64 string');\r\n  }\r\n  if (key.length < bytes) {\r\n    throw new TypeError(`Key must be at least ${bytes} bytes`);\r\n  }\r\n  key = key.slice(0, bytes);\r\n  let a = cekEnc.slice(0, 8);\r\n  let r = [];\r\n  for (let i = 8; i < cekEnc.length; i += 8) {\r\n    r.push(cekEnc.slice(i, i + 8));\r\n  }\r\n  let z = Buffer.alloc(16);\r\n  let count = 6 * r.length;\r\n  for (let j = 5; j >= 0 ; j--) {\r\n    for (let i = r.length - 1; i >= 0; i--) {\r\n      let c = `000000000000000${count.toString(16)}`.slice(-16);\r\n      c = Buffer.from(c, 'hex');\r\n      for (let n = 0; n < 8; n++) {\r\n        a[n] ^= c[n];\r\n      }\r\n      let decipher = crypto.createDecipheriv(`AES${bits}`, key, z);\r\n      let b = decipher.update(Buffer.concat([a, r[i], z]));\r\n      a = b.slice(0, 8);\r\n      r[i] = b.slice(8, 16);\r\n      count--;\r\n    }\r\n  }\r\n  if (!a.equals(Buffer.from('A6A6A6A6A6A6A6A6', 'hex'))) {\r\n    throw new Error('Key unwrapping failed');\r\n  }\r\n  return Buffer.concat(r);\r\n}\r\n", "const jws = require('./lib/jws.js');\r\nconst jwe = require('./lib/jwe.js');\r\nconst { responder } = require('./lib/common.js');\r\n\r\n// ===== TOKEN GENERATION =====================================================\r\n\r\nexports.generate = (alg, ...rest) => {\r\n  // alg, payload, key[, cb] or alg, payload, keystore, kid[, cb]\r\n  if (rest[0].constructor === Object) return jws.generate(alg, ...rest);\r\n  // alg, enc, payload, key[, cb] or alg, enc, payload, keystore, kid[, cb]\r\n  if (rest[1].constructor === Object) return jwe.generate(alg, ...rest);\r\n  // There is no payload object where expected\r\n  let idx = rest.length - 1;\r\n  if (idx > 1 && idx < 5 && typeof rest[idx] === 'function') {\r\n    rest[idx](error);\r\n  } else {\r\n    throw error;\r\n  }\r\n}\r\n\r\n// ===== TOKEN PARSING ========================================================\r\n\r\nexports.parse = (token) => new ParsedToken(token);\r\n\r\nfunction ParsedToken(token) {\r\n  this.parts = typeof token === 'string' ? token.split('.') : [];\r\n  if (this.parts.length === 3) {\r\n    this.type = 'JWS';\r\n  } else if (this.parts.length === 5) {\r\n    this.type = 'JWE';\r\n  } else {\r\n    this.error = { message: 'Invalid token' };\r\n    return;\r\n  }\r\n  try {\r\n    this.header = JSON.parse(Buffer.from(this.parts[0], 'base64'));\r\n  } catch (error) {\r\n    this.error = { message: `Non parsable header. ${error.message}` };\r\n    return;\r\n  }\r\n  if (this.type === 'JWS') {\r\n    // Parsing exposes payload for JWS only; for JWE happens at verify\r\n    try {\r\n      this.payload = JSON.parse(Buffer.from(this.parts[1], 'base64'));\r\n    } catch (error) {\r\n      this.error = { message: `Non parsable payload. ${error.message}` };\r\n    }\r\n  }\r\n}\r\n\r\n// ===== POST-PARSING UTLITIES ================================================\r\n\r\nParsedToken.prototype.setAlgorithmList = function(algList, encList) {\r\n  // algList is ignored if not string or array of strings\r\n  if (typeof algList === 'string') {\r\n    this.algList = [algList];\r\n  } else if (Array.isArray(algList)) {\r\n    this.algList = algList;\r\n  }\r\n  // encList is ignored if not string or array of strings\r\n  if (typeof encList === 'string') {\r\n    this.encList = [encList];\r\n  } else if (Array.isArray(encList)) {\r\n    this.encList = encList;\r\n  }\r\n  return this;\r\n}\r\n\r\nParsedToken.prototype.setTokenLifetime = function(lifetime) {\r\n  // lifetime is ignored if not integer greater than 0\r\n  if (Number.isInteger(lifetime) && lifetime > 0) this.lifetime = lifetime;\r\n  return this;\r\n}\r\n\r\nParsedToken.prototype.setAudience = function(audList) {\r\n  // audList is ignored if not string or array of strings\r\n  if (typeof audList === 'string') {\r\n    this.audList = [audList];\r\n  } else if (Array.isArray(audList)) {\r\n    this.audList = audList;\r\n  }\r\n  return this;\r\n}\r\n\r\nParsedToken.prototype.setIssuer = function(issList) {\r\n  // issList is ignored if not string or array of strings\r\n  if (typeof issList === 'string') {\r\n    this.issList = [issList];\r\n  } else if (Array.isArray(issList)) {\r\n    this.issList = issList;\r\n  }\r\n  return this;\r\n}\r\n\r\n// ===== TOKEN VERIFICATION ===================================================\r\n\r\nParsedToken.prototype.verify = function(p0, cb) {\r\n  // key[, cb] or keystore[, cb]\r\n  cb = typeof cb === 'function' ? cb : undefined;\r\n  if (this.error) return responder(null, this, cb);\r\n  let key;\r\n  if (p0.constructor !== Object) {\r\n    key = p0;\r\n  } else if (this.header.kid === undefined) {\r\n    // Cannot extract key from keystore\r\n    this.error = { message: 'Missing kid claim in header' };\r\n    return responder(null, this, cb);\r\n  } else if (p0[this.header.kid] === undefined) {\r\n    // Key not found in keystore\r\n    this.error = { message: 'Key with id not found', kid: this.header.kid };\r\n    return responder(null, this, cb);\r\n  } else {\r\n    key = p0[this.header.kid];\r\n  }\r\n  let verify = this.type === 'JWS' ? jws.verify : jwe.verify;\r\n  return verify(this, key, cb);\r\n}\r\n", "let getIdx = require('./_get-idx')\nlet cookie = require('cookie')\nlet jwt = require('node-webtokens')\nlet alg = 'dir'\nlet enc = 'A128GCM'\n\n// 128bit key size\nlet fallback = Buffer.from('1234567890123456').toString('base64')\n\n// need to STRONGLY encourage setting ARC_APP_SECRET in the docs\nlet key = process.env.ARC_APP_SECRET || fallback\n\n// wrapper for jwe.create/jwe.parse\nlet jwe = {\n  create (payload) {\n    return jwt.generate(alg, enc, payload, key)\n  },\n  parse (token) {\n    const WEEK = 604800\n    return jwt.parse(token).setTokenLifetime(WEEK).verify(key)\n  }\n}\n\n/**\n * reads req cookie and returns token payload or an empty object\n */\nfunction read (req, callback) {\n  let promise\n  if (!callback) {\n    promise = new Promise(function argh (res, rej) {\n      callback = function errback (err, result) {\n        err ? rej(err) : res(result)\n      }\n    })\n  }\n  let rawCookie = req.headers && (req.headers.cookie || req.headers.Cookie)\n  // Lambda payload version 2 puts the cookies in an array on the request\n  if (!rawCookie && req.cookies) {\n    rawCookie = req.cookies.join(';')\n  }\n\n  let idx = getIdx(rawCookie)\n  let sesh = cookie.parse(idx)._idx\n  let token = jwe.parse(sesh)\n  callback(null, token.valid ? token.payload : {})\n  return promise\n}\n\n/**\n * creates a Set-Cookie header with token payload encrypted\n */\nfunction write (payload, callback) {\n  let promise\n  if (!callback) {\n    promise = new Promise(function ugh (res, rej) {\n      callback = function errback (err, result) {\n        err ? rej(err) : res(result)\n      }\n    })\n  }\n  let key = '_idx'\n  let val = jwe.create(payload)\n  let maxAge = process.env.SESSION_TTL || 7.884e+8\n  let sameSite = process.env.ARC_SESSION_SAME_SITE || 'lax'\n  let options = {\n    maxAge,\n    expires: new Date(Date.now() + maxAge * 1000),\n    secure: true,\n    httpOnly: true,\n    path: '/',\n    sameSite,\n  }\n  if (process.env.SESSION_DOMAIN) {\n    options.domain = process.env.SESSION_DOMAIN\n  }\n  if (process.env.NODE_ENV === 'testing') {\n    delete options.secure\n  }\n  callback(null, cookie.serialize(key, val, options))\n  return promise\n}\n\nmodule.exports = { read, write }\n", "/**\n * Module dependencies.\n */\n\nvar crypto = require('crypto');\n\n/**\n * Sign the given `val` with `secret`.\n *\n * @param {String} val\n * @param {String} secret\n * @return {String}\n * @api private\n */\n\nexports.sign = function(val, secret){\n  if ('string' != typeof val) throw new TypeError(\"Cookie value must be provided as a string.\");\n  if ('string' != typeof secret) throw new TypeError(\"Secret string must be provided.\");\n  return val + '.' + crypto\n    .createHmac('sha256', secret)\n    .update(val)\n    .digest('base64')\n    .replace(/\\=+$/, '');\n};\n\n/**\n * Unsign and decode the given `val` with `secret`,\n * returning `false` if the signature is invalid.\n *\n * @param {String} val\n * @param {String} secret\n * @return {String|Boolean}\n * @api private\n */\n\nexports.unsign = function(val, secret){\n  if ('string' != typeof val) throw new TypeError(\"Signed cookie string must be provided.\");\n  if ('string' != typeof secret) throw new TypeError(\"Secret string must be provided.\");\n  var str = val.slice(0, val.lastIndexOf('.'))\n    , mac = exports.sign(str, secret)\n    , macBuffer = Buffer.from(mac)\n    , valBuffer = Buffer.alloc(macBuffer.length);\n\n  valBuffer.write(val);\n  return crypto.timingSafeEqual(macBuffer, valBuffer) ? str : false;\n};\n", "let aws = require('aws-sdk')\nlet https = require('https')\n\n/**\n * Instantiates Dynamo service interfaces\n * - Internal APIs should use `db` + `doc` to instantiate DynamoDB interfaces\n * - Avoid using `direct.db` + `direct.doc`: as it's an issue vector for using Functions in certain test harnesses!\n */\nfunction getDynamo (type, callback) {\n  if (!type) throw ReferenceError('Must supply Dynamo service interface type')\n\n  let testing = process.env.NODE_ENV === 'testing'\n  let arcLocal = process.env.ARC_LOCAL\n  let port = process.env.ARC_TABLES_PORT || 5000\n  let local = {\n    endpoint: new aws.Endpoint(`http://localhost:${port}`),\n    region: process.env.AWS_REGION || 'us-west-2' // Do not assume region is set!\n  }\n  let DB = aws.DynamoDB\n  let Doc = aws.DynamoDB.DocumentClient\n  let dynamo // Assigned below\n\n  /**\n   * This module may be loaded by @arc/arc via repl\n   * - The `direct` interfaces will instantiate before NODE_ENV is set\n   * - Thus, unlike most other scenarios, don't assume the presence of NODE_ENV\n   * - Also: some test harnesses (ahem) will automatically populate NODE_ENV with their own values, unbidden\n   * - *Why this matters*: using https.Agent (and not http.Agent) will stall the Sandbox\n   */\n  if (!testing && !arcLocal) {\n    let agent = new https.Agent({\n      keepAlive: true,\n      maxSockets: 50, // Node can set to Infinity; AWS maxes at 50; check back on this every once in a while\n      rejectUnauthorized: true,\n    })\n    aws.config.update({\n      httpOptions: { agent }\n    })\n    // TODO? migrate to using `AWS_NODEJS_CONNECTION_REUSE_ENABLED`?\n  }\n\n  if (type === 'db') {\n    dynamo = testing\n      ? new DB(local)\n      : new DB\n  }\n\n  if (type === 'doc') {\n    dynamo = testing\n      ? new Doc(local)\n      : new Doc\n  }\n\n  if (type === 'session') {\n    // if SESSION_TABLE_NAME isn't defined we mock the client and just pass session thru\n    let passthru = !process.env.SESSION_TABLE_NAME\n    let mock = {\n      get (params, callback) {\n        callback()\n      },\n      put (params, callback) {\n        callback()\n      }\n    }\n    dynamo = testing\n      ? new Doc(local)\n      : (passthru ? mock : new Doc)\n  }\n\n  if (!callback) return dynamo\n  else callback(null, dynamo)\n}\n\nmodule.exports = {\n  db: getDynamo.bind({}, 'db'),\n  doc: getDynamo.bind({}, 'doc'),\n  session: getDynamo.bind({}, 'session'),\n  direct: {\n    db: getDynamo('db'),\n    doc: getDynamo('doc')\n  }\n}\n", "/*!\n * random-bytes\n * Copyright(c) 2016 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict'\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar crypto = require('crypto')\n\n/**\n * Module variables.\n * @private\n */\n\nvar generateAttempts = crypto.randomBytes === crypto.pseudoRandomBytes ? 1 : 3\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = randomBytes\nmodule.exports.sync = randomBytesSync\n\n/**\n * Generates strong pseudo-random bytes.\n *\n * @param {number} size\n * @param {function} [callback]\n * @return {Promise}\n * @public\n */\n\nfunction randomBytes(size, callback) {\n  // validate callback is a function, if provided\n  if (callback !== undefined && typeof callback !== 'function') {\n    throw new TypeError('argument callback must be a function')\n  }\n\n  // require the callback without promises\n  if (!callback && !global.Promise) {\n    throw new TypeError('argument callback is required')\n  }\n\n  if (callback) {\n    // classic callback style\n    return generateRandomBytes(size, generateAttempts, callback)\n  }\n\n  return new Promise(function executor(resolve, reject) {\n    generateRandomBytes(size, generateAttempts, function onRandomBytes(err, str) {\n      if (err) return reject(err)\n      resolve(str)\n    })\n  })\n}\n\n/**\n * Generates strong pseudo-random bytes sync.\n *\n * @param {number} size\n * @return {Buffer}\n * @public\n */\n\nfunction randomBytesSync(size) {\n  var err = null\n\n  for (var i = 0; i < generateAttempts; i++) {\n    try {\n      return crypto.randomBytes(size)\n    } catch (e) {\n      err = e\n    }\n  }\n\n  throw err\n}\n\n/**\n * Generates strong pseudo-random bytes.\n *\n * @param {number} size\n * @param {number} attempts\n * @param {function} callback\n * @private\n */\n\nfunction generateRandomBytes(size, attempts, callback) {\n  crypto.randomBytes(size, function onRandomBytes(err, buf) {\n    if (!err) return callback(null, buf)\n    if (!--attempts) return callback(err)\n    setTimeout(generateRandomBytes.bind(null, size, attempts, callback), 10)\n  })\n}\n", "/*!\n * uid-safe\n * Copyright(c) 2014 Jonathan Ong\n * Copyright(c) 2015-2017 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict'\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar randomBytes = require('random-bytes')\n\n/**\n * Module variables.\n * @private\n */\n\nvar EQUAL_END_REGEXP = /=+$/\nvar PLUS_GLOBAL_REGEXP = /\\+/g\nvar SLASH_GLOBAL_REGEXP = /\\//g\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = uid\nmodule.exports.sync = uidSync\n\n/**\n * Create a unique ID.\n *\n * @param {number} length\n * @param {function} [callback]\n * @return {Promise}\n * @public\n */\n\nfunction uid (length, callback) {\n  // validate callback is a function, if provided\n  if (callback !== undefined && typeof callback !== 'function') {\n    throw new TypeError('argument callback must be a function')\n  }\n\n  // require the callback without promises\n  if (!callback && !global.Promise) {\n    throw new TypeError('argument callback is required')\n  }\n\n  if (callback) {\n    // classic callback style\n    return generateUid(length, callback)\n  }\n\n  return new Promise(function executor (resolve, reject) {\n    generateUid(length, function onUid (err, str) {\n      if (err) return reject(err)\n      resolve(str)\n    })\n  })\n}\n\n/**\n * Create a unique ID sync.\n *\n * @param {number} length\n * @return {string}\n * @public\n */\n\nfunction uidSync (length) {\n  return toString(randomBytes.sync(length))\n}\n\n/**\n * Generate a unique ID string.\n *\n * @param {number} length\n * @param {function} callback\n * @private\n */\n\nfunction generateUid (length, callback) {\n  randomBytes(length, function (err, buf) {\n    if (err) return callback(err)\n    callback(null, toString(buf))\n  })\n}\n\n/**\n * Change a Buffer into a string.\n *\n * @param {Buffer} buf\n * @return {string}\n * @private\n */\n\nfunction toString (buf) {\n  return buf.toString('base64')\n    .replace(EQUAL_END_REGEXP, '')\n    .replace(PLUS_GLOBAL_REGEXP, '-')\n    .replace(SLASH_GLOBAL_REGEXP, '_')\n}\n", "// epoch + one week IN SECONDS\n// - Date.now() returns ms\n// - DynamoDB TTL is in seconds\nmodule.exports = function _weekFromNow () {\n  return (Date.now() / 1000) + 604800\n}\n", "\nvar assert = require('assert')\n\nvar base62 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'\nvar base36 = 'abcdefghijklmnopqrstuvwxyz0123456789'\nvar base10 = '0123456789'\n\nexports = module.exports = create(base62)\nexports.base62 = exports\nexports.base36 = create(base36)\nexports.base10 = create(base10)\n\nexports.create = create\n\nfunction create(chars) {\n  assert(typeof chars === 'string', 'the list of characters must be a string!')\n  var length = Buffer.byteLength(chars)\n  return function rndm(len) {\n    len = len || 10\n    assert(typeof len === 'number' && len >= 0, 'the length of the random string must be a number!')\n    var salt = ''\n    for (var i = 0; i < len; i++) salt += chars[Math.floor(length * Math.random())]\n    return salt\n  }\n}\n", "'use strict';\r\n\r\n// Implements Brad Hill's Double HMAC pattern from\r\n// https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2011/february/double-hmac-verification/.\r\n// The approach is similar to the node's native implementation of timing safe buffer comparison that will be available on v6+.\r\n// https://github.com/nodejs/node/issues/3043\r\n// https://github.com/nodejs/node/pull/3073\r\n\r\nvar crypto = require('crypto');\r\n\r\nfunction bufferEqual(a, b) {\r\n  if (a.length !== b.length) {\r\n    return false;\r\n  }\r\n  // `crypto.timingSafeEqual` was introduced in Node v6.6.0\r\n  // <https://github.com/jshttp/basic-auth/issues/39>\r\n  if (crypto.timingSafeEqual) {\r\n    return crypto.timingSafeEqual(a, b);\r\n  }\r\n  for (var i = 0; i < a.length; i++) {\r\n    if (a[i] !== b[i]) {\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction timeSafeCompare(a, b) {\r\n  var sa = String(a);\r\n  var sb = String(b);\r\n  var key = crypto.pseudoRandomBytes(32);\r\n  var ah = crypto.createHmac('sha256', key).update(sa).digest();\r\n  var bh = crypto.createHmac('sha256', key).update(sb).digest();\r\n\r\n  return bufferEqual(ah, bh) && a === b;\r\n}\r\n\r\nmodule.exports = timeSafeCompare;\r\n", "/*!\n * csrf\n * Copyright(c) 2014 Jonathan Ong\n * Copyright(c) 2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict'\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar rndm = require('rndm')\nvar uid = require('uid-safe')\nvar compare = require('tsscmp')\nvar crypto = require('crypto')\n\n/**\n * Module variables.\n * @private\n */\n\nvar EQUAL_GLOBAL_REGEXP = /=/g\nvar PLUS_GLOBAL_REGEXP = /\\+/g\nvar SLASH_GLOBAL_REGEXP = /\\//g\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = Tokens\n\n/**\n * Token generation/verification class.\n *\n * @param {object} [options]\n * @param {number} [options.saltLength=8] The string length of the salt\n * @param {number} [options.secretLength=18] The byte length of the secret key\n * @public\n */\n\nfunction Tokens (options) {\n  if (!(this instanceof Tokens)) {\n    return new Tokens(options)\n  }\n\n  var opts = options || {}\n\n  var saltLength = opts.saltLength !== undefined\n    ? opts.saltLength\n    : 8\n\n  if (typeof saltLength !== 'number' || !isFinite(saltLength) || saltLength < 1) {\n    throw new TypeError('option saltLength must be finite number > 1')\n  }\n\n  var secretLength = opts.secretLength !== undefined\n    ? opts.secretLength\n    : 18\n\n  if (typeof secretLength !== 'number' || !isFinite(secretLength) || secretLength < 1) {\n    throw new TypeError('option secretLength must be finite number > 1')\n  }\n\n  this.saltLength = saltLength\n  this.secretLength = secretLength\n}\n\n/**\n * Create a new CSRF token.\n *\n * @param {string} secret The secret for the token.\n * @public\n */\n\nTokens.prototype.create = function create (secret) {\n  if (!secret || typeof secret !== 'string') {\n    throw new TypeError('argument secret is required')\n  }\n\n  return this._tokenize(secret, rndm(this.saltLength))\n}\n\n/**\n * Create a new secret key.\n *\n * @param {function} [callback]\n * @public\n */\n\nTokens.prototype.secret = function secret (callback) {\n  return uid(this.secretLength, callback)\n}\n\n/**\n * Create a new secret key synchronously.\n * @public\n */\n\nTokens.prototype.secretSync = function secretSync () {\n  return uid.sync(this.secretLength)\n}\n\n/**\n * Tokenize a secret and salt.\n * @private\n */\n\nTokens.prototype._tokenize = function tokenize (secret, salt) {\n  return salt + '-' + hash(salt + '-' + secret)\n}\n\n/**\n * Verify if a given token is valid for a given secret.\n *\n * @param {string} secret\n * @param {string} token\n * @public\n */\n\nTokens.prototype.verify = function verify (secret, token) {\n  if (!secret || typeof secret !== 'string') {\n    return false\n  }\n\n  if (!token || typeof token !== 'string') {\n    return false\n  }\n\n  var index = token.indexOf('-')\n\n  if (index === -1) {\n    return false\n  }\n\n  var salt = token.substr(0, index)\n  var expected = this._tokenize(secret, salt)\n\n  return compare(token, expected)\n}\n\n/**\n * Hash a string with SHA1, returning url-safe base64\n * @param {string} str\n * @private\n */\n\nfunction hash (str) {\n  return crypto\n    .createHash('sha1')\n    .update(str, 'ascii')\n    .digest('base64')\n    .replace(PLUS_GLOBAL_REGEXP, '-')\n    .replace(SLASH_GLOBAL_REGEXP, '_')\n    .replace(EQUAL_GLOBAL_REGEXP, '')\n}\n", "/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */\nlet promise\n\nmodule.exports = typeof queueMicrotask === 'function'\n  ? queueMicrotask.bind(typeof window !== 'undefined' ? window : global)\n  // reuse resolved promise, and allocate it lazily\n  : cb => (promise || (promise = Promise.resolve()))\n    .then(cb)\n    .catch(err => setTimeout(() => { throw err }, 0))\n", "/*! run-parallel. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */\nmodule.exports = runParallel\n\nconst queueMicrotask = require('queue-microtask')\n\nfunction runParallel (tasks, cb) {\n  let results, pending, keys\n  let isSync = true\n\n  if (Array.isArray(tasks)) {\n    results = []\n    pending = tasks.length\n  } else {\n    keys = Object.keys(tasks)\n    results = {}\n    pending = keys.length\n  }\n\n  function done (err) {\n    function end () {\n      if (cb) cb(err, results)\n      cb = null\n    }\n    if (isSync) queueMicrotask(end)\n    else end()\n  }\n\n  function each (i, err, result) {\n    results[i] = result\n    if (--pending === 0 || err) {\n      done(err)\n    }\n  }\n\n  if (!pending) {\n    // empty\n    done(null)\n  } else if (keys) {\n    // object\n    keys.forEach(function (key) {\n      tasks[key](function (err, result) { each(key, err, result) })\n    })\n  } else {\n    // array\n    tasks.forEach(function (task, i) {\n      task(function (err, result) { each(i, err, result) })\n    })\n  }\n\n  isSync = false\n}\n", "let uid = require('uid-safe')\nlet week = require('./_week-from-now')\nlet dynamo = require('../../../../tables/dynamo').session\nlet crsf = require('csrf')\nlet parallel = require('run-parallel')\n\nmodule.exports = function _create (name, payload, callback) {\n  parallel([\n    function _key (callback) {\n      uid(18, function _uid (err, val) {\n        if (err) callback(err)\n        else callback(null, { _idx: val })\n      })\n    },\n    function _secret (callback) {\n      (new crsf).secret(function _uid (err, val) {\n        if (err) callback(err)\n        else callback(null, { _secret: val })\n      })\n    }\n  ],\n  function _put (err, results) {\n    if (err) throw err\n    results.push({ _ttl: week() })\n    let keys = results.reduce((a, b) => Object.assign(a, b))\n    let session = Object.assign(payload, keys)\n    dynamo(function _gotDB (err, db) {\n      if (err) callback(err)\n      else {\n        db.put({\n          TableName: name,\n          Item: session\n        },\n        function _create (err) {\n          if (err) callback(err)\n          else callback(null, session)\n        })\n      }\n    })\n  })\n}\n", "let dynamo = require('../../../../tables/dynamo').session\nlet create = require('./create')\n\nmodule.exports = function _find (name, _idx, callback) {\n  dynamo(function _gotDB (err, db) {\n    if (err) callback(err)\n    else {\n      db.get({\n        TableName: name,\n        ConsistentRead: true,\n        Key: { _idx }\n      },\n      function _get (err, data) {\n        if (err) callback(err)\n        else {\n          let result = typeof data === 'undefined' ? false : data.Item\n          if (result && result._secret) {\n            callback(null, result)\n          }\n          else {\n            create(name, {}, callback)\n          }\n        }\n      })\n    }\n  })\n}\n", "let dynamo = require('../../../../tables/dynamo').session\nlet week = require('./_week-from-now')\n\nmodule.exports = function _update (name, payload, callback) {\n  let _ttl = week()\n  let session = Object.assign(payload, { _ttl })\n  dynamo(function _gotDB (err, db) {\n    if (err) callback(err)\n    else {\n      db.put({\n        TableName: name,\n        Item: session\n      },\n      function _create (err) {\n        if (err) callback(err)\n        else callback(null, session)\n      })\n    }\n  })\n}\n", "let cookie = require('cookie')\nlet getIdx = require('../_get-idx')\nlet { unsign, sign } = require('cookie-signature')\n\nlet find = require('./find')\nlet create = require('./create')\nlet update = require('./update')\n\nmodule.exports = { read, write }\n\n/**\n * reads request for session cookie and looks it up in dynamo\n */\nfunction read (request, callback) {\n\n  // be async/await friendly\n  let promise\n  if (!callback) {\n    promise = new Promise(function (res, rej) {\n      callback = function (err, result) {\n        err ? rej(err) : res(result)\n      }\n    })\n  }\n\n  // read dynamo session table\n  let name = process.env.SESSION_TABLE_NAME || tableLogicalId('arc-sessions')\n  let secret = process.env.ARC_APP_SECRET || process.env.ARC_APP_NAME || 'fallback'\n  // TODO: uppercase 'Cookie' is not the header name on AWS Lambda; it's\n  // lowercase 'cookie' on lambda...\n  let rawCookie = request.headers && (request.headers.Cookie || request.headers.cookie)\n  // Lambda payload version 2 puts the cookies in an array on the request\n  if (!rawCookie && request.cookies) {\n    rawCookie = request.cookies.join(';')\n  }\n\n  let idx = getIdx(rawCookie)\n  let sesh = cookie.parse(idx)._idx\n  let valid = unsign(sesh || '', secret)\n\n  // find or create a new session\n  let exec = sesh && valid ? find.bind({}, name) : create.bind({}, name)\n  let params = sesh && valid ? valid : {}\n\n  exec(params, callback)\n  return promise\n}\n\n/**\n * expect params to be\n * - _idx\n * - _secret\n */\nfunction write (params, callback) {\n  // be async/await friendly\n  let promise\n  if (!callback) {\n    promise = new Promise(function (res, rej) {\n      callback = function (err, result) {\n        err ? rej(err) : res(result)\n      }\n    })\n  }\n\n  // read dynamo session table\n  let name = process.env.SESSION_TABLE_NAME || tableLogicalId('arc-sessions')\n  let secret = process.env.ARC_APP_SECRET || process.env.ARC_APP_NAME || 'fallback'\n\n  update(name, params, function _update (err) {\n    if (err) {\n      callback(err)\n    }\n    else {\n      let maxAge = process.env.SESSION_TTL || 7.884e+8\n      let options = {\n        maxAge,\n        expires: new Date(Date.now() + maxAge * 1000),\n        secure: true,\n        httpOnly: true,\n        path: '/',\n        sameSite: 'lax',\n      }\n      if (process.env.SESSION_DOMAIN) {\n        options.domain = process.env.SESSION_DOMAIN\n      }\n      if (process.env.NODE_ENV === 'testing')\n        delete options.secure\n      let result = cookie.serialize('_idx', sign(params._idx, secret), options)\n      callback(null, result)\n    }\n  })\n\n  return promise\n}\n\nfunction tableLogicalId (name) {\n  let env = process.env.NODE_ENV === 'production' ? 'production' : 'staging'\n  return `${process.env.ARC_APP_NAME}-${env}-${name}`\n}\n", "let jwe = require('./providers/jwe')\nlet ddb = require('./providers/ddb')\n\nmodule.exports = function read (request, callback) {\n\n  if (process.env.SESSION_TABLE_NAME === 'jwe')\n    return jwe.read(request, callback)\n\n  return ddb.read(request, callback)\n}\n", "let jwe = require('./providers/jwe')\nlet ddb = require('./providers/ddb')\n\nmodule.exports = function write (params, callback) {\n\n  if (process.env.SESSION_TABLE_NAME === 'jwe')\n    return jwe.write(params, callback)\n\n  return ddb.write(params, callback)\n}\n", "let qs = require('querystring')\n\n/**\n * Arc 6 bodies are always base64 encoded strings with req.isBase64Encoded = true (or null, which we interpolate into `{}`)\n * <Arc 6 bodies are always objects\n */\nmodule.exports = function parseBody (req) {\n  let ctype = req.headers['Content-Type'] || req.headers['content-type']\n  let passthru = !req.body || !req.headers || !ctype || !Object.getOwnPropertyNames(req.body).length\n  if (passthru) {\n    return req.body\n  }\n  else {\n    // Paranoid deep copy\n    let request = JSON.parse(JSON.stringify(req))\n    let headers = request.headers\n    let contentType = type => headers && headers['Content-Type'] && headers['Content-Type'].includes(type) || headers && headers['content-type'] && headers['content-type'].includes(type)\n\n    let isString = typeof request.body === 'string'\n    let isBase64 = request.isBase64Encoded\n    let isParsing = isString && isBase64\n    let isJSON = (contentType('application/json') || contentType('application/vnd.api+json')) && isString\n    let isFormURLEncoded = contentType('application/x-www-form-urlencoded') && isParsing\n    let isMultiPartFormData = contentType('multipart/form-data') && isParsing\n    let isOctetStream = contentType('application/octet-stream') && isParsing\n\n    if (isJSON) {\n      try {\n        let data = isBase64\n          // Base64 + JSON-encoded payloads (>Arc 6 REST)\n          ? Buffer.from(request.body, 'base64').toString()\n          // Raw JSON (HTTP API + Lambda v2.0 payload)\n          : request.body\n        request.body = JSON.parse(data) || {}\n      }\n      catch (e) {\n        throw Error('Invalid request body encoding or invalid JSON')\n      }\n    }\n\n    if (isFormURLEncoded) {\n      let data = new Buffer.from(request.body, 'base64').toString()\n      request.body = qs.parse(data)\n    }\n\n    if (isMultiPartFormData || isOctetStream) {\n      request.body = request.body.base64\n        ? request.body\n        : { base64: request.body }\n    }\n\n    return request.body\n  }\n}\n", "module.exports = function interpolateParams (req) {\n  // Handle HTTP API v2.0 payload scenarios, which omit params instead of passing them as null\n  if (req.version && req.version === '2.0') {\n    let { requestContext: context } = req\n    if (context && context.http && context.http.method) {\n      req.httpMethod = context.http.method\n    }\n    let unUndefined = [ 'body', 'pathParameters', 'queryStringParameters' ]\n    unUndefined.forEach(i => {\n      if (req[i] === undefined) req[i] = {}\n    })\n    // Expect 'GET /foo' or '$default'\n    req.resource = req.routeKey.split(' ')[1] || req.routeKey\n    // Backfill `req.path`\n    req.path = req.rawPath\n  }\n\n  // Un-null APIG-proxy-Lambda params in 6+\n  let unNulled = [ 'body', 'pathParameters', 'queryStringParameters', 'multiValueQueryStringParameters' ]\n  unNulled.forEach(i => {\n    if (req[i] === null) req[i] = {}\n  })\n\n  // Backfill params generated by <6 VTL\n  if (!req.method) req.method = req.httpMethod\n  if (!req.params) req.params = req.pathParameters\n  if (!req.query)  req.query  = req.queryStringParameters\n\n  // Legacy path parameter interpolation; 6+ REST gets this for free in `req.path`\n  let params = /\\{\\w+\\}/g\n  if (params.test(req.path)) {\n    let matches = req.path.match(params)\n    let vars = matches.map(a => a.replace(/\\{|\\}/g, ''))\n    let idx = 0\n    matches.forEach(m => {\n      req.path = req.path.replace(m, req.params[vars[idx]])\n      idx += 1\n    })\n  }\n  return req\n}\n", "/**\n * HTTP error response generator and template\n */\nmodule.exports = {\n  httpError,\n  proxyConfig: proxyConfig()\n}\n\nfunction proxyConfig () {\n  let title = 'Index not found'\n  let message = `No static asset bucket or <code>get /</code> function found in your project. Possible solutions:<br?\n<ul>\n  <li>Add <code>@static</code> to your project manifest</li>\n  <li>Add <code>get /</code> to the <code>@http</code> pragma of your project manifest</li>\n  <li>Manually specify an S3 bucket (containing an <code>index.html</code> file) with the <code>ARC_STATIC_BUCKET</code> env var</li>\n  <li>If using <code>arc.http.proxy</code>, pass in a valid config object</li>\n</ul>\n<a href=\"https://arc.codes/primitives/static\" target=\"_blank\">Learn more</a>`\n  return httpError({ title, message })\n}\n\nfunction httpError ({ statusCode = 502, title = 'Unknown error', message = '' }) {\n  title = title === 'Error'\n    ? `${statusCode} error`\n    : `${statusCode} error: ${title}`\n  return {\n    statusCode,\n    headers: {\n      'Content-Type': 'text/html; charset=utf8;',\n      'Cache-Control': 'no-cache, no-store, must-revalidate, max-age=0, s-maxage=0'\n    },\n    body: `\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n  <title>${title}</title>\n  <style>\n    * {\n      margin: 0;\n      padding: 0;\n      box-sizing: border-box;\n    }\n    body {\n      font-family: -apple-system, BlinkMacSystemFont, sans-serif;\n    }\n    code {\n      font-size: 1.25rem;\n      color: #00c26e;\n    }\n    .max-width-320 {\n      max-width: 20rem;\n    }\n    .margin-left-8 {\n      margin-left: 0.5rem;\n    }\n    .margin-bottom-16 {\n      margin-bottom: 1rem;\n    }\n    .margin-bottom-8 {\n      margin-bottom: 0.5rem;\n    }\n    .padding-32 {\n      padding: 2rem;\n    }\n    .padding-top-16 {\n      padding-top: 1rem;\n    }\n    a, a:hover {\n      color: #333;\n    }\n    p, li {\n      padding-bottom: 0.5rem;\n    }\n  </style>\n</head>\n<body class=\"padding-32\">\n  <div>\n    <div class=\"margin-left-8\">\n      <div class=\"margin-bottom-16\">\n        <h1 class=\"margin-bottom-16\">\n          ${title}\n        </h1>\n        <p>\n          ${message}\n        </p>\n      </div>\n      <div class=\"padding-top-16\">\n        <p>\n          View Architect documentation at:\n        </p>\n        <a href=\"https://arc.codes\">https://arc.codes</a>\n      </div>\n    </div>\n  </div>\n</body>\n</html>\n`\n  }\n}\n", "/**\n * Common binary MIME types\n */\nmodule.exports = [\n  'application/octet-stream',\n  // Docs\n  'application/epub+zip',\n  'application/msword',\n  'application/pdf',\n  'application/rtf',\n  'application/vnd.amazon.ebook',\n  'application/vnd.ms-excel',\n  'application/vnd.ms-powerpoint',\n  'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n  'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n  // Fonts\n  'font/otf',\n  'font/woff',\n  'font/woff2',\n  // Images\n  'image/bmp',\n  'image/gif',\n  'image/jpeg',\n  'image/png',\n  'image/tiff',\n  'image/vnd.microsoft.icon',\n  'image/webp',\n  // Audio\n  'audio/3gpp',\n  'audio/aac',\n  'audio/basic',\n  'audio/mpeg',\n  'audio/ogg',\n  'audio/wavaudio/webm',\n  'audio/x-aiff',\n  'audio/x-midi',\n  'audio/x-wav',\n  // Video\n  'video/3gpp',\n  'video/mp2t',\n  'video/mpeg',\n  'video/ogg',\n  'video/quicktime',\n  'video/webm',\n  'video/x-msvideo',\n  // Archives\n  'application/java-archive',\n  'application/vnd.apple.installer+xml',\n  'application/x-7z-compressed',\n  'application/x-apple-diskimage',\n  'application/x-bzip',\n  'application/x-bzip2',\n  'application/x-gzip',\n  'application/x-java-archive',\n  'application/x-rar-compressed',\n  'application/x-tar',\n  'application/x-zip',\n  'application/zip'\n]\n", "let { httpError } = require('./errors')\nlet binaryTypes = require('./helpers/binary-types')\n\nmodule.exports = function responseFormatter (req, params) {\n  // Handle HTTP API v2.0 payload scenarios, which have some very strange edges\n  if (req.version && req.version === '2.0') {\n    // New school AWS\n    let knownParams = [ 'statusCode', 'body', 'headers', 'isBase64Encoded', 'cookies' ]\n    let hasKnownParams = p => knownParams.some(k => k === p)\n    // Old school Arc\n    let tidyParams = [ 'code', 'cookie', 'cors', 'location', 'session', 'status' ]\n    let hasTidyParams = p => tidyParams.some(k => k === p)\n    // Older school Arc\n    let staticallyBound = [ 'html', 'css', 'js', 'text', 'json', 'xml' ]\n    let isStaticallyBound = p => staticallyBound.some(k => k === p)\n\n    let is = t => typeof params === t\n    // Handle scenarios where we have a known parameter returned\n    if (is('object') &&\n        (params !== null) &&\n        !Array.isArray(params) &&\n        Object.keys.length === 1 &&\n        (Object.keys(params).some(hasKnownParams) ||\n         Object.keys(params).some(hasTidyParams) ||\n         Object.keys(params).some(isStaticallyBound))) {\n      params // noop\n    }\n    // Handle scenarios where arbitrary stuff is returned to be JSONified\n    else if (is('number') ||\n             (is('object') && params !== null) ||\n             (is('string') && params) ||\n             Array.isArray(params) ||\n             params instanceof Buffer) {\n      params = { body: JSON.stringify(params) }\n    }\n    // Not returning is actually valid now lolnothingmatters\n    else if (!params) params = {}\n  }\n\n  let isError = params instanceof Error // Doesn't really pertain to async\n  let buffer\n  let bodyIsBuffer = params.body && params.body instanceof Buffer\n  if (bodyIsBuffer) buffer = params.body // Back up buffer\n  if (!isError) params = JSON.parse(JSON.stringify(params)) // Deep copy to aid testing mutation\n  if (bodyIsBuffer) params.body = buffer // Restore non-JSON-encoded buffer\n\n  /**\n   * Response defaults\n   *   where possible, normalize headers to pascal-kebab case (lolsigh)\n   */\n  // Body\n  let body = params.body || ''\n\n  // Headers: Cache-Control\n  let cacheControl = params.cacheControl ||\n                     params.headers && params.headers['Cache-Control'] ||\n                     params.headers && params.headers['cache-control'] || ''\n  if (params.headers && params.headers['cache-control']) {\n    delete params.headers['cache-control'] // Clean up improper casing\n  }\n\n  // Headers: Content-Type\n  let type = params.type ||\n             params.headers && params.headers['Content-Type'] ||\n             params.headers && params.headers['content-type'] ||\n             'application/json; charset=utf8'\n  if (params.headers && params.headers['content-type']) {\n    delete params.headers['content-type'] // Clean up improper casing\n  }\n\n  // Cross-origin ritual sacrifice\n  let cors = params.cors\n\n  if (params.html) {\n    type = 'text/html; charset=utf8'\n    body = params.html\n  }\n  else if (params.css) {\n    type = 'text/css; charset=utf8'\n    body = params.css\n  }\n  else if (params.js) {\n    type = 'text/javascript; charset=utf8'\n    body = params.js\n  }\n  else if (params.text) {\n    type = 'text/plain; charset=utf8'\n    body = params.text\n  }\n  else if (params.json) {\n    type = 'application/json; charset=utf8'\n    body = JSON.stringify(params.json)\n  }\n  else if (params.xml) {\n    type = 'application/xml; charset=utf8'\n    body = params.xml\n  }\n\n  // Status\n  let providedStatus = params.status || params.code || params.statusCode\n  let statusCode = providedStatus || 200\n\n  let res = {\n    headers: Object.assign({}, { 'Content-Type': type }, params.headers || {}),\n    statusCode,\n    body\n  }\n\n  // REST API stuff\n  if (params.multiValueHeaders) {\n    res.multiValueHeaders = params.multiValueHeaders\n  }\n  // HTTP API stuff\n  if (params.cookies) {\n    res.cookies = params.cookies\n  }\n\n  // Error override\n  if (isError) {\n    let statusCode = providedStatus || 500\n    let title = params.name\n    let message = `\n      ${params.message}<br>\n      <pre>${params.stack}<pre>\n    `\n    res = httpError({ statusCode, title, message })\n  }\n\n  /**\n   * Only send res.type for non-proxy responses in Arc 5; attributes of each env:\n   * Arc 6:\n   * - ARC_CLOUDFORMATION\n   * - ARC_HTTP === 'aws_proxy'\n   * Arc 5:\n   * - !ARC_CLOUDFORMATION\n   * - !ARC_HTTP || ARC_HTTP === 'aws'\n   */\n  let notArcSix = !process.env.ARC_CLOUDFORMATION\n  let notArcProxy = !process.env.ARC_HTTP || process.env.ARC_HTTP === 'aws'\n  let isArcFive = notArcSix && notArcProxy\n  let notProxyReq = !req.resource || req.resource && req.resource !== '/{proxy+}'\n  if (isArcFive && notProxyReq) {\n    // This is a deprecated code path that may be removed when Arc 5 exits LTS status\n    // Fixes backwards compatibility: Arc vtl needs this param\n    res.type = type\n  }\n\n  // Set and/or update headers\n  let headers = res.headers\n  if (cacheControl) headers['Cache-Control'] = cacheControl\n  let antiCache = type.includes('text/html') ||\n                  type.includes('application/json') ||\n                  type.includes('application/vnd.api+json')\n  if (headers && !headers['Cache-Control'] && antiCache) {\n    headers['Cache-Control'] = 'no-cache, no-store, must-revalidate, max-age=0, s-maxage=0'\n  }\n  else if (headers && !headers['Cache-Control']) {\n    headers['Cache-Control'] = 'max-age=86400' // Default cache to one day unless otherwise specified\n  }\n  if (cors) headers['Access-Control-Allow-Origin'] = '*'\n  if (params.isBase64Encoded) res.isBase64Encoded = true\n  if (params.location) {\n    res.statusCode = providedStatus || 302\n    res.headers.Location = params.location\n  }\n\n  // Handle body encoding (if necessary)\n  let isBinary = binaryTypes.some(t => res.headers['Content-Type'].includes(t))\n  let bodyIsString = typeof res.body === 'string'\n  let b64enc = i => new Buffer.from(i).toString('base64')\n  // Encode (and flag) outbound buffers\n  if (bodyIsBuffer) {\n    res.body = b64enc(res.body)\n    res.isBase64Encoded = true\n  }\n  // Body is likely base64 & has binary MIME type, so flag it\n  if (bodyIsString && isBinary) res.isBase64Encoded = true\n\n  return res\n}\n", "let read = require('./session/read')\nlet write = require('./session/write')\nlet bodyParser = require('./helpers/body-parser')\nlet interpolate = require('./helpers/params')\nlet responseFormatter = require('./_res-fmt')\n\n/**\n * `arc.http` accepts one or more functions with an express-style sig\n */\nmodule.exports = function http (...fns) {\n\n  // Ensure we've been passed only functions\n  fns.forEach(f => {\n    if (typeof f != 'function')\n      throw TypeError(f + ' not a function')\n  })\n\n  // Return an AWS Lambda continuation passing function signature\n  return function lambda (request, context, callback) {\n\n    // Verify the request is configured by arc\n    if (!request.headers)\n      request.headers = {}\n\n    // Cache the functions\n    let cache = fns.slice()\n\n    // read the session\n    read(request, function _read (err, session) {\n      // Fail loudly if the session isn't set up correctly\n      if (err) throw err\n\n      // construct a response function\n      let req = interpolate(Object.assign({}, request, { session }))\n      req.body = bodyParser(req)\n      let res = response.bind({}, req, callback)\n\n      // loop thru middleware\n      ;(function iterator (fun) {\n        function fail () {throw Error('next() called from last function')}\n        let next = iterator.bind({}, cache.shift() || fail)\n        fun.call({}, req, res, next)\n      })(cache.shift())\n    })\n  }\n}\n\n/**\n * req is bound so we have a ref to req.session\n * callback is raw lambda callback\n */\nfunction response (req, callback, params) {\n  // Format the response\n  let res = responseFormatter(req, params)\n\n  // Legacy 'cookie' parameter, used after direct session writes\n  if (params && params.cookie) {\n    res.headers['Set-Cookie'] = params.cookie\n  }\n\n  // Save the passed session\n  if (params && params.session) {\n    // Tag the session data with _idx, secret, ttl, from req.session\n    let { _idx, _secret, _ttl } = req.session\n    let session = { _idx, _secret, _ttl, ...params.session }\n    write(session, function _write (err, cookie) {\n      if (err) callback(err)\n      else {\n        res.headers['Set-Cookie'] = cookie\n        callback(null, res)\n      }\n    })\n  }\n  else {\n    // Just pass it through\n    callback(null, res)\n  }\n}\n", "const { readFileSync, existsSync } = require('fs')\nconst { join } = require('path')\n\n/**\n * Architect static asset helper\n * - Returns the live asset path and filename\n *\n * In order to keep this method sync, it does not use reflection to get fingerprint status\n * - Not checking @static fingerprint true (which we used to read from the .arc file) is possibly dangerous, so ensure asset path is valid\n * - ? TODO: add fingerprint state to env vars in Arc 6 to restore config safety?\n * @param {string} path - the path to the asset (eg. /index.js)\n * @returns {string} path - the resolved asset path (eg. /_static/index-xxx.js)\n */\nmodule.exports = function _static (asset, options = {}) {\n  let key = asset[0] === '/' ? asset.substring(1) : asset\n  let isIndex = asset === '/'\n  let manifest = join(process.cwd(), 'node_modules', '@architect', 'shared', 'static.json')\n  let exists = existsSync(manifest)\n  let local = process.env.NODE_ENV === 'testing' || process.env.ARC_LOCAL\n  let stagePath = options.stagePath && !local ? '/' + process.env.NODE_ENV : ''\n  let path = `${stagePath}/_static`\n  if (!local && exists && !isIndex) {\n    let read = p => readFileSync(p).toString()\n    let pkg = JSON.parse(read(manifest))\n    let asset = pkg[key]\n    if (!asset)\n      throw ReferenceError(`Could not find asset in static.json (asset fingerprint manifest): ${key}`)\n    return `${path}/${asset}`\n  }\n  return `${path}/${isIndex ? '' : key}`\n}\n", "/**\n * no magic url helper\n *\n * given a path / returns\n *\n * - / if NODE_ENV === testing\n * - /staging if NODE_ENV === staging\n * - /production if NODE_ENV === production\n */\nmodule.exports = function url (url) {\n  let staging = process.env.NODE_ENV === 'staging'\n  let production = process.env.NODE_ENV === 'production'\n  if (!process.env.ARC_LOCAL && (staging || production))\n    return `/${process.env.NODE_ENV}${url}`\n  return url // fallthru for NODE_ENV=testing\n}\n", "let read = require('../session/read')\nlet write = require('../session/write')\nlet bodyParser = require('../helpers/body-parser')\nlet interpolate = require('../helpers/params')\nlet responseFormatter = require('../_res-fmt')\n\n/**\n * `arc.http.async` accepts one or more async functions\n *\n * Each function is a regular Arc 4+ async/await route function, that may return:\n * - A falsy value .......... move onto the next function\n * - A modified `request` ... move onto the next function, passing the mutated `request` on to any subsequent functions\n * - A `response` ........... end execution and respond to the client\n */\nmodule.exports = function httpAsync (...fns) {\n\n  // Ensure we've been passed only functions\n  fns.forEach(f => {\n    if (typeof f != 'function')\n      throw TypeError(f + ' not a function')\n  })\n\n  // Return an AWS Lambda async function signature\n  async function combined (request, context) {\n    let params\n    let first = true\n    for (let fn of fns) {\n      // Only parse the request obj of the first function\n      if (first) {\n        first = false\n        let session = await read(request)\n        let req = interpolate(Object.assign({}, request, { session }))\n        req.body = bodyParser(req)\n        request = req\n      }\n      // Run the function\n      let result = await fn(request, context)\n      let isRequest = result && result.httpMethod\n      if (isRequest) {\n        // Function returned a modified request, continuing...\n        request = result\n      }\n      else {\n        if (result) {\n          params = result\n          // Got a response, finishing...\n          break\n        }\n        // Did not get a result from, continuing...\n      }\n    }\n    let isHTTPv2 = request.version && request.version === '2.0'\n    // Finished combined function!\n    if (!params && !isHTTPv2) {\n      throw new Error(`Finished all functions without returning a response.`)\n    }\n    return response(request, params)\n  }\n  return combined\n}\n\nasync function response (req, params) {\n  // Format the response\n  let res = responseFormatter(req, params)\n\n  // Legacy 'cookie' parameter, used after direct session writes\n  if (params && params.cookie) {\n    res.headers['Set-Cookie'] = params.cookie\n  }\n\n  // Save the passed session\n  if (params && params.session) {\n    // Tag the session data with _idx, secret, ttl, from req.session\n    let { _idx, _secret, _ttl } = req.session\n    let session = { _idx, _secret, _ttl, ...params.session }\n    let cookie = await write(session)\n    res.headers['Set-Cookie'] = cookie\n  }\n  return res\n}\n", "/**\n *  @license\n *    Copyright 2018 Brigham Young University\n *\n *    Licensed under the Apache License, Version 2.0 (the \"License\");\n *    you may not use this file except in compliance with the License.\n *    You may obtain a copy of the License at\n *\n *        http://www.apache.org/licenses/LICENSE-2.0\n *\n *    Unless required by applicable law or agreed to in writing, software\n *    distributed under the License is distributed on an \"AS IS\" BASIS,\n *    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *    See the License for the specific language governing permissions and\n *    limitations under the License.\n **/\n'use strict';\n\n/**\n * Toggle the case of a string based on the number value passed in.\n * @param {string} string\n * @param {number} number\n * @param {object} [options={allowOverflow: true}]\n * @returns {string|boolean}\n */\nmodule.exports = binaryCase;\n\nfunction binaryCase(string, number, options) {\n    if (!options || typeof options !== 'object') options = {};\n    if (!options.hasOwnProperty('allowOverflow')) options.allowOverflow = true;\n\n    if (number > binaryCase.maxNumber(string) && !options.allowOverflow) return false;\n\n    return getBinaryCase(string, number);\n}\n\nbinaryCase.iterator = function(string, options) {\n    const max = binaryCase.maxNumber(string);\n\n    if (!options || typeof options !== 'object') options = {};\n    if (!options.hasOwnProperty('startIndex')) options.startIndex = 0;\n    if (typeof options.startIndex !== 'number' || !Number.isInteger(options.startIndex) || options.startIndex < 0) throw Error('Option startIndex must be a non-negative integer.');\n\n    let index = options.startIndex;\n    return {\n        next: function() {\n            return index > max\n                ? { done: true }\n                : { done: false, value: getBinaryCase(string, index++) };\n        }\n    };\n};\n\n/**\n * Get the maximum number that can be used before causing overflow.\n * @param {string} string\n * @returns {number}\n */\nbinaryCase.maxNumber = function(string) {\n    const pow = string.match(/[a-z]/ig).length;\n    return Math.pow(2, pow) - 1;\n};\n\n/**\n * Get an array of all possible variations.\n * @param {string} string\n * @returns {string[]}\n */\nbinaryCase.variations = function(string) {\n    const results = [];\n    const max = binaryCase.maxNumber(string);\n    for (let i = 0; i <= max; i++) {\n        results.push(binaryCase(string, i));\n    }\n    return results;\n};\n\n/**\n * A performance improved method for acquiring the binary case, provided by Blake Embrey with very minor modification by James Speirs.\n * @author Blake Embrey | https://github.com/blakeembrey\n * @author James Speirs | https://github.com/gi60s\n * @param {string} str\n * @param {number} val\n * @returns {string}\n */\nfunction getBinaryCase (str, val) {\n    let res = '';\n\n    for (let i = 0; i < str.length; i++) {\n        const code = str.charCodeAt(i);\n\n        if (code >= 65 && code <= 90) {\n            res += val & 1 ? String.fromCharCode(code + 32) : String.fromCharCode(code);\n            val >>>= 1;\n        } else if (code >= 97 && code <= 122) {\n            res += val & 1 ? String.fromCharCode(code - 32) : String.fromCharCode(code);\n            val >>>= 1;\n        } else {\n            res += String.fromCharCode(code);\n        }\n\n        if (val === 0) {\n            return res + str.substr(i + 1);\n        }\n    }\n\n    return res;\n}", "/*!\n * media-typer\n * Copyright(c) 2014 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n/**\n * RegExp to match *( \";\" parameter ) in RFC 2616 sec 3.7\n *\n * parameter     = token \"=\" ( token | quoted-string )\n * token         = 1*<any CHAR except CTLs or separators>\n * separators    = \"(\" | \")\" | \"<\" | \">\" | \"@\"\n *               | \",\" | \";\" | \":\" | \"\\\" | <\">\n *               | \"/\" | \"[\" | \"]\" | \"?\" | \"=\"\n *               | \"{\" | \"}\" | SP | HT\n * quoted-string = ( <\"> *(qdtext | quoted-pair ) <\"> )\n * qdtext        = <any TEXT except <\">>\n * quoted-pair   = \"\\\" CHAR\n * CHAR          = <any US-ASCII character (octets 0 - 127)>\n * TEXT          = <any OCTET except CTLs, but including LWS>\n * LWS           = [CRLF] 1*( SP | HT )\n * CRLF          = CR LF\n * CR            = <US-ASCII CR, carriage return (13)>\n * LF            = <US-ASCII LF, linefeed (10)>\n * SP            = <US-ASCII SP, space (32)>\n * SHT           = <US-ASCII HT, horizontal-tab (9)>\n * CTL           = <any US-ASCII control character (octets 0 - 31) and DEL (127)>\n * OCTET         = <any 8-bit sequence of data>\n */\nvar paramRegExp = /; *([!#$%&'\\*\\+\\-\\.0-9A-Z\\^_`a-z\\|~]+) *= *(\"(?:[ !\\u0023-\\u005b\\u005d-\\u007e\\u0080-\\u00ff]|\\\\[\\u0020-\\u007e])*\"|[!#$%&'\\*\\+\\-\\.0-9A-Z\\^_`a-z\\|~]+) */g;\nvar textRegExp = /^[\\u0020-\\u007e\\u0080-\\u00ff]+$/\nvar tokenRegExp = /^[!#$%&'\\*\\+\\-\\.0-9A-Z\\^_`a-z\\|~]+$/\n\n/**\n * RegExp to match quoted-pair in RFC 2616\n *\n * quoted-pair = \"\\\" CHAR\n * CHAR        = <any US-ASCII character (octets 0 - 127)>\n */\nvar qescRegExp = /\\\\([\\u0000-\\u007f])/g;\n\n/**\n * RegExp to match chars that must be quoted-pair in RFC 2616\n */\nvar quoteRegExp = /([\\\\\"])/g;\n\n/**\n * RegExp to match type in RFC 6838\n *\n * type-name = restricted-name\n * subtype-name = restricted-name\n * restricted-name = restricted-name-first *126restricted-name-chars\n * restricted-name-first  = ALPHA / DIGIT\n * restricted-name-chars  = ALPHA / DIGIT / \"!\" / \"#\" /\n *                          \"$\" / \"&\" / \"-\" / \"^\" / \"_\"\n * restricted-name-chars =/ \".\" ; Characters before first dot always\n *                              ; specify a facet name\n * restricted-name-chars =/ \"+\" ; Characters after last plus always\n *                              ; specify a structured syntax suffix\n * ALPHA =  %x41-5A / %x61-7A   ; A-Z / a-z\n * DIGIT =  %x30-39             ; 0-9\n */\nvar subtypeNameRegExp = /^[A-Za-z0-9][A-Za-z0-9!#$&^_.-]{0,126}$/\nvar typeNameRegExp = /^[A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126}$/\nvar typeRegExp = /^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/;\n\n/**\n * Module exports.\n */\n\nexports.format = format\nexports.parse = parse\n\n/**\n * Format object to media type.\n *\n * @param {object} obj\n * @return {string}\n * @api public\n */\n\nfunction format(obj) {\n  if (!obj || typeof obj !== 'object') {\n    throw new TypeError('argument obj is required')\n  }\n\n  var parameters = obj.parameters\n  var subtype = obj.subtype\n  var suffix = obj.suffix\n  var type = obj.type\n\n  if (!type || !typeNameRegExp.test(type)) {\n    throw new TypeError('invalid type')\n  }\n\n  if (!subtype || !subtypeNameRegExp.test(subtype)) {\n    throw new TypeError('invalid subtype')\n  }\n\n  // format as type/subtype\n  var string = type + '/' + subtype\n\n  // append +suffix\n  if (suffix) {\n    if (!typeNameRegExp.test(suffix)) {\n      throw new TypeError('invalid suffix')\n    }\n\n    string += '+' + suffix\n  }\n\n  // append parameters\n  if (parameters && typeof parameters === 'object') {\n    var param\n    var params = Object.keys(parameters).sort()\n\n    for (var i = 0; i < params.length; i++) {\n      param = params[i]\n\n      if (!tokenRegExp.test(param)) {\n        throw new TypeError('invalid parameter name')\n      }\n\n      string += '; ' + param + '=' + qstring(parameters[param])\n    }\n  }\n\n  return string\n}\n\n/**\n * Parse media type to object.\n *\n * @param {string|object} string\n * @return {Object}\n * @api public\n */\n\nfunction parse(string) {\n  if (!string) {\n    throw new TypeError('argument string is required')\n  }\n\n  // support req/res-like objects as argument\n  if (typeof string === 'object') {\n    string = getcontenttype(string)\n  }\n\n  if (typeof string !== 'string') {\n    throw new TypeError('argument string is required to be a string')\n  }\n\n  var index = string.indexOf(';')\n  var type = index !== -1\n    ? string.substr(0, index)\n    : string\n\n  var key\n  var match\n  var obj = splitType(type)\n  var params = {}\n  var value\n\n  paramRegExp.lastIndex = index\n\n  while (match = paramRegExp.exec(string)) {\n    if (match.index !== index) {\n      throw new TypeError('invalid parameter format')\n    }\n\n    index += match[0].length\n    key = match[1].toLowerCase()\n    value = match[2]\n\n    if (value[0] === '\"') {\n      // remove quotes and escapes\n      value = value\n        .substr(1, value.length - 2)\n        .replace(qescRegExp, '$1')\n    }\n\n    params[key] = value\n  }\n\n  if (index !== -1 && index !== string.length) {\n    throw new TypeError('invalid parameter format')\n  }\n\n  obj.parameters = params\n\n  return obj\n}\n\n/**\n * Get content-type from req/res objects.\n *\n * @param {object}\n * @return {Object}\n * @api private\n */\n\nfunction getcontenttype(obj) {\n  if (typeof obj.getHeader === 'function') {\n    // res-like\n    return obj.getHeader('content-type')\n  }\n\n  if (typeof obj.headers === 'object') {\n    // req-like\n    return obj.headers && obj.headers['content-type']\n  }\n}\n\n/**\n * Quote a string if necessary.\n *\n * @param {string} val\n * @return {string}\n * @api private\n */\n\nfunction qstring(val) {\n  var str = String(val)\n\n  // no need to quote tokens\n  if (tokenRegExp.test(str)) {\n    return str\n  }\n\n  if (str.length > 0 && !textRegExp.test(str)) {\n    throw new TypeError('invalid parameter value')\n  }\n\n  return '\"' + str.replace(quoteRegExp, '\\\\$1') + '\"'\n}\n\n/**\n * Simply \"type/subtype+siffx\" into parts.\n *\n * @param {string} string\n * @return {Object}\n * @api private\n */\n\nfunction splitType(string) {\n  var match = typeRegExp.exec(string.toLowerCase())\n\n  if (!match) {\n    throw new TypeError('invalid media type')\n  }\n\n  var type = match[1]\n  var subtype = match[2]\n  var suffix\n\n  // suffix after last +\n  var index = subtype.lastIndexOf('+')\n  if (index !== -1) {\n    suffix = subtype.substr(index + 1)\n    subtype = subtype.substr(0, index)\n  }\n\n  var obj = {\n    type: type,\n    subtype: subtype,\n    suffix: suffix\n  }\n\n  return obj\n}\n", "/*!\n * mime-db\n * Copyright(c) 2014 Jonathan Ong\n * MIT Licensed\n */\n\n/**\n * Module exports.\n */\n\nmodule.exports = require('./db.json')\n", "/*!\n * mime-types\n * Copyright(c) 2014 Jonathan Ong\n * Copyright(c) 2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict'\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar db = require('mime-db')\nvar extname = require('path').extname\n\n/**\n * Module variables.\n * @private\n */\n\nvar EXTRACT_TYPE_REGEXP = /^\\s*([^;\\s]*)(?:;|\\s|$)/\nvar TEXT_TYPE_REGEXP = /^text\\//i\n\n/**\n * Module exports.\n * @public\n */\n\nexports.charset = charset\nexports.charsets = { lookup: charset }\nexports.contentType = contentType\nexports.extension = extension\nexports.extensions = Object.create(null)\nexports.lookup = lookup\nexports.types = Object.create(null)\n\n// Populate the extensions/types maps\npopulateMaps(exports.extensions, exports.types)\n\n/**\n * Get the default charset for a MIME type.\n *\n * @param {string} type\n * @return {boolean|string}\n */\n\nfunction charset (type) {\n  if (!type || typeof type !== 'string') {\n    return false\n  }\n\n  // TODO: use media-typer\n  var match = EXTRACT_TYPE_REGEXP.exec(type)\n  var mime = match && db[match[1].toLowerCase()]\n\n  if (mime && mime.charset) {\n    return mime.charset\n  }\n\n  // default text/* to utf-8\n  if (match && TEXT_TYPE_REGEXP.test(match[1])) {\n    return 'UTF-8'\n  }\n\n  return false\n}\n\n/**\n * Create a full Content-Type header given a MIME type or extension.\n *\n * @param {string} str\n * @return {boolean|string}\n */\n\nfunction contentType (str) {\n  // TODO: should this even be in this module?\n  if (!str || typeof str !== 'string') {\n    return false\n  }\n\n  var mime = str.indexOf('/') === -1\n    ? exports.lookup(str)\n    : str\n\n  if (!mime) {\n    return false\n  }\n\n  // TODO: use content-type or other module\n  if (mime.indexOf('charset') === -1) {\n    var charset = exports.charset(mime)\n    if (charset) mime += '; charset=' + charset.toLowerCase()\n  }\n\n  return mime\n}\n\n/**\n * Get the default extension for a MIME type.\n *\n * @param {string} type\n * @return {boolean|string}\n */\n\nfunction extension (type) {\n  if (!type || typeof type !== 'string') {\n    return false\n  }\n\n  // TODO: use media-typer\n  var match = EXTRACT_TYPE_REGEXP.exec(type)\n\n  // get extensions\n  var exts = match && exports.extensions[match[1].toLowerCase()]\n\n  if (!exts || !exts.length) {\n    return false\n  }\n\n  return exts[0]\n}\n\n/**\n * Lookup the MIME type for a file path/extension.\n *\n * @param {string} path\n * @return {boolean|string}\n */\n\nfunction lookup (path) {\n  if (!path || typeof path !== 'string') {\n    return false\n  }\n\n  // get the extension (\"ext\" or \".ext\" or full path)\n  var extension = extname('x.' + path)\n    .toLowerCase()\n    .substr(1)\n\n  if (!extension) {\n    return false\n  }\n\n  return exports.types[extension] || false\n}\n\n/**\n * Populate the extensions and types maps.\n * @private\n */\n\nfunction populateMaps (extensions, types) {\n  // source preference (least -> most)\n  var preference = ['nginx', 'apache', undefined, 'iana']\n\n  Object.keys(db).forEach(function forEachMimeType (type) {\n    var mime = db[type]\n    var exts = mime.extensions\n\n    if (!exts || !exts.length) {\n      return\n    }\n\n    // mime -> extensions\n    extensions[type] = exts\n\n    // extension -> mime\n    for (var i = 0; i < exts.length; i++) {\n      var extension = exts[i]\n\n      if (types[extension]) {\n        var from = preference.indexOf(db[types[extension]].source)\n        var to = preference.indexOf(mime.source)\n\n        if (types[extension] !== 'application/octet-stream' &&\n          (from > to || (from === to && types[extension].substr(0, 12) === 'application/'))) {\n          // skip the remapping\n          continue\n        }\n      }\n\n      // set the extension -> mime\n      types[extension] = type\n    }\n  })\n}\n", "/*!\n * type-is\n * Copyright(c) 2014 Jonathan Ong\n * Copyright(c) 2014-2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict'\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar typer = require('media-typer')\nvar mime = require('mime-types')\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = typeofrequest\nmodule.exports.is = typeis\nmodule.exports.hasBody = hasbody\nmodule.exports.normalize = normalize\nmodule.exports.match = mimeMatch\n\n/**\n * Compare a `value` content-type with `types`.\n * Each `type` can be an extension like `html`,\n * a special shortcut like `multipart` or `urlencoded`,\n * or a mime type.\n *\n * If no types match, `false` is returned.\n * Otherwise, the first `type` that matches is returned.\n *\n * @param {String} value\n * @param {Array} types\n * @public\n */\n\nfunction typeis (value, types_) {\n  var i\n  var types = types_\n\n  // remove parameters and normalize\n  var val = tryNormalizeType(value)\n\n  // no type or invalid\n  if (!val) {\n    return false\n  }\n\n  // support flattened arguments\n  if (types && !Array.isArray(types)) {\n    types = new Array(arguments.length - 1)\n    for (i = 0; i < types.length; i++) {\n      types[i] = arguments[i + 1]\n    }\n  }\n\n  // no types, return the content type\n  if (!types || !types.length) {\n    return val\n  }\n\n  var type\n  for (i = 0; i < types.length; i++) {\n    if (mimeMatch(normalize(type = types[i]), val)) {\n      return type[0] === '+' || type.indexOf('*') !== -1\n        ? val\n        : type\n    }\n  }\n\n  // no matches\n  return false\n}\n\n/**\n * Check if a request has a request body.\n * A request with a body __must__ either have `transfer-encoding`\n * or `content-length` headers set.\n * http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.3\n *\n * @param {Object} request\n * @return {Boolean}\n * @public\n */\n\nfunction hasbody (req) {\n  return req.headers['transfer-encoding'] !== undefined ||\n    !isNaN(req.headers['content-length'])\n}\n\n/**\n * Check if the incoming request contains the \"Content-Type\"\n * header field, and it contains any of the give mime `type`s.\n * If there is no request body, `null` is returned.\n * If there is no content type, `false` is returned.\n * Otherwise, it returns the first `type` that matches.\n *\n * Examples:\n *\n *     // With Content-Type: text/html; charset=utf-8\n *     this.is('html'); // => 'html'\n *     this.is('text/html'); // => 'text/html'\n *     this.is('text/*', 'application/json'); // => 'text/html'\n *\n *     // When Content-Type is application/json\n *     this.is('json', 'urlencoded'); // => 'json'\n *     this.is('application/json'); // => 'application/json'\n *     this.is('html', 'application/*'); // => 'application/json'\n *\n *     this.is('html'); // => false\n *\n * @param {String|Array} types...\n * @return {String|false|null}\n * @public\n */\n\nfunction typeofrequest (req, types_) {\n  var types = types_\n\n  // no body\n  if (!hasbody(req)) {\n    return null\n  }\n\n  // support flattened arguments\n  if (arguments.length > 2) {\n    types = new Array(arguments.length - 1)\n    for (var i = 0; i < types.length; i++) {\n      types[i] = arguments[i + 1]\n    }\n  }\n\n  // request content type\n  var value = req.headers['content-type']\n\n  return typeis(value, types)\n}\n\n/**\n * Normalize a mime type.\n * If it's a shorthand, expand it to a valid mime type.\n *\n * In general, you probably want:\n *\n *   var type = is(req, ['urlencoded', 'json', 'multipart']);\n *\n * Then use the appropriate body parsers.\n * These three are the most common request body types\n * and are thus ensured to work.\n *\n * @param {String} type\n * @private\n */\n\nfunction normalize (type) {\n  if (typeof type !== 'string') {\n    // invalid type\n    return false\n  }\n\n  switch (type) {\n    case 'urlencoded':\n      return 'application/x-www-form-urlencoded'\n    case 'multipart':\n      return 'multipart/*'\n  }\n\n  if (type[0] === '+') {\n    // \"+json\" -> \"*/*+json\" expando\n    return '*/*' + type\n  }\n\n  return type.indexOf('/') === -1\n    ? mime.lookup(type)\n    : type\n}\n\n/**\n * Check if `expected` mime type\n * matches `actual` mime type with\n * wildcard and +suffix support.\n *\n * @param {String} expected\n * @param {String} actual\n * @return {Boolean}\n * @private\n */\n\nfunction mimeMatch (expected, actual) {\n  // invalid type\n  if (expected === false) {\n    return false\n  }\n\n  // split types\n  var actualParts = actual.split('/')\n  var expectedParts = expected.split('/')\n\n  // invalid format\n  if (actualParts.length !== 2 || expectedParts.length !== 2) {\n    return false\n  }\n\n  // validate type\n  if (expectedParts[0] !== '*' && expectedParts[0] !== actualParts[0]) {\n    return false\n  }\n\n  // validate suffix wildcard\n  if (expectedParts[1].substr(0, 2) === '*+') {\n    return expectedParts[1].length <= actualParts[1].length + 1 &&\n      expectedParts[1].substr(1) === actualParts[1].substr(1 - expectedParts[1].length)\n  }\n\n  // validate subtype\n  if (expectedParts[1] !== '*' && expectedParts[1] !== actualParts[1]) {\n    return false\n  }\n\n  return true\n}\n\n/**\n * Normalize a type and remove parameters.\n *\n * @param {string} value\n * @return {string}\n * @private\n */\n\nfunction normalizeType (value) {\n  // parse the type\n  var type = typer.parse(value)\n\n  // remove the parameters\n  type.parameters = undefined\n\n  // reformat it\n  return typer.format(type)\n}\n\n/**\n * Try to normalize a type and remove parameters.\n *\n * @param {string} value\n * @return {string}\n * @private\n */\n\nfunction tryNormalizeType (value) {\n  if (!value) {\n    return null\n  }\n\n  try {\n    return normalizeType(value)\n  } catch (err) {\n    return null\n  }\n}\n", "'use strict'\nconst http = require('http')\nconst url = require('url')\nconst binarycase = require('binary-case')\nconst isType = require('type-is')\n\nfunction getPathWithQueryStringParams (event) {\n  return url.format({ pathname: event.path, query: event.queryStringParameters })\n}\nfunction getEventBody (event) {\n  return Buffer.from(event.body, event.isBase64Encoded ? 'base64' : 'utf8')\n}\n\nfunction clone (json) {\n  return JSON.parse(JSON.stringify(json))\n}\n\nfunction getContentType (params) {\n  // only compare mime type; ignore encoding part\n  return params.contentTypeHeader ? params.contentTypeHeader.split(';')[0] : ''\n}\n\nfunction isContentTypeBinaryMimeType (params) {\n  return params.binaryMimeTypes.length > 0 && !!isType.is(params.contentType, params.binaryMimeTypes)\n}\n\nfunction mapApiGatewayEventToHttpRequest (event, context, socketPath) {\n  const headers = Object.assign({}, event.headers)\n\n  // NOTE: API Gateway is not setting Content-Length header on requests even when they have a body\n  if (event.body && !headers['Content-Length']) {\n    const body = getEventBody(event)\n    headers['Content-Length'] = Buffer.byteLength(body)\n  }\n\n  const clonedEventWithoutBody = clone(event)\n  delete clonedEventWithoutBody.body\n\n  headers['x-apigateway-event'] = encodeURIComponent(JSON.stringify(clonedEventWithoutBody))\n  headers['x-apigateway-context'] = encodeURIComponent(JSON.stringify(context))\n\n  return {\n    method: event.httpMethod,\n    path: getPathWithQueryStringParams(event),\n    headers,\n    socketPath\n    // protocol: `${headers['X-Forwarded-Proto']}:`,\n    // host: headers.Host,\n    // hostname: headers.Host, // Alias for host\n    // port: headers['X-Forwarded-Port']\n  }\n}\n\nfunction forwardResponseToApiGateway (server, response, resolver) {\n  const buf = []\n\n  response\n    .on('data', (chunk) => buf.push(chunk))\n    .on('end', () => {\n      const bodyBuffer = Buffer.concat(buf)\n      const statusCode = response.statusCode\n      const headers = response.headers\n\n      // chunked transfer not currently supported by API Gateway\n      /* istanbul ignore else */\n      if (headers['transfer-encoding'] === 'chunked') {\n        delete headers['transfer-encoding']\n      }\n\n      // HACK: modifies header casing to get around API Gateway's limitation of not allowing multiple\n      // headers with the same name, as discussed on the AWS Forum https://forums.aws.amazon.com/message.jspa?messageID=725953#725953\n      Object.keys(headers)\n        .forEach(h => {\n          if (Array.isArray(headers[h])) {\n            if (h.toLowerCase() === 'set-cookie') {\n              headers[h].forEach((value, i) => {\n                headers[binarycase(h, i + 1)] = value\n              })\n              delete headers[h]\n            } else {\n              headers[h] = headers[h].join(',')\n            }\n          }\n        })\n\n      const contentType = getContentType({ contentTypeHeader: headers['content-type'] })\n      const isBase64Encoded = isContentTypeBinaryMimeType({ contentType, binaryMimeTypes: server._binaryTypes })\n      const body = bodyBuffer.toString(isBase64Encoded ? 'base64' : 'utf8')\n      const successResponse = { statusCode, body, headers, isBase64Encoded }\n\n      resolver.succeed({ response: successResponse })\n    })\n}\n\nfunction forwardConnectionErrorResponseToApiGateway (error, resolver) {\n  console.log('ERROR: @vendia/serverless-express connection error')\n  console.error(error)\n  const errorResponse = {\n    statusCode: 502, // \"DNS resolution, TCP level errors, or actual HTTP parse errors\" - https://nodejs.org/api/http.html#http_http_request_options_callback\n    body: '',\n    headers: {}\n  }\n\n  resolver.succeed({ response: errorResponse })\n}\n\nfunction forwardLibraryErrorResponseToApiGateway (error, resolver) {\n  console.log('ERROR: @vendia/serverless-express error')\n  console.error(error)\n  const errorResponse = {\n    statusCode: 500,\n    body: '',\n    headers: {}\n  }\n\n  resolver.succeed({ response: errorResponse })\n}\n\nfunction forwardRequestToNodeServer (server, event, context, resolver) {\n  try {\n    const requestOptions = mapApiGatewayEventToHttpRequest(event, context, getSocketPath(server._socketPathSuffix))\n    const req = http.request(requestOptions, (response) => forwardResponseToApiGateway(server, response, resolver))\n    if (event.body) {\n      const body = getEventBody(event)\n\n      req.write(body)\n    }\n\n    req.on('error', (error) => forwardConnectionErrorResponseToApiGateway(error, resolver))\n      .end()\n  } catch (error) {\n    forwardLibraryErrorResponseToApiGateway(error, resolver)\n    return server\n  }\n}\n\nfunction startServer (server) {\n  return server.listen(getSocketPath(server._socketPathSuffix))\n}\n\nfunction getSocketPath (socketPathSuffix) {\n  /* istanbul ignore if */ /* only running tests on Linux; Window support is for local dev only */\n  if (/^win/.test(process.platform)) {\n    const path = require('path')\n    return path.join('\\\\\\\\?\\\\pipe', process.cwd(), `server-${socketPathSuffix}`)\n  } else {\n    return `/tmp/server-${socketPathSuffix}.sock`\n  }\n}\n\nfunction getRandomString () {\n  return Math.random().toString(36).substring(2, 15)\n}\n\nfunction createServer (requestListener, serverListenCallback, binaryTypes) {\n  const server = http.createServer(requestListener)\n\n  server._socketPathSuffix = getRandomString()\n  server._binaryTypes = binaryTypes ? binaryTypes.slice() : []\n  server.on('listening', () => {\n    server._isListening = true\n\n    if (serverListenCallback) serverListenCallback()\n  })\n  server.on('close', () => {\n    server._isListening = false\n  })\n    .on('error', (error) => {\n      /* istanbul ignore else */\n      if (error.code === 'EADDRINUSE') {\n        console.warn(`WARNING: Attempting to listen on socket ${getSocketPath(server._socketPathSuffix)}, but it is already in use. This is likely as a result of a previous invocation error or timeout. Check the logs for the invocation(s) immediately prior to this for root cause, and consider increasing the timeout and/or cpu/memory allocation if this is purely as a result of a timeout. @vendia/serverless-express will restart the Node.js server listening on a new port and continue with this request.`)\n        server._socketPathSuffix = getRandomString()\n        return server.close(() => startServer(server))\n      } else {\n        console.log('ERROR: server error')\n        console.error(error)\n      }\n    })\n\n  return server\n}\n\nfunction proxy (server, event, context, resolutionMode, callback) {\n  // DEPRECATED: Legacy support\n  if (!resolutionMode) {\n    const resolver = makeResolver({ context, resolutionMode: 'CONTEXT_SUCCEED' })\n    if (server._isListening) {\n      forwardRequestToNodeServer(server, event, context, resolver)\n      return server\n    } else {\n      return startServer(server)\n        .on('listening', () => proxy(server, event, context))\n    }\n  }\n\n  return {\n    promise: new Promise((resolve, reject) => {\n      const promise = {\n        resolve,\n        reject\n      }\n      const resolver = makeResolver({\n        context,\n        callback,\n        promise,\n        resolutionMode\n      })\n\n      if (server._isListening) {\n        forwardRequestToNodeServer(server, event, context, resolver)\n      } else {\n        startServer(server)\n          .on('listening', () => forwardRequestToNodeServer(server, event, context, resolver))\n      }\n    })\n  }\n}\n\nfunction makeResolver (params/* {\n  context,\n  callback,\n  promise,\n  resolutionMode\n} */) {\n  return {\n    succeed: (params2/* {\n      response\n    } */) => {\n      if (params.resolutionMode === 'CONTEXT_SUCCEED') return params.context.succeed(params2.response)\n      if (params.resolutionMode === 'CALLBACK') return params.callback(null, params2.response)\n      if (params.resolutionMode === 'PROMISE') return params.promise.resolve(params2.response)\n    }\n  }\n}\n\nexports.createServer = createServer\nexports.proxy = proxy\n\n/* istanbul ignore else */\nif (process.env.NODE_ENV === 'test') {\n  exports.getPathWithQueryStringParams = getPathWithQueryStringParams\n  exports.mapApiGatewayEventToHttpRequest = mapApiGatewayEventToHttpRequest\n  exports.forwardResponseToApiGateway = forwardResponseToApiGateway\n  exports.forwardConnectionErrorResponseToApiGateway = forwardConnectionErrorResponseToApiGateway\n  exports.forwardLibraryErrorResponseToApiGateway = forwardLibraryErrorResponseToApiGateway\n  exports.forwardRequestToNodeServer = forwardRequestToNodeServer\n  exports.startServer = startServer\n  exports.getSocketPath = getSocketPath\n  exports.makeResolver = makeResolver\n}\n", "'use strict'\n\nmodule.exports = require('./src/index')\n", "const serverlessExpress = require('@vendia/serverless-express')\n\nexports.createServer = serverlessExpress.createServer\nexports.proxy = serverlessExpress.proxy\n\n/* istanbul ignore else */\nif (process.env.NODE_ENV === 'test') {\n  exports.getPathWithQueryStringParams = serverlessExpress.getPathWithQueryStringParams\n  exports.mapApiGatewayEventToHttpRequest = serverlessExpress.mapApiGatewayEventToHttpRequest\n  exports.forwardResponseToApiGateway = serverlessExpress.forwardResponseToApiGateway\n  exports.forwardConnectionErrorResponseToApiGateway = serverlessExpress.forwardConnectionErrorResponseToApiGateway\n  exports.forwardLibraryErrorResponseToApiGateway = serverlessExpress.forwardLibraryErrorResponseToApiGateway\n  exports.forwardRequestToNodeServer = serverlessExpress.forwardRequestToNodeServer\n  exports.startServer = serverlessExpress.startServer\n  exports.getSocketPath = serverlessExpress.getSocketPath\n  exports.makeResolver = serverlessExpress.makeResolver\n}\n", "'use strict'\n\nmodule.exports = require('./src/index')\n", "const aws = require('aws-serverless-express')\n\nmodule.exports = function unexpress (app) {\n  let server = aws.createServer(app)\n  return function http (event, context, callback) {\n    if (process.env.NODE_ENV === 'testing' || process.env.ARC_LOCAL) {\n      return aws.proxy(server, event, context, 'CALLBACK', callback)\n    }\n    else {\n      return aws.proxy(server, event, context)\n    }\n  }\n}\n", "/**\n * transform reduces {headers, body} with given plugins\n *\n * @param args - arguments obj\n * @param args.Key - the origin S3 bucket Key requested\n * @param args.config - the entire arc.proxy.public config obj\n * @param args.defaults - the default {headers, body} in the transform pipeline\n */\nmodule.exports = function transform ({ Key, config, isBinary, defaults }) {\n  let filetype = Key.split('.').pop()\n  let plugins = config.plugins ? config.plugins[filetype] || [] : []\n  // early return if there's no processing to do\n  if (plugins.length === 0 || isBinary)\n    return defaults\n  else {\n    defaults.body = defaults.body.toString() // Convert non-binary files to strings for mutation\n    // otherwise walk the supplied plugins\n    return plugins.reduce(function run (response, plugin) {\n      /* eslint global-require: 'off' */\n      let transformer = typeof plugin === 'function' ? plugin : require(plugin)\n      return transformer(Key, response, config)\n    }, defaults)\n  }\n}\n", "module.exports = function templatizeResponse (params) {\n  let { isBinary, assets, response, isLocal = false } = params\n\n  // Bail early\n  if (isBinary) {\n    return response\n  }\n  else {\n    // Find: ${STATIC('path/filename.ext')}\n    //   or: ${arc.static('path/filename.ext')}\n    let staticRegex = /\\${(STATIC|arc\\.static)\\(.*\\)}/g\n    // Maybe stringify jic previous steps passed a buffer; perhaps we can remove this step if/when proxy plugins is retired\n    let body = response.body instanceof Buffer ? response.body.toString() : response.body\n    response.body = body.replace(staticRegex, function fingerprint (match) {\n      let start = match.startsWith(`\\${STATIC(`) ? 10 : 14\n      let Key = match.slice(start, match.length - 3)\n      // Normalize around no leading slash for static manifest lookups\n      let startsWithSlash = Key.startsWith('/')\n      let lookup = startsWithSlash ? Key.substr(1) : Key\n      if (assets && assets[lookup] && !isLocal) {\n        Key = assets[lookup]\n        Key = startsWithSlash ? `/${Key}` : Key\n      }\n      return Key\n    })\n    response.body = Buffer.from(response.body) // Re-enbufferize\n    return response\n  }\n}\n", "let {\n  gzipSync,\n  gunzipSync,\n  brotliCompressSync,\n  brotliDecompressSync,\n  deflateSync,\n  inflateSync,\n} = require('zlib')\n\nfunction compressor (direction, type, data) {\n  let compress = direction === 'compress'\n  let exec = {\n    gzip: compress ? gzipSync : gunzipSync,\n    br: compress ? brotliCompressSync : brotliDecompressSync,\n    deflate: compress ? deflateSync : inflateSync\n  }\n  if (!exec[type]) throw ReferenceError('Invalid compression type specified, must be gzip, br, or deflate')\n\n  return exec[type](data)\n}\n\nmodule.exports = {\n  compress: compressor.bind({}, 'compress'),\n  decompress: compressor.bind({}, 'decompress')\n}\n", "let mime = require('mime-types')\nlet path = require('path')\nlet { compress } = require('./compress')\n\n/**\n * Normalizes response shape\n */\nmodule.exports = function normalizeResponse (params) {\n  let { response, result, Key, isProxy, contentEncoding, config } = params\n\n  let noCache = [\n    'text/html',\n    'application/json',\n    'application/vnd.api+json'\n  ]\n  response.headers = response.headers || {}\n\n  // Establish Content-Type\n  let contentType =\n    response.headers['Content-Type'] || // Possibly get content-type passed via proxy plugins\n    response.headers['content-type'] || // ...\n    result && result.ContentType ||     // Fall back to what came down from S3's metadata\n    mime.contentType(path.extname(Key)) // Finally, fall back to the mime type database\n\n  // Set Content-Type\n  response.headers['Content-Type'] = contentType\n\n  // Set caching headers\n  let neverCache = noCache.some(n => contentType.includes(n))\n  if (config.cacheControl) {\n    response.headers['Cache-Control'] = config.cacheControl\n  }\n  else if (neverCache) {\n    response.headers['Cache-Control'] = 'no-cache, no-store, must-revalidate, max-age=0, s-maxage=0'\n  }\n  else if (result && result.CacheControl) {\n    response.headers['Cache-Control'] = result.CacheControl\n  }\n  else {\n    response.headers['Cache-Control'] = 'public, max-age=0, must-revalidate'\n  }\n\n  // Populate optional userland headers\n  if (config.headers) {\n    Object.keys(config.headers).forEach(h => response.headers[h] = config.headers[h])\n  }\n\n  // Normalize important common header casings to prevent dupes\n  if (response.headers['content-type']) {\n    response.headers['Content-Type'] = response.headers['content-type']\n    delete response.headers['content-type']\n  }\n  // Probably unable to be set via this code path, but normalize jic\n  if (response.headers['cache-control']) {\n    response.headers['Cache-Control'] = response.headers['cache-control']\n    delete response.headers['cache-control']\n  }\n\n  let notArcSix = !process.env.ARC_CLOUDFORMATION\n  let notArcProxy = !process.env.ARC_HTTP || process.env.ARC_HTTP === 'aws'\n  let isArcFive = notArcSix && notArcProxy\n  let isHTML = response.headers['Content-Type'].includes('text/html')\n  if (isArcFive && isHTML && !isProxy) {\n    // This is a deprecated code path that may be removed when Arc 5 exits LTS status\n    // Only return string bodies for certain types, and ONLY in Arc 5\n    response.body = Buffer.from(response.body).toString()\n    response.type = response.headers['Content-Type'] // Re-set type or it will fall back to JSON\n  }\n  else {\n    if (contentEncoding) {\n      response.body = compress(contentEncoding, response.body)\n      response.headers['Content-Encoding'] = contentEncoding\n    }\n    // Base64 everything else on the way out to enable text + binary support\n    response.body = Buffer.from(response.body).toString('base64')\n    response.isBase64Encoded = true\n  }\n\n  // Add ETag\n  response.headers.ETag = result.ETag\n\n  return response\n}\n", "let aws = require('aws-sdk')\nlet { existsSync, readFileSync } = require('fs')\nlet { join } = require('path')\nlet { httpError } = require('../../errors')\n\n/**\n * Peek into a dir without a trailing slash to see if it's got an index.html file\n *   If not, look for a custom 404.html\n *   Finally, return the default 404\n */\nmodule.exports = async function pretty (params) {\n  let { Bucket, Key, assets, headers, isFolder, prefix } = params\n  let { ARC_LOCAL, ARC_SANDBOX_PATH_TO_STATIC, NODE_ENV } = process.env\n  let local = NODE_ENV === 'testing' || ARC_LOCAL\n  let s3 = new aws.S3\n\n  function getKey (Key) {\n    let lookup = Key.replace(prefix + '/', '')\n    if (assets && assets[lookup]) {\n      Key = assets[lookup]\n      Key = prefix ? `${prefix}/${Key}` : Key\n    }\n    return Key\n  }\n\n  // eslint-disable-next-line\n  async function getLocal (file) {\n    let basepath = ARC_SANDBOX_PATH_TO_STATIC\n    if (!file.startsWith(basepath)) {\n      file = join(basepath, file)\n    }\n    if (!existsSync(file)) {\n      let err = ReferenceError(`NoSuchKey: ${Key} not found`)\n      err.name = 'NoSuchKey'\n      throw err\n    }\n    else return {\n      Body: readFileSync(file)\n    }\n  }\n\n  async function getS3 (Key) {\n    return await s3.getObject({ Bucket, Key }).promise()\n  }\n\n  async function get (file) {\n    let getter = local ? getLocal : getS3\n    try {\n      return await getter(file)\n    }\n    catch (err) {\n      if (err.name === 'NoSuchKey') {\n        err.statusCode = 404\n        return err\n      }\n      else {\n        err.statusCode = 500\n        return err\n      }\n    }\n  }\n\n  /**\n   * Enable pretty urls\n   *   Peek into a dir without trailing slash to see if it contains index.html\n   */\n  if (isFolder && !Key.endsWith('/')) {\n    let peek = getKey(`${Key}/index.html`)\n    let result = await get(peek)\n    if (result.Body) {\n      let body = result.Body.toString()\n      return { headers, statusCode: 200, body }\n    }\n  }\n\n  /**\n   * Enable custom 404s\n   *   Check to see if user defined a custom 404 page\n   */\n  let notFound = getKey(`404.html`)\n  let result = await get(notFound)\n  if (result.Body) {\n    let body = result.Body.toString()\n    return {\n      headers: {\n        'Content-Type': 'text/html; charset=utf8;',\n        'Cache-Control': 'no-cache, no-store, must-revalidate, max-age=0, s-maxage=0'\n      },\n      statusCode: 404,\n      body\n    }\n  }\n  else {\n    let err = result\n    let { statusCode } = err\n    let title = err.name\n    let message = `\n      ${err.message} <pre><b>${Key}</b></pre><br>\n      <pre>${err.stack}</pre>\n    `\n    return httpError({ statusCode, title, message })\n  }\n}\n", "let { existsSync, readFileSync } = require('fs')\nlet { extname, join, sep } = require('path')\nlet mime = require('mime-types')\nlet crypto = require('crypto')\n\nlet binaryTypes = require('../../helpers/binary-types')\nlet { httpError } = require('../../errors')\nlet transform = require('../format/transform') // Soon to be deprecated\nlet templatizeResponse = require('../format/templatize')\nlet normalizeResponse = require('../format/response')\nlet pretty = require('./_pretty')\n\n/**\n * arc.http.proxy.read\n *\n * Reads a file from the local filesystem, resolving an HTTP Lambda friendly payload\n *\n * @param {Object} params\n * @param {String} params.Key\n * @param {String} params.IfNoneMatch\n * @param {String} params.isFolder\n * @param {String} params.isProxy\n * @param {Object} params.config\n * @returns {Object} {statusCode, headers, body}\n */\nmodule.exports = async function readLocal (params) {\n\n  let { ARC_SANDBOX_PATH_TO_STATIC, ARC_STATIC_PREFIX, ARC_STATIC_FOLDER } = process.env\n  let { Key, IfNoneMatch, isFolder, isProxy, config } = params\n  let headers = {}\n  let response = {}\n\n  // Unlike S3, handle basePath and assets inside the function as Sandbox is long-lived\n  let staticAssets\n  // After 6.x we can rely on this env var in sandbox\n  let basePath = ARC_SANDBOX_PATH_TO_STATIC || join(process.cwd(), '..', '..', '..', 'public')\n  let staticManifest = join(basePath, 'static.json')\n  if (existsSync(staticManifest)) {\n    staticAssets = JSON.parse(readFileSync(staticManifest))\n  }\n  let assets = config.assets || staticAssets\n\n  // Look up the blob\n  // Assume we're running from a lambda in src/**/* OR from vendored node_modules/@architect/sandbox\n  let filePath = join(basePath, Key)\n  // Denormalize static folder for local paths (not something we'd do in S3)\n  let staticPrefix = ARC_STATIC_PREFIX || ARC_STATIC_FOLDER\n  if (filePath.includes(staticPrefix)) {\n    filePath = filePath.replace(`${staticPrefix}${sep}`, '')\n  }\n\n  try {\n    // If client sends If-None-Match, use it in S3 getObject params\n    let matchedETag = false\n\n    // If the static asset manifest has the key, use that, otherwise fall back to the original Key\n    let contentType = mime.contentType(extname(Key))\n\n    if (!existsSync(filePath)) {\n      return await pretty({ Key: filePath, config, isFolder })\n    }\n\n    let body = readFileSync(filePath)\n    let ETag = crypto.createHash('sha256').update(body).digest('hex')\n    let result = {\n      ContentType: contentType,\n      ETag\n    }\n    if (IfNoneMatch === ETag) {\n      matchedETag = true\n      headers.ETag = IfNoneMatch\n      response = {\n        statusCode: 304,\n        headers\n      }\n    }\n\n    // No ETag found, return the blob\n    if (!matchedETag) {\n      let isBinary = binaryTypes.some(type => result.ContentType.includes(type) || contentType.includes(type))\n\n      // Transform first to allow for any proxy plugin mutations\n      response = transform({\n        Key,\n        config,\n        isBinary,\n        defaults: {\n          headers,\n          body\n        }\n      })\n\n      // Handle templating\n      response = templatizeResponse({\n        isBinary,\n        assets,\n        response,\n        isLocal: true\n      })\n\n      // Normalize response\n      response = normalizeResponse({\n        response,\n        result,\n        Key,\n        isProxy,\n        config\n      })\n\n      // Add ETag\n      response.headers.ETag = result.ETag\n    }\n\n    if (!response.statusCode) {\n      response.statusCode = 200\n    }\n\n    return response\n  }\n  catch (err) {\n    let notFound = err.name === 'NoSuchKey'\n    if (notFound) {\n      return await pretty({ Key: filePath, config, isFolder })\n    }\n    else {\n      let title = err.name\n      let message = `\n        ${err.message}<br>\n        <pre>${err.stack}</pre>\n      `\n      return httpError({ statusCode: 500, title, message })\n    }\n  }\n}\n", "let { existsSync, readFileSync } = require('fs')\nlet { extname, join } = require('path')\nlet mime = require('mime-types')\nlet aws = require('aws-sdk')\n\nlet binaryTypes = require('../../helpers/binary-types')\nlet { httpError } = require('../../errors')\nlet transform = require('../format/transform') // Soon to be deprecated\nlet templatizeResponse = require('../format/templatize')\nlet normalizeResponse = require('../format/response')\nlet pretty = require('./_pretty')\nlet { decompress } = require('../format/compress')\n\n/**\n * arc.http.proxy.read\n *\n * Reads a file from S3, resolving an HTTP Lambda friendly payload\n *\n * @param {Object} params\n * @param {String} params.Key\n * @param {String} params.Bucket\n * @param {String} params.IfNoneMatch\n * @param {String} params.isFolder\n * @param {String} params.isProxy\n * @param {Object} params.config\n * @returns {Object} {statusCode, headers, body}\n */\nmodule.exports = async function readS3 (params) {\n\n  let { Bucket, Key, IfNoneMatch, isFolder, isProxy, config, rootPath } = params\n  let { ARC_STATIC_PREFIX, ARC_STATIC_FOLDER } = process.env\n  let prefix = ARC_STATIC_PREFIX || ARC_STATIC_FOLDER || config.bucket && config.bucket.folder\n  let assets = config.assets || staticAssets\n  let headers = {}\n  let response = {}\n\n  try {\n    // If client sends If-None-Match, use it in S3 getObject params\n    let matchedETag = false\n    let s3 = new aws.S3\n\n    // Try to interpolate HTML/JSON requests to fingerprinted filenames\n    let contentType = mime.contentType(extname(Key))\n    let capture = [ 'text/html', 'application/json' ]\n    let isCaptured = capture.some(type => contentType.includes(type))\n    if (assets && assets[Key] && isCaptured) {\n      // Not necessary to flag response formatter for anti-caching\n      // Those headers are already set in S3 file metadata\n      Key = assets[Key]\n    }\n\n    /**\n     * Check for possible fingerprint upgrades and forward valid requests\n     */\n    if (assets && assets[Key] && !isCaptured) {\n      let location = rootPath\n        ? `/${rootPath}/_static/${assets[Key]}`\n        : `/_static/${assets[Key]}`\n      return {\n        statusCode: 302,\n        headers: {\n          location,\n          'Cache-Control': 'no-cache, no-store, must-revalidate, max-age=0, s-maxage=0'\n        }\n      }\n    }\n\n    /**\n     * Folder prefix\n     *   Enables a bucket folder at root to be specified\n     */\n    if (prefix) {\n      Key = `${prefix}/${Key}`\n    }\n\n    let options = { Bucket, Key }\n    if (IfNoneMatch) {\n      options.IfNoneMatch = IfNoneMatch\n    }\n\n    let result = await s3.getObject(options).promise().catch(err => {\n      // ETag matches (getObject error code of NotModified), so don't transit the whole file\n      if (err.code === 'NotModified') {\n        matchedETag = true\n        headers.ETag = IfNoneMatch\n        response = {\n          statusCode: 304,\n          headers\n        }\n      }\n      else {\n        // Important: do not swallow this error otherwise!\n        throw err\n      }\n    })\n\n    // No ETag found, return the blob\n    if (!matchedETag) {\n      let contentEncoding = result.ContentEncoding\n      if (contentEncoding) {\n        result.Body = decompress(contentEncoding, result.Body)\n      }\n\n      let isBinary = binaryTypes.some(type => result.ContentType.includes(type) || contentType.includes(type))\n\n      // Transform first to allow for any proxy plugin mutations\n      response = transform({\n        Key,\n        config,\n        isBinary,\n        defaults: {\n          headers,\n          body: result.Body\n        }\n      })\n\n      // Handle templating\n      response = templatizeResponse({\n        isBinary,\n        assets,\n        response\n      })\n\n      // Normalize response\n      response = normalizeResponse({\n        response,\n        result,\n        Key,\n        isProxy,\n        contentEncoding,\n        config\n      })\n    }\n\n    if (!response.statusCode) {\n      response.statusCode = 200\n    }\n\n    return response\n  }\n  catch (err) {\n    let notFound = err.name === 'NoSuchKey'\n    if (notFound) {\n      return await pretty({ Bucket, Key, assets, headers, isFolder, prefix })\n    }\n    else {\n      let title = err.name\n      let message = `\n        ${err.message}<br>\n        <pre>${err.stack}</pre>\n      `\n      return httpError({ statusCode: 500, title, message })\n    }\n  }\n}\n\n/**\n * Fingerprinting manifest\n *   Load the manifest, try to hit the disk as infrequently as possible across invocations\n */\nlet staticAssets\nlet staticManifest = join(process.cwd(), 'node_modules', '@architect', 'shared', 'static.json')\nif (staticAssets === false) {\n  null /* noop*/\n}\nelse if (existsSync(staticManifest) && !staticAssets) {\n  staticAssets = JSON.parse(readFileSync(staticManifest))\n}\nelse {\n  staticAssets = false\n}\n", "let readLocal = require('./_local')\nlet readS3 = require('./_s3')\n\nfunction read () {\n  let { ARC_LOCAL, NODE_ENV } = process.env\n  let local = NODE_ENV === 'testing' || ARC_LOCAL\n  return local ? readLocal : readS3\n}\n\nmodule.exports = read()\n", "let read = require('./read')\nlet errors = require('../errors')\n\n/**\n * arc.http.proxy\n *\n * Primary interface for reading static assets out of S3\n *\n * @param config - object, for configuration\n * @param config.alias - object, map of root rel URLs to map to fully qualified root rel URLs\n * @param config.assets - object, map of local, unfingerprinted filenames to fingerprinted filenames\n * @param config.bucket - object, {staging, production} override the s3 bucket names\n * @param config.bucket.staging - object, {staging, production} override the s3 bucket names\n * @param config.bucket.production - object, {staging, production} override the s3 bucket names\n * @param config.bucket.folder - string, bucket folder\n * @param config.cacheControl - string, set a custom Cache-Control max-age header value\n * @param config.plugins - object, configure proxy-plugin-* transforms per file extension\n * @param config.spa - boolean, forces index.html no matter the folder depth\n *\n * @returns HTTPLambda - an HTTP Lambda function that proxies calls to S3\n */\nfunction proxy (config = {}) {\n  return async function httpProxy (req) {\n    let { ARC_STATIC_BUCKET, ARC_STATIC_SPA, NODE_ENV } = process.env\n    let deprecated = req.version === undefined || req.version === '1.0'\n\n    let isProduction = NODE_ENV === 'production'\n    let path = deprecated ? req.path : req.rawPath\n    let isFolder = path.split('/').pop().indexOf('.') === -1\n    let Key // Assigned below\n\n    /**\n     * Bucket config\n     */\n    let configBucket = config.bucket\n    let bucketSetting = isProduction\n      ? configBucket && configBucket['production']\n      : configBucket && configBucket['staging']\n    // Ok, all that out of the way, let's set the actual bucket, eh?\n    let Bucket = ARC_STATIC_BUCKET || bucketSetting\n    if (!Bucket) {\n      return errors.proxyConfig\n    }\n\n    /**\n     * Configure SPA + set up the file to be requested\n     */\n    let spa = ARC_STATIC_SPA === 'false'\n      ? false\n      : config && config.spa\n    if (!spa) config.spa = false\n    if (spa) {\n      // If SPA: force index.html\n      Key = isFolder ? 'index.html' : path.substring(1)\n    }\n    else {\n      // Return index.html for root, otherwise pass the path\n      let last = path.split('/').filter(Boolean).pop()\n      let isFile = last ? last.includes('.') : false\n      let isRoot = path === '/'\n\n      Key = isRoot ? 'index.html' : path.substring(1) // Always remove leading slash\n\n      // Append default index.html to requests to folder paths\n      if (isRoot === false && isFile === false) {\n        Key = `${Key.replace(/\\/$/, '')}/index.html`\n      }\n    }\n\n    /**\n     * Alias\n     *   Allows a Key to be manually overridden\n     */\n    let aliasing = config && config.alias && config.alias[path]\n    if (aliasing) {\n      Key = config.alias[path].substring(1) // Always remove leading slash\n    }\n\n    /**\n     * REST API [very deprecated]: strip `staging/`, `production/` path parts\n     * - Post Architect 5.5 (2019-02-03) which added /{proxy+} this would be an edge case\n     * - e.g. you'd see this if someone put up a proxy in not-`get /`\n     */\n    if (Key.startsWith('staging/'))     Key = Key.replace('staging/', '')\n    if (Key.startsWith('production/'))  Key = Key.replace('production/', '')\n\n    /**\n     * REST API [deprecated]: flag `staging/`, `production/` requests\n     */\n    let rootPath\n    let reqPath = req.requestContext && req.requestContext.path\n    if (deprecated && reqPath) {\n      if (reqPath && reqPath.startsWith('/staging/')) rootPath = 'staging'\n      if (reqPath && reqPath.startsWith('/production/')) rootPath = 'production'\n    }\n\n    // Normalize if-none-match header to lower case; it differs between environments\n    let find = k => k.toLowerCase() === 'if-none-match'\n    let IfNoneMatch = req.headers && req.headers[Object.keys(req.headers).find(find)]\n\n    // Ensure response shape is correct for proxy SPA responses\n    let isProxy = req.resource === '/{proxy+}' || !!req.rawPath\n\n    return await read({ Key, Bucket, IfNoneMatch, isFolder, isProxy, config, rootPath })\n  }\n}\n\nmodule.exports = {\n  proxy,  // Default\n  read    // Read a specific file\n}\n", "// HTTP\nlet http = require('./http')\n\n// HTTP helpers\nlet bodyParser = require('./helpers/body-parser')\nlet interpolate = require('./helpers/params')\nlet _static = require('../static')\nlet url = require('./helpers/url')\n\n// Session\nlet read = require('./session/read')\nlet write = require('./session/write')\n\n// Middleware\nlet _async = require('./async')\nlet express = require('./express')\n\n// Proxy\nlet proxy = require('./proxy')\n\nhttp.helpers = {\n  bodyParser,\n  interpolate,\n  static: _static,\n  url\n}\nhttp.session = { read, write }\nhttp.async = _async\nhttp.express = express\nhttp.proxy = proxy.proxy\n\n// Legacy methods\nhttp.proxy.public = proxy.proxy\nhttp.proxy.read = proxy.read\nhttp.middleware = _async\n\nmodule.exports = http\n", "let aws = require('aws-sdk')\nlet http = require('http')\n/**\n * @param {string} type - events, queues, or tables\n * @returns {object} {name: value}\n */\nmodule.exports = function lookup (callback) {\n  let Path = `/${process.env.ARC_CLOUDFORMATION}`\n  let Recursive = true\n  let values = []\n  let isLocal = process.env.NODE_ENV === 'testing'\n  let config\n  if (isLocal) {\n    // if running in sandbox, sandbox has an SSM mock, use that\n    let port = process.env.ARC_INTERNAL || 3332\n    let region = process.env.AWS_REGION || 'us-west-2'\n    config = {\n      endpoint: new aws.Endpoint(`http://localhost:${port}/_arc/ssm`),\n      region,\n      httpOptions: { agent: new http.Agent() }\n    }\n  }\n  let ssm = new aws.SSM(config)\n\n  function getParams (params) {\n    ssm.getParametersByPath(params, function done (err, result) {\n      if (err) {\n        callback(err)\n      }\n      else if (result.NextToken) {\n        values = values.concat(result.Parameters)\n        getParams({ Path, Recursive, NextToken: result.NextToken })\n      }\n      else {\n        values = values.concat(result.Parameters)\n        callback(null, values.reduce((a, b) => {\n          let hierarchy = b.Name.split('/')\n          hierarchy.shift() // leading slash\n          hierarchy.shift() // stack name\n          let type = hierarchy.shift() // i.e. tables, events, queues, plugins\n          if (!a[type]) a[type] = {}\n          let parent = a[type]\n          let child, lastChild, lastParent\n          /* eslint-disable-next-line */\n          while (child = hierarchy.shift()) {\n            if (!parent[child]) parent[child] = {}\n            lastParent = parent\n            parent = parent[child]\n            lastChild = child\n          }\n          lastParent[lastChild] = b.Value\n          return a\n        }, {}))\n      }\n    })\n  }\n\n  getParams({ Path, Recursive })\n}\n", "let http = require('http')\n\nmodule.exports = function send ({ id, payload }, callback) {\n  let port = process.env.PORT || 3333\n  let body = JSON.stringify({ id, payload })\n  let req = http.request({\n    method: 'POST',\n    port,\n    path: '/__arc',\n    headers: {\n      'Content-Type': 'application/json',\n      'Content-Length': Buffer.byteLength(body)\n    }\n  })\n  req.on('error', callback)\n  req.on('close', () => callback())\n  req.write(body)\n  req.end()\n}\n", "let aws = require('aws-sdk')\n\nmodule.exports = function send ({ id, payload }, callback) {\n  let endpoint\n  let ARC_WSS_URL = process.env.ARC_WSS_URL\n  if (!ARC_WSS_URL.startsWith('wss://')) {\n    // This format of env was only alive for a few weeks, can prob safely retire by mid 2020\n    endpoint = `https://${ARC_WSS_URL}/${process.env.NODE_ENV}`\n  }\n  else {\n    endpoint = `https://${ARC_WSS_URL.replace('wss://', '')}`\n  }\n  let api = new aws.ApiGatewayManagementApi({\n    apiVersion: '2018-11-29',\n    endpoint\n  })\n  api.postToConnection({\n    ConnectionId: id,\n    Data: JSON.stringify(payload)\n  },\n  function postToConnection (err) {\n    if (err) callback(err)\n    else callback()\n  })\n}\n", "let sandbox = require('./send-sandbox')\nlet run = require('./send')\n\n/**\n * arc.ws.send\n *\n * publish web socket events\n *\n * @param {Object} params\n * @param {String} params.id - the ws connecton id (required)\n * @param {Object} params.payload - an event payload (required)\n * @param {Function} callback - a node style errback (optional)\n * @returns {Promise} - returned if no callback is supplied\n */\nmodule.exports = function send ({ id, payload }, callback) {\n\n  // create a promise if no callback is defined\n  let promise\n  if (!callback) {\n    promise = new Promise(function (res, rej) {\n      callback = function (err, result) {\n        err ? rej(err) : res(result)\n      }\n    })\n  }\n\n  let local = process.env.NODE_ENV === 'testing' || process.env.ARC_LOCAL\n  let exec = local ? sandbox : run\n\n  exec({\n    id,\n    payload\n  }, callback)\n\n  return promise\n}\n", "/*! run-waterfall. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */\nmodule.exports = runWaterfall\n\nfunction runWaterfall (tasks, cb) {\n  var current = 0\n  var isSync = true\n\n  function done (err, args) {\n    function end () {\n      args = args ? [].concat(err, args) : [err]\n      if (cb) cb.apply(undefined, args)\n    }\n    if (isSync) process.nextTick(end)\n    else end()\n  }\n\n  function each (err) {\n    var args = Array.prototype.slice.call(arguments, 1)\n    if (++current >= tasks.length || err) {\n      done(err, args)\n    } else {\n      tasks[current].apply(undefined, [].concat(args, each))\n    }\n  }\n\n  if (tasks.length) {\n    tasks[0](each)\n  } else {\n    done(null)\n  }\n\n  isSync = false\n}\n", "var parallel = require('run-parallel')\n/**\n * var trigger = require('aws-dynamodb-lambda-trigger/lambda')\n *\n * function onInsert(record, callback) {\n *   console.log(record)\n *   callback(null, record) // errback style; results passed to context.succeed\n * }\n *\n * module.exports = trigger.insert(onInsert)\n */\n\nfunction __trigger (types, handler) {\n  return function __lambdaSignature (evt, ctx) {\n    // dynamo triggers send batches of records so we're going to create a handler for each one\n    var handlers = evt.Records.map(function (record) {\n      // for each record we construct a handler function\n      return function __actualHandler (callback) {\n        // if isInvoking we invoke the handler with the record\n        var isInvoking = types.indexOf(record.eventName) > -1\n        if (isInvoking) {\n          handler(record, callback)\n        }\n        else {\n          callback() // if not we just call the continuation (callback)\n        }\n      }\n    })\n    // executes the handlers in parallel\n    parallel(handlers, function __processedRecords (err, results) {\n      if (err) {\n        ctx.fail(err)\n      }\n      else {\n        ctx.succeed(results)\n      }\n    })\n  }\n}\n\n/* eslint indent: 0 */\nmodule.exports = {\n  insert: __trigger.bind({}, [ 'INSERT' ]),\n  modify: __trigger.bind({}, [ 'MODIFY' ]),\n  update: __trigger.bind({}, [ 'MODIFY' ]),\n  remove: __trigger.bind({}, [ 'REMOVE' ]),\n destroy: __trigger.bind({}, [ 'REMOVE' ]),\n     all: __trigger.bind({}, [ 'INSERT', 'MODIFY', 'REMOVE' ]),\n    save: __trigger.bind({}, [ 'INSERT', 'MODIFY' ]),\n  change: __trigger.bind({}, [ 'INSERT', 'REMOVE' ])\n}\n", "// accepts an object and promisifies all keys\nmodule.exports = function pfy (obj) {\n  var copy = {}\n  Object.keys(obj).forEach(k => {\n    copy[k] = promised(obj[k])\n  })\n  return copy\n}\n\n// accepts an errback style fn and returns a promisified fn\nfunction promised (fn) {\n  return function _promisified (params, callback) {\n    if (!callback) {\n      return new Promise(function (res, rej) {\n        fn(params, function (err, result) {\n          err ? rej(err) : res(result)\n        })\n      })\n    }\n    else {\n      fn(params, callback)\n    }\n  }\n}\n", "let dynamo = require('./dynamo')\nlet promisify = require('./promisify-object')\nlet parallel = require('run-parallel')\n\n/**\n * returns a data client\n */\nmodule.exports = function reflectFactory (tables, callback) {\n  let { db, doc } = dynamo\n  parallel({ db, doc }, function done (err, { db, doc }) {\n    if (err) throw err\n    else {\n\n      let data = Object.keys(tables).reduce((client, tablename) => {\n        client[tablename] = factory(tables[tablename])\n        return client\n      }, {})\n\n      Object.defineProperty(data, '_db', {\n        enumerable: false,\n        value: db\n      })\n\n      Object.defineProperty(data, '_doc', {\n        enumerable: false,\n        value: doc\n      })\n\n      // async jic for later\n      // eslint-disable-next-line\n      data.reflect = async function reflect () {\n        return tables\n      }\n\n      let _name = name => tables[name]\n      data.name = _name\n      data._name = _name\n\n      function factory (TableName) {\n        return promisify({\n          delete (key, callback) {\n            let params = {}\n            params.TableName = TableName\n            params.Key = key\n            doc.delete(params, callback)\n          },\n          get (key, callback) {\n            let params = {}\n            params.TableName = TableName\n            params.Key = key\n            doc.get(params, function _get (err, result) {\n              if (err) callback(err)\n              else callback(null, result.Item)\n            })\n          },\n          put (item, callback) {\n            let params = {}\n            params.TableName = TableName\n            params.Item = item\n            doc.put(params, function _put (err) {\n              if (err) callback(err)\n              else callback(null, item)\n            })\n          },\n          query (params, callback) {\n            params.TableName = TableName\n            doc.query(params, callback)\n          },\n          scan (params, callback) {\n            params.TableName = TableName\n            doc.scan(params, callback)\n          },\n          update (params, callback) {\n            params.TableName = TableName\n            doc.update(params, callback)\n          }\n        })\n      }\n\n      callback(null, data)\n    }\n  })\n}\n", "const promisifyObject = require('./promisify-object')\nconst parallel = require('run-parallel')\n\nconst stagingTables = tbl => !tbl.includes('-production-')\n\nfunction client (doc, TableName) {\n  let client = {\n    delete (key, callback) {\n      let params = {}\n      params.TableName = TableName\n      params.Key = key\n      doc.delete(params, callback)\n    },\n    get (key, callback) {\n      let params = {}\n      params.TableName = TableName\n      params.Key = key\n      doc.get(params, function _get (err, result) {\n        if (err) {\n          callback(err)\n        }\n        else {\n          callback(null, result.Item)\n        }\n      })\n    },\n    put (item, callback) {\n      let params = {}\n      params.TableName = TableName\n      params.Item = item\n      doc.put(params, function _put (err) {\n        if (err) {\n          callback(err)\n        }\n        else {\n          callback(null, item)\n        }\n      })\n    },\n    query (params, callback) {\n      params.TableName = TableName\n      doc.query(params, callback)\n    },\n    scan (params, callback) {\n      params.TableName = TableName\n      doc.scan(params, callback)\n    },\n    update (params, callback) {\n      params.TableName = TableName\n      doc.update(params, callback)\n    }\n  }\n  return promisifyObject(client)\n}\n\n/**\n * returns a data client\n */\nmodule.exports = function sandbox (dynamo, callback) {\n  function done (err, results) {\n    if (err) {\n      return callback(err)\n    }\n\n    const db = results[0]\n    const doc = results[1]\n\n    db.listTables({}, function listed (err, result) {\n      if (err) {\n        return callback(err)\n      }\n      const tables = result.TableNames.filter(stagingTables)\n      const data = {}\n      const tableMap = {}\n      tables.forEach(fullTableName => {\n        const tableName = fullTableName.replace(/.+-staging-/, '')\n        tableMap[tableName] = fullTableName\n        data[tableName] = client(doc, fullTableName)\n      })\n\n      Object.defineProperty(data, '_db', {\n        enumerable: false,\n        value: db\n      })\n\n      Object.defineProperty(data, '_doc', {\n        enumerable: false,\n        value: doc\n      })\n\n      // async jic for later\n      // eslint-disable-next-line\n      data.reflect = async () => tableMap\n\n      let _name = tableName => tableMap[tableName]\n      data.name = _name\n      data._name = _name\n\n      callback(null, data)\n    })\n  }\n\n  parallel([ dynamo.db, dynamo.doc ], done)\n}\n", "let waterfall = require('run-waterfall')\nlet old = require('./old')\nlet factory = require('./factory')\nlet sandbox = require('./sandbox')\nlet dynamo = require('./dynamo')\n\n// cheap client cache\nlet client = false\n\n/**\n * // example usage:\n * let arc = require('architect/functions')\n *\n * exports.handler = async function http(req) {\n *  let data = await arc.tables()\n *  await data.tacos.put({taco: 'pollo'})\n *  return {statusCode: 200}\n * }\n */\nfunction tables (arc) {\n  function api (callback) {\n    let promise\n    if (!callback) {\n      promise = new Promise(function ugh (res, rej) {\n        callback = function errback (err, result) {\n          if (err) rej(err)\n          else res(result)\n        }\n      })\n    }\n    /**\n     * Read Architect manifest if local / sandbox, otherwise use service reflection\n     */\n    let runningLocally = process.env.NODE_ENV === 'testing'\n    if (runningLocally) {\n      sandbox(dynamo, callback)\n    }\n    else if (client) {\n      callback(null, client)\n    }\n    else {\n      waterfall([\n        function (callback) {\n          arc.services().then(function (serviceMap) {\n            callback(null, serviceMap.tables)\n          }).catch(callback)\n        },\n        factory,\n        function (created, callback) {\n          client = created\n          callback(null, client)\n        }\n      ], callback)\n    }\n    return promise\n  }\n  // Export directly for fast use\n  api.doc = dynamo.direct.doc\n  api.db = dynamo.direct.db\n\n  // Legacy compat methods\n  api.insert = old.insert\n  api.modify = old.modify\n  api.update = old.update\n  api.remove = old.remove\n  api.destroy = old.destroy\n  api.all = old.all\n  api.save = old.save\n  api.change = old.change\n  return api\n}\n\nmodule.exports = tables\n", "let http = require('http')\nlet waterfall = require('run-waterfall')\nlet aws = require('aws-sdk')\n\n/**\n * invoke an sqs lambda by name\n *\n * usage\n *\n *   let arc = require('@architect/functions')\n *\n *   arc.queues.publish({\n *     name: 'queue-name-here',\n *     payload: {hello: 'world'},\n *   }, console.log)\n *\n */\nmodule.exports = function _publish (params, callback) {\n\n  // ensure required input\n  if (!params.name)\n    throw ReferenceError('missing params.name')\n  if (!params.payload)\n    throw ReferenceError('missing params.payload')\n\n  // queue name normalized with appname and env\n  let name = `${process.env.ARC_APP_NAME}-${process.env.NODE_ENV}-${params.name}`\n  let payload = params.payload\n\n  let promise\n  if (!callback) {\n    promise = new Promise((resolve, reject) => {\n      callback = function errback (err, result) {\n        err ? reject(err) : resolve(result)\n      }\n    })\n  }\n\n  // check if we're running locally\n  let local = process.env.NODE_ENV === 'testing' || process.env.ARC_LOCAL\n  if (local) {\n    let port = process.env.ARC_EVENTS_PORT || 3334\n\n    // if so send the mock request\n    let req = http.request({\n      method: 'POST',\n      port,\n      path: '/queues',\n    },\n    function done (res) {\n      let data = []\n      res.resume()\n      res.on('data', chunk => data.push(chunk))\n      res.on('end', () => {\n        let body = Buffer.concat(data).toString()\n        let code = `${res.statusCode}`\n        if (!code.startsWith(2)) callback(Error(`${body} (${code})`))\n        else callback(null, body)\n      })\n    })\n    req.write(JSON.stringify(params))\n    req.end('\\n')\n  }\n  else {\n    // otherwise attempt to sqs.sendMessage\n    let sqs = new aws.SQS\n    waterfall([\n      function reads (callback) {\n        sqs.getQueueUrl({\n          QueueName: name,\n        }, callback)\n      },\n      function publishes (result, callback) {\n        let QueueUrl = result.QueueUrl\n        let DelaySeconds = params.delaySeconds || 0\n        sqs.sendMessage({\n          QueueUrl,\n          DelaySeconds,\n          MessageBody: JSON.stringify(payload)\n        }, callback)\n      }\n    ],\n    function _published (err, result) {\n      if (err) throw err\n      callback(null, result)\n    })\n  }\n  return promise\n}\n", "let parallel = require('run-parallel')\n/**\n * // Exmaple usage:\n *\n * var arc = require('@architect/functions')\n *\n * function signup(record, callback) {\n *   console.log(record)\n *   callback()\n * }\n *\n * // or\n * async function signup(event) {\n *   console.log(event)\n *   return true\n * }\n *\n * exports.handler = arc.queues.subscribe(signup)\n *\n */\nmodule.exports = function _subscribe (fn) {\n  if (fn.constructor.name === 'AsyncFunction') {\n    return async function lambda (event) {\n      return await Promise.all(event.Records.map(async record => {\n        try {\n          let result = JSON.parse(record.body)\n          return await fn(result)\n        }\n        catch (e) {\n          console.log('Queue subscribe error:', e)\n          throw e\n        }\n      }))\n    }\n  }\n  else {\n    return function _lambdaSignature (evt, ctx, callback) {\n      // sqs triggers send batches of records\n      // so we're going to create a handler for each one\n      // and execute them in parallel\n      parallel(evt.Records.map(function _iterator (record) {\n        // for each record we construct a handler function that assumes body is JSON\n        return function _actualHandler (callback) {\n          try {\n            fn(JSON.parse(record.body), callback)\n          }\n          catch (e) {\n            callback(e)\n          }\n        }\n      }), callback)\n    }\n  }\n}\n", "let http = require('http')\n\nmodule.exports = function sandbox (params, callback) {\n  let port = process.env.ARC_EVENTS_PORT || 3334\n  let req = http.request({\n    method: 'POST',\n    port,\n    path: '/queues',\n  },\n  function done (res) {\n    let data = []\n    res.resume()\n    res.on('data', chunk => data.push(chunk))\n    res.on('end', () => {\n      let body = Buffer.concat(data).toString()\n      let code = `${res.statusCode}`\n      if (!code.startsWith(2)) callback(Error(`${body} (${code})`))\n      else callback(null, body)\n    })\n  })\n  req.write(JSON.stringify(params))\n  req.end('\\n')\n}\n", "let aws = require('aws-sdk')\nlet ledger = {}\n\nmodule.exports = function liveFactory (arc) {\n  return function live ({ name, payload, delaySeconds, groupID }, callback) {\n\n    function publish (QueueUrl, payload, callback) {\n      let sqs = new aws.SQS\n      let params = {\n        QueueUrl,\n        DelaySeconds: delaySeconds || 0,\n        MessageBody: JSON.stringify(payload)\n      }\n      if (QueueUrl.endsWith('.fifo')) {\n        params.MessageGroupId = groupID || name\n      }\n      sqs.sendMessage(params, callback)\n    }\n\n    function cacheLedgerAndPublish (serviceMap) {\n      ledger = serviceMap.queues\n      if (!ledger[name]) callback(ReferenceError(`${name} queue not found`))\n      else publish(ledger[name], payload, callback)\n    }\n\n    let arn = ledger[name]\n    if (arn) {\n      publish(ledger[name], payload, callback)\n    }\n    else {\n      arc.services().then(cacheLedgerAndPublish).catch(callback)\n    }\n  }\n}\n", "let sandbox = require('./publish-sandbox')\nlet queueFactory = require('./publish-queue')\n\n/**\n * invoke a queue lambda by sqs queue name\n */\nmodule.exports = function publishFactory (arc) {\n  let queue = queueFactory(arc)\n  return function publish (params, callback) {\n\n    if (!params.name)\n      throw ReferenceError('missing params.name')\n\n    if (!params.payload)\n      throw ReferenceError('missing params.payload')\n\n    let promise\n    if (!callback) {\n      promise = new Promise((resolve, reject) => {\n        callback = function errback (err, result) {\n          err ? reject(err) : resolve(result)\n        }\n      })\n    }\n\n    let isLocal = process.env.NODE_ENV === 'testing' || process.env.ARC_LOCAL\n    let exec = isLocal ? sandbox : queue\n    exec(params, callback)\n    return promise\n  }\n}\n", "let oldPublish = require('./publish-old')\nlet subscribe = require('./subscribe')\nlet publishFactory = require('./publish')\n\nmodule.exports = function queueFactory (arc) {\n  let publish = publishFactory(arc)\n  return {\n    /**\n     * arc.queues.publish\n     *\n     * publish to an sqs queue\n     *\n     * @param {Object} params\n     * @param {String} params.name - the queue name (required)\n     * @param {String} params.payload - a json event payload (required)\n     * @param {Function} callback - a node style errback (optional)\n     * @returns {Promise} - returned if no callback is supplied\n     */\n    publish (params, callback) {\n      if (process.env.ARC_CLOUDFORMATION) {\n        return publish(params, callback)\n      }\n      else {\n        return oldPublish(params, callback)\n      }\n    },\n\n    /**\n     * arc.queues.subscribe\n     *\n     * handle payloads published to the queue\n     *\n     * @param {Function} handler - a single queue handler function\n     * @returns {Lambda} - a Lambda function sig: (event, context, callback)=>\n     */\n    subscribe,\n  }\n}\n", "/* eslint global-require: \"off\" */\nlet http = require('http')\nlet aws = require('aws-sdk')\nlet sns = new aws.SNS\nlet ledger = {}\n\n// priv publish\n// blindly publishes to sns topic json stringified record\n// throws if fails so lambda errors are noticible\nfunction __publish (arn, payload, callback) {\n  sns.publish({\n    TopicArn: arn,\n    Message: JSON.stringify(payload)\n  },\n  function _published (err, result) {\n    if (err) throw err\n    callback(null, result)\n  })\n}\n\n/**\n * invoke an event lambda by name\n *\n * usage\n *\n *   let arc = require('@smallwins/arc-prototype')\n *\n *   arc.events.publish({\n *     name: 'eventname',\n *     payload: {hello: 'world'},\n *   }, console.log)\n *\n * this will invoke appname-staging-eventname (or appname-production-eventname)\n *\n * you can invoke events for other arc apps in the same region by overriding appname with app param like so:\n *\n *   arc.events.publish({\n *     app: 'otherappname',\n *     name: 'eventname',\n *     payload: {hello: 'world2'},\n *   }, console.log)\n */\nmodule.exports = function _publish (params, callback) {\n  if (!params.name)\n    throw ReferenceError('missing params.name')\n\n  if (!params.payload)\n    throw ReferenceError('missing params.payload')\n\n  let promise\n  if (!callback) {\n    promise = new Promise((resolve, reject) => {\n      callback = function errback (err, result) {\n        err ? reject(err) : resolve(result)\n      }\n    })\n  }\n\n  let isLocal = process.env.NODE_ENV === 'testing' || process.env.ARC_LOCAL\n  let exec = isLocal ? _local : _live\n  exec(params, callback)\n  return promise\n}\n\nfunction _live (params, callback) {\n  let { name, payload } = params\n  let arn = ledger[name]\n\n  if (arn) {\n    __publish(ledger[name], payload, callback)\n  }\n  else {\n    let override = params.app\n    let eventName = `${override ? params.app : process.env.ARC_APP_NAME}-${process.env.NODE_ENV}-${name}`\n    _scan({ eventName }, function _scan (err, found) {\n      if (err) throw err\n      // cache the arn here\n      ledger[name] = found\n      // and continue\n      __publish(ledger[name], payload, callback)\n    })\n  }\n}\n\nfunction _local (params, callback) {\n  let port = process.env.ARC_EVENTS_PORT || 3334\n  let req = http.request({\n    method: 'POST',\n    port,\n    path: '/events',\n  },\n  function done (res) {\n    let data = []\n    res.resume()\n    res.on('data', chunk => data.push(chunk))\n    res.on('end', () => {\n      let body = Buffer.concat(data).toString()\n      let code = `${res.statusCode}`\n      if (!code.startsWith(2)) callback(Error(`${body} (${code})`))\n      else callback(null, body)\n    })\n  })\n  req.write(JSON.stringify(params))\n  req.end('\\n')\n}\n\nfunction _scan ({ eventName }, callback) {\n  let sns = new aws.SNS()\n  ;(function __scanner (params = {}, callback) {\n    sns.listTopics(params, function _listTopics (err, results) {\n      if (err) throw err\n      let found = results.Topics.find(t => {\n        let bits = t.TopicArn.split(':')\n        let it = bits[bits.length - 1]\n        return it === eventName\n      })\n      if (found) {\n        callback(null, found.TopicArn)\n      }\n      else if (results.NextToken) {\n        setTimeout(() => {\n          // 30tps on sns.listTopics, so let's give just a bit of buffer\n          __scanner({ NextToken: results.NextToken }, callback)\n        }, 50)\n      }\n      else {\n        callback(Error(`topic ${eventName} not found`))\n      }\n    })\n  })({}, callback)\n}\n", "let parallel = require('run-parallel')\n\nlet fallback = {\n  Records: [\n    { Sns: { Message: JSON.stringify({}) } }\n  ]\n}\n\n/**\n * // Example usage:\n *\n * var arc = require('@architect/functions')\n *\n * function signup(record, callback) {\n *   console.log(record)\n *   callback()\n * }\n *\n * exports.handler = arc.events.subscribe(signup)\n */\nmodule.exports = function _subscribe (fn) {\n  if (fn.constructor.name === 'AsyncFunction') {\n    return async function lambda (event) {\n      event = event && Object.keys(event).length ? event : fallback\n      return await Promise.all(event.Records.map(async record => {\n        try {\n          let result = JSON.parse(record.Sns.Message)\n          return await fn(result)\n        }\n        catch (e) {\n          console.log('Event subscribe error:', e)\n          throw e\n        }\n      }))\n    }\n  }\n  else {\n    // callback interface\n    return function _lambdaSignature (event, context, callback) {\n      event = event && Object.keys(event).length ? event : fallback\n      // sns triggers send batches of records\n      // so we're going to create a handler for each one\n      // and execute them in parallel\n      parallel(event.Records.map(function _iterator (record) {\n        // for each record we construct a handler function\n        return function _actualHandler (callback) {\n          try {\n            fn(JSON.parse(record.Sns.Message), callback)\n          }\n          catch (e) {\n            callback(e)\n          }\n        }\n      }), callback)\n    }\n  }\n}\n", "let http = require('http')\n\nmodule.exports = function publishLocal (params, callback) {\n  let port = process.env.ARC_EVENTS_PORT || 3334\n  let req = http.request({\n    method: 'POST',\n    port,\n    path: '/events',\n  },\n  function done (res) {\n    let data = []\n    res.resume()\n    res.on('data', chunk => data.push(chunk))\n    res.on('end', () => {\n      let body = Buffer.concat(data).toString()\n      let code = `${res.statusCode}`\n      if (!code.startsWith(2)) callback(Error(`${body} (${code})`))\n      else callback(null, body)\n    })\n  })\n  req.write(JSON.stringify(params))\n  req.end('\\n')\n}\n", "let aws = require('aws-sdk')\nlet ledger = {}\n\nmodule.exports = function liveFactory (arc) {\n  return function live ({ name, payload }, callback) {\n\n    function publish (arn, payload, callback) {\n      let sns = new aws.SNS\n      sns.publish({\n        TopicArn: arn,\n        Message: JSON.stringify(payload)\n      }, callback)\n    }\n\n    function cacheLedgerAndPublish (serviceMap) {\n      ledger = serviceMap.events\n      if (!ledger[name]) callback(ReferenceError(`${name} event not found`))\n      else publish(ledger[name], payload, callback)\n    }\n\n    let arn = ledger[name]\n    if (arn) {\n      publish(ledger[name], payload, callback)\n    }\n    else {\n      arc.services().then(cacheLedgerAndPublish).catch(callback)\n    }\n  }\n}\n", "let sandbox = require('./publish-sandbox')\nlet topicFactory = require('./publish-topic')\n\n/**\n * invoke an event lambda by sns topic name\n */\nmodule.exports = function publishFactory (arc) {\n  let topic = topicFactory(arc)\n  return function publish (params, callback) {\n    if (!params.name)\n      throw ReferenceError('missing params.name')\n\n    if (!params.payload)\n      throw ReferenceError('missing params.payload')\n\n    let promise\n    if (!callback) {\n      promise = new Promise((resolve, reject) => {\n        callback = function errback (err, result) {\n          err ? reject(err) : resolve(result)\n        }\n      })\n    }\n\n    let isLocal = process.env.NODE_ENV === 'testing' || process.env.ARC_LOCAL\n    let exec = isLocal ? sandbox : topic\n    exec(params, callback)\n    return promise\n  }\n}\n", "let oldPublish = require('./publish-old')\nlet subscribe = require('./subscribe')\nlet publishFactory = require('./publish')\n\nmodule.exports = function eventFactory (arc) {\n  let publish = publishFactory(arc)\n  return {\n    /**\n     * arc.events.publish\n     *\n     * publish events (sns topics)\n     *\n     * @param {Object} params\n     * @param {String} params.name - the event name (required)\n     * @param {String} params.payload - a json event payload (required)\n     * @param {Function} callback - a node style errback (optional)\n     * @returns {Promise} - returned if no callback is supplied\n     */\n    publish (params, callback) {\n      if (process.env.ARC_CLOUDFORMATION) {\n        return publish(params, callback)\n      }\n      else {\n        return oldPublish(params, callback)\n      }\n    },\n\n    /**\n     * arc.events.subscribe\n     *\n     * listen for events (sns topics)\n     *\n     * @param {Function} handler - a single event handler function\n     * @returns {Lambda} - a Lambda function sig: (event, context, callback)=>\n     */\n    subscribe\n  }\n}\n", "/**\n * Ensure env is one of: 'testing', 'staging', or 'production'\n * - Some test harnesses (ahem) will automatically populate NODE_ENV with their own values, unbidden\n * - Due to tables.direct auto initializing, always set (or override) default NODE_ENV to 'testing'\n */\nlet env = process.env.NODE_ENV\nlet isNotStagingOrProd = env !== 'staging' && env !== 'production'\nif (!env || isNotStagingOrProd) {\n  process.env.NODE_ENV = 'testing'\n}\n\n\nlet http = require('./http')\nlet _static = require('./static')\nlet serviceDiscovery = require('./discovery')\nlet services\n\nlet send = require('./ws')\nlet arc = {\n  http,\n  static: _static,\n  ws: { send },\n  services: function () {\n    return new Promise(function (resolve, reject) {\n      if (services) resolve(services)\n      else serviceDiscovery(function (err, serviceMap) {\n        if (err) reject(err)\n        else {\n          services = serviceMap\n          resolve(services)\n        }\n      })\n    })\n  }\n}\narc.tables = require('./tables')(arc)\narc.queues = require('./queues')(arc)\narc.events = require('./events')(arc)\n\n// backwards compat\narc.proxy = {}\narc.proxy.public = http.proxy.public\narc.middleware = http.middleware\n// backwards compat\n\nmodule.exports = arc\n", "import { Handler } from 'aws-lambda';\nimport { AWSLambda as SentryAWSLambda } from '@sentry/serverless';\nimport { monitor as monitorConfig } from './config';\nimport { version } from '../package.json';\n\ninterface WrapOptions {\n  rethrow: boolean;\n}\n\nconst {\n  sentry: { dsn: sentryDSN },\n} = monitorConfig();\n\nif (sentryDSN) {\n  SentryAWSLambda.init({\n    dsn: sentryDSN,\n    tracesSampleRate: 1.0,\n    environment: process.env.NODE_ENV,\n    release: version,\n  });\n}\n\nexport function wrapHandler<T>(\n  handler: Handler<T>,\n  options: Partial<WrapOptions> = {}\n) {\n  if (sentryDSN) {\n    const { rethrow = true } = options;\n    return SentryAWSLambda.wrapHandler(handler, {\n      rethrowAfterCapture: rethrow,\n    });\n  }\n  return handler;\n}\n", "import { fail } from 'assert';\n\nexport function s3() {\n  return {\n    endpoint: env('DECI_S3_ENDPOINT', 'localhost:4568'),\n    accessKeyId: env('DECI_S3_ACCESS_KEY_ID'),\n    secretAccessKey: env('DECI_S3_SECRET_ACCESS_KEY'),\n    buckets: {\n      pads: env('DECI_S3_PADS_BUCKET'),\n      attachments: env('DECI_S3_ATTACHMENTS_BUCKET'),\n    },\n  };\n}\n\nexport function monitor() {\n  return {\n    sentry: {\n      dsn: env('SENTRY_DSN', ''),\n    },\n  };\n}\n\nexport function app() {\n  return {\n    urlBase: env('DECI_APP_URL_BASE', 'http://localhost:4200'),\n    limits: {\n      maxAttachmentSize: Number(env('DECI_MAX_ATTACHMENT_SIZE', '10485760')),\n      maxAttachmentUploadTokenExpirationSeconds: Number(\n        env('DECI_MAX_ATTACHMENT_UPLOAD_TOKEN_EXPIRATION_SECONDS', '600')\n      ),\n      maxAttachmentDownloadTokenExpirationSeconds: Number(\n        env('DECI_MAX_ATTACHMENT_DOWNLOAD_TOKEN_EXPIRATION_SECONDS', '600')\n      ),\n    },\n  };\n}\n\nexport function auth() {\n  return {\n    userKeyValidationExpirationSeconds: Number(\n      env('DECI_KEY_VALIDATION_EXPIRATION_SECONDS', '2592000')\n    ),\n    inviteExpirationSeconds: Number(\n      env('DECI_INVITE_EXPIRATION_SECONDS', '86400')\n    ),\n    jwt: {\n      secret: env('JWT_SECRET'),\n      signingKey: Buffer.from(\n        env('JWT_SIGNING_PRIVATE_KEY'),\n        'base64'\n      ).toString(),\n      maxAge: Number(env('JWT_MAX_AGE', '2592000')),\n    },\n    providers: {\n      github: {\n        clientId: env('GITHUB_CLIENT_ID'),\n        clientSecret: env('GITHUB_CLIENT_SECRET'),\n      },\n    },\n  };\n}\n\nexport function email() {\n  return {\n    ses: {\n      accessKeyId: env('DECI_SES_ACCESS_KEY_ID'),\n      secretAccessKey: env('DECI_SES_SECRET_ACCESS_KEY'),\n      region: env('AWS_REGION', 'eu-west-2'),\n    },\n    senderEmailAddress: env('DECI_FROM_EMAIL_ADDRESS'),\n  };\n}\n\nfunction env(\n  name: string,\n  defaultValue: string | undefined = undefined\n): string {\n  let value = process.env[name];\n  if (value == null) {\n    if (defaultValue !== undefined) {\n      value = defaultValue;\n    } else {\n      fail(`${name} env var must be defined`);\n    }\n  }\n  return value;\n}\n", "import { APIGatewayProxyEventV2 as APIGatewayProxyEvent } from 'aws-lambda';\nimport { HttpResponse } from '@architect/functions';\nimport { wrapHandler } from './monitor';\n\ntype Handler = (req: APIGatewayProxyEvent) => Promise<string | HttpResponse>;\n\nexport default (handler: Handler) => {\n  return wrapHandler(\n    async (req: APIGatewayProxyEvent): Promise<HttpResponse> => {\n      try {\n        const result = await handler(req);\n        if (result === null || result === undefined) {\n          return {\n            statusCode: 404,\n          };\n        }\n\n        if (typeof result === 'string') {\n          return {\n            statusCode: okStatusCodeFor(req),\n            body: result,\n            headers: {\n              'content-type': 'text/plain',\n            },\n          };\n        }\n        if (isFullReturnObject(result)) {\n          return result;\n        }\n        return {\n          statusCode: okStatusCodeFor(req),\n          headers: {\n            'content-type': 'application/json; charset=utf-8',\n          },\n          body: JSON.stringify(result),\n        };\n      } catch (err) {\n        console.error(err);\n        return {\n          statusCode: 500,\n          json: {\n            name: err.name,\n            message: err.message,\n            stack: err.stack,\n          },\n        };\n      }\n    }\n  );\n};\n\nfunction isFullReturnObject(result: HttpResponse) {\n  return !!result.statusCode || !!result.json;\n}\n\nfunction okStatusCodeFor(req: APIGatewayProxyEvent) {\n  const verb = req.routeKey.split(' ')[0];\n  switch (verb) {\n    case 'PUT':\n    case 'DELETE':\n      return 202;\n    case 'POST':\n      return 201;\n  }\n  return 200;\n}\n", "import { APIGatewayProxyEventV2 as APIGatewayProxyEvent } from 'aws-lambda';\nimport { parse as parseCookie } from 'simple-cookie';\nimport NextAuthJWT from 'next-auth/jwt';\nimport tables from './tables';\nimport jwtConf from './auth-flow/jwt';\n\ntype AuthResult = {\n  user: User | null;\n  token: string | null | undefined;\n  secret: string | null;\n  gotFromSecProtocolHeader: boolean;\n};\n\ntype SessionTokenResult = {\n  token: string | null | undefined;\n  gotFromSecProtocolHeader: boolean;\n};\n\ntype Request = APIGatewayProxyEvent & {\n  cookies?: string[] | null;\n};\n\ntype ParsedCookies = Record<string, string>;\n\nexport const TOKEN_COOKIE_NAMES = [\n  'next-auth.session-token',\n  '__Secure-next-auth.session-token',\n];\n\nasync function auth(event: Request): Promise<AuthResult> {\n  const { token, gotFromSecProtocolHeader } = getSessionToken(event);\n  let user: User | null = null;\n  let secret: string | null = null;\n  if (token) {\n    const { decode: decodeJWT } = NextAuthJWT;\n    try {\n      const decoded = await decodeJWT({\n        ...jwtConf,\n        token,\n      });\n\n      if (decoded.accessToken) {\n        const userWithSecret = await findUserByAccessToken(\n          decoded.accessToken as string\n        );\n        if (userWithSecret) {\n          const { secret: _secret, ...userWithoutSecret } = userWithSecret;\n          secret = _secret;\n          user = userWithoutSecret;\n        }\n      }\n    } catch (err) {\n      console.error(err.message);\n      // do nothing\n    }\n  }\n\n  return { user, token, secret, gotFromSecProtocolHeader };\n}\n\nfunction getSessionToken(event: Request): SessionTokenResult {\n  let gotFromSecProtocolHeader = false;\n  const cookies = parseCookies(event.headers.Cookie || event.cookies || []);\n  let token =\n    cookies[TOKEN_COOKIE_NAMES[0]] ||\n    cookies[TOKEN_COOKIE_NAMES[1]] ||\n    event.headers.authorization ||\n    event.headers.Authorization;\n  if (!token) {\n    const protocol =\n      event.headers['sec-websocket-protocol'] ||\n      event.headers['Sec-WebSocket-Protocol'];\n    if (protocol) {\n      const protocolParts = protocol\n        .split(',')\n        .map((t) => t.trim())\n        .filter((t) => t !== 'graphql-transport-ws');\n      if (protocolParts.length === 1) {\n        token = protocolParts[0];\n        gotFromSecProtocolHeader = true;\n      }\n    }\n  }\n  if (token && token.startsWith('Bearer ')) {\n    token = token.substring('Bearer '.length);\n  }\n  return { token, gotFromSecProtocolHeader };\n}\n\nfunction parseCookies(cookies: string[] | string): ParsedCookies {\n  if (!cookies) {\n    cookies = [];\n  }\n  if (!Array.isArray(cookies)) {\n    cookies = [cookies];\n  }\n  return cookies.reduce((cookies: ParsedCookies, cookie: string) => {\n    const { name, value } = parseCookie(cookie) as {\n      name: string;\n      value: string;\n    };\n    cookies[name] = value;\n    return cookies;\n  }, {} as ParsedCookies);\n}\n\nasync function findUserByAccessToken(\n  accessToken: string\n): Promise<UserWithSecret | undefined> {\n  const data = await tables();\n\n  const foundUsers = await data.users.query({\n    IndexName: 'bySecret',\n    KeyConditionExpression: 'secret = :secret',\n    ExpressionAttributeValues: {\n      ':secret': accessToken,\n    },\n  });\n\n  return foundUsers.Items[0];\n}\n\nexport default auth;\n", "import arc from '@architect/functions';\nimport timestamp from '../utils/timestamp';\n\nconst enhancedTables: (keyof EnhancedDataTables)[] = [\n  'users',\n  'userkeys',\n  'permissions',\n  'workspaces',\n  'pads',\n  'workspaceroles',\n  'invites',\n  'futurefileattachments',\n  'fileattachments',\n];\n\nconst observedTables = [\n  'userkeys',\n  'permissions',\n  'tags',\n  'usertaggedresources',\n  'fileattachments',\n];\n\nlet tablesPromise: Promise<DataTables>;\n\nexport default async function tables(): Promise<DataTables> {\n  if (tablesPromise) {\n    return tablesPromise;\n  }\n\n  const p = new Promise<DataTables>((resolve, reject) => {\n    arc\n      .tables()\n      .then((_tables) => {\n        const tables = _tables as unknown as DataTables;\n        for (const enhancedTableName of enhancedTables) {\n          enhance(tables, enhancedTableName);\n        }\n        for (const observedTable of observedTables) {\n          observe(tables, observedTable);\n        }\n        resolve(tables);\n      })\n      .catch(reject);\n  });\n\n  return p;\n}\n\nfunction observe(tables: DataTables, tableName: keyof DataTables) {\n  const table = tables[tableName];\n  if (!table) {\n    throw new Error('No table named ' + tableName);\n  }\n  if (table.__deci_observed__) {\n    return;\n  }\n  table.__deci_observed__ = true;\n\n  table['put'] = putReplacer(table, tableName, table.put);\n  table['delete'] = deleteReplacer(table, tableName, table.delete);\n}\n\nfunction putReplacer<T>(\n  table: DataTable<T>,\n  tableName: keyof DataTables,\n  method: (doc: any) => Promise<void>\n) {\n  return async function putReplacer(args: any) {\n    const ret = await method.call(table, args);\n\n    await arc.queues.publish({\n      name: `${tableName}-changes`,\n      payload: {\n        table: tableName,\n        action: 'put',\n        args,\n      },\n    });\n\n    return ret;\n  };\n}\n\nfunction deleteReplacer<T>(\n  table: DataTable<T>,\n  tableName: keyof DataTables,\n  method: (doc: any) => Promise<void>\n) {\n  return async function deleteReplacer(args: any) {\n    const recordBeforeDelete = await table.get({ id: args.id });\n    const ret = await method.call(table, args);\n\n    await arc.queues.publish({\n      name: `${tableName}-changes`,\n      payload: {\n        table: tableName,\n        action: 'delete',\n        args,\n        recordBeforeDelete,\n      },\n    });\n\n    return ret;\n  };\n}\n\nfunction enhance(tables: DataTables, tableName: keyof DataTables) {\n  const table = tables[tableName];\n  if (!table) {\n    throw new Error('No table named ' + tableName);\n  }\n\n  if (typeof table.create === 'function') {\n    return;\n  }\n\n  table.create = async function create(doc: any) {\n    if (!doc.createdAt) {\n      doc.createdAt = timestamp();\n    }\n\n    return table.put(doc);\n  };\n}\n", "export default function timestamp(): number {\n  return Math.round(Date.now() / 1000);\n}\n", "import NextAuthJWT from 'next-auth/jwt';\nimport { auth as authConfig } from '../config';\n\nconst config = authConfig().jwt;\n\nexport default {\n  ...config,\n  encode: NextAuthJWT.encode,\n  decode: NextAuthJWT.decode,\n};\n", "import tables from './tables';\n\nexport async function isAuthorized(resource: string, user: TableRecordIdentifier, permissionType: PermissionType = 'READ'): Promise<boolean> {\n  if (resource.endsWith('/')) {\n    resource = resource.substring(0, resource.length - 1);\n  }\n  const data = await tables();\n  const permissions: PermissionRecord[] = (\n    await data.permissions.query({\n      IndexName: 'byResourceAndUser',\n      KeyConditionExpression:\n        'user_id = :user_id and resource_uri = :resource_uri',\n      ExpressionAttributeValues: {\n        ':user_id': user.id,\n        ':resource_uri': resource,\n      },\n    })\n  ).Items;\n\n  return permissions.some(isEnoughPermissionFor(permissionType));\n}\n\nfunction isEnoughPermissionFor(requiredPermissionType: PermissionType) {\n  return (existingPermission: PermissionRecord): boolean => {\n    if (requiredPermissionType === 'READ') {\n      return true;\n    }\n    if (requiredPermissionType === 'WRITE') {\n      return (\n        existingPermission.type === 'WRITE' ||\n        existingPermission.type === 'ADMIN'\n      );\n    }\n    return existingPermission.type === requiredPermissionType;\n  };\n}\n", "export function encode(id: string) {\n  let newId = id.replace(/\\//g, ':');\n  if (newId.startsWith(':')) {\n    newId = newId.substring(1);\n  }\n  return newId;\n}\n\nexport function decode(id: string | undefined) {\n  let newId = (id || '').replace(/:/g, '/');\n  if (!newId.startsWith('/')) {\n    newId = '/' + newId;\n  }\n  return newId;\n}\n", "import S3 from 'aws-sdk/clients/s3';\nimport { s3 as s3Config } from '../config';\n\nconst { buckets, ...config } = s3Config();\nconst options = {\n  ...config,\n  sslEnabled: process.env.NODE_ENV !== 'testing',\n  s3ForcePathStyle: true,\n  signatureVersion: 'v4',\n};\nconst Bucket = buckets.pads;\nconst s3 = new S3(options);\n\nexport function duplicate(id: ID, oldID: ID): Promise<void> {\n  const CopySource =\n    '/' + Bucket + '/' + encodeId(`/pads/${encodeId(oldID)}/content`);\n  const options = {\n    Bucket,\n    Key: encodeId(`/pads/${encodeId(id)}/content`),\n    CopySource,\n  };\n\n  return s3\n    .copyObject(options)\n    .promise()\n    .catch((err) => {\n      if (err.statusCode === 404 || err.statusCode === 403) {\n        return null;\n      }\n      console.log(`Error copying ${id}:`, err);\n      throw err;\n    })\n    .then(() => {\n      return;\n    });\n}\n\nexport function put(id: ID, _body: string): Promise<any> {\n  const Body = Buffer.from(_body, 'utf-8');\n  const Key = encodeId(id);\n  const options = {\n    Bucket,\n    Key,\n    Body,\n  };\n  return s3\n    .putObject(options)\n    .promise()\n    .catch((err) => {\n      console.log(`Error putting ${id} in ${Bucket}:`, err);\n      throw err;\n    });\n}\n\nexport function get(id: ID): Promise<string | null> {\n  const options = {\n    Bucket,\n    Key: encodeId(id),\n  };\n  return s3\n    .getObject(options)\n    .promise()\n    .catch((err) => {\n      if (err.statusCode === 404 || err.statusCode === 403) {\n        return null;\n      }\n      console.log(`Error getting ${id}:`, err);\n      throw err;\n    })\n    .then((data) => {\n      return data?.Body ? data.Body.toString('utf-8') : null;\n    });\n}\n\nexport async function remove(id: ID): Promise<void> {\n  await s3\n    .deleteObject({\n      Bucket,\n      Key: encodeId(id),\n    })\n    .promise();\n}\n\nfunction encodeId(id: string): string {\n  return encodeURIComponent(id);\n}\n", "import { APIGatewayProxyEventV2 as APIGatewayProxyEvent } from 'aws-lambda';\nimport handle from '../../../handle';\nimport auth from '../../../auth';\nimport { isAuthorized } from '../../../authorization';\nimport { decode } from '../../../resource';\nimport { get } from '../../../s3/pads';\n\nexports.handler = handle(async (event: APIGatewayProxyEvent) => {\n  const { user } = await auth(event);\n\n  if (!event.pathParameters) {\n    return {\n      statusCode: 401,\n      body: 'missing parameters',\n    };\n  }\n  const id = decode(event.pathParameters.id!);\n  if (!user || !(await isAuthorized(id, user, 'READ'))) {\n    return {\n      status: 403,\n      body: 'Forbidden',\n    };\n  }\n\n  const doc = await get(id);\n  if (!doc) {\n    return {\n      statusCode: 403,\n      body: 'Not found',\n    };\n  }\n  return doc;\n});\n"],
  "mappings": "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",
  "names": []
}
