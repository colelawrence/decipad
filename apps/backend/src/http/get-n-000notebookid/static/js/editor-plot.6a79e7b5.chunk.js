"use strict";exports.id=5145,exports.ids=[5145],exports.modules={34098:(e,t,l)=>{l.r(t),l.d(t,{default:()=>ye});var n,a,o=l(85663),r=l(1146),i=l(55013),c=l(426),s=l(30969),d=l(79820),u=l(168),m=l(5594);const p={name:"1t782ze--CellInput--inputStyles",styles:"width:100%;background:transparent;border:0;font-variant-numeric:tabular-nums;::placeholder{opacity:0.5;};label:-CellInput--inputStyles;"},h=(0,c.css)(u.editorTable.typography,{height:"calc(".concat(null===(n=u.editorTable.typography)||void 0===n?void 0:n.lineHeight," * ").concat(null===(a=u.editorTable.typography)||void 0===a?void 0:a.fontSize,")")},";label:-CellInput--headingStyles;"),y=(0,c.css)(d.t5,"padding:6px 0;;label:-CellInput--headerStyles;"),g=(0,c.css)(d.ts,"padding:8px 0;;label:-CellInput--dataStyles;"),f=()=>!0,b=e=>{let{id:t,placeholder:l,readOnly:n=!1,variant:a="data",value:o,format:r=i.yR,onChange:c=i.ZT,validate:d=f,transform:u=i.yR}=e;const[b,v]=(0,s.useState)(null),k=(0,s.useRef)(null);(0,s.useEffect)((()=>{v(null)}),[o]);const x=()=>{null!=b&&(d(b)?c(u(b)):c(""),v(null))},C=null!=b?b:r(o);return(0,m.tZ)("input",{id:t,css:[p,"heading"===a&&h,"header"===a&&y,"data"===a&&g,";label:-CellInput--CellInput;"],ref:k,onBlur:x,onChange:e=>{v(e.target.value)},onFocus:()=>{v(o)},onKeyDown:e=>{"Enter"===e.key&&x()},placeholder:l,readOnly:n,value:C})};var v=l(66840);const k=(0,c.css)(d.ts,(0,v.m)("currentTextColor",(0,v.g)("errorColor")),";label:-ErrorMessage--errorStyles;"),x=e=>{let{message:t}=e;return(0,m.tZ)("p",{contentEditable:!1,css:k,children:t})};var C=l(32514),N=l(55575),S=l(71799);const T=["line","bar","arc","area","point"],Z={bar:"Bar",line:"Line",point:"Point",area:"Area",arc:"Pie"},P=["point","circle","square","tick"],z=(0,c.css)(d.KY,";label:-PlotParams--selectFontStyles;"),B=(0,c.css)({backgroundColor:(0,v.g)("highlightColor"),width:"100%",maxWidth:"140px"},";label:-PlotParams--selectStyles;"),w=e=>{let{labelText:t,children:l,value:n,setValue:a}=e;return(0,m.tZ)(N._,{renderContent:e=>(0,m.tZ)("select",{css:[z,B,";label:-PlotParams--SelectInput;"],id:e,onChange:e=>{a(e.target.value)},value:n,children:l}),children:(0,m.BX)("span",{css:z,children:[t,":"]})})},V={name:"1gxxle5--PlotParams--wrapperContainerStyles",styles:"margin-bottom:20px;label:-PlotParams--wrapperContainerStyles;"},O={name:"1vu5uqe--PlotParams--containerStyles",styles:"display:flex;flex-wrap:wrap;gap:4px;margin-bottom:4px;label:-PlotParams--containerStyles;"},E=["deciblues","accent","category20","dark2","paired","pastel1","pastel2","set2","set3"],R=()=>(0,m.BX)(m.HY,{children:[(0,m.tZ)("option",{value:""},"__none"),";",E.map((e=>(0,m.tZ)("option",{value:e,children:e},e)))]}),X=e=>{let{sourceVarName:t,sourceVarNameOptions:l,sourceExprRefOptions:n,columnNameOptions:a,setSourceVarName:o,markType:r,setMarkType:i,xColumnName:c,setXColumnName:s,yColumnName:d,setYColumnName:u,sizeColumnName:p,setSizeColumnName:h,colorColumnName:y,setColorColumnName:g,thetaColumnName:f,setThetaColumnName:b,colorScheme:v,setColorScheme:k,shape:x,setShape:C}=e;const N=(0,m.tZ)("option",{value:""},"__none"),z=[N].concat(l.map(((e,t)=>{var l;return(0,m.tZ)("option",{value:null!==(l=null===n||void 0===n?void 0:n[t])&&void 0!==l?l:e,children:e},e)}))),B=[N].concat(a.map((e=>(0,m.tZ)("option",{value:e,children:e},e)))),E=[N].concat(T.map((e=>(0,m.tZ)("option",{value:e,children:Z[e]},e))));return(0,m.BX)("div",{css:[V,S.XS,";label:-PlotParams--PlotParams;"],children:[(0,m.BX)("div",{css:O,children:[(0,m.tZ)(w,{labelText:"Table",setValue:o,value:t,children:z}),t&&(0,m.BX)(m.HY,{children:[(0,m.tZ)(w,{labelText:"Chart",setValue:i,value:P.includes(r)?"point":r,children:E}),P.includes(r)&&(0,m.tZ)(w,{labelText:"Shape",setValue:C,value:x,children:P.map((e=>(0,m.tZ)("option",{value:e,children:e},e)))})]})]}),t&&(0,m.BX)("div",{css:O,children:["arc"!==r&&(0,m.BX)(m.HY,{children:[(0,m.tZ)(w,{labelText:"Label",setValue:s,value:c,children:B}),(0,m.tZ)(w,{labelText:"Value",setValue:u,value:d,children:B}),(P.includes(r)||"area"===r)&&(0,m.tZ)(w,{labelText:"Sizes",setValue:h,value:p,children:B})]}),"arc"===r&&(0,m.tZ)(w,{labelText:"Slice size",setValue:b,value:f,children:B}),("bar"===r||"arc"===r)&&(0,m.tZ)(w,{labelText:"Colors",setValue:g,value:y,children:B}),("bar"===r||"arc"===r)&&y&&(0,m.tZ)(w,{labelText:"Color Scheme",setValue:k,value:v||"",children:(0,m.tZ)(R,{})})]})]})};var I=l(42356),A=l(70099);const D=()=>{const[e]=(0,r.yt)();return e?{...A.dark,background:"transparent"}:void 0};const Y={name:"cuzs7u--PlotResult--styles",styles:"& > svg{max-width:100%;};label:-PlotResult--styles;"},j=e=>{let{spec:t,data:l,onError:n=i.ZT}=e;const a=S.cR-10;return(0,m.tZ)(I.Z,{css:Y,renderer:"svg",spec:t,data:l,width:a,height:a/1.618,onError:n,actions:!1,config:D()})};const F={name:"1cnncrj--PlotBlock--plotIconSizeStyles",styles:"display:grid;width:22px;height:22px;label:-PlotBlock--plotIconSizeStyles;"},M={name:"1uojmb6--PlotBlock--plotTitleStyles",styles:"display:flex;align-items:center;gap:4px;label:-PlotBlock--plotTitleStyles;"},q={name:"1y95mkj--PlotBlock--plotBlockStyles",styles:"display:grid;row-gap:16px;label:-PlotBlock--plotBlockStyles;"},H={name:"x198hx--PlotBlock--plotStyles",styles:"align-self:center;label:-PlotBlock--plotStyles;"},W=e=>{let{readOnly:t=!1,errorMessage:l,plotParams:n,result:a,title:o,onTitleChange:r=i.ZT}=e;return(0,m.BX)("section",{css:q,contentEditable:!1,children:[(0,m.BX)("div",{css:M,children:[(0,m.tZ)("div",{css:F,children:(0,m.tZ)(C.X,{})}),(0,m.tZ)(b,{value:o,onChange:r,placeholder:"Chart title"})]}),(0,m.BX)(m.HY,{children:[!t&&(0,m.tZ)(X,{...n}),l&&(0,m.tZ)(x,{message:l}),a&&(0,m.tZ)("output",{css:H,children:(0,m.tZ)(j,{...a})})]})]})};var _=l(94866),K=l(24217),L=l(82623),$=l(13986);const Q={xColumnName:"x",yColumnName:"y",sizeColumnName:"size",colorColumnName:"color",thetaColumnName:"theta"},U={x:!1,y:!0,size:!1,color:!1,theta:!1},G=Object.keys(Q),J=e=>{switch(e){case"bar":case"area":case"point":return"rgba(69, 195, 235)";case"circle":case"square":return"white";default:return}};function ee(e){return[e.xColumnName,e.yColumnName,e.sizeColumnName,e.colorColumnName,e.thetaColumnName].filter(Boolean)}function te(e){if("date"!==e.kind)throw new Error("expected column to be of date type");switch(e.date){case"year":return"utcyear";case"month":return"utcyearmonth";case"day":return"utcyearmonthdate";case"hour":return"utcyearmonthdatehours";case"minute":return"utcyearmonthdatehoursminutes";case"second":case"millisecond":return"utcyearmonthdatehoursminutesseconds"}}function le(e,t,l,n,a){const o=function(e){switch(e.kind){case"date":return"temporal";case"string":return"nominal";default:return"quantitative"}}(l),r={field:t,type:o,title:"",timeUnit:"date"===l.kind?te(l):void 0,axis:{grid:n},legend:"arc"!==a?null:void 0};return"nominal"===o&&(r.sort=null),r}function ne(e){const t=[];let l=!0;for(const[n,a]of Object.entries(e))n&&a&&(a.forEach(((e,a)=>{if(l)t.push([[n,e]]);else{t[a].push([n,e])}})),l=!1);return t.map((e=>Object.fromEntries(e)))}function ae(e,t){if(!e||"table"!==e.type.kind)return;const l=null===e||void 0===e?void 0:e.type;if(!l||"table"!==l.kind)return;const n=null===e||void 0===e?void 0:e.value;if(!n)return;const a=n,o=ee(t),r=o.map((e=>{const t=l.columnNames.indexOf(e);return[l.columnTypes[t],a[t]]})),i={};return o.forEach(((e,t)=>{const[l,n]=r[t];i[e]=function(e,t){return t&&t.length?"number"===e.kind?t.map((t=>(0,$.kc)(t,e.unit).valueOf())):"date"===e.kind?t.map((e=>new Date(Number(e)))):t:t}(l,n)})),{table:ne(i)}}function oe(e,t){let l=1/0,n=-1/0;for(const a of t){const t=a[e];t&&"number"===typeof t&&(t<l&&(l=t),t>n&&(n=t))}if(Number.isFinite(l)&&Number.isFinite(n)){const e=n-l;return[Math.min(l,0),Math.ceil(n+e/10)]}}const re=new Set(["number","date"]),ie=new Set(["string","boolean"]),ce=function(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if("table"!==e.kind)return;let n=-1;for(const a of e.columnTypes){n+=1;const o=e.columnNames[n];if(!(l.indexOf(o)>=0)&&("column"===a.kind&&t.has(a.cellType.kind)))return[e.columnNames[n],a.cellType]}},se=(e,t)=>ce(e,re,t),de=(e,t)=>ce(e,ie,t),ue=e=>!e.name.includes(".")&&"table"===e.type.kind,me=["point","circle","square","tick"],pe=e=>{var t;const l=(0,o.l3)(),n=(0,r.Iy)(),a=n.getNamesDefined$.useWithSelector((e=>e.filter(ue).map((e=>((e,t)=>{var l;return{...t,exprRef:(0,$.v5)(null!==(l=e.getVarBlockId(t.name))&&void 0!==l?l:"")}})(n,e))))),i=null===(t=n.getVarResult$.use(e.sourceVarName))||void 0===t?void 0:t.result;let c=(e=>{return e?("arc"===e.mark.type?(e.encoding.x&&(e.encoding.x=void 0),e.encoding.y&&(e.encoding.y=void 0),e.encoding.size&&(e.encoding.size=void 0),e.mark.theta||(e.mark.theta=0),e.mark.innerRadius||(e.mark.innerRadius=50),null!==(t=e.encoding.theta)&&void 0!==t&&t.scale&&(e.encoding.theta.scale=void 0)):e.encoding.theta&&(e.encoding.theta=void 0),"line"!==e.mark.type&&"area"!==e.mark.type||e.mark.point||(e.mark.point={filled:!1,fill:"white",size:140,strokeWidth:5}),"line"===e.mark.type&&e.encoding.size&&(e.encoding.size=void 0),"bar"!==e.mark.type||e.mark.cornerRadiusEnd||(e.mark.cornerRadiusEnd=4,null!==(l=e.encoding)&&void 0!==l&&null!==(n=l.y)&&void 0!==n&&n.axis&&(e.encoding.y.axis.labelAlign="right"),e.encoding.size&&(e.encoding.size=void 0)),e.config||(e.config={}),e.config.autosize||(e.config.autosize="fit"),e.config.axis||(e.config.axis={titleColor:"#999"}),e.config.style||(e.config.style={cell:{stroke:"transparent"}}),e.config.legend||(e.config.legend={direction:"horizontal",orient:"top"}),e.encoding.color&&(null!==(a=e.encoding.color.scale)&&void 0!==a&&a.scheme||(e.encoding.color.scale={scheme:"sameblue"})),e):e;var t,l,n,a})(((e,t,l)=>{if("table"!==(null===t||void 0===t?void 0:t.kind)||!l)return l;if("arc"===l.mark.type){const n=[];if(!l.encoding.theta){const a=se(t,n);a&&(n.push(a[0]),l.encoding.theta=le(e,...a,!1,l.mark.type))}if(!l.encoding.color){const a=de(t,n);a&&(l.encoding.theta=le(e,...a,!1,l.mark.type))}return l}if(!l.encoding.x){var n,a,o;const r=[null===(n=l.encoding.y)||void 0===n?void 0:n.field,null===(a=l.encoding.size)||void 0===a?void 0:a.field,null===(o=l.encoding.color)||void 0===o?void 0:o.field],i=de(t,r)||se(t,r);i&&(l.encoding.x=le(e,...i,!1,l.mark.type))}if(!l.encoding.y){var r,i,c;const n=[null===(r=l.encoding.x)||void 0===r?void 0:r.field,null===(i=l.encoding.size)||void 0===i?void 0:i.field,null===(c=l.encoding.color)||void 0===c?void 0:c.field],a=se(t,n)||de(t,n);a&&(l.encoding.y=le(e,...a,!0,l.mark.type))}if(!l.encoding.y){const n=se(t)||de(t);n&&(l.encoding.y=le(e,...n,!0,l.mark.type))}return l})(n,null===i||void 0===i?void 0:i.type,function(e,t,l){if(!l.markType||!t||"table"!==t.kind)return;const n=ee(l),a=n.map((e=>t.columnNames.indexOf(e))).map((e=>e>=0&&t.columnTypes[e]||void 0)),o=G.reduce(((e,t)=>{const o=l[t];if(!o)return e;const r=n.indexOf(o),i=a[r];if(i){const n=Q[t];e[n]=le(0,o,i,U[n],l.markType)}return e}),{});o.color&&!o.color.scale&&(o.color.scale={scheme:l.colorScheme}),o.y&&o.y.axis&&(o.y.axis.labelAngle=0,o.y.axis.labelBaseline="line-bottom",o.y.axis.labelAlign="left"),o.x&&o.x.axis&&(o.x.axis.labelColor="#777E89",o.x.axis.labelFontSize=14,o.x.axis.labelFontWeight=700),"bar"!==l.markType&&"arc"!==l.markType&&(o.color=void 0);const r="bar"===l.markType?{width:{band:.75}}:{};return{mark:{type:l.markType,tooltip:!0,...r},data:{name:"table"},encoding:o,config:{encoding:{color:{scheme:l.colorScheme||"deciblues"}},symbol:{stroke:"rgba(69, 195, 235)",fill:"0xfff"},mark:{stroke:"arc"===l.markType||o.color?void 0:"rgba(69, 195, 235)",fill:J(l.markType),strokeWidth:6},axis:{gridColor:"#AAB1BD",gridDash:[5,5],labelColor:"#D6D6D6",domainColor:"#AAB1BD",domainOpacity:0,labelAngle:-45,labelBound:!0,labelFontSize:12,tickSize:0},autosize:"fit"}}}(0,null===i||void 0===i?void 0:i.type,e)));const d=ae(i,e);c=c&&d&&function(e,t){if("arc"!==e.mark.type)for(const l of Object.values(null===e||void 0===e?void 0:e.encoding))if(l){const{field:e}=l,n=oe(e,t.table);n&&(l.scale||(l.scale={}),l.scale.domain=n)}return e}(c,d);const u=(0,L.Z)(l,e,"markType"),m=(0,s.useMemo)((()=>{if(me.includes(e.markType))return e.markType}),[e.markType]);return{spec:c,data:d,plotParams:{sourceVarNameOptions:a.map((e=>e.name)),sourceExprRefOptions:a.map((e=>e.exprRef)),columnNameOptions:"table"===(null===i||void 0===i?void 0:i.type.kind)&&i.type.columnNames||[],setSourceVarName:(0,L.Z)(l,e,"sourceVarName"),setMarkType:u,setXColumnName:(0,L.Z)(l,e,"xColumnName"),setYColumnName:(0,L.Z)(l,e,"yColumnName"),setSizeColumnName:(0,L.Z)(l,e,"sizeColumnName"),setColorColumnName:(0,L.Z)(l,e,"colorColumnName"),setThetaColumnName:(0,L.Z)(l,e,"thetaColumnName"),setColorScheme:(0,L.Z)(l,e,"colorScheme"),...e,setShape:u,shape:m}}};var he=l(3828);const ye=e=>{let{attributes:t,element:l,children:n}=e;(0,K.I)(l,o.QC);const a=(0,o.l3)(),i=(0,r.VY)(),{spec:c,data:s,plotParams:d}=pe(l),u=(0,L.Z)(a,l,"title");return(0,m.BX)(_.vL,{element:l,blockKind:"plot",contentEditable:!1,...t,children:[(0,m.tZ)(W,{readOnly:i,plotParams:d,result:c&&s&&{spec:c,data:s},title:l.title||"Plot",onTitleChange:u}),n]})};(0,he.scheme)("deciblues",["#ecf9fd","#daf3fb","#c7edf9","#b5e7f7","#a2e1f5","#8fdbf3","#7dd5f1","#6acfef","#58c9ed","rgba(69, 195, 235)"]),(0,he.scheme)("sameblue",["rgba(69, 195, 235)","rgba(69, 195, 235)","rgba(69, 195, 235)","rgba(69, 195, 235)","rgba(69, 195, 235)","rgba(69, 195, 235)","rgba(69, 195, 235)","rgba(69, 195, 235)","rgba(69, 195, 235)"])}};
//# sourceMappingURL=editor-plot.6a79e7b5.chunk.js.map